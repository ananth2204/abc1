{"INMR01": {"INMLRECL": 80, "INMFNODE": "N1", "INMFUID": "SBGOLOB", "INMTNODE": "A", "INMTUID": "A", "INMFTIME": "20201220012925000000", "INMNUMF": 1}, "INMR02": {"1": {"INMUTILN": "IEBCOPY", "INMSIZE": 58786, "INMDSORG": "PO", "INMTYPE": "None", "INMLRECL": 80, "INMBLKSZ": 5600, "INMRECFM": "FB", "INMDIR": 7, "INMDSNAM": "CBT.V500.FILE840.PDS", "numfile": 1}, "2": {"INMUTILN": "INMCOPY", "INMSIZE": 58786, "INMDSORG": "PS", "INMLRECL": 32756, "INMBLKSZ": 3120, "INMRECFM": "VS", "numfile": 1}}, "INMR03": {"1": {"INMSIZE": 58786, "INMDSORG": "PS", "INMLRECL": 80, "INMRECFM": "?"}}, "file": {"CBT.V500.FILE840.PDS": {"COPYR1": {"type": "PDS", "DS1DSORG": 512, "DS1BLKL": 5600, "DS1LRECL": 80, "DS1RECFM": "FB", "DS1KEYL": 0, "DS1OPTCD": 0, "DS1SMSFG": 0, "file_tape_blocksize": 3120, "DVAOPTS": 12336, "DVACLASS": 32, "DVAUNIT": 15, "DVAMAXRC": 32760, "DVACYL": 3340, "DVATRK": 15, "DVATRKLN": 58786, "DVAOVHD": 0, "num_header_records": 2, "DS1REFD": "200354", "DS1SCEXT": "b'\\x00\\x00\\x00'", "DS1SCALO": "b'\\x80\\x00\\x00\\xbe'", "DS1LSTAR": "b'\\x00\\x02\\x10'", "DS1TRBAL": "b'tz'"}, "COPYR2": {"deb": "b'\\x01\\x00\\x00\\x00\\xff\\x00\\x00\\x00\\x8f\\x03\\x90\\x00\\x04\\x9a\\xc0\\xd8'", "extents": ["b'\\x01\\x00\\x00\\x00\\xff\\x00\\x00\\x00\\x8f\\x03\\x90\\x00\\x04\\x9a\\xc0\\xd8'", "b'X\\xf4\\xfd\\xd0\\x00\\x00\\x05\\xd0\\x00\\x0b\\x05\\xd0\\x00\\r\\x00\\x03'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'"]}, "members": {"$$$#DATE": {"ttr": 516, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x04P\\x00A\\x01\\x102O\\x01\\x102O\\x18W\\x00\\x0c\\x00\\x0c\\x00\\x00\\xc3\\xc2\\xe3`\\xf4\\xf8\\xf0@@@'", "ispf": {"version": "04.80", "flags": 0, "createdate": "2010-11-20T00:00:00", "modifydate": "2010-11-20T18:57:41", "lines": 12, "newlines": 12, "modlines": 0, "user": "CBT-480"}, "text": "REGULAR CBT TAPE - VERSION 480    FILE:  840\n\n    ORIGINAL DSNAME:  SBGOLOB.CBT480.FILE840\n    ---------------\n                    --RECFM-LRECL-BLKSIZE-DSORG\n                      FB    80    5600    PO\n\n   PDS117I 6 MEMBERS COUNTED; CUMULATIVE SIZE IS 206 RECORDS\n\n\nTIME THIS PDS WAS SHIPPED:   11/20/10    18:57:41    GMT-5:00\n\n", "mimetype": "text/plain", "datatype": "iso-8859-1", "extension": ".txt"}, "$$NOTE1": {"ttr": 518, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x00\\x00\\x10\\x01\\x102O\\x01\\x102O\\x18Q\\x006\\x006\\x00\\x00\\xe2\\xc2\\xc7\\xd6\\xd3\\xd6\\xc2@@@'", "ispf": {"version": "01.00", "flags": 0, "createdate": "2010-11-20T00:00:00", "modifydate": "2010-11-20T18:51:10", "lines": 54, "newlines": 54, "modlines": 0, "user": "SBGOLOB"}, "text": "Subject:  Submission to CBT Tape\nFrom:     \"Mark Jacobs\" <mark.jacobs@custserv.com>\nDate:     Fri, 19 Nov 2010 09:09:20 -0500\nTo:       \"Sam Golob\" <sbgolob@cbttape.org>\n\nSam,\n\nI'm attaching to this email an xmit archive of a little ICSF KGUP\nprotection exit that I wrote to save me from shooting myself in\nthe foot if I accentally delete a production data decryption key.\n\nFrom the $NOTES member in the PDS.\n\nICSF PROVIDES A BATCH INTERFACE (KGUP) THAT ALLOWS AN AUTHORIZED ICSF\nADMINISTRATOR TO ADD/DELETE/UPDATE KEYS IN THE CKDS DATABASE.\n\nWHILE YOUR SECURITY PRODUCT CAN PROTECT THE USAGE OF THESE KEYS DURING\nTHEIR INTENDED USAGE, THERE IS NO PROTECTION AGAINST ACCIDENTAL OR\nMALICIOUS ACTIONS ON THE KEYS THEMSELVES.\n\nTHE SUPPLIED KGUPEXIT ICSF EXIT ENHANCES ICSF SECURITY BY CHECKING\nTO SEE IF THE ICSF ADMINISTRATOR HAS UPDATE ACCESS TO THE KEY BEING\nACTED UPON, PRIOR TO ALLOWING THE UTILITY PROGRAM TO PERFORM THE\nREQUESTED FUNCTION.\n\n----------------------------------------\nKEY GENERATION DIAGNOSTIC REPORT\n\nADD TYPE(DATA) LENGTH(24),\n LAB(XYZZY)\n>>>CSFG0414 STATEMENT REJECTED BY INSTALLATION EXIT.\n\nICH408I USER(AIMJ    ) GROUP(TECHSUPT) NAME(JACOBS,MARK HOWARD  )\n  XYZZY CL(CSFKEYS )\n  INSUFFICIENT ACCESS AUTHORITY\n  FROM * (G)\n  ACCESS INTENT(UPDATE )  ACCESS ALLOWED(NONE   )\n-----------------------------------------\n\nMARK JACOBS\nTIME CUSTOMER SERVICE\n\nmark.jacobs@custserv.com\n\n--\nMark Jacobs\nTime Customer Service\nTampa, FL\n----\n\nSam Lowry: Give my best to Alison and the twins.\nJack Lint: Triplets.\nSam Lowry: Triplets? My how time flies\n\n", "mimetype": "text/plain", "datatype": "ebcdic", "extension": ".txt"}, "$NOTES": {"ttr": 520, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x01\\x00G\\x01\\x102?\\x01\\x102?\\x08U\\x00\\x1e\\x00\\x1a\\x00\\x00\\xc1\\xc9\\xd4\\xd1@@@@@@'", "ispf": {"version": "01.01", "flags": 0, "createdate": "2010-11-19T00:00:00", "modifydate": "2010-11-19T08:55:47", "lines": 30, "newlines": 26, "modlines": 0, "user": "AIMJ"}, "text": "ICSF PROVIDES A BATCH INTERFACE (KGUP) THAT ALLOWS AN AUTHORIZED ICSF\nADMINSTRATOR TO ADD/DELETE/UPDATE KEYS IN THE CKDS DATABASE.\n\nWHILE YOUR SECURITY PRODUCT CAN PROTECT THE USAGE OF THESE KEYS DURING\nTHEIR INTENDED USAGE, THERE IS NO PROTECTION AGAINST ACCIDENTAL OR\nMALICIOUS ACTIONS ON THE KEYS THEMSELVES.\n\nTHE SUPPLIED KGUPEXIT ICSF EXIT ENHANCES ICSF SECURITY BY CHECKING\nTO SEE IF THE ICSF ADMINISTRATOR HAS UPDATE ACCESS TO THE KEY BEING\nACTED UPON, PRIOR TO ALLOWING THE UTILITY PROGRAM TO PERFORM THE\nREQUESTED FUNCTION.\n\n----------------------------------------\nKEY GENERATION DIAGNOSTIC REPORT\n\nADD TYPE(DATA) LENGTH(24),\n LAB(XYZZY)\n>>>CSFG0414 STATEMENT REJECTED BY INSTALLATION EXIT.\n\nICH408I USER(AIMJ    ) GROUP(TECHSUPT) NAME(JACOBS,MARK HOWARD  )\n  XYZZY CL(CSFKEYS )\n  INSUFFICIENT ACCESS AUTHORITY\n  FROM * (G)\n  ACCESS INTENT(UPDATE )  ACCESS ALLOWED(NONE   )\n-----------------------------------------\n\nMARK JACOBS\nTIME CUSTOMER SERVICE\n\nmark.jacobs@custserv.com\n", "mimetype": "text/plain", "datatype": "unknown-8bit", "extension": ".txt"}, "@FILE840": {"ttr": 522, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x04P\\x00)\\x01\\x102O\\x01\\x102O\\x18W\\x00\\x07\\x00\\x07\\x00\\x00\\xc3\\xc2\\xe3`\\xf4\\xf8\\xf0@@@'", "ispf": {"version": "04.80", "flags": 0, "createdate": "2010-11-20T00:00:00", "modifydate": "2010-11-20T18:57:29", "lines": 7, "newlines": 7, "modlines": 0, "user": "CBT-480"}, "text": "//***FILE 840 is from Mark Jacobs and contains an ICSF KGUP         *   FILE 840\n//*           protection exit which inhibits the changing of ICSF   *   FILE 840\n//*           decryption keys, based on RACF permissions.           *   FILE 840\n//*           See member called $NOTES.                             *   FILE 840\n//*                                                                 *   FILE 840\n//*           email:  mark.jacobs@custserv.com                      *   FILE 840\n//*                                                                 *   FILE 840\n", "mimetype": "text/plain", "datatype": "unknown-8bit", "extension": ".txt"}, "CSFPRM00": {"ttr": 524, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x00\\x00\\x03\\x01\\x102?\\x01\\x102?\\x08H\\x00\\x10\\x00\\x10\\x00\\x00\\xc1\\xc9\\xd4\\xd1@@@@@@'", "ispf": {"version": "01.00", "flags": 0, "createdate": "2010-11-19T00:00:00", "modifydate": "2010-11-19T08:48:03", "lines": 16, "newlines": 16, "modlines": 0, "user": "AIMJ"}, "text": "CKDSN(CSF.YR2010.CSFCKDS)\nPKDSN(CSF.YR2010.CSFPKDS)\nTKDSN(CSF.CSFTKDS)\nCHECKAUTH(NO)\nCKTAUTH(YES)\nCOMPAT(NO)\nKEYAUTH(NO)\nMAXLEN(2147483647)\nREASONCODES(ICSF)\nSSM(YES)\nSYSPLEXCKDS(YES,FAIL(YES))\nSYSPLEXPKDS(YES,FAIL(YES))\nSYSPLEXTKDS(YES,FAIL(YES))\nTRACEENTRY(10000)\nUSERPARM(&SYSNAME.ICSF)\nEXIT(CSFKGUP,KGUPEXIT,FAIL(ICSF))\n", "mimetype": "text/plain", "datatype": "iso-8859-1", "extension": ".txt"}, "KGUPEXIT": {"ttr": 526, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x00\\x00C\\x01\\x102?\\x01\\x102?\\x083\\x00W\\x00W\\x00\\x00\\xc1\\xc9\\xd4\\xd1@@@@@@'", "ispf": {"version": "01.00", "flags": 0, "createdate": "2010-11-19T00:00:00", "modifydate": "2010-11-19T08:33:43", "lines": 87, "newlines": 87, "modlines": 0, "user": "AIMJ"}, "text": "KGUPEXUT TITLE 'CRYPTOGRAPHIC SERVICES FACILITY KGUP EXIT'\n         TITLE 'INTERNAL MACROS'\n         MACRO\n         DOCPGM\n         LCLC  &LABEL\n.**********************************************************************\n.****                                                             *****\n.****    THIS MACRO DOCUMENTS THE CSECT.                          *****\n.****                                                             *****\n.****    CSECT NAME                                               *****\n.****    ASSEMBLER NAME AND VERSION                               *****\n.****    TIME AND DATE                                            *****\n.****    OPERATING SYSTEM LEVEL                                   *****\n.****                                                             *****\n.**********************************************************************\n&SKIPIT  SETC  '$$$$'.'&SYSNDX'\n         USING &SYSECT,R15       TEMPORARY BASE REGISTER\n         J     &SKIPIT           GO AROUND EYE CATCHER\n         DC    C'&SYSSTYP &SYSECT WAS '\n         DC    C'ASSEMBLED BY &SYSASM VERSION &SYSVER. '\n         DC    C'AT &SYSTIME ON &SYSDATC. '\n         DC    C'UNDER &SYSTEM_ID'\nLOADPT   DC    A(KGUPEXIT)\nSAVEX    DS    18F\n&SKIPIT  DS    0H\n         MEND\n         TITLE 'PROGRAM ENTRY STUFF'\n         PUNCH ' ENTRY KGUPEXIT'\nKGUPEXIT CSECT\nKGUPEXIT RMODE ANY          (ANY,24)\nKGUPEXIT AMODE 31           (ANY,24,31)\n*\n* AUTHOR             :  MARK JACOBS\n* DATE               :  11/17/2009\n* INSTALLATION       :  TIME CUSTOMER SERVICE\n* CALLED ENVIRONMENT :  SUPERVISOR STATE, APF-AUTHORIZED\n*                    :  TCB MODE\n*                    :  ADDRESS SPACE CONTROL MODE=PRIMARY\n*                    :  AMODE(31), RMODE(ANY)\n* PROGRAM LOGIC      :  CHECKS RACF AUTHORIZATION TO THE TARGET\n*                    :  ENCRYPTION KEY (CSFKEYS GENERAL RESOURCE CLASS)\n*                    :  BEFORE ALLOWING CSFKGUP TO PERFORM THE\n*                    :  REQUESTED KEY FUNCTION.\n*\n*   BEWARE OF BUGS IN THE CODE BELOW; I HAVE ONLY PROVED IT\n*   CORRECT, NOT TRIED IT.  -- DONALD KNUTH\n*\n*\n*   MODIFICATION LOG\n*\n*   11/17/2009 - INITIAL VERSION\n*\n*\n         PRINT OFF\n         COPY  IEABRC\n         YREGS\n         PRINT ON\n         SPLEVEL SET\n         DOCPGM\n         BAKR  R14,0            SAVE REGS ON LINKAGE STACK\n         L     R12,LOADPT       LOAD BASE REGISTER\n         DROP  R15              DROP TEMPORARY BASE REGISTER\n         USING KGUPEXIT,R12     TELL ASSEMBLER ABOUT BASE REGISTER\n         LA    R13,SAVEX        POINT R13 TO SAVE AREA\n         MVC   4(4,R13),=C'F1SA' SET ACRONYM IN SAVE AREA\n         L     R2,0(,R1)        LOAD ADDRESS OF KGUP EXIT CONTROL BLOCK\n         USING KGXP,R2           TELL ASSEMBLER\n         TM    KGXFUNCT,KGXRCDPR RECORD PRE-PROCESSING ENTRY POINT?\n         JZ    EXIT              NO. GET OUT\n         TM    KGXACTON,KGXADD+KGXUPDTE+KGXDELET+KGXRENAM   ACTIONS\n         JZ    EXIT       ARE WE TRYING TO DO KEY WORK? NO - EXIT.\n         LA    R3,KGXLABEL      GET ADDRESS OF TARGET KEY LABEL\n*\n*    SNAFUCATE THE FUNCTION BEING CALLED BY KGUP\n*\n         RACROUTE REQUEST=AUTH,CLASS='CSFKEYS',ENTITY=((R3)),          X\n               ATTR=UPDATE,LOG=ASIS,SYSTEM=YES,RELEASE=7730,           X\n               WORKA=RACWK\n         LTR   R15,R15          TEST SAF RETURN CODE\n         JZ    USERAUTH         GIVE THUMBS UP\n         MVC   KGXRETCD,=F'4'  REJECT CONTROL STATEMENT. KGUP CONTINUES\nUSERAUTH EQU   *\nEXIT     SR    R15,R15          SET ZERO RETURN CODE\n         PR    ,                RETURN TO CALLER\nRACWK    DS  CL512\n         CSFMKGXP\n         END\n", "mimetype": "text/plain", "datatype": "iso-8859-1", "extension": ".txt"}}}}, "SCRIPTOPTIONS": {"filename": "./CBT840/FILE840.XMI", "LRECL": 80, "loglevel": 30, "outputfolder": "CBT840", "encoding": "cp1140", "unnum": true, "quiet": false, "force": false, "binary": false, "modifydate": true}}