000010 IDENTIFICATION DIVISION.
000020   PROGRAM-ID.    SYS007P0.
000030   INSTALLATION.  OCCIDENTAL CHEMICAL CORPORATION.
000040 DATE-COMPILED.   DATE.
000050 REMARKS. WRITTEN BY :
000060                             ROBERT P DZIALAK
000070                             OCCIDENTAL CHEMICAL CORPORATION
000080                             360 RAINBOW BLVD. SOUTH
000090                             NIAGARA FALLS , NEW YORK 14303
000100                             (716) 286-3251
000110*
000120*    THE PURPOSE OF THIS PROGRAM IS AS FOLLOWS:
000130*       THIS PROGRAM IS USED TO INITIATE A AUTOMATIC COMMAND
000140*       TO JES2. THIS AUTOMATIC COMMAND IS SET TO EXECUTE
000150*       10 MINITES FROM THE TIME THIS PROGRAM IS EXECUTED.
000160*       THE FORMAT OF THE AUTOMATIC COMMAND WRITTEN TO THE
000170*       INTERNAL READER IS:
000180*
000190*           /*$TA,T=HH.MM,'$VS,''S SYSL,N=JJJJJJJJ'''
000200*
000210*    WHERE: HH-MM - THE HOUR AND MINITE THIS COMMAND IS TO EXECUTE
000220*                   THIS PROGRAM IS THE LAST STEP TO BE EXECUTED
000230*                   IN A JOB WHOSE JCL IS TO BE SELECTED FROM
000240*                   LIBSPOOL FOR PRINTING. DELAYING THE EXECUTION
000250*                   FOR 10 MINITES GIVES LIBSPOOL A CHANCE TO
000260*                   SELECT THE JCL FROM JES2 AND PROCESS IT INTO
000270*                   THE LIBSPOOL DATA SET AFTER THE JOB FINISHES
000280*                   EXECUTION.
000290*        JJJJJJJJ - JOB NAME RUNTO SELECT FROM THE LIBRARIAN DATA
000300*                   SET REFERENCED IN THE 'SYSL' JCL PROCEDURE.
000310*                   JOB 'JJJJJJJJ' EXECUTES JCL WHICH EXECUTES
000320*                   THE PROGRAM WHICH SELECTS JCL MODULES FROM THE
000330*                   LIBSPOOL LIBRARIAN DATA SET. SELECTION CARDS
000340*                   ARE COMTAINED WITH THIS JCL TO CHOSE THE
000350*                   GENERIC JOB NAMES AND MATCHING RUN DATES/TIME
000360*                   TO PRINT.
000370 ENVIRONMENT DIVISION.
000380  CONFIGURATION SECTION.
000390    SOURCE-COMPUTER. IBM-370.
000400    OBJECT-COMPUTER. IBM-370.
000410  INPUT-OUTPUT SECTION.
000420    FILE-CONTROL.
000430       SELECT COMMNDCD              ASSIGN TO UT-S-COMMNDCD.
000440 DATA DIVISION.
000450  FILE SECTION.
000460   FD  COMMNDCD
000470       BLOCK CONTAINS 1 RECORDS
000480       LABEL RECORDS ARE STANDARD.
000490   01  COMMND-REC                 PIC X(80).
000500  WORKING-STORAGE SECTION.
000510   77  WAIT-TIME                  PIC S9(4) COMP VALUE +10.
000520   01  JES2-COMMAND.
000530       02 FILLER                  PIC X(08) VALUE '/*$TA,T='.
000540       02 EXEC-HH                 PIC 99.
000550       02 FILLER                  PIC X(01) VALUE '.'.
000560       02 EXEC-MM                 PIC 99.
000570       02 FILLER                  PIC X(01) VALUE ','.
000580       02 FILLER                  PIC X(01) VALUE QUOTE.
000590       02 FILLER                  PIC X(04) VALUE '$VS,'.
000600       02 FILLER                  PIC X(01) VALUE QUOTE.
000610       02 FILLER                  PIC X(01) VALUE QUOTE.
000620       02 FILLER                  PIC X(09) VALUE 'S SYSL,N='.
000630       02 EXEC-JOBNAME            PIC X(08).
000640       02 FILLER                  PIC X(01) VALUE QUOTE.
000650       02 FILLER                  PIC X(01) VALUE QUOTE.
000660       02 FILLER                  PIC X(01) VALUE QUOTE.
000670       02 FILLER                  PIC X(39) VALUE SPACES.
000680*
000690   01  WS-CUR-TIME.
000700       02 CUR-HH                  PIC 99.
000710       02 CUR-MM                  PIC 99.
000720       02 FILLER                  PIC X(4).
000730*
000740 LINKAGE SECTION.
000750   01  INPUT-PARMS.
000760       02 PARM-LENGTH             PIC S9(4) COMP.
000770       02 PARMS.
000780           03 JOBNAMEQ            PIC X(8).
000790           03 JOB-TO-EXEC         PIC X(8).
000800           03 DELAYEQ             PIC X(7).
000810           03 DELAY-MIN           PIC 9(2).
000820*
000830 PROCEDURE DIVISION USING INPUT-PARMS.
000840     IF PARM-LENGTH GREATER 15
000850        MOVE JOB-TO-EXEC TO EXEC-JOBNAME
000860        IF PARM-LENGTH GREATER 24 AND DELAY-MIN GREATER 0
000870            MOVE DELAY-MIN TO WAIT-TIME
000880         ELSE
000890            DISPLAY 'PARMS INCORRECT'
000900            GO TO STOP-RUN
000910     ELSE
000920        DISPLAY 'PARMS INCORRECT'
000930        GO TO STOP-RUN.
000940*
000950     MOVE TIME-OF-DAY TO WS-CUR-TIME.
000960     MOVE CUR-HH TO EXEC-HH.
000970     COMPUTE EXEC-MM = WAIT-TIME + CUR-MM.
000980     IF EXEC-MM GREATER 59
000990         ADD 1 TO EXEC-HH
001000         SUBTRACT 60 FROM EXEC-MM.
001010     IF EXEC-HH GREATER 23
001020         MOVE 0 TO EXEC-HH.
001030*
001040     OPEN OUTPUT COMMNDCD.
001050*
001060     WRITE COMMND-REC FROM JES2-COMMAND.
001070*
001080     CLOSE COMMNDCD.
001090 STOP-RUN.
001100     STOP RUN.
