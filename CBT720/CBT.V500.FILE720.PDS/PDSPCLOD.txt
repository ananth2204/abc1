/*  REXX  */
/* TRACE ?RESULTS */
 FLAG = 'N'     /* SET FLAG INITIALLY TO NO */
 SAY 'ENTER THE NAME OF THE INPUT FILE; E.G. C:\CBT\SOURCE.TXT '
 PULL INFILE
 SAY 'ENTER THE NAME OF THE OUTPUT DIRECTORY; E.G. C:\CBT\SOURCE\'
 PULL OUTDIR
  OUTFILE = ' '
 /* LINEIN(INFILE) */
 DO UNTIL DONE = 'YES'
  PARSE VALUE LINEIN(INFILE) WITH RECORD
  SELECT

   WHEN WORD(RECORD,1) = './' & WORD(RECORD,2) = 'ENDUP' THEN
    DONE = 'YES'

   WHEN WORD(RECORD,1) = './' & WORD(RECORD,2) = 'ADD' THEN
    DO
     MEMBER = WORD(TRANSLATE(WORD(RECORD,3)," ","="),2)
     SAY 'DOING MEMBER' MEMBER
     OUTFILE = OUTDIR||MEMBER||'.TXT'
    END

   OTHERWISE
    WRITE = LINEOUT(OUTFILE,RECORD)
  END
 END
EXIT
