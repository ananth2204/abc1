NCP generation migration aid

In the past, when I have installed a new version of the Network
Control Program (NCP), I have had to search meticulously
through the Migration Guide to identify which NCP parameters
require amendment.  Depending on which release you are
installing this can range from less than a dozen to more than it
is worth mentioning here.  In the newest release of NCP, IBM
has provided the NCP Generation Migration Aid.  With release
3.5 of ACF/SSP, this facility is available as a Small
Programming Enhancement (SPE) - PTF UR90191 (MVS),
PTF UR90192 (VM), and PTF UR90193 (VSE).  With Version
3.5.1 of ACF/SSP the migration aid is included as standard.

The migration aid is a new option of the NCP/EP Definition
Facility (NDF).  The aid can be used to modify a working NCP
generation definition for a 3720 or 3745 communications
control unit.  The aid will delete any statements that are no
longer required, amend keywords as necessary, move
keywords from one statement to another, and add keywords
and statements where applicable.  The migration aid does not
work for X25 NPSI keywords, NPM keywords, NRF
keywords, NTO keywords, and user-defined keywords.

The output produced by the migration aid is in three formats.
These are:

o      A generation listing

o      A new definition (NEWDEFN) file

o      A load module.

The NEWDEFN file will contain the modified NCP generation
deck and consists of comment blocks, unchanged keywords,
and modified keywords.  The file should be reviewed and then
can be used as input to an NCP generation.  If a keyword
cannot be resolved, the migration aid will insert a string of
three question marks after the equals sign on the keyword in
question.  The file can be defined as re-usable.  This means
that it can be used as input to VTAM and also as input to the
NDF for re-generation.  You should use the OPTIONS
statement in the NCP source deck to control the re-usable
option of the NEWDEFN file.

Several new statements have been created to control the
execution of the migration aid. The migration aid will convert
NCP source decks for NCP Version 2 onwards.  These decks
are always converted to either NCP Versions 5.2.1 or 5.3
upwards.  So if you have a NCP Version 3 running on a 3705
and want to install a 3745 the aid would be useful to convert
the source code to work on the new controller.

To perform migration you should execute the following
processes:

1      Obtain an error free source NCP deck to be used as input
      to the NDF.

2      Allocate a NEWDEFN file.  The migration aid will place
      the modified generation into the file.  Because of the
      additional comments and statements generated by the
      migration aid you should allocate the file at least twice as
      large as the original source deck.  The file should be in
      fixed block eighty-byte character format.

3      You will have to choose the parameters that control the
      migration aid.  The required parameters are TMODEL,
      TVERSION, and TUSGTIER.  Optional parameters are
      CHANNELS, DPU, and SAVEADDR.  These parameters
      can be specified on the NCP OPTIONS statement or in the
      NDF JCL as parameters on the EXEC card.  Below, I have
      included the parameters as part of the JCL.  The comments
      in the JCL detail how the parameters are used.  If you do
      code the parameters in the JCL and also on the OPTIONS
      statement in the NCP source code, the NDF programs will
      use the latter.  In the example I am migrating an NCP to be
      used on a 3745-210 communications controller at usage
      tier two.  The new version of the NCP that I am installing
      is Version 5.3.1.

4      Once you have coded these statements the NDF job should
      be submitted.

5      Once the job has completed, the output should be reviewed
      in detail.  Messages with a severity code of eight or more
      indicate errors that could not be resolved by the migration aid.

6      The NEWDEFN file will contain the new NCP source
      deck.  The migration aid will have inserted comment
      blocks throughout the file.  You can identify these
      comment blocks by searching for the string of characters
      ':MIGINFO'.  This string of characters is placed at the
      beginning of all comment blocks.  A sample summary
      comment block for the whole generation and the BUILD
      statement is shown below.

7      You can submit another NDF job with the NEWDEFN file
      as input if no further changes are required.  You can
      remove the comments added to the NEWDEFN file by
      using the REMOVCOM=YES keyword on the parameter
      statement in the NDF JCL.

This new facility provides useful productivity aids to the
Network Systems Programmer to help migrate NCPs from
lower to higher releases.


SAMPLE JCL TO INVOKE THE NDF MIGRATION AID

//STS01NCP    JOB   (SDTS),'J.BRADLEY',CLASS=A,MSGCLASS=Q,
//            MSGLEVEL=(1,1),NOTIFY=STS01,REGION=8M
//*      **************************************************************
//*      * EXAMPLE OF USING NCP MIGRATION AID.                        *
//*      * RELEVANT MANUAL IS:-                                       *
//*      * NCP/SSP LIBRARY SUPPLEMENT FOR THE NCP MIGRATION AID.      *
//*      * - SD35-0251.                                               *
//*      * INFORMATION.                                               *
//*      * 1) NEWDEFN FILE IS ALLOCATED AS A SEQUENTIAL FILE. IT      *
//*      *    CAN ALSO BE A MEMBER OF A PDS TYPE DATASET. THE FILE    *
//*      *    SHOULD BE 80 BYTE CHARACTER CARD FORMAT.                *
//*      * 2) TMODEL=3745-210 INFORMS THE MIGRATION AID THAT THE      *
//*      *    GENERATED NCP WILL RUN ON A MODEL 210 TYPE OF 3745      *
//*      *    FRONT END PROCESSOR.                                    *
//*      * 3) TUSGTIER=2 SPECIFIES USAGE TIER GROUP TWO.              *
//*      * 4) TVERSION=V5R3.1 WILL CONVERT THE INPUT SOURCE NCP CODE  *
//*      *    TO VERSION 5 RELEASE 3.1 SOURCE CODE.                   *
//*      **************************************************************
//NDF         EXEC  PGM=ICNRTNDF,REGION=8M,
//            PARM=('TMODEL=3745-210','TUSGTIER=2','TVERSION=V5R3.1',
//            'FASTRUN=ON')
//STEPLIB     DD    DSN=NCP91B.SSPLIB,DISP=SHR
//            DD    DSN=NCP91B.NPSILNK,DISP=SHR
//GENDECK     DD    DSN=SYS1.VTAMLST(SGEN00A),DISP=SHR
//SYSPRINT    DD    SYSOUT=*
//PRINTER     DD    SYSOUT=*
//DBWORKFL    DD    DSN=&WORKF,DISP=(,DELETE),UNIT=WORK,
//            SPACE=(CYL,(5,1))
//TBL1SRCE    DD    DSN=&SRCE1,DISP=(,DELETE),UNIT=WORK,
//            SPACE=(CYL,(5,2)),DCB=BLKSIZE=3200
//TBL1LIST    DD    DSN=TBL1LIST,UNIT=WORK,DISP=(NEW,PASS),
//            SPACE=(CYL,(10,5)),DCB=BLKSIZE=21780
//TBL1OBJ     DD    DSN=&OBJ(ICNTABL1),DISP=(,PASS),UNIT=WORK,
//            SPACE=(CYL,(5,1,1)),DCB=BLKSIZE=3200
//TBL2SRCE    DD    DSN=&SRCE2,DISP=(,DELETE),UNIT=WORK,
//            SPACE=(CYL,(10,10)),DCB=BLKSIZE=3200
//TBL2LIST    DD    DSN=TBL2LIST,UNIT=WORK,DISP=(NEW,PASS),
//            SPACE=(CYL,(10,2))
//TBL2OBJ     DD    DSN=&OBJ(ICNTABL2),DISP=(MOD,PASS),
//            DCB=BLKSIZE=3200,VOL=REF=*.TBL1OBJ
//SYSUT1      DD    UNIT=WORK,SPACE=(CYL,(10,10)),DISP=(,DELETE)
//SYSLIB      DD    DSN=NCP91B.ANCPMAC1,DISP=SHR
//            DD    DSN=NCP91B.ABALMAC1,DISP=SHR
//LNKSTMT     DD    DSN=&LNKFL,DISP=(,PASS),UNIT=WORK,
//            SPACE=(CYL,(1,1)),DCB=BLKSIZE=3120
//NEWDEFN     DD    DSN=STS01.BD.DATA.NEWDEFN,DISP=SHR


SAMPLE COMMENT BLOCKS

*:MIGINFO**************************************************************
* MIGRATION AID SUMMARY
*
* THE MIGRATION AID WAS INVOKED WITH THESE PARAMETERS SPECIFIED OR
* DEFAULTED:
*   TVERSION=V5R3.1
*   TMODEL=3745-210
*   TUSGTIER=2
*   CHANNELS=GROUP
*            IF CHANNEL DEFINITIONS EXISTED IN THE SOURCE GENERATION
*            DEFINITION, THEY ARE NOW DEFINED ON THE GROUP AND LINE
*            STATEMENTS.
*   DPU=YES
*            TGBXTRA, PATHEXT, AND VRPOOL(2) DEFAULT TO A VALUE
*            GREATER THAN ZERO, MEANING THAT NCP STORAGE IS ALLOCATED
*            FOR THE DYNAMIC PATH UPDATE FUNCTION.  SINCE DPU=YES,
*            THE MIGRATION AID ALLOWED UNSPECIFIED VALUES OF
*            TGBXTRA, PATHEXT, AND VRPOOL(2) TO TAKE THEIR NORMAL
*            DEFAULTS.  THIS MEANS THAT STORAGE WILL BE ALLOCATED
*            FOR THE DPU FUNCTION, WHETHER YOU INTEND TO USE DPU
*            OR NOT.
*   SAVEADDR=YES
*            THE VALUES SPECIFIED FOR ADDRESS, AUTO, DUALCOM,
*            DYNADMP, HICHAN, AND LOCHAN HAVE BEEN RETAINED.  THESE
*            VALUES MAY NOT BE VALID IF YOU ARE MIGRATING TO A NEW
*            CONTROLLER OR A LOWER USAGE TIER.
*
*:MIGEND***************************************************************
*:MIGINFO**************************************************************
* MIGRATION AID BUILD STATEMENT SUMMARY
*
* INFORMATIONAL
*   MAXSUBA MAY BE REMOVED IF ALL THE NODES IN YOUR NETWORK ARE
*   CAPABLE OF EXTENDED NETWORK ADDRESSING, BUT ONLY IF YOU REMOVE
*   IT FROM THE GENERATION DEFINITIONS OF ALL THE OTHER NODES IN YOUR
*   NETWORK.
*
* CHANGES
*   VERSION=V5R3.1 - CHANGED FROM V5R2.1
*      - CHANGED VIA TVERSION
*   MODEL=3745-210 - CHANGED FROM 3745
*      - CHANGED VIA TMODEL
*
*:MIGEND***************************************************************


John Bradley
Technical Support Engineer (UK)

