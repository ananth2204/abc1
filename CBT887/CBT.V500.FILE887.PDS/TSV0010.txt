//SCOTTZ JOB 'TSV0010',CLASS=S,MSGCLASS=X,MSGLEVEL=(1,1),
//            NOTIFY=SCOTT,REGION=4096K,
//            USER=SCOTT,PASSWORD=SCOTTY
//*
//*   NAME:    SYS2.USERMODS(TSV0010)
//*   PURPOSE: USING SMP, INSTALL THE USERMOD TSV0010 WHICH UPDATES THE
//*            CONSOLE PROCESSER WHICH LISTS THE DATE AND TIME.
//*            ALSO ADDS SUPPORT FOR DISPLAYS OF IPLINFO, XCF, APF,
//*            SMS, AND SMF.
//*   NOTE(S): AN IPL WITH CLPA IS REQUIRED TO IMPLEMENT.
//*
//*   STATUS:  TEST
//*
//*
//REJRES  EXEC SMP,
//            RVOL=MVSRES
//SMPCNTL  DD  *
  REJECT  S(TSV0010) .
 RESETRC .
  RESTORE S(TSV0010) .
/*
//RECEIVE EXEC SMP,
//            RVOL=MVSRES
//SMPPTFIN DD DATA,DLM='$$'
++ USERMOD(TSV0010) /* MVS CONSOLE COMMAND PROCESSER */ .
++ VER(Z038)
   FMID(EBB1102)
   PRE(TSV0024) .
++ SRC(IEE3503D) DISTLIB(AOSB3) SYSLIB(SAMPLIB) .
         TITLE 'IEE3503D - DISPLAY / TRACK ROUTER'
***********************************************************************
*                                                                     *
*  MODULE NAME  =  IEE3503D                                     Y02669*
*                                                                     *
*  DESCRIPTION  =  ROUTER FOR DISPLAY AND TRACK COMMANDS        Y02669*
*                                                                     *
*  COPYRIGHT    =  N/A                                          Y02669*
*                                                                     *
*  STATUS       =  VS/2 - DUMPING IMPROVEMENTS                @G33CPMR*
*                                                                     *
*  FUNCTION     =  THIS MODULE DETERMINES THE DISPLAY COMMAND   Y02669*
*                  OPERANDS: D  A          ACTIVE               Y02669*
*                               C,K        K COMMAND OPERANDS   Y02669*
*                               DMN        DOMAIN             @Z40BPSV*
*                               DUMP       DUMP               @G33CPMR*
*                               CONSOLES(C)CONSOLES             YM1916*
*                               JOBS (J)   JOBS, STARTED TASKS  Y02669*
*                               M          MATRIX               Y02651*
*                               NET        VTAM                 Y02674*
*                               PFK        PGM FUNCTION KEYS    Y02669*
*                               R          REQUESTS             Y02669*
*                               SLIP       SERVICEABILITY     @G17SPTJ*
*                                           LEVEL INDICATOR   @G17SPTJ*
*                                            PROGRAM          @G17SPTJ*
*                               T          TIME                 Y02669*
*                               TP         TCAM                 Y02669*
*                               TS         TIME SHARING USERIDS Y02669*
*                               U          UNITS                Y02669*
*                               3850       MSS COMMAND        @Z40LPTA*
*                               IPLINFO    IPLINFO                *SKV*
*                               SMF        SMF                    *SKV*
*                               SYMBOLS    SYMBOLS                *SKV*
*                               APF        APF                    *SKV*
*                                                                     *
*                  AND THE TRACK OPERANDS:                      Y02669*
*                           TR  A          ACTIVE               Y02669*
*                               JOBS (J)   JOBS, STARTED TASKS  Y02669*
*                               TS         TIME SHARING USERIDS Y02669*
*                  (THE TRACK COMMAND IS A TIMER INTERVAL       Y02669*
*                  DRIVEN DISPLAY.)                             Y02669*
*                                                                     *
*                  IT THEN ROUTES SPECIFIC INFORMATION IN THE   Y02669*
*                  XSA (EXTENTED SAVE AREA) TO THE APPROPIATE   Y02669*
*                  PROCESSOR.                                   Y02669*
*                                                                     *
*                  ONLY D T (DISPLAY TIME) IS HANDLED           Y02669*
*                  EXCLUSIVELY IN IEE3503D.                     Y02669*
*                                                                     *
     EJECT
*                                                                     *
*   OPERATION   =  FOR D U; U,; THE VERB CODE IN XAN IS CHANGED Y02669*
*                  TO X'52', IEE3503D BRANCHES TO IEE7503D TO   Y02669*
*                  RESOLVE THE ROUTING OPERAND (L=CCA) OR       Y02669*
*                  DETERMINE THE DEFAULTS.                      Y02669*
*                                                                     *
*                  FOR D M; M,; M= THE VERB CODE IN XAN IS      Y02651*
*                  CHANGED TO X'32', IEE3503D BRANCHES TO       Y02651*
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND      Y02651*
*                  (L=CCA) OR DETERMINE THE DEFAULTS.           Y02651*
*                                                                     *
*                  FOR D TS; TS,; JOBS(J); JOBS,(J,); A; A,;    Y02669*
*                  A BIT IS SET IN XAX (XAXMASK), IEE3503D      Y02669*
*                  BRANCHES TO IEE7503D TO ESTABLISH ROUTING    Y02669*
*                  INFORMATION FROM THE L=CCA OPERAND OR        Y02669*
*                  DETERMINE THE APPROPIATE DEFAULTS            Y02669*
*                  AND CHECK FOR AND PROCESS THE 'LIST'(L)      Y02669*
*                  OPERAND. (SEE OUTPUT FOR BIT SETTINGS)       Y02669*
*                                                                     *
*                  FOR D C,K; C,K,; CONSOLES(C); CONSOLES,(C,); YM1916*
*                  THE VERB CODE IN XAN IS CHANGED TO X'2C'     Y02669*
*                  FOR C,K AND X'3E' FOR CONSOLES; IEE3503D     YM1916*
*                  BRANCHES TO IEE7503D TO RESOLVE THE ROUTING  Y02669*
*                  OPERAND (L=CCA) OR DETERMINE THE DEFAULTS.   Y02669*
*                                                                     *
*                  FOR D R; R,; THE VERB CODE IN XAN IS         Y02669*
*                  CHANGED TO X'42', IEE3503D BRANCHES TO       Y02669*
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND      Y02669*
*                  (L=CCA) OR DETERMINE THE DEFAULTS.           Y02669*
*                                                                     *
*                  FOR D PFK; THE VERB CODE IN XAN IS CHANGED   Y02669*
*                  TO X'36'AND XAS IS SET TO ZEROES, IEE3503D   Y02669*
*                  BRANCHES TO IEE0803D TO CREATE A CSCB.       Y02669*
*                                                                     *
*                  FOR D T; THE FOLLOWING MESSAGE IS WRITTEN    Y02669*
*                  TO THE OPERATOR VIA WTO OR TPUT:             Y02669*
*                    IEE136I    TIME=XX.XX.XX    DATE=XX.XXX    Y02669*
*                  CONTROL IS RETURNED.                         Y02669*
*                                                                     *
*                  FOR D TP,; IEE3503D BRANCHES TO IED1303D.    Y02669*
*                                                                     *
*                  FOR D NET,; IEE3503D BRANCHES TO ISTCFF3D.   Y02674*
*                                                                     *
*                  FOR D 3850; IEE3503D BRANCHES TO IEE7503D  @Z40LPTA*
*                                                                     *
*                  FOR D DMN; IEE3503D BRANCHES TO IEE7503D   @Z40BPSV*
*                                                                     *
         EJECT
*                                                                     *
*                  FOR D SLIP, THE VERB CODE IN XAN IS        @G17SPTJ*
*                  CHANGED TO X'A8'.  IEE3503D BRANCHES TO    @G17SPTJ*
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND    @G17SPTJ*
*                  (L=CCA) OR TO DETERMINE THE DEFAULTS       @G17SPTJ*
*                                                                     *
*                  FOR D DUMP, THE VERB CODE IN XAN IS        @G33CPMR*
*                  CHANGED TO X'B0'.  IEE3503D BRANCHES TO    @G33CPMR*
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND    @G33CPMR*
*                  (L=CCA) OR TO DETERMINE THE DEFAULTS       @G33CPMR*
*                                                                     *
*                  **** NOTE ****                             @G17SPTJ*
*                    FOR 'D DMN', 'D SLIP' AND 'D DUMP':      @G33CPMR*
*                  WHENEVER THE ABOVE-MENTIONED COMMANDS ARE  @G17SPTJ*
*                  ENTERED, THEY ARE CHECKED OUT FURTHER TO   @G17SPTJ*
*                  SEE IF THE SYSTEM SUPPORTS THE SU'S THAT   @G17SPTJ*
*                  ARE ASSOCIATED WITH THE COMMAND.           @G17SPTJ*
*                                                             @G17SPTJ*
*                  FOR TR TS; TS,; JOBS(J); JOBS,(J,); A; A,;   Y02669*
*                  A BIT IS SET IN XAX (XAXMASK), IEE3503D      Y02669*
*                  BRANCHES TO IEE7503D TO ESTABLISH ROUTING    Y02669*
*                  INFORMATION FROM THE L=CCA OPERAND OR        Y02669*
*                  DETERMINE THE APPROPIATE DEFAULTS AND        Y02669*
*                  CHECK FOR AND PROCESS THE 'LIST' (L)         Y02669*
*                  OPERAND.(SEE OUTPUT FOR BIT SETTINGS)        Y02669*
*                                                                     *
         EJECT
*                                                                     *
*  NOTES                                                        Y02669*
*                                                                     *
*  CHARACTER/                                                   Y02669*
*  CODE                                                         Y02669*
*  DEPENDENCIES =  ANY CHARACTER CODE OTHER THAN EBCDIC WILL    Y02669*
*                  REQUIRE REASSEMBLY OF THIS MODULE.           Y02669*
*                                                                     *
*  DEPENDENCIES =  IEE0403D TO RECOGNIZE THE DISPLAY AND        Y02669*
*                  TRACK COMMANDS AND PASS THE OPERAND          Y02669*
*                  INFORMATION IN THE XSA.                      Y02669*
*                                                                     *
*                  SVC 100 WILL REJECT AS INVALID D A AND       Y02669*
*                  THE TRACK COMMAND FROM ANY TIME SHARING      Y02669*
*                  TERMINAL INCLUDING THOSE IN OPERATOR MODE.   Y02669*
*                                                                     *
*                  ISTCFF3D WILL VALIDITY CHECK FOR NET,.       Y02674*
*                                                                     *
*                  MP WILL BE SUPPORTED AS A STANDARD           Y02651*
*                  AND D M (MATRIX) WILL BE INCLUDED.           Y02651*
*                                                                     *
*                  THE MSGRT COMMAND WILL PROVIDE SUPPORT FOR   Y02669*
*                  A ROUTING DEFAULT FOR D TS; JOBS; A; R;      Y02669*
*                  AND TR TS; JOBS; AND A.                      Y02669*
*                                                                     *
*                  JOBS AND J AND JOBS,LIST AND J,L WILL BE     Y02669*
*                  SUPPORTED. L CAN SUBSTITUTE FOR 'LIST'.      Y02669*
*                                                                     *
*                  A SU TABLE (IHASUBIT) REFLECTING THE SU'S  @G17SPTJ*
*                  INSTALLED ON THIS SYSTEM.                  @G17SPTJ*
*                                                                     *
*  RESTRICTIONS =  TIME SHARING TERMINALS INCLUDING THOSE IN    Y02669*
*                  OPERATOR MODE ARE NOT PERMITTED TO ISSUE D A.Y02669*
*                                                                     *
*                  THE 'L' OPERAND FROM A TIME SHARING USER     Y02669*
*                  ON D C,K; CONSOLES(C); JOBS; M; TS; R; U     YM1916*
*                  WILL BE DETECTED AS INVALID IN IEE7503D.     Y02669*
*                                                                     *
*                  NO TIME SHARING TERMINAL IS PERMITTED TO     Y02669*
*                  ISSUE THE TRACK COMMAND.                     Y02669*
*                                                                     *
*  REGISTER/                                                    Y02669*
*  CONVENTIONS  =  NONE                                         Y02669*
*                                                                     *
*  PATCH-LABEL  =  PATCH                                        Y02669*
*                                                                     *
* MODULE TYPE   =  CSECT                                        Y02669*
*                                                                     *
*  PROCESSOR    =  N/A                                          Y02669*
*                                                                     *
*  MODULE SIZE  =  X'3DD'                                     @G33CPMR*
*                                                                     *
*                                                                     *
*   ATTRIBUTES  =  REENTRANT, SUPERVISOR MODE, KEY ZERO,        Y02669*
*                  PAGED LPA                                    Y02669*
*                                                                     *
*  ENTRY POINT  =  IEE3503D FROM IEE0403D                       Y02669*
*  PURPOSE      =  TO ROUTE THE DISPLAY OR TRACK                Y02669*
*                  COMMAND TO THE PROPER PROCESSOR.             Y02669*
*  LINKAGE      =  BRANCH                                       Y02669*
*  INPUT DATA   =  REGISTER 2 POINTS TO XSA                     Y02669*
*                    XAL POINTS TO 1ST OPERAND IN BUFFER        Y02669*
*                    XAU IS 1-BYTE UCMI (X'00' COMMAND ISSUED   Y02669*
*                        INTERNALLY OR FROM THE INPUT STREAM)   Y02669*
*                    XAA CONTAINS THE ASID (X'0000' = NON-TS)   Y02669*
*                    XAN CONTAINS THE VERB CODE X'68' - DISPLAY Y02669*
*                                               X'C4' - TRACK   Y02669*
*                    XAR POINTS TO THE LENGTH FIELD AT THE      Y02669*
*                        BEGINNING OF THE COMMAND BUFFER        Y02669*
*                    XAV CONTAINS THE COMMAND VERB              Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                                                                     *
*   REGISTERS                                                   Y02669*
*    SAVED      =  NONE  (REGISTER 14 REMAINS UNTOUCHED)        Y02669*
*                                                                     *
*    CONTENTS DURING                                            Y02669*
*     PROCESSING=  R0   WORK REGISTER                           Y02669*
*                  R1   WORK REGISTER                           Y02669*
*                  R2   INPUT REGISTER - POINTER TO XSA         Y02669*
*                  R3   MODULE BASE REGISTER                    Y02669*
*                  R4   USED TO CONTAIN UCMI FOR WTO            Y02669*
*                  R5   PTR TO COMMAND BUFFER AND               Y02669*
*                       CONTAINS ASID FOR TPUT                  Y02669*
*                  R6   USED TO ADDRESS COMPARE TABLE ENTRIES   Y02669*
*                        AND THE SU BIT STRING                @G17SPTJ*
*                  R7   UNUSED                                  Y02669*
*                  R8   UNUSED                                  Y02669*
*                  R9   WORK REGISTER                           Y02669*
*                  R10  CONTAINS SU NUMBER                    @G17SPTJ*
*                  R11  ADDRESSES END OF COMPARE TABLE          Y02669*
*                  R12  UNUSED                                  Y02669*
*                  R13  UNUSED                                  Y02669*
*                  R14  RETURN ADDRESS                          Y02669*
*                  R15  USED FOR BAL, RC FROM TPUT, AND BR EXIT Y02669*
*                                                                     *
*    RESTORED    = NONE                                         Y02669*
*                                                                     *
      EJECT
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = RETURN VIA BR R14 FROM DDTIM                 Y02669*
*   CONDITIONS   = FOR D T                                      Y02669*
*   OUTPUT DATA  = IEE136I  TIME=XX.XX.XX   DATE=XX.XXX VIA WTO Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = RETURN VIA BR R14 FROM XTPUT                 Y02669*
*   CONDITIONS   = FOR D T                                      Y02669*
*   OUTPUT DATA  = IEE136I  TIME=XX.XX.XX  DATE=XX.XXX VIA TPUT Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = BRANCH TO IEE0803D FROM DDPFK                Y02669*
*   CONDITIONS   = TO CREATE A CSCB FOR D PFK                   Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAN NOW CONTAINS X'36'                     Y02669*
*                    XAS CLEARED (WILL CONTAIN ZEROES)          Y02669*
*                        CONTAINS VALID INPUT TO IEE0803D.      Y02669*
*                        FOR ALL OTHER DISPLAY FUNCTIONS        Y02669*
*                        THIS FIELD IS FILLED IN IN IEE7503D    Y02699*
*                    XAX CLEARED (WILL CONTAIN ZEROES)          Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = BRANCH TO IEE7503D FROM DD7503D              Y02669*
* 1 CONDITIONS   = TO VALIDITY CHECK:                           Y02669*
*                    L=CCA,LIST FOR  D A,  AND A                Y02669*
*                                      TS,  AND TS              Y02669*
*                                      JOBS, AND JOBS (J, & J)  Y02669*
*                                    TR A, AND A                Y02669*
*                                       TS, AND TS              Y02669*
*                                       JOBS, & JOBS (J, & J)   Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN STILL CONTAINS X'68' FOR DISPLAY       Y02669*
*                                       X'C4' FOR TRACK         Y02669*
*                    XAXMASK WILL CONTAIN AN INDICATOR          Y02669*
*                      SPECIFYING THE DESIRED DISPLAY OR        Y02669*
*                      TRACK FUNCTION:                          Y02669*
*                      X'80' FOR JOBS                           Y02669*
*                      X'08' FOR TS                             Y02669*
*                      X'88' FOR A                              Y02669*
*   RETURN CODES = NONE                                         Y02669*
* 2 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D U AND U,       Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN NOW CONTAINS X'52'                     Y02669*
*                    XAXMASK WILL CONTAIN ZEROES                Y02669*
*   RETURN CODES = NONE                                         Y02669*
* 3 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D C,K; C,K,;     Y02669*
*                    CONSOLES(C); AND CONSOLES,(C,)             YM1916*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN NOW CONTAINS X'2C' FOR C,K             Y02669*
*                                     X'3E' FOR CONSOLES(C)     YM1916*
*                    XAXMASK WILL CONTAIN ZEROES                Y02669*
*   RETURN CODES = NONE                                         Y02669*
* 4 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D M; M=; AND M,  Y02651*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02651*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN NOW CONTAINS X'32'                     Y02651*
*                    XAXMASK WILL CONTAIN ZEROES                Y02651*
*   RETURN CODES = NONE                                         Y02651*
* 5 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D R AND R,       Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN NOW CONTAINS X'42'                     Y02651*
*                    XAXMASK WILL CONTAIN ZEROES                Y02651*
*   RETURN CODES = NONE                                         Y02669*
* 6 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D 3850 AND     @Z40LPTA*
*                    3850,                                    @Z40LPTA*
*   OUTPUT DATA  = R2 POINTS TO XSA                           @Z40LPTA*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @Z40LPTA*
*                    XAN NOW CONTAINS X'F3'                   @Z40LPTA*
*                    XAXMASK WILL CONTAIN ZEROES              @Z40LPTA*
*   RETURN CODES = NONE                                       @Z40LPTA*
* 7 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D DMN; DMN=;   @Z40BPSV*
*                    DMN,                                     @Z40BPSV*
*   OUTPUT DATA  = R2 POINTS TO XSA                           @Z40BPSV*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @Z40BPSV*
*                    XAN NOW CONTAINS X'88'                   @Z40BPSV*
*                    XAXMASK WILL CONTAIN ZEROES              @Z40BPSV*
*   RETURN CODES = NONE                                       @Z40BPSV*
* 8 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D SLIP; SLIP=; @G17SPTJ*
*                    SLIP,                                    @G17SPTJ*
*   OUTPUT DATA  = R2 POINTS TO XSA                           @G17SPTJ*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @G17SPTJ*
*                    XAN NOW CONTAINS X'A8'                   @G17SPTJ*
*                    XAXMASK WILL CONTAIN ZEROES              @G17SPTJ*
*   RETURN CODES = NONE                                       @Z40BPSV*
* 9 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D DUMP AND     @G33CPMR*
*                    D DUMP,                                  @G33CPMR*
*   OUTPUT DATA  = R2 POINTS TO XSA                           @G33CPMR*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @G33CPMR*
*                    XAN NOW CONTAINS X'B0'                   @G33CPMR*
*                    XAXMASK WILL CONTAIN ZEROES              @G33CPMR*
*   RETURN CODES = NONE                                       @G33CPMR*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = BRANCH TO IED1303D FROM DDTP                 Y02669*
*   CONDITIONS   = FOR D TP,                                    Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = BRANCH TO ISTCFF3D FROM DDNET                Y02674*
*   CONDITIONS   = FOR D NET,                                   Y02674*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02674*
*   RETURN CODES = NONE                                         Y02674*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - ERROR  = RETURN VIA BR R14 FROM XTPUT                 Y02669*
*   CONDITIONS   = FOR D T; TPUT FAILED DUE TO OUTSTANDING TPUT Y02669*
*   OUTPUT DATA  = NONE                                         Y02669*
*   RETURN CODES = REG 15 CONTAINS X'00000014'                  Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - ERROR  = BRANCH TO IEE0503D FROM D0503D               Y02669*
*   CONDITIONS   = TO ISSUE MESSAGE 'IEE305I COMMAND INVALID',  Y02669*
*                  IF AN INVALID DISPLAY OR TRACK OPERAND IS    Y02669*
*                  FOUND.                                       Y02669*
*                  TO ISSUE MESSAGE 'IEE026I COMMAND NOT      @G17SPTJ*
*                  SUPPORTED' WHEN SYSTEM DOES NOT SUPPORT    @G17SPTJ*
*                  THE SU REQUIRED BY THE COMMAND.            @G17SPTJ*
*                  TO ISSUE MESSAGE 'IEE311I PARAMETER MISSING',Y02669*
*                  IF NO OPERAND IS FOUND IN THE COMMAND BUFFER.Y02669*
*                  TO ISSUE MESSAGE 'IEE341I CLOCK NOT ACTIVE', Y02669*
*                  IF THE TIME MACRO RETURNS AN ERROR CODE      Y02669*
*                  FOR DISPLAY TIME (D T).                      Y02669*
*   OUTPUT DATA  = ERROR CODES FOR MESSAGES ISSUED IN IEE0503D  Y02669*
*                  IN XSA POINTED TO BY REG 2                   Y02669*
*                    XAE WILL CONTAIN  X'05' FOR IEE305I        Y02669*
*                                      X'0B' FOR IEE311I        Y02669*
*                                      X'24' FOR IEE341I        Y02669*
*                    XAV STILL CONTAINS THE COMMAND VERB        Y02669*
*                        OR THE WORD 'CLOCK' FOR IEE341I        Y02669*
*                    XAU STILL CONTAINS THE CONSOLE ID          Y02669*
*                    XAA STILL CONTAINS ASID IF REQUESTER       Y02669*
*                        IS TIME SHARING USER ELSE X'0000'.     Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
      EJECT
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*  EXTERNAL                                                     Y02669*
*   REFERENCES                                                  Y02669*
*   ROUTINES     = BRANCHES TO   IEE0803D   IEE0503D            Y02669*
*                                IED1303D   IEE7503D            Y02669*
*                                ISTCFF3D                       Y02674*
*                                                                     *
*   DATA AREAS   = PSEUDO-SACB TO BE USED THROUGHOUT SVC 34     Y02669*
*                    ORG   XAX                                  Y02669*
*                  XAXMASK  DS    C       REQUEST FLAGS         Y02669*
*                  XAXJOBS  EQU   X'80'   JOBS      (J)         Y02669*
*                  XAXJOBSL EQU   X'40'   JOBS,LIST (J,L)       Y02669*
*                  XAXTS    EQU   X'08'   TS                    Y02669*
*                  XAXTSL   EQU   X'04'   TS,LIST   (TS,L)      Y02669*
*                  XAXA     EQU   X'88'   A                     Y02669*
*                  XAXAL    EQU   X'44'   A,LIST    (A,L)       Y02669*
*                  XAXFREE  DS    C       RESERVED              Y02669*
*                  XAXUTME  DS    H       UTME=NNN VALUE        Y02669*
*                  XAXSACB  DS    F       ADDRESS OF SACB       Y02669*
*                                                                     *
*   CONTROL                                                     Y02669*
*    BLOCKS      = IEEXSA     R - INPUT - COMMAND BUFFER ADDR   Y02669*
*                             W - OUTPUT - BITS SET             Y02669*
*                  IHASUBIT   R                               @G17SPTJ*
*                  CVT        R                               @G17SPTJ*
*                                                                     *
         EJECT
*    TABLES      = A COMPARE TABLE IS USED TO  DETERMINE THE    Y02669*
*                  VALIDITY OF THE OPERANDS ON THE DISPLAY AND  Y02669*
*                  TRACK COMMANDS.                              Y02669*
*                  THE FORMAT OF EACH ENTRY IS THE SAME.        Y02669*
*                                                                     *
*                  DLEN   DC   AL1(L'XXX-1) - LENGTH OF         Y02669*
*                                             SPECIFIC OPERAND  Y02669*
*                  XXX    DC   C'YYYYY' - CHARACTER OPERAND     Y02669*
*                                         REPRESENTATION        Y02669*
*                                                                     *
*                  DLEN AND 'XXX' ARE USED IN AN EX OF A CLC.   Y02669*
*                  IF THE OPERANDS MATCH, A BRANCH IS TAKEN TO  Y02669*
*                  THE CODE WHICH IN TURN BRANCHES TO THE       Y02669*
*                  PROPER PROCESSOR OR HANDLES THE COMMAND.     Y02669*
*                  OTHERWISE, THE REGISTER USED TO ADDRESS THE  Y02669*
*                  TABLE IS INCREMENTED BY TWO + THE VALUE OF   Y02669*
*                  DLEN TO REACH THE NEXT TABLE ENTRY.          Y02669*
*                  THE VALID TRACK OPERANDS ARE PLACED AT THE   Y02669*
*                  END OF THE COMPARE TABLE AND ADDRESSING OF   Y02669*
*                  THE TABLE IS ADJUSTED WHEN VALIDITY          Y02669*
*                  CHECKING THE TRACK COMMAND.                  Y02669*
*                                                                     *
*                  A BRANCH TABLE IS USED IN CONNECTION WITH    Y02669*
*                  THE COMPARE TABLE. IT CONSISTS OF BRANCHES   Y02669*
*                  TO THE PROPER OPERAND PROCESSORS. AN INDEX   Y02669*
*                  REGISTER IS MAINTAINED THROUGHOUT THE SCAN   Y02669*
*                  OF THE COMPARE TABLE. THIS IS USED AT        Y02669*
*                  DBRANCH TO GIVE CONTROL TO THE INDICATED     Y02669*
*                  PROCESSOR VIA THE BRANCH TABLE.              Y02669*
*                                                                     *
*   MACROS       = MODID                                        Y02669*
*                  TIME                                         Y02669*
*                  WTO                                          Y02669*
*                  TPUT                                         Y02669*
*                                                                     *
*   ENQUEUE                                                     Y02669*
*     RESOURCES  = NONE                                         Y02669*
*                                                                     *
*   LOCKS HELD   = NONE                                         Y02669*
*                                                                     *
*   CHANGE LEVEL = Y02669                                       Y02669*
*                  Y02674                                       Y02674*
*                  Y02651                                       Y02651*
*                  YM1916                                       YM1916*
*                  Z40LPTA                                    @Z40LPTA*
*                  Z40BPSV                                    @Z40BPSV*
*                  G17SPTJ                                    @G17SPTJ*
*                  G33CPMR                                    @G33CPMR*
*                                                                     *
         EJECT
*   MESSAGES     = THE FOLLOWING MESSAGE IS CONTAINED IN AND    Y02669*
*                  ISSUED FROM THIS MODULE:                     Y02669*
*                                                                     *
*                   IEE136I  TIME=HH.MM.SS  DATE=YY.DDD         Y02669*
*                                                                     *
*                  THE FOLLOWING MESSAGES ARE CONTAINED IN      Y02669*
*                  AND ISSUED FROM IEE0503D:                    Y02669*
*                                                                     *
*                    MSGID    CODE    MESSAGE TEXT              Y02669*
*                    _____    ____    ____________              Y02669*
*                   IEE026I   X'1A'   NOT SUPPORTED           @G17SPTJ*
*                   IEE305I   X'05'   COMMAND INVALID           Y02669*
*                   IEE311I   X'11'   PARAMETER MISSING         Y02669*
*                   IEE341I   X'24'   'CLOCK' NOT ACTIVE        Y02669*
*                                                                     *
*   SYSGEN       = INCLUDED WITH SVC 34 IN LOAD MODULE          Y02669*
*                  IGC0003D, SYSGEN MACRO SGIEF441,             Y02669*
*                  DLIB ASOB3, TARGLIB LPALIB.                  Y02669*
*                                                                     *
*   SYSTEM                                                      Y02669*
*    LIBRARIES   = NONE                                         Y02669*
*                                                              TSV0010*
*   CHANGE LOG:                                                TSV0010*
*      AS OF 11/09/2005 THIS MODULE HAS NO PTFS AGAINST IT     TSV0010*
*         AS PER SMP.                                          TSV0010*
*      11/19/2005  SKV  CHANGE TO CHANGE THE DISPLAY DATE TO   TSV0010*
*                       REFLECT THE 21ST CENTURY AFTER LABEL   TSV0010*
*                       DDTIME.                                TSV0010*
*      11/01/2007  SKV  CHANGE TO INCLUDE RESPONSE TO A        TSV0010*
*                       DISPLAY IPLINFO. DISPLAY XCF, AND      TSV0010*
*                       DISPLAY SYMBOLS.                       TSV0010*
*      01/01/2012  SKV  CHANGE TO INCLUDE RESPONSE TO A        TSV0010*
*                       DISPLAY APF.                           TSV0010*
*      07/06/2012  SKV  CHANGE TO INCLUDE RESPONSE TO A        TSV0010*
*                       DISPLAY SMS.                           TSV0010*
*                                                              TS00000*
***********************************************************************
         EJECT
IEE3503D CSECT
***********************************************************************
*                                                                     *
*                         REGISTER    EQUATES                         *
*                                                                     *
***********************************************************************
R0       EQU   0                  WORK REGISTER
R1       EQU   1                  WORK REGISTER
R2       EQU   2                  INPUT - BASE REG FOR XSA
R3       EQU   3                  MODULE BASE REGISTER
R4       EQU   4                  USED FOR UCMI                  Y02669
R5       EQU   5                  PTR TO OPERAND BUFFER AND ASID Y02669
R6       EQU   6                  USED TO ADDRESS TABLE ENTRIES
*                                  AND THE SU BIT STRING       @G17SPTJ
R7       EQU   7    (UNUSED)      UNUSED                         Y02669
R8       EQU   8    (UNUSED)      UNUSED                         Y02669
R9       EQU   9                  WORK REGISTER
R10      EQU   10                 SU NUMBER STORAGE AREA       @G17SPTJ
R11      EQU   11                 ADDRESSES END OF TABLE
R12      EQU   12   (UNUSED)      UNUSED                         Y02669
R13      EQU   13   (UNUSED)      UNUSED                         Y02669
R14      EQU   14                 RETURN ADDRESS
R15      EQU   15                 USED FOR BAL AND BRANCH EXIT
         SPACE
***********************************************************************
*                                                                     *
*                      DISPLACEMENTS AND LENGTHS                      *
*                                                                     *
***********************************************************************
D0       EQU   0                  DISPLACEMENTS
D1       EQU   1
D2       EQU   2
D3       EQU   3
D4       EQU   4
D5       EQU   5
D6       EQU   6
D7       EQU   7
L0       EQU   0                  LENGTHS                        Y02669
L1       EQU   1
L2       EQU   2
L3       EQU   3
L4       EQU   4
L8       EQU   8
         EJECT
***********************************************************************
*                                                                     *
*                           VERB CODES                           Y02669
*                                                                     *
***********************************************************************
TR       EQU   X'C4'              VERB CODE FOR TRACK            Y02669
CK       EQU   X'2E'              VERB CODE FOR DISPLAY C,K      Y02669
DOMAIN   EQU   X'88'              VERB CODE FOR DISPLAY DMN    @Z40BPSV
MATRIX   EQU   X'32'              VERB CODE FOR DISPLAY MATRIX   Y02669
PFK      EQU   X'36'              VERB CODE FOR DISPLAY PFK      Y02669
CONSOLES EQU   X'3E'              VERB CODE FOR DISPLAY CONSOLES Y02669
REQUESTS EQU   X'42'              VERB CODE FOR DISPLAY REQUESTS Y02669
UNITS    EQU   X'52'              VERB CODE FOR DISPLAY UNITS    Y02669
D38      EQU   X'F3'              VERB CODE FOR DISPLAY 3850   @Z40LPTA
SLIP     EQU   X'A8'              VERB CODE FOR DISPLAY SLIP   @G17SPTJ
DUMP     EQU   X'B0'              VERB CODE FOR DISPLAY DUMP   @G33CPMR
         SPACE
***********************************************************************
*                                                                     *
*                           SU TEST BIT MASKS                  @G17SPTJ
*                                                                     *
***********************************************************************
MASK7    EQU   7                  SU 7 BIT MASK                @G17SPTJ
MASK17   EQU   17                 SU 17 BIT MASK               @G17SPTJ
MASK33   EQU   33                 SU 33 BIT MASK               @G33CPMR
         SPACE
***********************************************************************
*                                                                     *
*                           MASKS                                Y02669
*                                                                     *
***********************************************************************
FLAG     EQU   X'80'              FLAG - DENOTES TPUT RETRY       20030
XF0      EQU   X'F0'              MASK FOR OI                    Y02669
X0F      EQU   15                 MASK FOR STORING ALL BYTES     Y02669
*                                 IN A REGISTER                  Y02669
M7       EQU   7                  MASK FOR MOVING ADDRESS IN ICM Y02669
         SPACE
***********************************************************************
*                                                                     *
*                           ERROR CODES                          Y02669
*                                                                     *
***********************************************************************
ERR305   EQU   X'05'              MASK FOR IEE305I-INVALID CMD   Y02669
ERR311   EQU   X'0B'              MASK FOR IEE311I-PARM MISSING  Y02669
ERR341   EQU   X'24'              MASK FOR IEE341I-NOT ACTIVE    Y02669
ERR026   EQU   X'1A'              MASK FOR IEE026I-NOT         @G17SPTJ
*                                                   SUPPORTED  @G17SPTJ
         EJECT
***********************************************************************
*                                                                     *
*            ESTABLISH ADDRESSABILITY FOR MODULE AND XSA         Y02669
*               GET POINTER TO OPERANDS FROM XAL                 Y02669
*  ERR - IEE311I PARAMETER MISSING - IF THERE ARE NO OPERANDS    Y02669
*                                                                     *
***********************************************************************
         BALR  R3,0               ESTABLISH PROGRAM ADDRESSABILITY
         USING *,R3
         MODID BRANCH=YES                                        Y01886
         USING IEEXSA,R2          ADDRESS EXTENDED SAVE AREA
         SR    R5,R5              CLEAR THE REGISTER             Y02669
         ICM   R5,M7,XAL+1        GET 3 BYTE ADDR OF OPERANDS    Y02669
         BZ    DERR311            NONE, ERR - PARAMETER MISSING  Y02669
         SPACE  2
***********************************************************************
*                                                                     *
*                 IS THIS A DISPLAY OR TRACK COMMAND?            Y02669
*                                                                     *
***********************************************************************
         SPACE 2
         SR    R9,R9              CLEAR REGISTER FOR OPERAND LENGTH
         SR    R15,R15            USED TO INDEX BRANCH TABLE
         XC    XAX(L8),XAX        CLEAR DISPLAY/TRACK FIELDS     Y02669
         LA    R11,DENTAB         CALCULATE COMPARE TABLE END ADDRESS
         CLI   XAN,TR             IS THIS A TRACK COMMAND?       Y02669
         BNE   DISPLAY            NO, USE WHOLE COMPARE TABLE    Y02669
         EJECT
***********************************************************************
*                                                                     *
*    LOOP THROUGH COMPARE TABLE LOOKING FOR VALID TRACK OPERAND  Y02669
*                                                                     *
***********************************************************************
         SPACE 2
TRACK    EQU   *                                                 Y02669
         LA    R6,DTRTAB          OTHERWISE, USE ONLY VALID      Y02669
         USING DTRTAB,R6          TRACK COMPARES                 Y02669
TRLOOP   EQU   *                                                 Y02669
         IC    R9,DTRLEN          LENGTH OF COMPARE TABLE ENTRY  Y02669
         EX    R9,COMPARE         CHECK FOR MATCH                Y02669
         BE    TRTABLE(R15)       IF MATCH,PROCESS ACCORDINGLY   Y02669
         LA    R6,D2(R9,R6)       NO MATCH, GO TO NEXT ENTRY     Y02669
         LA    R15,D4(R15)        INCRE INDEX FOR BRANCH TABLE   Y02669
         CR    R6,R11             END OF COMPARE TABLE REACHED?  Y02669
         BL    TRLOOP             NO, GO BACK AND CHECK NEXT     Y02669
*                                 TABLE ENTRY                    Y02669
         DROP  R6                 NECESSARY TO RE-EST BASE REG   Y02669
         B     DERR305            YES, INVALID OPERAND-ERROR     Y02669
         SPACE 2
***********************************************************************
*                                                                     *
* LOOP THROUGH COMPARE TABLE LOOKING FOR VALID DISPLAY OPERAND   Y02669
*                                                                     *
***********************************************************************
         SPACE 2
DISPLAY  EQU   *                                                 Y02669
         LA    R6,DTAB            COMPARE TABLE BEGINNING ADDR   Y02669
         USING DTAB,R6            EST. ADDRESSABILITY TO TABLE
DLOOP    EQU   *                                                 Y02669
         IC    R9,DLEN            LENGTH OF COMPARE TABLE ENTRY
         EX    R9,COMPARE         CHECK FOR MATCH                Y02669
         BE    BRTABLE(R15)       IF MATCH, PROCESS ACCORDINGLY  Y02669
         LA    R6,D2(R9,R6)       NO MATCH, GO TO NEXT ENTRY
         LA    R15,D4(R15)        INCRE INDEX FOR BRANCH TABLE
         CR    R6,R11             END OF COMPARE TABLE REACHED?   M0467
         BL    DLOOP              NO, GO BACK AND CHECK NEXT      20030
*                                 TABLE ENTRY                     20030
         DROP  R6                 NECESSARY TO RE-EST BASE REG   Y02669
         B     DERR305            YES, INVALID OPERAND-ERROR     Y02669
         EJECT
***********************************************************************
*                                                                     *
*                       DISPLAY UNITS                              O111
*                                                                     *
***********************************************************************
DDUNIT   EQU   *                                                 Y02669
         MVI   XAN,UNITS          CHANGE VERB CODE IN XSA        Y02669
         B     DD7503D            BRANCH TO IEE7503D             Y02669
         SPACE  5
***********************************************************************
*                                                                     *
*                DISPLAY CONFIGURATION MATRIX                    Y02651
*                                                                     *
***********************************************************************
DDMATRIX EQU   *                                                 Y02651
         MVI   XAN,MATRIX         CHANGE VERB CODE IN XSA        Y02651
         B     DD7503D            BRANCH TO IEE7503D             Y02651
         SPACE   5
***********************************************************************
*                                                                     *
*            TRACK OR DISPLAY JOBS  (J)                          Y02669
*                             TS                                 Y02669
*                             A                                  Y02669
*                                                                     *
***********************************************************************
DDACTIVE EQU   *                                                 Y02669
         OI    XAXMASK,XAXJOBS+XAXTS  INDICATE ACTIVE OPTION     Y02669
         B     DD7503D             BRANCH TO IEE7503D            Y02669
DDJOBS   EQU   *                                                 Y02669
         OI    XAXMASK,XAXJOBS     INDICATE JOBS OPTION          Y02669
         B     DD7503D             BRANCH TO IEE7503D            Y02669
DDTS     EQU   *                                                 Y02669
         OI    XAXMASK,XAXTS       INDICATE TS OPTION            Y02669
         B     DD7503D             BRANCH TO IEE7503D            Y02669
         EJECT
***********************************************************************
*                                                                     *
*                       DISPLAY CONSOLES (C)                     YM1916
*                                                                     *
***********************************************************************
DDCONS   EQU   *                                                 Y02669
         MVI   XAN,CONSOLES       CHANGE VERB CODE IN XSA        Y02669
         B     DD7503D            BRANCH TO IEE7503D             Y02669
         SPACE   5
***********************************************************************
*                                                                     *
*                      DISPLAY REQUESTS                          Y02669
*                                                                     *
***********************************************************************
DDREQ    EQU   *                                                 Y02669
         MVI   XAN,REQUESTS       CHANGE VERB CODE IN XSA        Y02669
         B     DD7503D            BRANCH TO IEE7503D             Y02669
         SPACE   5
***********************************************************************
*                                                                     *
*                       DISPLAY 3850                           @Z40LPTA
*                                                                     *
***********************************************************************
DD3850   EQU   *                                               @Z40LPTA
         MVI   XAN,D38          RE-SET VERB INDICATOR          @Z40LPTA
         B     DD7503D          BRANCH TO IEE7503D             @Z40LPTA
         EJECT
***********************************************************************
*                                                                     *
*                       DISPLAY DOMAIN                         @Z40BPSV
*                                                                     *
***********************************************************************
DDDOMAIN EQU   *                                               @Z40BPSV
         MVI   XAN,DOMAIN       CHANGE VERB CODE IN XSA        @Z40BPSV
         LA    R10,MASK7        SET SU NUMBER FOR TESTING      @G17SPTJ
         B     TESTSU           BRANCH TO TEST SU NUMBER       @G17SPTJ
         SPACE 5
***********************************************************************
*                                                                     *
*                       DISPLAY SLIP                           @G17SPTJ
*                                                                     *
***********************************************************************
DDSLIP   EQU   *                                               @G17SPTJ
         MVI   XAN,SLIP         CHANGE VERB CODE IN XSA        @G17SPTJ
         LA    R10,MASK17       SET SU NUMBER FOR TESTING      @G17SPTJ
         B     TESTSU           BRANCH TO TEST SU NUMBER       @G17SPTJ
         SPACE 5
***********************************************************************
*                                                                     *
*                       DISPLAY DUMP                           @G33CPMR
*                                                                     *
***********************************************************************
DDDUMP   EQU   *                                               @G33CPMR
         MVI   XAN,DUMP         CHANGE VERB CODE IN XSA        @G33CPMR
         LA    R10,MASK33       SET SU NUMBER FOR TESTING      @G33CPMR
         B     TESTSU           BRANCH TO TEST SU NUMBER       @G33CPMR
         SPACE 5
***********************************************************************
*                                                                     *
*                       DISPLAY C,K                              Y02669
*                                                                     *
***********************************************************************
DDCK     EQU   *                                                 Y02669
         MVI   XAN,CK             CHANGE VERB CODE IN XSA        Y02669
DD7503D  EQU   *                                                 Y02669
         L     R15,VCON7503       GET ADDRESS OF IEE7503D        Y02669
         BR    R15                BRANCH TO CHECK ROUTING INFO   Y02669
         EJECT
***********************************************************************
*                                                                     *
*                       DISPLAY PFK                               21002
*                                                                     *
***********************************************************************
DDPFK    EQU   *                                                 Y02669
         MVI   XAN,PFK            CHANGE VERB CODE IN XSA        Y02669
         XC    XAS(L8),XAS        CLEAR DEFAULT ROUTING FIELD    Y02669
*                                 FOR ALL OTHER DISPLAY FUNCTIONSY02669
*                                 FIELD IS SET IN IEE7503D       Y02669
         L     R15,VCON0803       GET ADDR OF IEE0803D           Y02669
         BR    R15                BRANCH TO CSCB CREATION        Y02669
         SPACE   5
***********************************************************************
*                                                                     *
*                        DISPLAY TP,                              20002
*                                                                     *
***********************************************************************
DDTP     EQU   *                                                 Y02669
         L     R15,VCON1303       GET ADDR OF IED1303D           Y02669
         BR    R15                BRANCH TO D TP MODULE          Y02669
         SPACE  5
***********************************************************************
*                                                                     *
*                       DISPLAY NET,                             Y02674
*                                                                     *
***********************************************************************
DDNET    EQU   *                                                 Y02674
         L     R15,VCONCFF3       GET ADDR OF ISTCFF3D           Y02674
         BR    R15                BRANCH TO D NET MODULE         Y02674
         EJECT
***********************************************************************
*                                                                     *
*                      DISPLAY  TIME                                  *
*                                                                     *
***********************************************************************
DDTIME   EQU   *                                                 Y02669
         SR    R4,R4                 CLEAR FOR IC
         IC    R4,XAU                SAVE UCMI FOR WTO
         LH    R5,XAA                SAVE ASID FOR TPUT          Y02669
         TIME  DEC,ERRET=DERR341                                 Y02669
         MVC   XSA(DDLN),DDMSG       MOVE IN INCOMPLETE WTO MSG  Y02669
         STCM  R0,X0F,XTM            TIME IN XSA AFTER 'TIME='   Y02669
         UNPK  XTM(L8),XTM(L4)       UNPACK TIME
         MVC   XTM(L2),XTM+D1        LEFT ADJUST HOURS
         MVI   XTM+D2,C'.'           INSERT PERIOD
         MVC   XTM+D7(L1),XTM+D6     RIGHT ADJUST  ....
         MVC   XTM+D6(L1),XTM+D5     ....SECONDS
         MVI   XTM+D5,C'.'           INSERT PERIOD
         STCM  R1,X0F,XDATE          DATE IN XSA AFTER 'DATE= '  Y02669
         UNPK  XDATE(L8),XDATE(L4)   UNPACK DATE
         OI    XDATE+D7,XF0          SET LOW ORDER BYTE  EBCDIC  Y02669
         MVC   XDATE(L2),=C'19'      SET DEFAULT CENTURY            SKV
         CLC   XDATE+D2(1),=C'1'     IS THIS THE 21 CENTURY?        SKV
         BNE   DDTIME1                NO - USE DEFAULT              SKV
         MVC   XDATE(L2),=C'20'      SET AS THE 21 CENTURY?         SKV
DDTIME1  EQU   *                                                    SKV
         MVC   XDATE+D2(L2),XDATE+D3 LEFT ADJUST YEAR               SKV
         MVI   XDATE+D4,C'.'         INSERT PERIOD                  SKV
***      MVC   XDATE+D5(L3),XDATE+D5 LEFT ADJUST DAY                SKV
*        MVC   XDATE(L2),XDATE+D3    LEFT ADJUST YEAR
*        MVI   XDATE+D2,C'.'         INSERT PERIOD
*        MVC   XDATE+D3(L3),XDATE+D5 LEFT ADJUST DAY
*        MVC   XDATE+D6(L2),DDBLNK   BLANK OUT ANY LEFT-OVERS
         LTR   R5,R5                 TERMINAL REQUEST             20030
         BNZ   XTPUT                 YES, PUT TIME MSG TO TERM    20030
         LR    R0,R4                 PUT UCMI INTO REG 0
         WTO   MF=(E,(R2))           WRITE TO OPERATOR - TIME AND DATE
         BR    R14                   RETURN TO SYSTEM
         EJECT
***********************************************************************
*                                                                     *
*                      DISPLAY  APF                     *ADDED SKV    *
*                                                                     *
***********************************************************************
LMS503D  DC    V(IEES503D)
DDAPF    DS    0H
         LR    R7,R14                SAVE RETURN ADDRESS
         SR    R4,R4                 CLEAR FOR IC
         IC    R4,XAU                SAVE UCMI FOR WTO
         LH    R5,XAA                SAVE ASID FOR TPUT
         MVC   XSA(DAPFNLN),DAPFNMSG  MOVE IN WTO MSG
         LR    R0,R4                 PUT UCMI INTO REG 0
         WTO   MF=(E,(R2))           WRITE TO OPERATOR - GTBK
*        LOAD  EP=IEES503D           LOAD THE ROUTINE TO DISPLAY INFO
*        LR    R15,R0                GET EPA OF MODULE LOADED
         L     R15,LMS503D           GET EPA OF MODULE LOADED
         L     R0,=F'0003'           SET PARM TO DO APF DISPLAY
         BALR  R14,R15               AND RUN IT
*        DELETE EP=IEES503D          DELETE THE PREVIOUSLY LOADED RTN
         LR    R14,R7                RESTORE RETURN ADDRESS
         BR    R14                   RETURN TO SYSTEM
         EJECT
***********************************************************************
*                                                                     *
*                      DISPLAY  SMS                     *ADDED SKV    *
*                                                                     *
***********************************************************************
DDSMS    EQU   *
         SR    R4,R4                 CLEAR FOR IC
         IC    R4,XAU                SAVE UCMI FOR WTO
         LH    R5,XAA                SAVE ASID FOR TPUT
         MVC   XSA(DGTB2LN),DGTB2MSG MOVE IN INCOMPLETE WTO MSG
         LR    R0,R4                 PUT UCMI INTO REG 0
         WTO   MF=(E,(R2))           WRITE TO OPERATOR - GTBK
         BR    R14                   RETURN TO SYSTEM
         EJECT
***********************************************************************
*                                                                     *
*                      DISPLAY  XCF                     *ADDED SKV    *
*                                                                     *
***********************************************************************
DDXCF    EQU   *
         SR    R4,R4                 CLEAR FOR IC
         IC    R4,XAU                SAVE UCMI FOR WTO
         LH    R5,XAA                SAVE ASID FOR TPUT
         MVC   XSA(DGTBKLN),DGTBKMSG MOVE IN INCOMPLETE WTO MSG
         LR    R0,R4                 PUT UCMI INTO REG 0
         WTO   MF=(E,(R2))           WRITE TO OPERATOR - GTBK
         BR    R14                   RETURN TO SYSTEM
         EJECT
***********************************************************************
*                                                                     *
*                      DISPLAY  SYMBOLS                 *ADDED SKV    *
*                                                                     *
***********************************************************************
DDSYM    EQU   *
         SR    R4,R4                 CLEAR FOR IC
         IC    R4,XAU                SAVE UCMI FOR WTO
         LH    R5,XAA                SAVE ASID FOR TPUT
         MVC   XSA(DGSYMLN),DGSYMMSG MOVE IN INCOMPLETE WTO MSG
         LR    R0,R4                 PUT UCMI INTO REG 0
         WTO   MF=(E,(R2))           WRITE TO OPERATOR - GTBK
         BR    R14                   RETURN TO SYSTEM
         EJECT
********************************************************************SKV
*                                                                   SKV
*                      DISPLAY SMF                                  SKV
*                                                                   SKV
********************************************************************SKV
DDSMF    DS    0H                                                   SKV
         LR    R7,R14               SAVE RETURN ADDRESS
         CLC   3(2,R5),=C',D'       ASKING FOR DATASET INFORMATION?
         BE    DDSMFD                YES, GO DISPLAY IT
         CLC   3(2,R5),=C',O'       ASKING FOR DATASET INFORMATION?
         BE    DDSMFO                YES, GO DISPLAY IT
         CLC   3(2,R5),=C',A'       ASKING FOR OPTIONS & DATASET INFO?
         BE    DDSMFO                YES, GO DISPLAY IT
DDSMFO   DS    0H
         L     R0,=F'0001'          SET PARM TO DO SMF OPTION DISPLAY
         B     DDSMFX                YES, GO DO IT
DDSMFD   DS    0H
         L     R0,=F'0002'          SET PARM TO DO SMF DATASET DISPLY
DDSMFX   DS    0H
         L     R15,LMS503D          GET EPA OF MODULE LOADED
         BALR  R14,R15               AND RUN IT
         LR    R14,R7               RESTORE RETURN ADDRESS
         BR    R14                  RETURN TO SYSTEM
         EJECT
***********************************************************************
*                                                                     *
*                      DISPLAY  IPLINFO                 *ADDED SKV    *
*                                                                     *
***********************************************************************
DDIPLI   EQU   *
*        SR    R4,R4                 CLEAR FOR IC
*        IC    R4,XAU                SAVE UCMI FOR WTO
*        LH    R5,XAA                SAVE ASID FOR TPUT
*        LR    R0,R4                 PUT UCMI INTO REG 0
*        WTO   MF=(E,(R2))           WRITE TO OPERATOR - IPL INFO
*
         SR    R4,R4                 CLEAR FOR IC
         IC    R4,XAU                SAVE UCMI FOR WTO
         LH    R5,XAA                SAVE ASID FOR TPUT
*  INSERT TIME OF DISPLAY
         TIME  DEC,ERRET=DERR341                                 Y02669
         MVC   XSA(DDLN),DDMSG       MOVE IN INCOMPLETE WTO MSG  Y02669
         STCM  R0,X0F,DIPLMSGL+14    TIME IN XSA AFTER 'TIME='   Y02669
         UNPK  DIPLMSGL+14(08),DIPLMSGL+14(L4)  UNPACK TIME
         MVC   DIPLMSGL+14(02),DIPLMSGL+15      LEFT ADJUST HOURS
         MVI   DIPLMSGL+16,C'.'                 INSERT PERIOD
         MVC   DIPLMSGL+21(01),DIPLMSGL+20      RIGHT ADJUST  ....
         MVC   DIPLMSGL+20(01),DIPLMSGL+19      ....SECONDS
         MVI   DIPLMSGL+19,C'.'                 INSERT PERIOD
*  DO OS NAME
         L     R1,16                      POINT TO CVT
         USING CVT,R1                     MAP CVT
         TM    CVTDCB,CVT1SSS             IS THIS PCP?
         BNO   DIPL1                       NO -
         MVC   DIPLMSGL+111(03),=C'PCP'   MOVE OS NAME
DIPL1    DS    0H
         TM    CVTDCB,CVT2SPS             IS THIS MFT?
         BNO   DIPL2                       NO -
         MVC   DIPLMSGL+111(03),=C'MFT'   MOVE OS NAME
DIPL2    DS    0H
         TM    CVTDCB,CVT4MS1             IS THIS MVT?
         BNO   DIPL3                       NO -
         MVC   DIPLMSGL+111(03),=C'MVT'   MOVE OS NAME
DIPL3    DS    0H
         TM    CVTDCB,CVT2SPS+CVT6DAT     IS THIS VS1?
         BNO   DIPL4                       NO -
         MVC   DIPLMSGL+111(03),=C'VS1'   MOVE OS NAME
DIPL4    DS    0H
         TM    CVTDCB,CVT4MS1+CVT6DAT     IS THIS MVS?
         BNO   DIPL5                       NO -
         MVC   DIPLMSGL+111(03),=C'MVS'   MOVE OS NAME
DIPL5    DS    0H
         DROP  R1
*  DO OS RELEASE
         L     R1,16                      POINT TO CVT
         L     R15,=F'4'                  OFFSET TO PREFIX NEEDED
         SR    R1,R15                     POINT TO CVT W/SOME PREFIX
*        USING CVTXTNT2,R1                MAP CVT
         MVC   DIPLMSGL+115(02),0(R1)     CVTNUMB
         MVC   DIPLMSGL+117(01),=C'.'
         MVC   DIPLMSGL+118(02),2(R1)     CVTLEVL
*        DROP  R1
*  DO CLPA, CVIO, OR WARM (NO DISPLAY)
         L     R1,16                      POINT TO CVT
         USING CVT,R1                     MAP CVT
         L     R15,CVTASMVT               POINT TO ASMVT
         USING ASMVT,R15                  MAP ASMVT
         MVC   DIPLMSGL+168(04),=C'WARM'  STATE DEFAULT WARM START
         TM    ASMFLAG2,ASMQUICK          WAS CLPA DONE?
         BNZ   DIPL6                       NO - CHECK NEXT
         TM    ASMFLAG2,ASMWARM           WAS CLPA DONE?
         BNZ   DIPL6                       NO - CHECK NEXT
         MVC   DIPLMSGL+168(04),=C'CLPA'   YES - SAY CLPA
         B     DIPL8                       GO CONTINUE ON
DIPL6    DS    0H
         TM    ASMFLAG2,ASMWARM           WAS CVIO DONE?
         BNZ   DIPL7                       NO - CHECK NEXT
         MVC   DIPLMSGL+168(04),=C'CVIO'   YES - SAY CVIO
         B     DIPL8                       GO CONTINUE ON
DIPL7    DS    0H
DIPL8    DS    0H
         DROP  R1
*  DO NUCLEUD ID
         L     R1,16                      POINT TO CVT
         USING CVTXTNT2,R1                MAP CVT
         MVC   DIPLMSGL+224(01),CVTNUCLS  MOVE IN IPL'ED NUCLEUS ID
         DROP  R1
*  DO SMF ID
         L     R1,16                      POINT TO CVT
         USING CVT,R1                     MAP CVT
         L     R15,CVTSMCA                POINT TO SMF AREA
         USING SMCABASE,R15               MAP SMF AREA
         MVC   DIPLMSGL+185(04),SMCASID   MOVE IN SMFID
         DROP  R1
         DROP  R15
*  DO IPL ADDRESS & VOLUME NAME
         L     R1,16                      POINT TO CVT
         USING CVT,R1                     MAP CVT
         L     R15,CVTSYSAD               POINT TO IPL UCB
         USING UCB,R15                    MAP UCB AREA
         MVC   DIPLMSGL+304(03),UCBNAME
         MVC   DIPLMSGL+318(06),UCBVOLI
*        MVC   XSA(DIPL1LN),DIPL1MSG MOVE IN INCOMPLETE WTO MSG
         DROP  R1
         DROP  R15
         LR    R0,R4                 PUT UCMI INTO REG 0
         LA    R2,DIPLMSGL           POINT TO WTO LIST FORM
         WTO   MF=(E,(R2))           WRITE TO OPERATOR - IPL INFO
         BR    R14                   RETURN TO SYSTEM
         EJECT
***********************************************************************
*                                                                     *
*      FOR TPUTS REGISTER 1 POINTS TO THE BEGINNING OF THE       Y02669
*      MESSAGE TEXT NOT TO THE PRECEDING WORD OF TEXT LENGTH     Y02669
*      AND MCS FLAGS.  THEREFORE THE HI ORDER BYTE OF THIS WORD  Y02669
*      IS USED AS THE RETRY INDICATOR. IT WILL BE SET TO X'80'   Y02669
*      THE FIRST TIME A RETRY IS ATTEMPTED AND CONTROL WILL BE   Y02669
*      RETURNED TO THE SYSTEM IF THE RETRY FAILS.                Y02669
*                                                                     *
***********************************************************************
         SPACE 2
XTPUT    EQU   *                                                  20030
         LH    R0,XAH                TEXT BY 4 FOR TPUT (MSFLAGS) 20030
         SH    R0,FOUR                                            20030
         LA    R1,XAI                ADDR OF MSG TEXT             20030
         TPUT  (1),(0),TJID=(5)      PUT MSG TO TERMINAL          20030
         CH    R15,ERRCODE           CHECK TPUT RETURN CODE       20030
         BCR   D7,R14                OK, RETURN TO SYSTEM         20030
         SPACE  1
         TM    XAH,FLAG              HAS A RETRY BEEN ATTEMPTED  Y02669
         BCR   D1,R14                YES, RETURN TO SYSTEM        20030
         OI    XAH,FLAG              SET FLAG TO DENOTE RETRY    Y02669
         B     XTPUT                 RETRY TPUT                   20030
         EJECT
***********************************************************************
*                                                                     *
*     FOR SU-DEPENDENT COMMANDS, EXECUTION PASSES HERE TO             *
*     ASCERTAIN IF THE SYSTEM SUPPORTS THE COMMAND IN QUESTION.       *
*     THE TEST IS MADE AGAINST A FOUR WORD SU BIT MASK IN THE         *
*     NUCLEUS WHICH IS POINTED TO BY THE CVTIHASU FIELD.  ON          *
*     ENTRY TO THIS SUBROUTINE, REGISTER 10 CONTAINS THE SU           *
*     NUMBER TO BE USED AS THE TEST AGAINST THE BIT MASK FIELD.       *
*     IF THE SU IS INSTALLED, PROCESSING CONTINUES.  OTHERWISE,       *
*     AN IEE026I ERROR MESSAGE IS ISSUED.                      @G33CPMR
*                                                                     *
***********************************************************************
         SPACE
TESTSU   EQU   *                                               @G17SPTJ
         L     R6,CVTPTR          ESTABLISH CVT ADDRESSABILITY @G17SPTJ
         USING CVT,R6                                          @G17SPTJ
         L     R6,CVTIHASU        ESTABLISH SU ADDRESSABILITY  @G17SPTJ
         USING SUBITS,R6                                       @G17SPTJ
         C     R10,SIXFOUR        IS SU NUMBER BELOW 64?       @G17SPTJ
         BL    BELOW64            YES, BRANCH AROUND REDUCTION @G17SPTJ
         LM    R4,R5,SUBYTE9      OBTAIN 2ND 2 SU WORDS        @G33CPMR
         S     R10,SIXFOUR        REDUCE SU NUMBER BY 64       @G17SPTJ
         B     SHIFT              BRANCH AROUND NEXT INSTR.    @G17SPTJ
BELOW64  EQU   *                                               @G17SPTJ
         LM    R4,R5,SUBYTE1      OBTAIN 1ST 2 SU WORDS        @G33CPMR
SHIFT    EQU   *                                               @G17SPTJ
         LTR   R10,R10            IS IT SU 0 OR SU 64?         @G17SPTJ
         BZ    SHIFTED            YES, AVOID SHIFTING          @G17SPTJ
LOOP     EQU   *                                               @G17SPTJ
         SLDL  R4,D1              SHIFT ACCORDING TO SU NUMBER @G17SPTJ
         BCT   R10,LOOP           CONTINUE SHIFTING UNTIL ZERO @G17SPTJ
SHIFTED  EQU   *                                               @G17SPTJ
         LTR   R4,R4              IS SU INSTALLED ON SYSTEM?   @G17SPTJ
         BM    DD7503D            YES, BRANCH TO IEE7503D      @G17SPTJ
         B     DERR026            NO, SU NOT INSTALLED - ERROR @G33CPMR
         EJECT
***********************************************************************
*                                                                     *
*                         ERROR EXITS                            Y02669
*                                                                     *
***********************************************************************
         SPACE 2
DERR026  EQU   *                                               @G33CPMR
         MVI   XAE,ERR026         ERROR CODE = 26 - NO SUPPORT @G33CPMR
         B     D0503D             BRANCH TO IEE0503D           @G33CPMR
DERR311  EQU   *                                                 Y02669
         MVI   XAE,ERR311         ERROR CODE=11 FOR PARM MISSING Y02669
         B     D0503D             BRANCH TO IEE0503D             Y02669
DERR305  EQU   *                                                 Y02669
         MVI   XAE,ERR305         ERROR CODE=5 FOR INVALID COMD  Y02669
         B     D0503D             BRANCH TO IEE0503D             Y02669
DERR341  EQU   *                                                 Y02669
         MVI   XAE,ERR341         ERROR CODE=36 FOR NOT ACTIVE   Y02669
         MVC   XAV(L8),CLOCKERR   GET KEYWORD 'CLOCK'            Y02669
D0503D   EQU   *                                                 Y02669
         L     R15,VCON0503       GET ADDR OF IEE0503D           Y02669
         BR    R15                BRANCH TO MESSAGE MODULE       Y02669
         EJECT
***********************************************************************
*                                                                     *
*                         CONSTANTS                              Y02669
*                                                                     *
***********************************************************************
         SPACE   5
FOUR     DC    H'4'               USED IN SH INSTRUCTION         Y02669
SIXFOUR  DC    F'00000064'        COMPARAND OF 64              @G17SPTJ
ERRCODE  DC    X'0014'            TPUT RETURN CODE - MSG DID NOT  20030
*                                 GO DUE TO AN OUTSTANDING TPUT   20030
DDBLNK   DC    C'        '        USED FOR PADDING
CLOCKERR DC    C'CLOCK   '        USED FOR D T ERROR MESSAGE     Y02669
VCON0503 DC    V(IEE0503D)        ADDRESS OF MESSAGE MODULE      Y02669
VCON0803 DC    V(IEE0803D)        ADDRESS OF CSCB CREATION MOD   Y02669
VCON1303 DC    V(IED1303D)        ADDRESS OF D TP MODULE         Y02669
VCON7503 DC    V(IEE7503D)        ADDRESS OF SDS MODULE          Y02669
VCONCFF3 DC    V(ISTCFF3D)        ADDRESS OF NET MODULE          Y02674
         SPACE
DDMSG    WTO   'IEE136I  TIME=         DATE=        ',MF=L,            X
               DESC=(5),MCSFLAG=(REG0,RESP)                      Y02669
DDLN     EQU   *-DDMSG
         SPACE
DAPFNMSG WTO   'IXC361I   D APF - ENTRY              ',MF=L,           X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DAPFNLN  EQU   *-DAPFNMSG                                          *SKV
         SPACE
DGTB2MSG WTO   'IXC361I   D SMS,? - YOU''RE KIDDING RIGHT?',MF=L,      X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DGTB2LN  EQU   *-DGTB2MSG                                          *SKV
         SPACE
DGTBKMSG WTO   'IXC361I   D XCF,? - YOU''RE KIDDING RIGHT?',MF=L,      X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DGTBKLN  EQU   *-DGTBKMSG                                          *SKV
         SPACE
DGSYMMSG WTO   'IEA007I  STATIC SYSTEM SYMBOL VALUES - N/A',MF=L,      X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DGSYMLN  EQU   *-DGSYMMSG                                          *SKV
         SPACE
DSMRMSE1 WTO   'SKV0002E: SMCA ADDRESS NOT SET.',                      X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
DSMRMSX1 EQU   *-DSMRMSE1
DSMRMSE2 WTO   'SKV0003E: SMCA AREA BAD.',                             X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
DSMRMSX2 EQU   *-DSMRMSE2
DGSM1MSG WTO   'IEE967I   SMF PARAMETERS',MF=L,                        X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DGSM1LN  EQU   *-DGSM1MSG                                          *SKV
DGSM2MSG WTO   '   NO INFORMATION AT THIS TIME.',MF=L,                 X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DGSM2LN  EQU   *-DGSM2MSG                                          *SKV
         SPACE
DIPLIMSG WTO   'IEE254I - HH.MM.SS IPLINFO DISPLAY            ',MF=L,  X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DIPLILN  EQU   *-DIPLIMSG                                          *SKV
         SPACE
DIPLMSGL WTO   ('IEE254I - HH:MM.SS IPLINFO DISPLAY       ',C),        X
               (' SYSTEM IPLED AT HH:MM.SS ON MM/DD/YYYY  ',D),        X
               (' RELEASE --- --- ----             ',D),               X
               (' USED  IEASYS00                   ',D),               X
               (' SMFID XXXX                       ',D),               X
               (' NUCID 0Y                         ',D),               X
               (' CATALOG SYSCATLG                 ',D),               X
               (' IPL DEVICE ZZZ ON VOLUME ABCDEF  ',DE),              X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
         SPACE
DSMRMSKD WTO   ('SKV0001I SMF XAL:12345678  XAV:12345678         ',C), X
               ('  XAR:12345678  R5:12345678                     ',D), X
               ('                                                ',DE),X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
DSMRMSKX EQU   *-DSMRMSKD
WTOML1P1 EQU   064+005
WTOML1P2 EQU   064+024
WTOML1P3 EQU   064+037
WTOML2P1 EQU   116+012
WTOML2P2 EQU   116+016
WTOML3P1 EQU   168+010
WTOML3P2 EQU   168+013
WTOML3P3 EQU   168+025
WTOML4P1 EQU   220+007
WTOML5P1 EQU   272+005
WTOML5P2 EQU   272+016
WTOML6P1 EQU   324+004 MAN_
WTOML6P2 EQU   324+006 ACTIVE/INACT/*FULL*
WTOML6P3 EQU   324+014 VOLSER
WTOML6P4 EQU   324+028 MAN_
WTOML6P5 EQU   324+030 ACTIVE/INACT/*FULL*
WTOML6P6 EQU   324+037 VOLSER
WTOML7P1 EQU   376+004
WTOML7P2 EQU   376+011
WTOML7P3 EQU   376+020
WTOML7P4 EQU   376+027
WTOML7P5 EQU   376+034
WTOML7P6 EQU   376+044
         SPACE   5
PONE     DC    PL4'1'
DBLWORD  DC    D'0'
         DC    C'ABCD'
DBLWRDP0 DC    D'0'
DBLWRDP1 DC    D'0'
         DC    C'EFGH'
OFLD     DC    C'----'
EMASK    DC    X'40202020'
MICROSEC DC    F'60000000'
MSHIFT   DC    F'1048576'
LTH      DC    F'50000000'
DECVALUE DC    H'0'
         SPACE   2
COMPARE  CLC   D1(L0,R6),D0(R5)   LOOK FOR MATCH IN TABLE        Y02669
         SPACE   5
***********************************************************************
*                                                                     *
*                        PATCH AREA                              Y02669
*                                                                     *
***********************************************************************
         SPACE   2
PATCH    DC      CL50'*****PATCH AREA - IEE3503D******'          Y02669
         EJECT
***********************************************************************
*                                                                     *
*                         BRANCH  TABLE                          Y02669
*                                                                     *
*        THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE WITH  Y02669
*        THE 'COMPARE TABLE'                                     Y02669
*        THE BRANCH TABLE FOR THE TRACK COMMAND STARTS WITH      Y02669
*        TRTABLE                                                 Y02669
*                                                                     *
***********************************************************************
         SPACE   5
BRTABLE  DS    0H                                                Y02669
         B     DDTIME             BRANCH TO PROCESS D T          Y02669
         B     DDREQ              BRANCH TO PROCESS D R          Y02669
         B     DDREQ              BRANCH TO PROCESS D R,LIST     Y02669
         B     DDUNIT             BRANCH TO PROCESS D U          Y02669
         B     DDUNIT             BRANCH TO PROCESS D U,         Y02669
         B     DDMATRIX           BRANCH TO PROCESS D M          Y02651
         B     DDMATRIX           BRANCH TO PROCESS D M=         Y02651
         B     DDMATRIX           BRANCH TO PROCESS D M,         Y02651
         B     DDTP               BRANCH TO PROCESS DISPLAY TP,  Y02669
         B     DDNET              BRANCH TO PROCESS DISPLAY NET, Y02674
         B     DDCK               BRANCH TO PROCESS DISPLAY C,K  Y02669
         B     DDCK               BRANCH TO PROCESS DISPLAY C,K, Y02669
         B     DDCONS             BRANCH TO PROCESS D CONSOLES   YM1916
         B     DDCONS             BRANCH TO PROCESS D CONSOLES,  YM1916
         B     DDCONS             BRANCH TO PROCESS D C          YM1916
         B     DDCONS             BRANCH TO PROCESS D C,         YM1916
         B     DDPFK              BRANCH TO PROCESS D PFK        Y02669
         B     DD3850             BRANCH TO PROCESS D 3850     @Z40LPTA
         B     DD3850             BRANCH TO PROCESS D 3850,    @Z40LPTA
         B     DDDOMAIN           BRANCH TO PROCESS D DMN      @Z40BPSV
         B     DDDOMAIN           BRANCH TO PROCESS D DMN=     @Z40BPSV
         B     DDDOMAIN           BRANCH TO PROCESS D DMN,     @Z40BPSV
         B     DDSLIP             BRANCH TO PROCESS D SLIP     @G17SPTJ
         B     DDSLIP             BRANCH TO PROCESS D SLIP,    @G17SPTJ
         B     DDSLIP             BRANCH TO PROCESS D SLIP=    @G17SPTJ
         B     DDDUMP             BRANCH TO PROCESS D DUMP     @G33CPMR
         B     DDDUMP             BRANCH TO PROCESS D DUMP,    @G33CPMR
         B     DDDUMP             BRANCH TO PROCESS D D        @G33CPMR
         B     DDDUMP             BRANCH TO PROCESS D D,       @G33CPMR
TRTABLE  DS    0H                                                Y02669
         B     DDACTIVE           BRANCH TO PROCESS D OR TR A    Y02669
         B     DDACTIVE           BRANCH TO PROCESS D OR TR A,   Y02669
         B     DDJOBS             BRANCH TO PROCESS D OR TR J    Y02669
         B     DDJOBS             BRANCH TO PROCESS D OR TR J,   Y02669
         B     DDJOBS             BRANCH TO PROCESS D OR TR JOBS Y02669
         B     DDJOBS             BRANCH TO PROCESS D OR TR JOBS,Y02669
         B     DDTS               BRANCH TO PROCESS D OR TR TS   Y02669
         B     DDTS               BRANCH TO PROCESS D OR TR TS   Y02669
         B     DDSMS              BRANCH TO PROCESS D SMS          *SKV
         B     DDSMS              BRANCH TO PROCESS D SMS,         *SKV
         B     DDXCF              BRANCH TO PROCESS D XCF          *SKV
         B     DDXCF              BRANCH TO PROCESS D XCF,         *SKV
         B     DDIPLI             BRANCH TO PROCESS D IPLINFO      *SKV
         B     DDSMF              BRANCH TO PROCESS D SMF          *SKV
         B     DDSMF              BRANCH TO PROCESS D SMF,         *SKV
         B     DDSYM              BRANCH TO PROCESS D SYMBOLS      *SKV
         B     DDAPF              BRANCH TO PROCESS D APF          *SKV
         EJECT
***********************************************************************
*   NOTE:  THE FOLLOWING TABLE MUST BE THE LAST ITEM IN THIS     Y02669
*          MODULE SINCE A USING FOR THE TABLE IS ISSUED ON       Y02669
*          REGISTER 6 AND THUS CAN REESTABLISH THE MODULE'S      Y02669
*          BASE REGISTER FOR ANY CODE WHICH FOLLOWS THIS TABLE.  Y02669
*                                                                     *
*                        COMPARE TABLE                           Y02669
*                                                                     *
*           THIS TABLE MUST BE IN A ONE-TO-ONE CORRESPONDENCE    Y02669
*           WITH THE BRANCH TABLE                                Y02669
*           TRACK COMMANDS START WITH DTRTAB                     Y02669
***********************************************************************
DTAB     EQU   *
DLEN     EQU   *
         DC    AL1(L'DTIME-1)     LENGTH OF DISPLAY OPERAND       20030
DTIME    DC    C'T '              DISPLAY OPERAND                 20030
         DC    AL1(L'DREQ-1)            *                        Y02669
DREQ     DC    C'R '                    *                        Y02669
         DC    AL1(L'DREQA-1)           *                        Y02669
DREQA    DC    C'R,'                    *                        Y02669
         DC    AL1(L'DUNIT-1)           *                        Y02669
DUNIT    DC    C'U '                    *                        Y02669
         DC    AL1(L'DUNITA-1)          *                        Y02669
DUNITA   DC    C'U,'                    *                        Y02669
         DC    AL1(L'DMATRIX-1)         *                        Y02651
DMATRIX  DC    C'M '                    *                        Y02651
         DC    AL1(L'DMATRIXA-1)        *                        Y02651
DMATRIXA DC    C'M='                    *                        Y02651
         DC    AL1(L'DMATRIXB-1)        *                        Y02651
DMATRIXB DC    C'M,'                    *                        Y02651
         DC    AL1(L'DTP-1)             *                        Y02669
DTP      DC    C'TP,'                   *                        Y02669
         DC    AL1(L'DNET-1)            *                        Y02674
DNET     DC    C'NET,'                  *                        Y02674
         DC    AL1(L'DCK-1)             *                         21002
DCK      DC    C'C,K '                  *                         21002
         DC    AL1(L'DCKA-1)            *                         21002
DCKA     DC    C'C,K,'                  *                         21002
         DC    AL1(L'DCONSOLE-1)        *                         20030
DCONSOLE DC    C'CONSOLES '             *                         20030
         DC    AL1(L'DCONSOLA-1)        *                         21002
DCONSOLA DC    C'CONSOLES,'             *                         21002
         DC    AL1(L'DC-1)              *                        YM1916
DC       DC    C'C '                    *                        YM1916
         DC    AL1(L'DCA-1)             *                        YM1916
DCA      DC    C'C,'                    *                        YM1916
         DC    AL1(L'DPFK-1)            *                        Y02669
DPFK     DC    C'PFK '                  *                        Y02669
         DC    AL1(L'D3850-1)           *                      @Z40LPTA
D3850    DC    C'3850 '                 *                      @Z40LPTA
         DC    AL1(L'D3850C-1)          *                      @Z40LPTA
D3850C   DC    C'3850,'                 *                      @Z40LPTA
         DC    AL1(L'DDOMAIN-1)         *                      @Z40BPSV
DDOMAIN  DC    C'DMN '                  *                      @Z40BPSV
         DC    AL1(L'DDOMAINE-1)        *                      @Z40BPSV
DDOMAINE DC    C'DMN='                  *                      @Z40BPSV
         DC    AL1(L'DDOMAINC-1)        *                      @Z40BPSV
DDOMAINC DC    C'DMN,'                  *                      @Z40BPSV
         DC    AL1(L'DSLIP-1)           *                      @G17SPTJ
DSLIP    DC    C'SLIP '                 *                      @G17SPTJ
         DC    AL1(L'DSLIPA-1)          *                      @G17SPTJ
DSLIPA   DC    C'SLIP,'                 *                      @G17SPTJ
         DC    AL1(L'DSLIPA-1)          *                      @G17SPTJ
DSLIPB   DC    C'SLIP='                 *                      @G17SPTJ
         DC    AL1(L'DDUMP-1)           *                      @G33CPMR
DDUMP    DC    C'DUMP '                 *                      @G33CPMR
         DC    AL1(L'DDUMPA-1)          *                      @G33CPMR
DDUMPA   DC    C'DUMP,'                 *                      @G33CPMR
         DC    AL1(L'DD-1)              *                      @G33CPMR
DD       DC    C'D '                    *                      @G33CPMR
         DC    AL1(L'DDA-1)             *                      @G33CPMR
DDA      DC    C'D,'                    *                      @G33CPMR
         EJECT
DTRTAB   EQU   *                                                 Y02669
DTRLEN   EQU   *                                                 Y02669
         DC    AL1(L'DACTIVE-1)   LENGTH OF DISPLAY/TRACK OPERANDY02669
DACTIVE  DC    C'A '              DISPLAY/TRACK OPERAND          Y02669
         DC    AL1(L'DACTIVEA-1)        *                        Y02669
DACTIVEA DC    C'A,'                    *                        Y02669
         DC    AL1(L'DJ-1)              *                        Y02669
DJ       DC    C'J '                    *                        Y02669
         DC    AL1(L'DJA-1)             *                        Y02669
DJA      DC    C'J,'                    *                        Y02669
         DC    AL1(L'DJOBS-1)           *                        Y02669
DJOBS    DC    C'JOBS '                 *                        Y02669
         DC    AL1(L'DJOBSA-1)          *                        Y02669
DJOBSA   DC    C'JOBS,'                 *                        Y02669
         DC    AL1(L'DTS-1)             *                        Y02669
DTS      DC    C'TS '                   *                        Y02669
         DC    AL1(L'DTSA-1)            *                        Y02669
DTSA     DC    C'TS,'                   *                        Y02669
         DC    AL1(L'DSMS-1)            *                          *SKV
DSMS     DC    C'SMS '                  *                          *SKV
         DC    AL1(L'DSMSA-1)           *                          *SKV
DSMSA    DC    C'SMS,'                  *                          *SKV
         DC    AL1(L'DXCF-1)            *                          *SKV
DXCF     DC    C'XCF '                  *                          *SKV
         DC    AL1(L'DXCFA-1)           *                          *SKV
DXCFA    DC    C'XCF,'                  *                          *SKV
         DC    AL1(L'DIPLI-1)           *                          *SKV
DIPLI    DC    C'IPLINFO '              *                          *SKV
         DC    AL1(L'DSMF-1)            *                          *SKV
DSMF     DC    C'SMF '                  *                          *SKV
         DC    AL1(L'DSMFA-1)           *                          *SKV
DSMFA    DC    C'SMF,'                  *                          *SKV
         DC    AL1(L'DSMM-1)            *                          *SKV
DSMM     DC    C'SYMBOLS '              *                          *SKV
         DC    AL1(L'DAPF-1)            *                          *SKV
DAPF     DC    C'APF '                  *                          *SKV
DENTAB   EQU   *                                                   *SKV
         EJECT
IEEXSA   DSECT
         IEEXSA
XTM      EQU   XAT-D2                                            Y02669
XDATE    EQU   XAS                                               Y02669
         EJECT
         IHASUBIT
         EJECT
         CVT   DSECT=YES,LIST=YES
         IEESMCA
UCB      DSECT
         IEFUCBOB LIST=YES
         ILRASMVT DSECT=YES
         END
++ SRC(IEES503D) DISTLIB(AOSB3) SYSLIB(SAMPLIB) .
         TITLE 'IEES503D - DISPLAY - CONTINUATION'
***********************************************************************
*                                                                     *
*  MODULE NAME  =  IEES503D                                     Y02669*
*                                                                     *
*  DESCRIPTION  =  ROUTER FOR DISPLAY APF LIST, SMF OPTIONS,    Y02669*
*                  SMF DATASETS                                       *
*                                                                     *
*  AUTHOR       =  SCOTT VETTER                                 Y02669*
*                                                                     *
*  DATE WRITTEN =  30 APRIL 2011                                Y02669*
*                                                                     *
*  NOTE(S)      =  NEW MODULE                                   Y02669*
*                                                                     *
*  COPYRIGHT    =  N/A                                          Y02669*
*                                                                     *
*  STATUS       =  VS/2 - DUMPING IMPROVEMENTS                @G33CPMR*
*                                                                     *
*  FUNCTION     =  THIS MODULE PROCESSES THE DISPLAY COMMANDS   Y02669*
*                  FOR SMF AND APF.                             Y02669*
*                                                                     *
     EJECT
*                                                                     *
*   OPERATION   =  FOR D U; U,; THE VERB CODE IN XAN IS CHANGED Y02669*
*                  TO X'52', IEE3503D BRANCHES TO IEE7503D TO   Y02669*
*                  RESOLVE THE ROUTING OPERAND (L=CCA) OR       Y02669*
*                  DETERMINE THE DEFAULTS.                      Y02669*
*                                                                     *
*                  FOR D M; M,; M= THE VERB CODE IN XAN IS      Y02651*
*                  CHANGED TO X'32', IEE3503D BRANCHES TO       Y02651*
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND      Y02651*
*                  (L=CCA) OR DETERMINE THE DEFAULTS.           Y02651*
*                                                                     *
*                  FOR D TS; TS,; JOBS(J); JOBS,(J,); A; A,;    Y02669*
*                  A BIT IS SET IN XAX (XAXMASK), IEE3503D      Y02669*
*                  BRANCHES TO IEE7503D TO ESTABLISH ROUTING    Y02669*
*                  INFORMATION FROM THE L=CCA OPERAND OR        Y02669*
*                  DETERMINE THE APPROPIATE DEFAULTS            Y02669*
*                  AND CHECK FOR AND PROCESS THE 'LIST'(L)      Y02669*
*                  OPERAND. (SEE OUTPUT FOR BIT SETTINGS)       Y02669*
*                                                                     *
*                  FOR D C,K; C,K,; CONSOLES(C); CONSOLES,(C,); YM1916*
*                  THE VERB CODE IN XAN IS CHANGED TO X'2C'     Y02669*
*                  FOR C,K AND X'3E' FOR CONSOLES; IEE3503D     YM1916*
*                  BRANCHES TO IEE7503D TO RESOLVE THE ROUTING  Y02669*
*                  OPERAND (L=CCA) OR DETERMINE THE DEFAULTS.   Y02669*
*                                                                     *
*                  FOR D R; R,; THE VERB CODE IN XAN IS         Y02669*
*                  CHANGED TO X'42', IEE3503D BRANCHES TO       Y02669*
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND      Y02669*
*                  (L=CCA) OR DETERMINE THE DEFAULTS.           Y02669*
*                                                                     *
*                  FOR D PFK; THE VERB CODE IN XAN IS CHANGED   Y02669*
*                  TO X'36'AND XAS IS SET TO ZEROES, IEE3503D   Y02669*
*                  BRANCHES TO IEE0803D TO CREATE A CSCB.       Y02669*
*                                                                     *
*                  FOR D T; THE FOLLOWING MESSAGE IS WRITTEN    Y02669*
*                  TO THE OPERATOR VIA WTO OR TPUT:             Y02669*
*                    IEE136I    TIME=XX.XX.XX    DATE=XX.XXX    Y02669*
*                  CONTROL IS RETURNED.                         Y02669*
*                                                                     *
*                                                                     *
*                                                                     *
         EJECT
*                                                                     *
*                  FOR D SLIP, THE VERB CODE IN XAN IS        @G17SPTJ*
*                  CHANGED TO X'A8'.  IEE3503D BRANCHES TO    @G17SPTJ*
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND    @G17SPTJ*
*                  (L=CCA) OR TO DETERMINE THE DEFAULTS       @G17SPTJ*
*                                                                     *
*                  FOR D DUMP, THE VERB CODE IN XAN IS        @G33CPMR*
*                  CHANGED TO X'B0'.  IEE3503D BRANCHES TO    @G33CPMR*
*                  IEE7503D TO RESOLVE THE ROUTING OPERAND    @G33CPMR*
*                  (L=CCA) OR TO DETERMINE THE DEFAULTS       @G33CPMR*
*                                                                     *
*                  **** NOTE ****                             @G17SPTJ*
*                    FOR 'D DMN', 'D SLIP' AND 'D DUMP':      @G33CPMR*
*                  WHENEVER THE ABOVE-MENTIONED COMMANDS ARE  @G17SPTJ*
*                  ENTERED, THEY ARE CHECKED OUT FURTHER TO   @G17SPTJ*
*                  SEE IF THE SYSTEM SUPPORTS THE SU'S THAT   @G17SPTJ*
*                  ARE ASSOCIATED WITH THE COMMAND.           @G17SPTJ*
*                                                             @G17SPTJ*
*                  FOR TR TS; TS,; JOBS(J); JOBS,(J,); A; A,;   Y02669*
*                  A BIT IS SET IN XAX (XAXMASK), IEE3503D      Y02669*
*                  BRANCHES TO IEE7503D TO ESTABLISH ROUTING    Y02669*
*                  INFORMATION FROM THE L=CCA OPERAND OR        Y02669*
*                  DETERMINE THE APPROPIATE DEFAULTS AND        Y02669*
*                  CHECK FOR AND PROCESS THE 'LIST' (L)         Y02669*
*                  OPERAND.(SEE OUTPUT FOR BIT SETTINGS)        Y02669*
*                                                                     *
         EJECT
*                                                                     *
*  NOTES                                                        Y02669*
*                                                                     *
*  CHARACTER/                                                   Y02669*
*  CODE                                                         Y02669*
*  DEPENDENCIES =  ANY CHARACTER CODE OTHER THAN EBCDIC WILL    Y02669*
*                  REQUIRE REASSEMBLY OF THIS MODULE.           Y02669*
*                                                                     *
*  DEPENDENCIES =  IEE0403D TO RECOGNIZE THE DISPLAY AND        Y02669*
*                  TRACK COMMANDS AND PASS THE OPERAND          Y02669*
*                  INFORMATION IN THE XSA.                      Y02669*
*                                                                     *
*                  SVC 100 WILL REJECT AS INVALID D A AND       Y02669*
*                  THE TRACK COMMAND FROM ANY TIME SHARING      Y02669*
*                  TERMINAL INCLUDING THOSE IN OPERATOR MODE.   Y02669*
*                                                                     *
*                  ISTCFF3D WILL VALIDITY CHECK FOR NET,.       Y02674*
*                                                                     *
*                  MP WILL BE SUPPORTED AS A STANDARD           Y02651*
*                  AND D M (MATRIX) WILL BE INCLUDED.           Y02651*
*                                                                     *
*                  THE MSGRT COMMAND WILL PROVIDE SUPPORT FOR   Y02669*
*                  A ROUTING DEFAULT FOR D TS; JOBS; A; R;      Y02669*
*                  AND TR TS; JOBS; AND A.                      Y02669*
*                                                                     *
*                  JOBS AND J AND JOBS,LIST AND J,L WILL BE     Y02669*
*                  SUPPORTED. L CAN SUBSTITUTE FOR 'LIST'.      Y02669*
*                                                                     *
*                  A SU TABLE (IHASUBIT) REFLECTING THE SU'S  @G17SPTJ*
*                  INSTALLED ON THIS SYSTEM.                  @G17SPTJ*
*                                                                     *
*  RESTRICTIONS =  TIME SHARING TERMINALS INCLUDING THOSE IN    Y02669*
*                  OPERATOR MODE ARE NOT PERMITTED TO ISSUE D A.Y02669*
*                                                                     *
*                  THE 'L' OPERAND FROM A TIME SHARING USER     Y02669*
*                  ON D C,K; CONSOLES(C); JOBS; M; TS; R; U     YM1916*
*                  WILL BE DETECTED AS INVALID IN IEE7503D.     Y02669*
*                                                                     *
*                  NO TIME SHARING TERMINAL IS PERMITTED TO     Y02669*
*                  ISSUE THE TRACK COMMAND.                     Y02669*
*                                                                     *
*  REGISTER/                                                    Y02669*
*  CONVENTIONS  =  NONE                                         Y02669*
*                                                                     *
*  PATCH-LABEL  =  PATCH                                        Y02669*
*                                                                     *
* MODULE TYPE   =  CSECT                                        Y02669*
*                                                                     *
*  PROCESSOR    =  N/A                                          Y02669*
*                                                                     *
*  MODULE SIZE  =  X'3DD'                                     @G33CPMR*
*                                                                     *
*                                                                     *
*   ATTRIBUTES  =  REENTRANT, SUPERVISOR MODE, KEY ZERO,        Y02669*
*                  PAGED LPA                                    Y02669*
*                                                                     *
*  ENTRY POINT  =  IEE3503D FROM IEE0403D                       Y02669*
*  PURPOSE      =  TO ROUTE THE DISPLAY OR TRACK                Y02669*
*                  COMMAND TO THE PROPER PROCESSOR.             Y02669*
*  LINKAGE      =  BRANCH                                       Y02669*
*  INPUT DATA   =  REGISTER 2 POINTS TO XSA                     Y02669*
*                    XAL POINTS TO 1ST OPERAND IN BUFFER        Y02669*
*                    XAU IS 1-BYTE UCMI (X'00' COMMAND ISSUED   Y02669*
*                        INTERNALLY OR FROM THE INPUT STREAM)   Y02669*
*                    XAA CONTAINS THE ASID (X'0000' = NON-TS)   Y02669*
*                    XAN CONTAINS THE VERB CODE X'68' - DISPLAY Y02669*
*                                               X'C4' - TRACK   Y02669*
*                    XAR POINTS TO THE LENGTH FIELD AT THE      Y02669*
*                        BEGINNING OF THE COMMAND BUFFER        Y02669*
*                    XAV CONTAINS THE COMMAND VERB              Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                                                                     *
*   REGISTERS                                                   Y02669*
*    SAVED      =  NONE  (REGISTER 14 REMAINS UNTOUCHED)        Y02669*
*                                                                     *
*    CONTENTS DURING                                            Y02669*
*     PROCESSING=  R0   WORK REGISTER                           Y02669*
*                  R1   WORK REGISTER                           Y02669*
*                  R2   INPUT REGISTER - POINTER TO XSA         Y02669*
*                  R3   MODULE BASE REGISTER                    Y02669*
*                  R4   USED TO CONTAIN UCMI FOR WTO            Y02669*
*                  R5   PTR TO COMMAND BUFFER AND               Y02669*
*                       CONTAINS ASID FOR TPUT                  Y02669*
*                  R6   USED TO ADDRESS COMPARE TABLE ENTRIES   Y02669*
*                        AND THE SU BIT STRING                @G17SPTJ*
*                  R7   UNUSED                                  Y02669*
*                  R8   UNUSED                                  Y02669*
*                  R9   WORK REGISTER                           Y02669*
*                  R10  CONTAINS SU NUMBER                    @G17SPTJ*
*                  R11  ADDRESSES END OF COMPARE TABLE          Y02669*
*                  R12  UNUSED                                  Y02669*
*                  R13  UNUSED                                  Y02669*
*                  R14  RETURN ADDRESS                          Y02669*
*                  R15  USED FOR BAL, RC FROM TPUT, AND BR EXIT Y02669*
*                                                                     *
*    RESTORED    = NONE                                         Y02669*
*                                                                     *
      EJECT
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = RETURN VIA BR R14 FROM DDTIM                 Y02669*
*   CONDITIONS   = FOR D T                                      Y02669*
*   OUTPUT DATA  = IEE136I  TIME=XX.XX.XX   DATE=XX.XXX VIA WTO Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = RETURN VIA BR R14 FROM XTPUT                 Y02669*
*   CONDITIONS   = FOR D T                                      Y02669*
*   OUTPUT DATA  = IEE136I  TIME=XX.XX.XX  DATE=XX.XXX VIA TPUT Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = BRANCH TO IEE0803D FROM DDPFK                Y02669*
*   CONDITIONS   = TO CREATE A CSCB FOR D PFK                   Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAN NOW CONTAINS X'36'                     Y02669*
*                    XAS CLEARED (WILL CONTAIN ZEROES)          Y02669*
*                        CONTAINS VALID INPUT TO IEE0803D.      Y02669*
*                        FOR ALL OTHER DISPLAY FUNCTIONS        Y02669*
*                        THIS FIELD IS FILLED IN IN IEE7503D    Y02699*
*                    XAX CLEARED (WILL CONTAIN ZEROES)          Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = BRANCH TO IEE7503D FROM DD7503D              Y02669*
* 1 CONDITIONS   = TO VALIDITY CHECK:                           Y02669*
*                    L=CCA,LIST FOR  D A,  AND A                Y02669*
*                                      TS,  AND TS              Y02669*
*                                      JOBS, AND JOBS (J, & J)  Y02669*
*                                    TR A, AND A                Y02669*
*                                       TS, AND TS              Y02669*
*                                       JOBS, & JOBS (J, & J)   Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN STILL CONTAINS X'68' FOR DISPLAY       Y02669*
*                                       X'C4' FOR TRACK         Y02669*
*                    XAXMASK WILL CONTAIN AN INDICATOR          Y02669*
*                      SPECIFYING THE DESIRED DISPLAY OR        Y02669*
*                      TRACK FUNCTION:                          Y02669*
*                      X'80' FOR JOBS                           Y02669*
*                      X'08' FOR TS                             Y02669*
*                      X'88' FOR A                              Y02669*
*   RETURN CODES = NONE                                         Y02669*
* 2 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D U AND U,       Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN NOW CONTAINS X'52'                     Y02669*
*                    XAXMASK WILL CONTAIN ZEROES                Y02669*
*   RETURN CODES = NONE                                         Y02669*
* 3 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D C,K; C,K,;     Y02669*
*                    CONSOLES(C); AND CONSOLES,(C,)             YM1916*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN NOW CONTAINS X'2C' FOR C,K             Y02669*
*                                     X'3E' FOR CONSOLES(C)     YM1916*
*                    XAXMASK WILL CONTAIN ZEROES                Y02669*
*   RETURN CODES = NONE                                         Y02669*
* 4 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D M; M=; AND M,  Y02651*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02651*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN NOW CONTAINS X'32'                     Y02651*
*                    XAXMASK WILL CONTAIN ZEROES                Y02651*
*   RETURN CODES = NONE                                         Y02651*
* 5 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D R AND R,       Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1   Y02669*
*                    XAN NOW CONTAINS X'42'                     Y02651*
*                    XAXMASK WILL CONTAIN ZEROES                Y02651*
*   RETURN CODES = NONE                                         Y02669*
* 6 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D 3850 AND     @Z40LPTA*
*                    3850,                                    @Z40LPTA*
*   OUTPUT DATA  = R2 POINTS TO XSA                           @Z40LPTA*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @Z40LPTA*
*                    XAN NOW CONTAINS X'F3'                   @Z40LPTA*
*                    XAXMASK WILL CONTAIN ZEROES              @Z40LPTA*
*   RETURN CODES = NONE                                       @Z40LPTA*
* 7 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D DMN; DMN=;   @Z40BPSV*
*                    DMN,                                     @Z40BPSV*
*   OUTPUT DATA  = R2 POINTS TO XSA                           @Z40BPSV*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @Z40BPSV*
*                    XAN NOW CONTAINS X'88'                   @Z40BPSV*
*                    XAXMASK WILL CONTAIN ZEROES              @Z40BPSV*
*   RETURN CODES = NONE                                       @Z40BPSV*
* 8 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D SLIP; SLIP=; @G17SPTJ*
*                    SLIP,                                    @G17SPTJ*
*   OUTPUT DATA  = R2 POINTS TO XSA                           @G17SPTJ*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @G17SPTJ*
*                    XAN NOW CONTAINS X'A8'                   @G17SPTJ*
*                    XAXMASK WILL CONTAIN ZEROES              @G17SPTJ*
*   RETURN CODES = NONE                                       @Z40BPSV*
* 9 CONDITIONS   = TO VALIDITY CHECK L=CCA FOR D DUMP AND     @G33CPMR*
*                    D DUMP,                                  @G33CPMR*
*   OUTPUT DATA  = R2 POINTS TO XSA                           @G33CPMR*
*                    XAP CONTAINS ADDRESS OF END OF BUFFER +1 @G33CPMR*
*                    XAN NOW CONTAINS X'B0'                   @G33CPMR*
*                    XAXMASK WILL CONTAIN ZEROES              @G33CPMR*
*   RETURN CODES = NONE                                       @G33CPMR*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = BRANCH TO IED1303D FROM DDTP                 Y02669*
*   CONDITIONS   = FOR D TP,                                    Y02669*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - NORMAL = BRANCH TO ISTCFF3D FROM DDNET                Y02674*
*   CONDITIONS   = FOR D NET,                                   Y02674*
*   OUTPUT DATA  = R2 POINTS TO XSA                             Y02674*
*   RETURN CODES = NONE                                         Y02674*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - ERROR  = RETURN VIA BR R14 FROM XTPUT                 Y02669*
*   CONDITIONS   = FOR D T; TPUT FAILED DUE TO OUTSTANDING TPUT Y02669*
*   OUTPUT DATA  = NONE                                         Y02669*
*   RETURN CODES = REG 15 CONTAINS X'00000014'                  Y02669*
*                                                                     *
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*                                                                     *
** EXIT - ERROR  = BRANCH TO IEE0503D FROM D0503D               Y02669*
*   CONDITIONS   = TO ISSUE MESSAGE 'IEE305I COMMAND INVALID',  Y02669*
*                  IF AN INVALID DISPLAY OR TRACK OPERAND IS    Y02669*
*                  FOUND.                                       Y02669*
*                  TO ISSUE MESSAGE 'IEE026I COMMAND NOT      @G17SPTJ*
*                  SUPPORTED' WHEN SYSTEM DOES NOT SUPPORT    @G17SPTJ*
*                  THE SU REQUIRED BY THE COMMAND.            @G17SPTJ*
*                  TO ISSUE MESSAGE 'IEE311I PARAMETER MISSING',Y02669*
*                  IF NO OPERAND IS FOUND IN THE COMMAND BUFFER.Y02669*
*                  TO ISSUE MESSAGE 'IEE341I CLOCK NOT ACTIVE', Y02669*
*                  IF THE TIME MACRO RETURNS AN ERROR CODE      Y02669*
*                  FOR DISPLAY TIME (D T).                      Y02669*
*   OUTPUT DATA  = ERROR CODES FOR MESSAGES ISSUED IN IEE0503D  Y02669*
*                  IN XSA POINTED TO BY REG 2                   Y02669*
*                    XAE WILL CONTAIN  X'05' FOR IEE305I        Y02669*
*                                      X'0B' FOR IEE311I        Y02669*
*                                      X'24' FOR IEE341I        Y02669*
*                    XAV STILL CONTAINS THE COMMAND VERB        Y02669*
*                        OR THE WORD 'CLOCK' FOR IEE341I        Y02669*
*                    XAU STILL CONTAINS THE CONSOLE ID          Y02669*
*                    XAA STILL CONTAINS ASID IF REQUESTER       Y02669*
*                        IS TIME SHARING USER ELSE X'0000'.     Y02669*
*   RETURN CODES = NONE                                         Y02669*
*                                                                     *
      EJECT
*  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *  *
*  EXTERNAL                                                     Y02669*
*   REFERENCES                                                  Y02669*
*   ROUTINES     = BRANCHES TO   IEE0803D   IEE0503D            Y02669*
*                                IED1303D   IEE7503D            Y02669*
*                                ISTCFF3D                       Y02674*
*                                                                     *
*   DATA AREAS   = PSEUDO-SACB TO BE USED THROUGHOUT SVC 34     Y02669*
*                    ORG   XAX                                  Y02669*
*                  XAXMASK  DS    C       REQUEST FLAGS         Y02669*
*                  XAXJOBS  EQU   X'80'   JOBS      (J)         Y02669*
*                  XAXJOBSL EQU   X'40'   JOBS,LIST (J,L)       Y02669*
*                  XAXTS    EQU   X'08'   TS                    Y02669*
*                  XAXTSL   EQU   X'04'   TS,LIST   (TS,L)      Y02669*
*                  XAXA     EQU   X'88'   A                     Y02669*
*                  XAXAL    EQU   X'44'   A,LIST    (A,L)       Y02669*
*                  XAXFREE  DS    C       RESERVED              Y02669*
*                  XAXUTME  DS    H       UTME=NNN VALUE        Y02669*
*                  XAXSACB  DS    F       ADDRESS OF SACB       Y02669*
*                                                                     *
*   CONTROL                                                     Y02669*
*    BLOCKS      = IEEXSA     R - INPUT - COMMAND BUFFER ADDR   Y02669*
*                             W - OUTPUT - BITS SET             Y02669*
*                  IHASUBIT   R                               @G17SPTJ*
*                  CVT        R                               @G17SPTJ*
*                                                                     *
         EJECT
*    TABLES      = A COMPARE TABLE IS USED TO  DETERMINE THE    Y02669*
*                  VALIDITY OF THE OPERANDS ON THE DISPLAY AND  Y02669*
*                  TRACK COMMANDS.                              Y02669*
*                  THE FORMAT OF EACH ENTRY IS THE SAME.        Y02669*
*                                                                     *
*                  DLEN   DC   AL1(L'XXX-1) - LENGTH OF         Y02669*
*                                             SPECIFIC OPERAND  Y02669*
*                  XXX    DC   C'YYYYY' - CHARACTER OPERAND     Y02669*
*                                         REPRESENTATION        Y02669*
*                                                                     *
*                  DLEN AND 'XXX' ARE USED IN AN EX OF A CLC.   Y02669*
*                  IF THE OPERANDS MATCH, A BRANCH IS TAKEN TO  Y02669*
*                  THE CODE WHICH IN TURN BRANCHES TO THE       Y02669*
*                  PROPER PROCESSOR OR HANDLES THE COMMAND.     Y02669*
*                  OTHERWISE, THE REGISTER USED TO ADDRESS THE  Y02669*
*                  TABLE IS INCREMENTED BY TWO + THE VALUE OF   Y02669*
*                  DLEN TO REACH THE NEXT TABLE ENTRY.          Y02669*
*                  THE VALID TRACK OPERANDS ARE PLACED AT THE   Y02669*
*                  END OF THE COMPARE TABLE AND ADDRESSING OF   Y02669*
*                  THE TABLE IS ADJUSTED WHEN VALIDITY          Y02669*
*                  CHECKING THE TRACK COMMAND.                  Y02669*
*                                                                     *
*                  A BRANCH TABLE IS USED IN CONNECTION WITH    Y02669*
*                  THE COMPARE TABLE. IT CONSISTS OF BRANCHES   Y02669*
*                  TO THE PROPER OPERAND PROCESSORS. AN INDEX   Y02669*
*                  REGISTER IS MAINTAINED THROUGHOUT THE SCAN   Y02669*
*                  OF THE COMPARE TABLE. THIS IS USED AT        Y02669*
*                  DBRANCH TO GIVE CONTROL TO THE INDICATED     Y02669*
*                  PROCESSOR VIA THE BRANCH TABLE.              Y02669*
*                                                                     *
*   MACROS       = MODID                                        Y02669*
*                  TIME                                         Y02669*
*                  WTO                                          Y02669*
*                  TPUT                                         Y02669*
*                                                                     *
*   ENQUEUE                                                     Y02669*
*     RESOURCES  = NONE                                         Y02669*
*                                                                     *
*   LOCKS HELD   = NONE                                         Y02669*
*                                                                     *
*   CHANGE LEVEL = Y02669                                       Y02669*
*                  Y02674                                       Y02674*
*                  Y02651                                       Y02651*
*                  YM1916                                       YM1916*
*                  Z40LPTA                                    @Z40LPTA*
*                  Z40BPSV                                    @Z40BPSV*
*                  G17SPTJ                                    @G17SPTJ*
*                  G33CPMR                                    @G33CPMR*
*                                                                     *
         EJECT
*   MESSAGES     = THE FOLLOWING MESSAGE IS CONTAINED IN AND    Y02669*
*                  ISSUED FROM THIS MODULE:                     Y02669*
*                                                                     *
*                   IEE136I  TIME=HH.MM.SS  DATE=YY.DDD         Y02669*
*                                                                     *
*                  THE FOLLOWING MESSAGES ARE CONTAINED IN      Y02669*
*                  AND ISSUED FROM IEE0503D:                    Y02669*
*                                                                     *
*                    MSGID    CODE    MESSAGE TEXT              Y02669*
*                    _____    ____    ____________              Y02669*
*                   IEE026I   X'1A'   NOT SUPPORTED           @G17SPTJ*
*                   IEE305I   X'05'   COMMAND INVALID           Y02669*
*                   IEE311I   X'11'   PARAMETER MISSING         Y02669*
*                   IEE341I   X'24'   'CLOCK' NOT ACTIVE        Y02669*
*                                                                     *
*   SYSGEN       = INCLUDED WITH SVC 34 IN LOAD MODULE          Y02669*
*                  IGC0003D, SYSGEN MACRO SGIEF441,             Y02669*
*                  DLIB ASOB3, TARGLIB LPALIB.                  Y02669*
*                                                                     *
*   SYSTEM                                                      Y02669*
*    LIBRARIES   = NONE                                         Y02669*
*                                                              TSV0010*
*   CHANGE LOG:                                                TSV0010*
*      AS OF 11/09/2005 THIS MODULE HAS NO PTFS AGAINST IT     TSV0010*
*         AS PER SMP.                                          TSV0010*
*      11/19/2005  SKV  CHANGE TO CHANGE THE DISPLAY DATE TO   TSV0010*
*                       REFLECT THE 21ST CENTURY AFTER LABEL   TSV0010*
*                       DDTIME.                                TSV0010*
*      11/01/2007  SKV  CHANGE TO INCLUDE RESPONSE TO A        TSV0010*
*                       DISPLAY IPLINFO. DISPLAY XCF, AND      TSV0010*
*                       DISPLAY SYMBOLS.                       TSV0010*
*      01/01/2012  SKV  CHANGE TO INCLUDE RESPONSE TO A        TSV0010*
*                       DISPLAY APF.                           TSV0010*
*                                                              TS00000*
***********************************************************************
         EJECT
IEES503D CSECT
***********************************************************************
*                                                                     *
*                         REGISTER    EQUATES                         *
*                                                                     *
***********************************************************************
R0       EQU   0                  WORK REGISTER
R1       EQU   1                  WORK REGISTER
R2       EQU   2                  INPUT - BASE REG FOR XSA
R3       EQU   3                  MODULE BASE REGISTER
R4       EQU   4                  USED FOR UCMI                  Y02669
R5       EQU   5                  PTR TO OPERAND BUFFER AND ASID Y02669
R6       EQU   6                  USED TO ADDRESS TABLE ENTRIES
*                                  AND THE SU BIT STRING       @G17SPTJ
R7       EQU   7    (UNUSED)      UNUSED                         Y02669
R8       EQU   8    (UNUSED)      UNUSED                         Y02669
R9       EQU   9                  WORK REGISTER
R10      EQU   10                 SU NUMBER STORAGE AREA       @G17SPTJ
R11      EQU   11                 ADDRESSES END OF TABLE
R12      EQU   12   (UNUSED)      UNUSED                         Y02669
R13      EQU   13   (UNUSED)      UNUSED                         Y02669
R14      EQU   14                 RETURN ADDRESS
R15      EQU   15                 USED FOR BAL AND BRANCH EXIT
         SPACE
***********************************************************************
*                                                                     *
*                      DISPLACEMENTS AND LENGTHS                      *
*                                                                     *
***********************************************************************
D0       EQU   0                  DISPLACEMENTS
D1       EQU   1
D2       EQU   2
D3       EQU   3
D4       EQU   4
D5       EQU   5
D6       EQU   6
D7       EQU   7
L0       EQU   0                  LENGTHS                        Y02669
L1       EQU   1
L2       EQU   2
L3       EQU   3
L4       EQU   4
L8       EQU   8
         EJECT
***********************************************************************
*                                                                     *
*                           ENTRY / EXIT CODE                         *
*                                                                     *
***********************************************************************
         EJECT
         SPACE 3
         USING *,R15
         B     AROUNDID
         DC    CL8'IEES503D'
         DC    CL1'-'
         DC    CL8'&SYSDATE'
         DC    CL1'-'
         DC    CL8'&SYSTIME'
         DC    CL1'-'
         DC    CL8'V1.R1.M0'
         DC    CL1'-'
AROUNDID DS    0H
         DROP  R15
         STM   R14,R12,12(R13)      SAVE CALLERS REGISTERS
         BALR  R3,0                 COPY BASE REGISTER
         USING *,R3
         LR    R10,R0               SAVE PARM
         LR    R11,R1               SAVE REG1
         LR    R9,R13               SAVE REG13 CALLER'S SAP
         GETMAIN RU,LV=2048         GET WORKING STORAGE
         LR    R13,R1               SET SAP AND BASE FOR W.S.
         USING SA,R13               MAP THE WORKING STORAGE AREA
         ST    R9,SAVEAREA+4        SAVE CALLERS SAP
         USING IEEXSA,R2            MAP THE WORKING STORAGE AREA
         SPACE 3
         MVC   WTOAREA(SWTO1X),SWTO1
         MVC   WTOAREA+24(5),=C'* S *'
         LA    R1,WTOAREA
         WTO   MF=(E,(1))
         C     R10,=F'0001'          IS THIS A CALL TO DISPL SMF OPTNS?
         BE    DDSMFO                YES - WELL, GO DO IT
         C     R10,=F'0002'          IS THIS A CALL TO DISPL SMF DSNS?
         BE    DDSMFD                YES - WELL, GO DO IT
         C     R10,=F'0003'          IS THIS A CALL TO DISPL APF?
         BE    DDAPF                 YES - WELL, GO DO IT
*        ABEND 001,DUMP             IF NOTHING ELSE - TERMINATE
         SPACE 3
EXITRTN  DS    0H
         MVC   WTOAREA(SWTO1X),SWTO1
         MVC   WTOAREA+24(5),=C'X E X'
         LA    R1,WTOAREA
         WTO   MF=(E,(R1))
         SPACE 3
         L     R9,SAVEAREA+4        RELOAD CALLERS SAP
         FREEMAIN RU,LV=2048,A=(R13) FREE GOTTEN STORAGE
         LR    R13,R9               RESTORE CALLERS SAP
         LM    R14,R12,12(R13)      RELOAD CALLERS REGISTERS
         BR    R14                  RETURN TO CALLER
SWTO1    WTO   'SKV BEFORE BRANCH                           ',MF=L
SWTO1X   EQU   *-SWTO1
         EJECT
********************************************************************SKV
*                                                                   SKV
*                      DISPLAY APF                                  SKV
*                                                                   SKV
********************************************************************SKV
DDAPF    DS    0H                                                   SKV
* *********************************************************************
*
*    DO INITILIZATION
*       SAVE THE REGISTERS
*       GET STORAGE FOR WTO MESSAGE
*       GET THE POINTER TO THE TABLE FROM THE CVT,
*       GET THE NUMBER OF ENTRIES,
*       AND MOVE THE HEADING TO GOTTEN STORAGE AREA.
*
* *********************************************************************
         SPACE 3
         STM   R0,R15,SA2           SAVE REGISTERS
         SPACE 1
         GETMAIN RU,LV=2048         GET STRG FOR MESSAGE AREA
         ST    R1,STRGAREA          AND SAVE THE POINTER TO IT
         LR    R10,R1               COPY MSG AREA POINTER
         SPACE 3
         L     R1,CVTPTR            POINT TO THE CVT
         USING CVT,R1                AND MAP IT
         L     R4,CVTAUTHL          POINT TO THE START OF THE APF TABLE
         DROP  R1                   DROP CVT MAPPING
         SR    R5,R5
         LH    R5,0(R4)             GET COUNT OF NUMBER OF ENTRIES
         LA    R4,2(R4)             POINT PAST NMBR OF ENTRIES FEILD
         MVC   0(59,R10),WTOMSG     MOVE INITIAL WTO MSG HEADER TO STRG
         LA    R10,8(R10)           ADJUST POSITION
         SR    R8,R8                CLEAR LINE COUNTER
         SPACE 3
* *********************************************************************
*
*    PROCESS EACH ENTRY
*       CLEAR THE OUTPUT LINE,
*       GET ENTRY LENGTH
*       WRITE OUT THE VOLSER
*       WRITE OUT THE VARIABLE LENGTH DSNAME,
*       ADJUST TO GET THE NEXT ENTRY,
*       WRITE THE RESULTS,
*       AND DO OVER AGIN IF NEED BE.
*
* *********************************************************************
         SPACE 3
LISTNTRY DS    0H
         LA    R8,1(R8)             ADD 1 TO LINE COUNTER
         LA    R10,52(R10)          POINT TO NEXT AREA
         MVC   0(52,R10),WTOMSG+60  MOVE SUBSEQUENT WTO MSG TO STRG
         SR    R6,R6                CLEAR ENTRY LENGTH REG
         ICM   R6,X'0001',0(R4)     ST ENTRY LENGTH IN REG
         LR    R7,R6                SAVE LENGTH
         MVC   15(6,R10),1(R4)      MOVE VOLSER TO BUFFER
         S     R6,=F'6'             SUBTRACT VOLSER LENGTH
         S     R6,=F'1'             SUBTRACT 1 FOR EX INSTRUCTION
         C     R6,=F'28'            IS THE DSNAME LENGTH > 28?
         BNH   APFLENT1              NO - CONTINUE
         L     R6,=F'28'             YES - SET DSNAME MAX LEN TO 28
APFLENT1 DS    0H
         EX    R6,MOVEDSN1          MOVE DATASET NAME IN WTO STRG BUFR
         SPACE 3
         AR    R4,R7                POINT PAST DSNAME
         LA    R4,1(R4)             ADD 1 TO ACCOUNT FOR LENGTH FIELD
         SPACE 3
         C     R8,=F'39'            DID WE REACH THE MAX FOR WTO?
         BH    APFMAXM               YES - SET MORE MESSAGE AND END
         SPACE 3
         BCT   R5,LISTNTRY          GO PROCESS THE ENTRY
         B     TERM                 BYPASS THE OVERFLOW MESSAGE
         SPACE 3
* *********************************************************************
*
*   END OF LIST ROUTINE - SET WTO MSG WITH # LINES, SET THE LAST LINE,
*                         ISSUE THE WTO, AND EXIT.
*
* *********************************************************************
         SPACE 1
APFMAXM  DS    0H
         MVC   15(10,R10),=C'          '
         MVC   25(06,R10),=C'(MORE)'
         MVC   31(26,R10),=C'                       '
         SPACE 3
* *********************************************************************
*
*   END OF LIST ROUTINE - SET WTO MSG WITH # LINES, SET THE LAST LINE,
*                         ISSUE THE WTO, AND EXIT.
*
* *********************************************************************
         SPACE 1
TERM     DS    0H
         SPACE 1
         LR    R9,R10               SAVE NEXT RECORD POINTER
         MVI   2(R9),X'30'          SET LAST LINE IN WTO MSG
         L     R10,STRGAREA         GET WTO MESSAGE STRG AREA
         LA    R8,1(R8)             ADD 1 IN LINE COUNT TO INCL HEADER
         STC   R8,59(R10)           SET NUMBER OF LINES IN WTO MSG AREA
         LA    R11,1000(R10)         AND SET THE END
         LR    R0,R4                  PUT UCMI INTO REG 0
         SR    R4,R4
         IC    R4,XAU
         LH    R5,XAA
         LR    R0,R4                  PUT UCMI INTO REG 0
         L     R10,STRGAREA         GET WTO MESSAGE STRG AREA
         WTO   MF=(E,(R10))         ISSUE WTO
*
         FREEMAIN RU,LV=2048,A=(R10)
         SPACE 1
         LM    R0,R15,SA2           RESTORE REGISTERS
         SPACE 1
         B     EXITRTN              GO EXIT THIS ROUTINE
         SPACE 3
*  EXECUTE COMMANDS FOR APF ROUTINE
         SPACE 3
MOVEDSN1 MVC   23(0,R10),7(R4)      MOVE DSNAME TO BUFFER
         SPACE 3
*  WTO MSG  FOR APF ROUTINE
         SPACE 3
WTOMSG   WTO   ('SKVAPF01I CURRENT APF ENTRIES                   ',C), X
               ('           VOLSER  DSNAME                       ',D), X
               ('                                                ',DE),X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L
WTOMSGL  EQU   *
         SPACE 3
         EJECT
********************************************************************SKV
*                                                                   SKV
*                      DISPLAY SMF OPTIONS                          SKV
*                                                                   SKV
********************************************************************SKV
DDSMFO   DS    0H                                                   SKV
         STM   R0,R15,SA2           SAVE REGISTERS
         SPACE 3
         GETMAIN RU,LV=2048
         LR    R7,R1
         ST    R7,STRGAREA          AND SAVE THE POINTER TO IT
*        AGO   .SKVLAB
         MVC   469(2,R7),=2XL1'00'
         MVC   0(DSMRMSKX,R7),DSMRMSKD      MOVE BASE MSG TO W.S.
*        MVC   21(8,R7),XAV
*        MVC   35(8,R7),XAL
*        MVC   70(8,R7),XAR
         MVC   83(20,R7),0(R5)
         MVC   79(2,R7),3(R5)
         LA    R6,79(R7)
         MVI   78(R7),C'*'
         MVI   81(R7),C'*'
         LR    R0,R4                  PUT UCMI INTO REG 0
         SR    R4,R4
**       IC    R4,XAU
**       LH    R5,XAA
         WTO   MF=(E,(R7))          WRITE TO OPERATOR - SMF INFO
         SPACE 3
         L     R12,CVTPTR           POINT TO THE CVT
         USING CVTMAP,R12           MAP THE CVT
         CLC   CVTSMCA(4),=F'0'
         BE    BYPNS
         MVC   469(2,R7),0(R7)      SET FIELD FOR OPERANDS IF ANY
         CLC   0(2,R6),=C',D'       ASKING FOR DATASET INFORMATION?
         BE    DDSMFD                YES, GO DISPLAY IT
         B     BYPX                  NO, GO DISPLAY OPTIONS
BYPNS    DS    0H
         MVC   0(DSMRMSX1,R7),DSMRMSE1
         LR    R0,R4                PUT UCMI INTO REG 0
         SR    R4,R4
**       IC    R4,XAU
**       LH    R5,XAA
         WTO   MF=(E,(R7))          WTO - SMF NOT RUNNING
         B     DDSMFX               GO EXIT PROGRAM
BYPX     DS    0H
         L     R6,CVTSMCA           POINT TO THE SMF'S SMCA
         USING SMCABASE,R6          MAP THE SMCA
         CLC   SMCASMCA(L'SMCASMCA),=C'SMCA'  VALID STORAGE AREA?
         BE    BYPZ                            YES - CONTINUE
         MVC   0(DSMRMSX2,R7),DSMRMSE2
         LR    R0,R4                  PUT UCMI INTO REG 0
         SR    R4,R4
         IC    R4,XAU
**       LH    R5,XAA
**       LR    R0,R4                  PUT UCMI INTO REG 0
         WTO   MF=(E,(R7))            WTO - SMF'S SMCA AREA HEADER BAD
         B     DDSMFX               GO EXIT PROGRAM
         DROP  R12
         SPACE 3
BYPZ     DS    0H
         SR    R0,R0
         LR    R8,R7                  POINT TO RECEIVING FIELD
         LH    R9,=H'424'             SET LENGTH FOR MESSAGE
         LA    R14,DSMRMSGD           POINT TO SENDING FIELD
         LH    R15,=H'424'            SET FILL CHAR
         MVCL  R8,R14                 MOVE MESSAGE TO BUFFER
         MVC   WTOML1P3(L'SMCASID,R7),SMCASID  SET SID
*        B     BYPD          *TEMP
         TM    SMCAOPT,SMCAOPT1       JOB ACCOUNTING?
         BNO   BYP0                    NO - SKIP
         MVC   WTOML2P1(3,R7),=C'JOB'  YES - SET IT
         MVC   WTOML7P1(1,R7),=C'1'    YES - SET IT
*        B     BYP0                   GO CONTINUE
BYP0     DS    0H
         TM    SMCAOPT,SMCAOPT2       STEP ACCOUNTING?
         BNO   BYP1                    NO - SKIP
         MVC   WTOML2P2(4,R7),=C'STEP' YES - SET IT
         MVC   WTOML7P1(1,R7),=C'2'    YES - SET IT
         B     BYP1                   GO CONTINUE
BYP1     DS    0H
         SPACE 3
BYP2     DS    0H
         TM    SMCAOPT,SMCADSA        DATASET ACCOUNTING?
         BNO   BYP3                    NO - SKIP
         MVC   WTOML3P1(2,R7),=C'DS'   YES - SET IT
         MVC   WTOML7P3(1,R7),=C'2'    YES - SET IT
         B     BYP3                   GO CONTINUE
BYP3     DS    0H
         TM    SMCAOPT,SMCAVOL        STEP ACCOUNTING?
         BNO   BYP4                    NO - SKIP
         MVC   WTOML3P2(3,R7),=C'VOL'  YES - SET IT
         MVC   WTOML7P3(1,R7),=C'1'    YES - SET IT
         B     BYP4                   GO CONTINUE
BYP4     DS    0H
         TM    SMCAOPT,SMCADSA+SMCAVOL DATASET AND VOLUME ACCOUNTING?
         BNO   BYP5                    NO - SKIP
         MVC   WTOML7P3(1,R7),=C'3'    YES - SET IT
         B     BYP5                   GO CONTINUE
BYP5     DS    0H
         SPACE 3
         TM    SMCAOPT,SMCAEXT        EXITS TAKEN?
         BNO   BYP6                    NO - SKIP
         MVC   WTOML4P1(3,R7),=C'YES'  YES - SET IT
         MVC   WTOML7P2(3,R7),=C'YES'  SET EXT=
         B     BYP6                   GO CONTINUE
BYP6     DS    0H
         SPACE 3
         MVC   WTOML7P5(4,R7),=C'NONE' SET NO RECORDING BEING DONE MAN=
         MVC   WTOML1P2(5,R7),=C'INACT'  SAA - SET SMF
         MVC   WTOML1P1(5,R7),=C'INACT'  SAA - SET RECORDING
         MVC   WTOML6P2(6,R7),=C'INACT '  SAA - SET ACTIVE D.S.
         MVC   WTOML6P5(6,R7),=C'INACT '  SAA - SET ACTIVE D.S.
         TM    SMCAMISC,SMCAUSER+SMCAMAN ALL RECORDING REQUESTED?
         BNO   BYP8                    NO - SKIP
         MVC   WTOML1P1(6,R7),=C'ACTIVE'  SET SMF ACTIVE
         MVC   WTOML6P2(6,R7),=C'ACTIVE'  SET ACTIVE D.S.
         MVC   WTOML6P5(6,R7),=C'INACT '  SET ACTIVE D.S.
         MVC   WTOML7P5(4,R7),=C'ALL '       YES - SET IT
         MVC   WTOML1P2(6,R7),=C'ACTIVE'   YES - SET IT
         B     BYPE                   GO CONTINUE
BYP8     DS    0H
         TM    SMCAMISC,SMCAMAN       USER RECORDING REQUESTED?
         BNO   BYPE                    NO - SKIP
         MVC   WTOML1P1(6,R7),=C'ACTIVE'     SET SMF ACTIVE
         MVC   WTOML6P2(6,R7),=C'ACTIVE'     SET ACTIVE D.S.
         MVC   WTOML6P5(6,R7),=C'INACT ' SET ACTIVE D.S.
         MVC   WTOML7P5(4,R7),=C'USER'       YES - SET IT
         MVC   WTOML1P2(6,R7),=C'ACTIVE'     YES - SET IT
         B     BYPE                   GO CONTINUE
BYPE     DS    0H
         TM    SMCASWA,SMCADSTR       ERROR RECORDING?
         BNO   BYP9                    NO - SKIP
         MVC   WTOML1P2(6,R7),=C'(FULL)'  YES - SET IT
         MVC   WTOML6P2(6,R7),=C'*FULL '  SAA - SET ACTIVE D.S.
         MVC   WTOML6P5(6,R7),=C'*FULL '  SAA - SET ACTIVE D.S.
         B     BYP9                   GO CONTINUE
BYP9     DS    0H
         SPACE 3
         MVC   WTOML7P6(3,R7),=C'NO '    OPERATOR NOT ALLOWED TO CHANGE
         TM    SMCAMISC,SMCAOPI       OPERATOR ALLOWED TO CHANGE?
         BNO   BYPA                    NO - SKIP
         MVC   WTOML7P6(3,R7),=C'YES'  YES - SET OPI=
         B     BYPA                   GO CONTINUE
BYPA     DS    0H
         SPACE 3
         MVC   WTOML6P1(1,R7),SMCAXORY   SET ACTIVE DATASET
         MVC   WTOML6P3(6,R7),SMCAPDEV   SET ACTIVE VOLSER
         MVC   WTOML6P4(1,R7),SMCAYORX   SET INACTIVE DATASET
         MVC   WTOML6P6(6,R7),SMCAADEV   SET INACTIVE VOLSER
         SPACE 3
         L     R1,SMCABSIZ              GET BUFFER SIZE
         CVD   R1,480(R7)               CONVERT SIZE TO PACKED FORM
         UNPK  WTOML5P2(8,R7),480(R7)   CONVERT TO READABLE AND DISPLAY
         OI    WTOML5P2+7(R7),X'F0'     CONVERT TO READABLE AND DISPLAY
         SPACE 3
         SR    R14,R14
         L     R15,SMCAJWT            GET JOB WAIT TIME
         M     R14,MSHIFT             CONVERT FROM
         D     R14,MICROSEC              MICROSECONDS TIMER UNITS
         CVD   R14,480(R7)            CONVERT TO READABLE SUB-MINUTES
         CVD   R15,490(R7)            CONVERT TO READABLE SUB-MINUTES
         CLC   480+4(4),LTH      ARE WE TO ROUND UP?
         BL    BYPB                    NO - GO CONTINUE
         AP    490+4(4),PONE     ROUND UP BY ONE MINUTE
BYPB     DS    0H
         MVC   500(R7),EMASK
         ED    500(R7),490+6(R7)
         MVC   WTOML5P1(4,R7),500(R7)
BYPC     DS    0H
         MVC   WTOML7P4(1,R7),=C'0'      SET DEFAULT REC=
         TM    SMCAMISC,SMCATDS       TEMP DS?
         BNO   BYPD                    NO - SKIP
         MVC   WTOML3P3(4,R7),=C'TEMP' YES - SET IT
         MVC   WTOML7P4(1,R7),=C'2'          SET REC=
*        B     BYPD                   GO CONTINUE
BYPD     DS    0H
         SPACE 3
         LR    R0,R4                  PUT UCMI INTO REG 0
         SR    R4,R4
         IC    R4,XAU
**       LH    R5,XAA
**       LR    R0,R4                  PUT UCMI INTO REG 0
         WTO   MF=(E,(R7))            WRITE TO OPERATOR - SMF INFO
S1       LA    R1,DWSMFOX
         WTO   MF=(E,(R1))
S2       LA    R1,DWSMFOX
         WTO   MF=(E,(R1))
         SPACE 3
.SKVLAB  ANOP
*        TM    SMCASWA,SMCADSTR       ERROR RECORDING?
*        BNO   BYPF                    NO - SKIP
*        WTO   '*** SMF DATASETS FULL!   RECORDING HALTED.            '
*        WTO   '*** 0,000,000,000 RECORDS LOST.                       '
BYPF     DS    0H
         FREEMAIN RU,LV=2048,A=(R7)
         LM    R0,R15,SA2           RESTORE REGISTERS
         LA    R1,DWSMFOY
*        MVC   19(2,R1),3(R5)
         LR    R0,R4                  PUT UCMI INTO REG 0
         SR    R4,R4
**       IC    R4,XAU
**       LH    R5,XAA
         LR    R0,R4                  PUT UCMI INTO REG 0
         WTO   MF=(E,(R1))
         LA    R1,DWSMFOY
         WTO   MF=(E,(R1))
         LA    R1,DWSMFOY
         WTO   MF=(E,(R1))
         CLC   3(2,R5),=C',A'       ASKING FOR OPTIONS & DATASET INFO?
         BE    DDSMFD                YES - GO DISPLAY DETAIL OF SMF DS
         LA    R1,DWSMFO2
         WTO   MF=(E,(R1))
         LA    R1,DWSMFO2
         WTO   MF=(E,(R1))
         B     EXITRTN              GO EXIT THIS ROUTINE
DWSMFOX  WTO   'SKVD001I  SMF X                      ',MF=L,           X
               DESC=(5),MCSFLAG=(REG0,RESP)
DWSMFOXL EQU   *-DWSMFOX
DWSMFOY  WTO   'SKVD001I  SMF Y                      ',MF=L,           X
               DESC=(5),MCSFLAG=(REG0,RESP)
DWSMFOYL EQU   *-DWSMFOY
DWSMFO2  WTO   'SKVD001I  SMF 1                      ',MF=L,           X
               DESC=(5),MCSFLAG=(REG0,RESP)
DWSMFO2L EQU   *-DWSMFO2
         EJECT
********************************************************************SKV
*                                                                   SKV
*                      DISPLAY SMF DATASETS                         SKV
*                                                                   SKV
********************************************************************SKV
DWSMFD1  WTO   'SKVD001I  SMF DATASETS STARTED       ',MF=L,           X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DWSMFD1L EQU   *-DWSMFD1                                           *SKV
DDSMFD   DS    0H
         STM   R0,R15,SA2           SAVE REGISTERS
*        LA    R1,DWSMFD1
*        WTO   MF=(E,(1))
*        LA    R1,DWSMFO1
*        WTO   MF=(E,(1))
         SPACE 3
         GETMAIN RU,LV=2048
         LR    R7,R1
         L     R12,CVTPTR           POINT TO THE CVT
         USING CVTMAP,R12           MAP THE CVT
         L     R6,CVTSMCA           POINT TO THE SMF'S SMCA
         USING SMCABASE,R6          MAP THE SMCA
         MVC   0(DSMDMSGL,R7),DSMDMSGD
         LR    R0,R4                  PUT UCMI INTO REG 0
         SR    R4,R4
         IC    R4,XAU
         LH    R5,XAA
         LR    R0,R4                  PUT UCMI INTO REG 0
         MVC   115+009(1,R7),SMCAXORY     SET ACTIVE DATASET
         MVC   115+012(6,R7),SMCAPDEV     SET ACTIVE VOLSER
         MVC   115+019(5,R7),=C' YES '    SET AS IN USE
         TM    SMCAPSTA,SMCAPMTY          IS DATASET READY TO BE USED?
         BNO   BYPSD1
         MVC   115+018(6,R7),=C' AVAIL'   SET AS AVAILABLE
BYPSD1   DS    0H
         TM    SMCAPSTA,SMCAPNAV          IS DATASET NOT AVAILABLE?
         BNO   BYPSD2
         MVC   115+021(6,R7),=C'NOT AVA'  SET AS NOT AVAILABLE
BYPSD2   DS    0H
         MVC   165+011(1,R7),SMCAYORX     SET INACTIVE DATASET
         MVC   165+014(6,R7),SMCAADEV     SET INACTIVE VOLSER
         MVC   165+021(5,R7),=C' YES '    SET AS IN USE
         TM    SMCASTA,SMCAPMTY           IS DATASET READY TO BE USED?
         BNO   BYPSD3
         MVC   165+021(6,R7),=C' AVAIL'   SET AS AVAILABLE
BYPSD3   DS    0H
         TM    SMCASTA,SMCAPNAV           IS DATASET NOT AVAILABLE?
         BNO   BYPSD4
         MVC   165+021(6,R7),=C'NOT AVA'  SET AS NOT AVAILABLE
BYPSD4   DS    0H
         TM    SMCASWA,SMCADSTR         DISASTER BIT SET?
         BNO   BYPSD5                    NO - BYPASS
         MVC   115+018(6,R7),=C'* FULL'    SET DS AS FULL
         MVC   165+021(6,R7),=C'* FULL'    SET DS AS FULL
BYPSD5   DS    0H
         WTO   MF=(E,(R7))            WRITE TO OPERATOR - SMF DS INFO
BYPY     DS    0H
DDSMFX   DS    0H
         FREEMAIN RU,LV=2048,A=(R7)
         LM    R0,R15,SA2           RESTORE REGISTERS
         B     EXITRTN                GO EXIT THIS ROUTINE
         DROP  R12                    GO CONTINUE
         DROP  R6
         SPACE 3
         EJECT
***********************************************************************
*                                                                     *
*                         CONSTANTS                              Y02669
*                                                                     *
***********************************************************************
         SPACE   5
FOUR     DC    H'4'               USED IN SH INSTRUCTION         Y02669
SIXFOUR  DC    F'00000064'        COMPARAND OF 64              @G17SPTJ
ERRCODE  DC    X'0014'            TPUT RETURN CODE - MSG DID NOT  20030
*                                 GO DUE TO AN OUTSTANDING TPUT   20030
DDBLNK   DC    C'        '        USED FOR PADDING
CLOCKERR DC    C'CLOCK   '        USED FOR D T ERROR MESSAGE     Y02669
         SPACE 3
MSGLNEA  WTO   ('SVAPF01I DATASETS IN THE APFLIST                ',C), X
               ('                                                ',D), X
               ('                                                ',DE),X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
MSGLNEH  DS    0C
         DC    C'SVAP001 DATASETS IN THE APFLIST'
MSGLNEHL EQU   *-MSGLNEH
         SPACE 3
MSGLNE1  DS    0C
         DS    CL1
MSGLNE1V DS    CL6
         DS    CL1
MSGLNE1D DS    CL44
MSGLNE1L EQU   *-MSGLNE1
         SPACE 3
DAPFNMSG WTO   'IXC361I   D APF - NOT QUITE AVAILABLE',MF=L,           X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DAPFNLN  EQU   *-DAPFNMSG                                          *SKV
         SPACE
         SPACE
DGSYMMSG WTO   'IEA007I  STATIC SYSTEM SYMBOL VALUES - N/A',MF=L,      X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DGSYMLN  EQU   *-DGSYMMSG                                          *SKV
         SPACE
DSMRMSE1 WTO   'SKV0002E: SMCA ADDRESS NOT SET.',                      X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
DSMRMSX1 EQU   *-DSMRMSE1
DSMRMSE2 WTO   'SKV0003E: SMCA AREA BAD.',                             X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
DSMRMSX2 EQU   *-DSMRMSE2
DGSM1MSG WTO   'IEE967I   SMF PARAMETERS',MF=L,                        X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DGSM1LN  EQU   *-DGSM1MSG                                          *SKV
DGSM2MSG WTO   '   NO INFORMATION AT THIS TIME.',MF=L,                 X
               DESC=(5),MCSFLAG=(REG0,RESP)                        *SKV
DGSM2LN  EQU   *-DGSM2MSG                                          *SKV
         SPACE
DSMRMSKD WTO   ('SKV0001I SMF XAL:12345678  XAV:12345678         ',C), X
               ('  XAR:12345678  R5:12345678                     ',D), X
               ('                                                ',DE),X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
DSMRMSKX EQU   *-DSMRMSKD
DSMRMSGD WTO   ('SKV0001I SMF PARAMETER DETAIL                   ',C), X
               ('SMF: -----   RECORDING: -----   SID: ----       ',D), X
               ('ACCOUNTING: --- ----                            ',D), X
               ('DATASETS: -- ---                                ',D), X
               ('EXITS: ---                                      ',D), X
               ('JWT: ---   BUF: ----                            ',D), X
               ('MAN-X ACTIVE (123456)   MAN-: INACT (123456)    ',D), X
               ('OPT=-  EXT=NO   DSV=0  REC=-  MAN=----  OPI=--- ',DE),X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
DSMRMSGX EQU   *-DSMRMSGD
WTOML1P1 EQU   064+005
WTOML1P2 EQU   064+024
WTOML1P3 EQU   064+037
WTOML2P1 EQU   116+012
WTOML2P2 EQU   116+016
WTOML3P1 EQU   168+010
WTOML3P2 EQU   168+013
WTOML3P3 EQU   168+025
WTOML4P1 EQU   220+007
WTOML5P1 EQU   272+005
WTOML5P2 EQU   272+016
WTOML6P1 EQU   324+004 MAN_
WTOML6P2 EQU   324+006 ACTIVE/INACT/*FULL*
WTOML6P3 EQU   324+014 VOLSER
WTOML6P4 EQU   324+028 MAN_
WTOML6P5 EQU   324+030 ACTIVE/INACT/*FULL*
WTOML6P6 EQU   324+037 VOLSER
WTOML7P1 EQU   376+004
WTOML7P2 EQU   376+011
WTOML7P3 EQU   376+020
WTOML7P4 EQU   376+027
WTOML7P5 EQU   376+034
WTOML7P6 EQU   376+044
         SPACE   5
DSMDMSGD WTO   ('SKV0001I SMF DATASET USAGE DETAIL               ',C), X
               (' DSNAME    VOLSER IN-USE ALLOC  USED   %FULL    ',D), X
               ('SYS1.MAN-  111111         ---    ---    ----    ',D), X
               ('SYS1.MAN+  222222         ---    ---    ----    ',DE),X
               DESC=(5),MCSFLAG=(REG0,RESP),MF=L                   *SKV
DSMDMSGL EQU   *-DSMDMSGD
         SPACE   5
PONE     DC    PL4'1'
DBLWORD  DC    D'0'
         DC    C'ABCD'
DBLWRDP0 DC    D'0'
DBLWRDP1 DC    D'0'
         DC    C'EFGH'
OFLD     DC    C'----'
EMASK    DC    X'40202020'
MICROSEC DC    F'60000000'
MSHIFT   DC    F'1048576'
LTH      DC    F'50000000'
DECVALUE DC    H'0'
         SPACE   5
         EJECT
IEEXSA   DSECT
         IEEXSA
XTM      EQU   XAT-D2                                            Y02669
XDATE    EQU   XAS                                               Y02669
         EJECT
         IHASUBIT
SA       DSECT
SAVEAREA DS    18F
SA2      DS    18F                  ROUTINE'S REGISTER SAVE AREAS
STRGAREA DS    F                    GOTTEN STORAGE FOR GETMAINS
DBLAREA1 DS    D
DBLAREA2 DS    D
WTOAREA  DS    0C
         DS    CL255
         DS    CL255
         DS    CL255
         DS    CL255
         EJECT
         CVT   DSECT=YES,LIST=YES
         IEESMCA
UCB      DSECT
         IEFUCBOB LIST=YES
         ILRASMVT DSECT=YES
         END
++JCLIN.
//TSV0010 JOB 'IEES503D',CLASS=A
//ASMSTEP EXEC  ASMS,OBJ=AOSB3,MOD=IEES503D,CLASS='*'
//SYSIN    DD  DSN=SYS1.SAMPLIB(IEES503D),DISP=SHR
//*LNKSTEP EXEC  LINKS,PARM='LIST,LET,NCAL,XREF,RENT,REUS',
//*        UNIT=3350,SER=MVSRES,N=SYS1,
//*        NAME=LPALIB,P1=' ',MOD=,P2=' ',
//*        OBJ=AOSB3,CLASS='*'
//*SYSLIN    DD  *
//*   INCLUDE SYSPUNCH(IEES503D)
//*   NAME IEES503D(R)
//SG12 EXEC LINKS,
// PARM='NCAL,LIST,XREF,LET,RENT',
//    UNIT='3350',SER=MVSRES,N=SYS1,NAME=LPALIB,P1=' ',
//    MOD=,P2=' ',OBJ=OBJPDS01,CLASS=A
//AOSB3 DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=SYS1.AOSB3
//AOS00 DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=SYS1.AOS00
//AOS21 DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=SYS1.AOS21
//AOSC5 DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=SYS1.AOSC5
//AOSCE DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=SYS1.AOSCE
//AOST4 DD DISP=SHR,VOLUME=(,RETAIN),DSNAME=SYS1.AOST4
//SYSLIN DD *
 INCLUDE AOSB3(IEE0003D)
 INCLUDE AOSB3(IEE0303D)
 INCLUDE AOSB3(IEE5403D)
 INCLUDE AOSB3(IEE0403D)
 INCLUDE AOSB3(IEE0503D)
 INCLUDE AOSB3(IEE0603D)
 INCLUDE AOSC5(IEE6503D)
 INCLUDE AOSC5(IEE6603D)
 INCLUDE AOSB3(IEE7703D)
 INCLUDE AOSB3(IEE7803D)
 INCLUDE AOSB3(IEE6903D)
 INCLUDE AOSB3(IEE6303D)
 INCLUDE AOSB3(IEE6403D)
 INCLUDE AOSB3(IEE3203D)
 INCLUDE AOSB3(IEE4703D)
 INCLUDE AOSB3(IEE4303D)
 INCLUDE AOS21(IED1303D)
 INCLUDE AOSB3(IEE5103D)
 INCLUDE AOSB3(IEE5503D)
 INCLUDE AOSB3(IEE7503D)
 INCLUDE AOSB3(IEE6703D)
 INCLUDE AOSB3(IEE6803D)
 INCLUDE AOSB3(IEE8B03D)
 INCLUDE AOSB3(IEE5903D)
 INCLUDE AOSB3(IEE5603D)
 INCLUDE AOSB3(IEE0703D)
 INCLUDE AOSB3(IEE1403D)
 INCLUDE AOSB3(IEE4103D)
 INCLUDE AOSB3(IEE7203D)
 INCLUDE AOSB3(IEE5703D)
 INCLUDE AOSB3(IEE0803D)
 INCLUDE AOSB3(IEE3503D)
 INCLUDE AOSB3(IEE1603D)
 INCLUDE AOSB3(IEE9403D)
 INCLUDE AOSC5(IEAVEMRQ)
 INCLUDE AOSC5(IEAVVRP1)
 INCLUDE AOSCE(IGF2503D)
 INCLUDE AOSCE(IGF2603D)
 INCLUDE AOSB3(IEE7103D)
 INCLUDE AOSB3(IEE3703D)
 INCLUDE AOST4(IKJ5803D)
 INCLUDE AOSB3(IEE2903D)
 INCLUDE AOSC5(IEEMB815)
 INCLUDE AOSC5(IEE8603D)
 INCLUDE AOSB3(ISTCFF3D)
 INCLUDE AOSCE(IGFDE0)
 INCLUDE AOSCE(IGFDE1)
 INCLUDE AOSCE(IGFDV1)
 INCLUDE AOSB3(IEES503D)
 ORDER IEE0003D
 ORDER IEE0303D
 ORDER IEE5403D
 ORDER IEE0403D
 ORDER IEE7503D
 ORDER IEE5603D
 ORDER IEE5903D
 ORDER IEE6703D
 ORDER IEE7703D
 ORDER IEE6803D
 ORDER IEE6903D
 ORDER IEE6303D
 ORDER IEE6403D
 ORDER IEES503D
 ALIAS IGG2103D,IGC0503D,IEE2103D,IEE0503D
 ALIAS IEE7603D
 ENTRY IEE0003D
 NAME IGC0003D(R)
$$
/*
//SMPCNTL  DD  *
  RECEIVE S(TSV0010) .
/*
//APPLCHK EXEC SMP,
//            RVOL=MVSRES
//SMPCNTL  DD  *
  APPLY S(TSV0010)
        ASSEM
        CHECK
        BYPASS(ID) .
/*
//APPL    EXEC SMP,
//            RVOL=MVSRES
//SMPCNTL  DD  *
  APPLY S(TSV0010)
        ASSEM .
/*
