/* REXX  */
/* THIS PROGRAM IS NOT FULLY COMMENTED */
/* A COMMENTS SHOULD BE VERY LIKELY AS IN CONSOLV PROGRAM   */

/* READ THE SSID FROM INPDD1 - JUST 1 ROW */
"EXECIO 1 DISKR INPDD1"
PARSE PULL COMMAND
"EXECIO 0 DISKR INPDD1 (FINIS"
SAY '******' COMMAND
"EXECIO 1 DISKR INPDD2"
PARSE PULL AUTHID
"EXECIO 0 DISKR INPDD2 (FINIS"

/* FORM THE DB2 COMMAND */
IF AUTHID = 'NONE' THEN
   COMMAND = "-"STRIP(COMMAND) "DIS THD(DISC*)"
ELSE
   COMMAND = "-"STRIP(COMMAND) "DIS THD(SERV*)"

IF AUTHID = 'SVI' THEN
   COMMAND = "-"STRIP(COMMAND) "DIS THD(*)"

SAY COMMAND

ADDRESS TSO
 "CONSOLE ACTIVATE NAME(SYSCONEX)"
 "CONSPROF SOLDISPLAY(NO) SOLNUM(800)"
 "CONSPROF UNSOLDISPLAY(NO) SOLNUM(400)"
 "CONSPROF"
 CART = 'APPL0001'
 INTERPRET "'CONSOLE SYSCMD('COMMAND') CART('"CART"')'"
 MESSAGE = 'F'
 MSG_STEM.0 = 0
 DO WHILE MESSAGE = 'F'
    INTERPRET 'MSG =' "GETMSG(''MSG_STEM.'',''SOL'','"CART"',,1)"
    INTERPRET 'MSG =' "GETMSG(''MSG_STEM.'',''SOL'','"CART"',,1)"
    SAY 'MSG' MSG
    IF MSG = 0  THEN
       LEAVE
    ELSE
    DO
       IF MSG = 4 THEN
          LEAVE
       ELSE
          ITERATE
    END
 END

 SAY 'IZVEDENA KOMANDA:' COMMAND
 SAY '-----------------------------------------------------'
 DO I = 1 TO MSG_STEM.0
    SAY MSG_STEM.I
 END
 SAY ' '
 "CONSOLE DEACTIVATE"
 "CONSPROF SOLDISPLAY(YES)"
 "CONSPROF UNSOLDISPLAY(YES)"

SAY MSG
