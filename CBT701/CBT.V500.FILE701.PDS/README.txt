DOC FOR REXX EXECS CALLED BY BATCH JOBS


       AUTHOR:   MARINO DRAZETA

       CALL:     MARINO DRAZETA
                 FINA COMPANY
                 PUT REPUBLIKE 24A
                 DUBROVNIK 20000
                 CROATIA
                 (+385 20 431311)


THE DATASET CONTRIBUTED CONTAINS 3 ARTICLES WHICH COULD BE USEFULL
FOR A DB2/SYSTEM ADMIN. THE CONCEPT IS THE SAME FOR ALL 3. BATCH JOB
CALLS SOME REXX EXECS IN ORDER TO FULLFILL WANTED TASKS. THE JOBS AND
EXECS ARE COMMENTED INSIDE THE CODE.


1. ARTICLE - DROP/CREATE FOREIGN KEYS DDL STATEMENTS CREATION
-------------------------------------------------------------

   THIS ARTICLE ENABLES TO CREATE DATASETS WITH DROP/CREATION DDL
   STATEMENTS FOR THE SSID AND SCHEMA SPECIFIED.
   THE STATEMENTS CREATED COULD BE EXECUTED THROUGH USUAL ENVIRONMENTS
   (IE. SPUFI)

MEMBERS REQUIRED:

   # DB2FKDC  - JCL

      YOU HAVE TO ADJUST JOBLIB DD DSN ACCORDING YOUR INSTALATION
      //JOBLIB   DD  DSN=SYS1.P61.DSN610.SDSNEXIT,DISP=SHR
      //         DD  DSN=P61.DSN610.SDSNLOAD,DISP=SHR

   # DRCRFKY1 - REXX PRG. CALLED BY THE JCL ABOVE

STEP S01

   JUST TO AVIOD DUPLICATE DATASET NAME CREATION

STEP S02

   SPECIFY AN ARBITRARY DSN WHERE YOU WANT TO KEEP DROP/CREAT STATEMENTS
   IE. //OUTDD1   DD DSN=DB2MADR.CBT.CONTRIB(DROPFK),DISP=SHR
   IE. //OUTDD2   DD DSN=DB2MADR.CBT.CONTRIB(CREFK),DISP=SHR
   DB2MADR.CBT.CONTRIB(DROPFK)   WILL CONTAIN DROP DDL STATEMENTS
   DB2MADR.CBT.CONTRIB(CREFK)    WILL CONTAIN CREATE DDL STATEMENTS
   ABOVE MEMBERS ARE INCLUDED IN THE CONTRIBUTION DATASET.

   SPECIFY AN SSID, SCHEMA, (OPTIONALY TABLES) FOR SYSTSIN
   IE .//SYSTSIN  DD *
       TB0          -> SSID
       RAZV         -> SCHEMA
       GRESKA       -> TABLENAME (OPTIONALY)
       VR_PRIHODA   -> TABLENAME (OPTIONALY)
       ETC.

   IF TABLE NAMES ARE SPECIFIED (AS IN THE EXAMPLE ABOVE) THE OUTPUT
   WILL INCLUDE DROP/CREAT STATEMENTS FOR JUST THAT TABLES.
   OTHERWISE, THE OUTPUT WILL INCLUDE DROP/CREAT STATEMENTS FOR
   ALL TABLES IN THE SPECIFIED SCHEMA, INCLUDING RELATIONS TOWARD
   A TABLES IN SOME OTHER SCHEMA (PARENT TABLES OUTSIDE SCH. SPECIFIED).


2. ARTICLE - USING BATCH JOB FOR A SYSTEM COMMANDS EXECUTION
-------------------------------------------------------------

   THIS ARTICLE ENABLES TO EXECUTE A SYSTEM COMMANDS USING BATCH JOB.
   THE JOB OUTPUT CONTAINS THE STATEMENTS AND A SYSTEM RESPONSE.

MEMBERS REQUIRED:

   # CONSBATC - JCL

      YOU HAVE TO ADJUST JOBLIB DD DSN ACCORDING YOUR INSTALATION
      //JOBLIB   DD  DSN=SYS1.P61.DSN610.SDSNEXIT,DISP=SHR
      //         DD  DSN=P61.DSN610.SDSNLOAD,DISP=SHR

   # CONSCOMM - REXX PRG. CALLED BY THE JCL ABOVE

   # CONSOLV  - REXX PRG. CALLED BY THE JCL ABOVE


PREPARATION REQUIRED:

   IN ORDER TO EXECUTE THIS JOB EMCS CONSOLE NAMED SYSCONEX SHOULD BE
   GRANTED BY MSTR AUTHORITY (CONSOLE NAME(SYSCONEX) AUTH(MASTER)).


STEP S01

   BELOW SYSTSIN SPECIFY SYSTEM COMMANDS YOU WANT TO EXECUTE.
   EXAMPLES ARE SHOWN IN CONSBATC AND CONSBAT1 MEMBERS.

STEP S02

   THIS STEP EXECUTES IKJEFT01 WHICH CALLS CONSOLV REXX PROGRAM.
   PURPOSE OF THE PROGRAM IS TO ESTABLISH EMCS CONSOLE SESSION. THEN
   USING GETMSG FUNCTION TO PROVIDE  A SYSTEM RESPONSE.


3. ARTICLE - USING BATCH JOB FOR DB2 DRDA THREADS TERMINATION
-------------------------------------------------------------

   THIS ARTICLE PROVIDES, ACCORDING THE AUTHID KEYWORD SELECTIVELY
   OR ALL, DB2 DRDA THREADS TERMINATION. IT HASN'T IMPACT TO THE
   CICS, IMS OR BATCH THREADS. MAY BE USEFULL IN THE QUICK DB OR DDF
   SHUTDOWN SITUATION. PROGRAM EXECUTION IS PERFORMED THROUGH MVS
   CONSOLE ENVIRONMENT, SO THE MAX_LINES RESTRICTION REMAINS. WHEN A
   HUGE NUMBER OF DRDA CONNECTION IS PRESENTED ITERATIVE JOB EXECUTION
   COULD BE REQUIRED.

MEMBERS REQUIRED:

   # SYCANTHD - JCL

      YOU HAVE TO ADJUST JOBLIB DD DSN ACCORDING YOUR INSTALATION
      //JOBLIB   DD  DSN=SYS1.P61.DSN610.SDSNEXIT,DISP=SHR
      //         DD  DSN=P61.DSN610.SDSNLOAD,DISP=SHR

   # SYCANCOM - REXX PRG. CALLED BY THE JCL ABOVE

   # CONSOLV3 - REXX PRG. CALLED BY THE JCL ABOVE

   # CONSOLV4 - REXX PRG. CALLED BY THE JCL ABOVE

PREPARATION REQUIRED:

   IN ORDER TO EXECUTE THIS JOB EMCS CONSOLE NAMED SYSCONEX SHOULD BE
   GRANTED BY MSTR AUTHORITY.

STEP S01

HERE YOU HAVE TO PUT SSID (SUBSYSTEM IDENTIFIER) AND AUTHID (AUTHORIZ.
IDENTIFIER). IN THE EXAMPLE BELOW ALL DB2 DRDA THREADS FOR SSID: PB3 AND
WITH AUTHID: GOTDB SHOULD BE CANCELED.

     //SYSTSIN  DD *
       PB3
       GOTDB

IF YOU FOR AUTHID PUT THE KEYWORD "SVI" ALL DB2 DRDA THREADS FOR
SSID: PB3 SHOULD BE CANCELED.

     //SYSTSIN  DD *
       PB3
       SVI

STEP S02

   THIS STEP EXECUTES IKJEFT01 WHICH CALLS CONSOL3 REXX PROGRAM.
   PURPOSE OF THE PROGRAM IS TO ESTABLISH EMCS CONSOLE SESSION. THEN
   USING GETMSG FUNCTION TO PROVIDE A SYSTEM RESPONSE ON COMMAND:
   -SSID DIS THD(*)

STEP S03

   THIS STEP EXECUTES IKJEFT01 WHICH CALLS CONSOL4 REXX PROGRAM.
   PURPOSE OF THE PROGRAM IS TO ESTABLISH EMCS CONSOLE SESSION. THEN,
   AFTER SELECTION ACCORDING THE AUTHID WHICH WAS PUT IN STEP 01,
   USING SYSCMD FUNCTION TO EXECUTE COMMAND: -SSID CANCEL THD(TOKEN) ,
   AND USING GETMSG FUNCTION PROVIDE A SYSTEM RESPONSE ON THE COMMAND.
