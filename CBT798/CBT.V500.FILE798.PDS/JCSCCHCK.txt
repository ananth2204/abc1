      *================================================================*KDS08257
      * KKKKKKKKKKKKK   DDDDDDDD    SSSSSSSS                           *KDS08257
      * KKKKKKKKKKKKK  DDDDDDDDD   SSSSSSSSS                           *KDS08257
      *      KKKK      DDDD        SSSS                                *KDS08257
      *      KKKK      DDDD        SSSS                                *KDS08257
      *      KKKK      DDDD        SSSS          1111          0000000 *KDS08257
      *      KKKK      DDDDDDDD    SSSSSSSS      1111        0000000000*KDS08257
      *      KKKK        DDDDDDD    SSSSSSSS     1111        0000  0000*KDS08257
      *      KKKK           DDDD        SSSS    1111         0000  0000*KDS08257
      *      KKKK           DDDD        SSSS    1111        0000  0000 *KDS08257
      *      KKKK           DDDD        SSSS    1111        0000  0000 *KDS08257
      * KKK  KKKK           DDDD        SSSS   1111   0000  0000  0000 *KDS08257
      * KKKKKKKK      DDDDDDDDDD   SSSSSSSSS   1111  0000  0000000000  *KDS08257
      * KKKKKKKK      DDDDDDDDD    SSSSSSSS    1111 0000    000000000  *KDS08257
      *================================================================*KDS08257
      *                                                                 KDS08257
      ******************************************************************KDS08257
      * Created   By :Kang Dengsong                                    *KDS08257
      * Created Date :SEP 13, 2008                                     *KDS08257
      * REMARK       :Copy book(For check batch cycle)                 *KDS08257
      *              :Job scheduler system                             *KDS08257
      ******************************************************************KDS08257
           MOVE SPACE                             TO WS-RUN             KDS08257
           MOVE SPACE                             TO WS-RUN2            KDS08257
           MOVE SPACE                             TO WS-RESP            KDS08257
           EVALUATE TRUE                                                KDS08257
              WHEN JCBMAST-EXEC1-DAILY                                  KDS08257
                   PERFORM D110-CHECK-DAILY                             KDS08257
              WHEN JCBMAST-EXEC1-MONTH                                  KDS08257
                   MOVE JCBMAST-EXEC-FREQ1-SUFFIX TO WS-SUFFIX          KDS08257
                   PERFORM D120-CHECK-MONTH                             KDS08257
              WHEN JCBMAST-EXEC1-WEEK                                   KDS08257
                   MOVE JCBMAST-EXEC-FREQ1-SUFFIX TO WS-SUFFIX          KDS08257
                   PERFORM D130-CHECK-WEEK                              KDS08257
              WHEN JCBMAST-EXEC1-LOGON                                  KDS08257
                   PERFORM D140-CHECK-LOGON                             KDS08257
              WHEN JCBMAST-EXEC1-ONCE                                   KDS08257
                   PERFORM D150-CHECK-ONCE                              KDS08257
              WHEN JCBMAST-EXEC1-MONTH-ST                               KDS08257
                   PERFORM D160-CHECK-MONTH-ST                          KDS08257
              WHEN JCBMAST-EXEC1-MONTH-ED                               KDS08257
                   PERFORM D170-CHECK-MONTH-ED                          KDS08257
              WHEN JCBMAST-EXEC1-WEEK-END                               KDS08257
                   PERFORM D180-CHECK-WEEK-END                          KDS08257
              WHEN JCBMAST-EXEC1-QTR-END                                KDS08257
                   PERFORM D190-CHECK-QTR-END                           KDS08257
              WHEN JCBMAST-EXEC1-YAR-END                                KDS08257
                   PERFORM D1A0-CHECK-YAR-END                           KDS08257
              WHEN JCBMAST-EXEC1-ANY                                    KDS08257
                   PERFORM D1B0-CHECK-ANY                               KDS08257
           END-EVALUATE                                                 KDS08257
           EVALUATE TRUE                                                KDS08257
              WHEN JCBMAST-EXEC2-DAILY                                  KDS08257
                   PERFORM D110-CHECK-DAILY                             KDS08257
              WHEN JCBMAST-EXEC2-MONTH                                  KDS08257
                   MOVE JCBMAST-EXEC-FREQ2-SUFFIX TO WS-SUFFIX          KDS08257
                   PERFORM D120-CHECK-MONTH                             KDS08257
              WHEN JCBMAST-EXEC2-WEEK                                   KDS08257
                   MOVE JCBMAST-EXEC-FREQ2-SUFFIX TO WS-SUFFIX          KDS08257
                   PERFORM D130-CHECK-WEEK                              KDS08257
              WHEN JCBMAST-EXEC2-LOGON                                  KDS08257
                   PERFORM D140-CHECK-LOGON                             KDS08257
              WHEN JCBMAST-EXEC2-ONCE                                   KDS08257
                   PERFORM D150-CHECK-ONCE                              KDS08257
              WHEN JCBMAST-EXEC2-MONTH-ST                               KDS08257
                   PERFORM D160-CHECK-MONTH-ST                          KDS08257
              WHEN JCBMAST-EXEC2-MONTH-ED                               KDS08257
                   PERFORM D170-CHECK-MONTH-ED                          KDS08257
              WHEN JCBMAST-EXEC2-WEEK-END                               KDS08257
                   PERFORM D180-CHECK-WEEK-END                          KDS08257
              WHEN JCBMAST-EXEC2-QTR-END                                KDS08257
                   PERFORM D190-CHECK-QTR-END                           KDS08257
              WHEN JCBMAST-EXEC2-YAR-END                                KDS08257
                   PERFORM D1A0-CHECK-YAR-END                           KDS08257
              WHEN JCBMAST-EXEC2-ANY                                    KDS08257
                   PERFORM D1B0-CHECK-ANY                               KDS08257
           END-EVALUATE                                                 KDS08257
           EVALUATE TRUE                                                KDS08257
              WHEN JCBMAST-EXEC3-DAILY                                  KDS08257
                   PERFORM D110-CHECK-DAILY                             KDS08257
              WHEN JCBMAST-EXEC3-MONTH                                  KDS08257
                   MOVE JCBMAST-EXEC-FREQ3-SUFFIX TO WS-SUFFIX          KDS08257
                   PERFORM D120-CHECK-MONTH                             KDS08257
              WHEN JCBMAST-EXEC3-WEEK                                   KDS08257
                   MOVE JCBMAST-EXEC-FREQ3-SUFFIX TO WS-SUFFIX          KDS08257
                   PERFORM D130-CHECK-WEEK                              KDS08257
              WHEN JCBMAST-EXEC3-LOGON                                  KDS08257
                   PERFORM D140-CHECK-LOGON                             KDS08257
              WHEN JCBMAST-EXEC3-ONCE                                   KDS08257
                   PERFORM D150-CHECK-ONCE                              KDS08257
              WHEN JCBMAST-EXEC3-MONTH-ST                               KDS08257
                   PERFORM D160-CHECK-MONTH-ST                          KDS08257
              WHEN JCBMAST-EXEC3-MONTH-ED                               KDS08257
                   PERFORM D170-CHECK-MONTH-ED                          KDS08257
              WHEN JCBMAST-EXEC3-WEEK-END                               KDS08257
                   PERFORM D180-CHECK-WEEK-END                          KDS08257
              WHEN JCBMAST-EXEC3-QTR-END                                KDS08257
                   PERFORM D190-CHECK-QTR-END                           KDS08257
              WHEN JCBMAST-EXEC3-YAR-END                                KDS08257
                   PERFORM D1A0-CHECK-YAR-END                           KDS08257
              WHEN JCBMAST-EXEC3-ANY                                    KDS08257
                   PERFORM D1B0-CHECK-ANY                               KDS08257
           END-EVALUATE                                                 KDS08257
           COMPUTE WS-J = 1                                             KDS08257
           PERFORM UNTIL WS-J > 3                                       KDS08257
              EVALUATE TRUE                                             KDS08257
                 WHEN JCBMAST-DEPEND-RELATE(WS-J) = EQ                  KDS08257
                   IF JCBMAST-DEPEND-TYPE(WS-J)  = N                    KDS08257
                      IF JCBMAST-DEPEND-VALUE0-9(WS-J)  =               KDS08257
                                       JCBMAST-DEPEND-VALUE1-9(WS-J)    KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   ELSE                                                 KDS08257
                      IF JCBMAST-DEPEND-VALUE0(WS-J)=                   KDS08257
                         JCBMAST-DEPEND-VALUE1(WS-J)                    KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   END-IF                                               KDS08257
                 WHEN JCBMAST-DEPEND-RELATE(WS-J)  = GT                 KDS08257
                   IF JCBMAST-DEPEND-TYPE(WS-J)   = N                   KDS08257
                      IF JCBMAST-DEPEND-VALUE0-9(WS-J)    >             KDS08257
                                        JCBMAST-DEPEND-VALUE1-9(WS-J)   KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   ELSE                                                 KDS08257
                      IF JCBMAST-DEPEND-VALUE0(WS-J) >                  KDS08257
                         JCBMAST-DEPEND-VALUE1(WS-J)                    KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   END-IF                                               KDS08257
                 WHEN JCBMAST-DEPEND-RELATE(WS-J) = GE                  KDS08257
                   IF JCBMAST-DEPEND-TYPE(WS-J) = N                     KDS08257
                      IF JCBMAST-DEPEND-VALUE0-9(WS-J) >=               KDS08257
                         JCBMAST-DEPEND-VALUE1-9(WS-J)                  KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   ELSE                                                 KDS08257
                      IF JCBMAST-DEPEND-VALUE0(WS-J) >=                 KDS08257
                         JCBMAST-DEPEND-VALUE1(WS-J)                    KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   END-IF                                               KDS08257
                 WHEN JCBMAST-DEPEND-RELATE(WS-J)  = NE                 KDS08257
                   IF JCBMAST-DEPEND-TYPE(WS-J) = N                     KDS08257
                      IF JCBMAST-DEPEND-VALUE0-9(WS-J)   NOT =          KDS08257
                         JCBMAST-DEPEND-VALUE1-9(WS-J)                  KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   ELSE                                                 KDS08257
                      IF JCBMAST-DEPEND-VALUE0(WS-J) NOT =              KDS08257
                            JCBMAST-DEPEND-VALUE1(WS-J)                 KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   END-IF                                               KDS08257
                 WHEN JCBMAST-DEPEND-RELATE(WS-J) = LE                  KDS08257
                   IF JCBMAST-DEPEND-TYPE(WS-J)  = N                    KDS08257
                      IF JCBMAST-DEPEND-VALUE0-9(WS-J)  <=              KDS08257
                         JCBMAST-DEPEND-VALUE1-9(WS-J)                  KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   ELSE                                                 KDS08257
                      IF JCBMAST-DEPEND-VALUE0(WS-J) <=                 KDS08257
                            JCBMAST-DEPEND-VALUE1(WS-J)                 KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   END-IF                                               KDS08257
                 WHEN JCBMAST-DEPEND-RELATE(WS-J) = LT                  KDS08257
                   IF JCBMAST-DEPEND-TYPE(WS-J)  = N                    KDS08257
                      IF JCBMAST-DEPEND-VALUE0-9(WS-J) <                KDS08257
                         JCBMAST-DEPEND-VALUE1-9(WS-J)                  KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   ELSE                                                 KDS08257
                      IF JCBMAST-DEPEND-VALUE0(WS-J)    <               KDS08257
                         JCBMAST-DEPEND-VALUE1(WS-J)                    KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   END-IF                                               KDS08257
                 WHEN JCBMAST-DEPEND-RELATE(WS-J)  = BI                 KDS08257
                   IF JCBMAST-DEPEND-TYPE(WS-J)  = N                    KDS08257
                      IF JCBMAST-DEPEND-VALUE0-9(WS-J)  >=              KDS08257
                         JCBMAST-DEPEND-VALUE1-9(WS-J) AND              KDS08257
                         JCBMAST-DEPEND-VALUE0-9(WS-J) <=               KDS08257
                         JCBMAST-DEPEND-VALUE2-9(WS-J)                  KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   ELSE                                                 KDS08257
                      IF JCBMAST-DEPEND-VALUE0(WS-J) >=                 KDS08257
                            JCBMAST-DEPEND-VALUE1(WS-J)  AND            KDS08257
                         JCBMAST-DEPEND-VALUE0(WS-J)  <=                KDS08257
                         JCBMAST-DEPEND-VALUE2(WS-J)                    KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   END-IF                                               KDS08257
                 WHEN JCBMAST-DEPEND-RELATE(WS-J)  = XB                 KDS08257
                   IF JCBMAST-DEPEND-TYPE(WS-J)  = N                    KDS08257
                      IF JCBMAST-DEPEND-VALUE0-9(WS-J) <                KDS08257
                         JCBMAST-DEPEND-VALUE1-9(WS-J) OR               KDS08257
                         JCBMAST-DEPEND-VALUE0-9(WS-J)  >               KDS08257
                         JCBMAST-DEPEND-VALUE2-9(WS-J)                  KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   ELSE                                                 KDS08257
                      IF JCBMAST-DEPEND-VALUE0(WS-J)   <                KDS08257
                         JCBMAST-DEPEND-VALUE1(WS-J)  AND               KDS08257
                         JCBMAST-DEPEND-VALUE0(WS-J)  >                 KDS08257
                         JCBMAST-DEPEND-VALUE2(WS-J)                    KDS08257
                      THEN                                              KDS08257
                         MOVE WS-YES    TO WS-RUN2                      KDS08257
                      END-IF                                            KDS08257
                   END-IF                                               KDS08257
              END-EVALUATE                                              KDS08257
              COMPUTE WS-J = WS-J + 1                                   KDS08257
           END-PERFORM                                                  KDS08257
           EXIT.                                                        KDS08257
       D110-CHECK-DAILY.                                                KDS08257
           IF (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                  KDS08257
              OR JCBMAST-JOB-STATUS = A OR K)                           KDS08257
           THEN                                                         KDS08257
              IF JCBMAST-EXEC-TIME NOT = WS-000000                      KDS08257
                 COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +             KDS08257
                         JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS         KDS08257
                 COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                   KDS08257
                         WS-CUR-MM * 60 + WS-CUR-SS                     KDS08257
                 IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND      KDS08257
                    WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME          KDS08257
                 THEN                                                   KDS08257
                    MOVE WS-YES          TO WS-RUN                      KDS08257
                 ELSE                                                   KDS08257
                     PERFORM UNTIL WS-RESP = WS-YES OR WS-NO            KDS08257
                      DISPLAY JCBMAST-JOB ' Scheduler run time is '     KDS08257
                      JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2) KDS08257
                      ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '    KDS08257
                       WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'        KDS08257
                      WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'KDS08257
                      UPON CONSOLE                                      KDS08257
                      ACCEPT WS-RESP FROM CONSOLE                       KDS08257
                     END-PERFORM                                        KDS08257
                     IF WS-RESP = WS-YES                                KDS08257
                        MOVE WS-YES       TO WS-RUN                     KDS08257
                     END-IF                                             KDS08257
                 END-IF                                                 KDS08257
              ELSE                                                      KDS08257
                 MOVE WS-YES             TO WS-RUN                      KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D120-CHECK-MONTH.                                                KDS08257
           IF (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                  KDS08257
               OR JCBMAST-JOB-STATUS = A OR K)                          KDS08257
           THEN                                                         KDS08257
              IF DATECNTL-TWD(7:2) = WS-SUFFIX(1:2)                     KDS08257
                 IF JCBMAST-EXEC-TIME NOT = WS-000000                   KDS08257
                    COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +          KDS08257
                            JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS      KDS08257
                    COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                KDS08257
                            WS-CUR-MM * 60 + WS-CUR-SS                  KDS08257
                    IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND   KDS08257
                       WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME       KDS08257
                    THEN                                                KDS08257
                       MOVE WS-YES          TO WS-RUN                   KDS08257
                    ELSE                                                KDS08257
                      PERFORM UNTIL WS-RESP = WS-YES OR WS-NO           KDS08257
                       DISPLAY JCBMAST-JOB ' Scheduler run time is '    KDS08257
                     JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2)  KDS08257
                      ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '    KDS08257
                      WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'         KDS08257
                      WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'KDS08257
                        UPON CONSOLE                                    KDS08257
                        ACCEPT WS-RESP FROM CONSOLE                     KDS08257
                       END-PERFORM                                      KDS08257
                       IF WS-RESP = WS-YES                              KDS08257
                          MOVE WS-YES       TO WS-RUN                   KDS08257
                       END-IF                                           KDS08257
                    END-IF                                              KDS08257
                 ELSE                                                   KDS08257
                    MOVE WS-YES             TO WS-RUN                   KDS08257
                 END-IF                                                 KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D130-CHECK-WEEK.                                                 KDS08257
           IF (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                  KDS08257
               OR JCBMAST-JOB-STATUS = A OR K)                          KDS08257
           THEN                                                         KDS08257
              IF WS-SUFFIX(1:2) = DATECNTL-WEEKDAYS                     KDS08257
                 IF JCBMAST-EXEC-TIME NOT = WS-000000                   KDS08257
                    COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +          KDS08257
                            JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS      KDS08257
                    COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                KDS08257
                            WS-CUR-MM * 60 + WS-CUR-SS                  KDS08257
                    IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND   KDS08257
                       WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME       KDS08257
                    THEN                                                KDS08257
                       MOVE WS-YES          TO WS-RUN                   KDS08257
                    ELSE                                                KDS08257
                       PERFORM UNTIL WS-RESP = WS-YES OR WS-NO          KDS08257
                       DISPLAY JCBMAST-JOB ' Scheduler run time is '    KDS08257
                     JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2)  KDS08257
                      ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '    KDS08257
                      WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'         KDS08257
                      WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'KDS08257
                        UPON CONSOLE                                    KDS08257
                        ACCEPT WS-RESP FROM CONSOLE                     KDS08257
                       END-PERFORM                                      KDS08257
                       IF WS-RESP = WS-YES                              KDS08257
                          MOVE WS-YES       TO WS-RUN                   KDS08257
                       END-IF                                           KDS08257
                    END-IF                                              KDS08257
                 ELSE                                                   KDS08257
                    MOVE WS-YES             TO WS-RUN                   KDS08257
                 END-IF                                                 KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D140-CHECK-LOGON.                                                KDS08257
           IF WS-FROM-MODE = IPL                                        KDS08257
              MOVE WS-YES                   TO WS-RUN                   KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D150-CHECK-ONCE.                                                 KDS08257
           IF DATECNTL-TWD  = JCBMAST-EXEC-DATE AND                     KDS08257
             (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                   KDS08257
              OR JCBMAST-JOB-STATUS = A OR K)                           KDS08257
           THEN                                                         KDS08257
              IF JCBMAST-EXEC-TIME NOT = WS-000000                      KDS08257
                 COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +             KDS08257
                         JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS         KDS08257
                 COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                   KDS08257
                         WS-CUR-MM * 60 + WS-CUR-SS                     KDS08257
                 IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND      KDS08257
                    WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME          KDS08257
                 THEN                                                   KDS08257
                    MOVE WS-YES          TO WS-RUN                      KDS08257
                 ELSE                                                   KDS08257
                     PERFORM UNTIL WS-RESP = WS-YES OR WS-NO            KDS08257
                     DISPLAY JCBMAST-JOB ' Scheduler run time is '      KDS08257
                     JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2)  KDS08257
                    ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '      KDS08257
                     WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'          KDS08257
                    WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'  KDS08257
                      UPON CONSOLE                                      KDS08257
                      ACCEPT WS-RESP FROM CONSOLE                       KDS08257
                     END-PERFORM                                        KDS08257
                     IF WS-RESP = WS-YES                                KDS08257
                        MOVE WS-YES       TO WS-RUN                     KDS08257
                     END-IF                                             KDS08257
                 END-IF                                                 KDS08257
              ELSE                                                      KDS08257
                 MOVE WS-YES             TO WS-RUN                      KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D160-CHECK-MONTH-ST.                                             KDS08257
           IF (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                  KDS08257
               OR JCBMAST-JOB-STATUS = A OR K)                          KDS08257
           THEN                                                         KDS08257
              IF DATECNTL-MTHSTR-IND = WS-YES                           KDS08257
                 IF JCBMAST-EXEC-TIME NOT = WS-000000                   KDS08257
                    COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +          KDS08257
                            JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS      KDS08257
                    COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                KDS08257
                            WS-CUR-MM * 60 + WS-CUR-SS                  KDS08257
                    IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND   KDS08257
                       WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME       KDS08257
                    THEN                                                KDS08257
                       MOVE WS-YES          TO WS-RUN                   KDS08257
                    ELSE                                                KDS08257
                       PERFORM UNTIL WS-RESP = WS-YES OR WS-NO          KDS08257
                       DISPLAY JCBMAST-JOB ' Scheduler run time is '    KDS08257
                       JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2)KDS08257
                      ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '    KDS08257
                       WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'        KDS08257
                      WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'KDS08257
                        UPON CONSOLE                                    KDS08257
                        ACCEPT WS-RESP FROM CONSOLE                     KDS08257
                       END-PERFORM                                      KDS08257
                       IF WS-RESP = WS-YES                              KDS08257
                          MOVE WS-YES       TO WS-RUN                   KDS08257
                       END-IF                                           KDS08257
                    END-IF                                              KDS08257
                 ELSE                                                   KDS08257
                    MOVE WS-YES             TO WS-RUN                   KDS08257
                 END-IF                                                 KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D170-CHECK-MONTH-ED.                                             KDS08257
           IF (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                  KDS08257
               OR JCBMAST-JOB-STATUS = A OR K)                          KDS08257
           THEN                                                         KDS08257
              IF DATECNTL-MTHEND-IND = WS-YES                           KDS08257
                 IF JCBMAST-EXEC-TIME NOT = WS-000000                   KDS08257
                    COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +          KDS08257
                            JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS      KDS08257
                    COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                KDS08257
                            WS-CUR-MM * 60 + WS-CUR-SS                  KDS08257
                    IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND   KDS08257
                       WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME       KDS08257
                    THEN                                                KDS08257
                       MOVE WS-YES          TO WS-RUN                   KDS08257
                    ELSE                                                KDS08257
                       PERFORM UNTIL WS-RESP = WS-YES OR WS-NO          KDS08257
                       DISPLAY JCBMAST-JOB ' Scheduler run time is '    KDS08257
                       JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2)KDS08257
                        ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '  KDS08257
                       WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'        KDS08257
                      WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'KDS08257
                        UPON CONSOLE                                    KDS08257
                        ACCEPT WS-RESP FROM CONSOLE                     KDS08257
                       END-PERFORM                                      KDS08257
                       IF WS-RESP = WS-YES                              KDS08257
                          MOVE WS-YES       TO WS-RUN                   KDS08257
                       END-IF                                           KDS08257
                    END-IF                                              KDS08257
                 ELSE                                                   KDS08257
                    MOVE WS-YES             TO WS-RUN                   KDS08257
                 END-IF                                                 KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D180-CHECK-WEEK-END.                                             KDS08257
           IF (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                  KDS08257
               OR JCBMAST-JOB-STATUS = A OR K)                          KDS08257
           THEN                                                         KDS08257
              IF DATECNTL-WEEKEND-IND = WS-YES                          KDS08257
                 IF JCBMAST-EXEC-TIME NOT = WS-000000                   KDS08257
                    COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +          KDS08257
                            JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS      KDS08257
                    COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                KDS08257
                            WS-CUR-MM * 60 + WS-CUR-SS                  KDS08257
                    IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND   KDS08257
                       WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME       KDS08257
                    THEN                                                KDS08257
                       MOVE WS-YES          TO WS-RUN                   KDS08257
                    ELSE                                                KDS08257
                       PERFORM UNTIL WS-RESP = WS-YES OR WS-NO          KDS08257
                       DISPLAY JCBMAST-JOB ' Scheduler run time is '    KDS08257
                       JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2)KDS08257
                        ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '  KDS08257
                         WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'      KDS08257
                      WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'KDS08257
                        UPON CONSOLE                                    KDS08257
                        ACCEPT WS-RESP FROM CONSOLE                     KDS08257
                       END-PERFORM                                      KDS08257
                       IF WS-RESP = WS-YES                              KDS08257
                          MOVE WS-YES       TO WS-RUN                   KDS08257
                       END-IF                                           KDS08257
                    END-IF                                              KDS08257
                 ELSE                                                   KDS08257
                    MOVE WS-YES             TO WS-RUN                   KDS08257
                 END-IF                                                 KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D190-CHECK-QTR-END.                                              KDS08257
           IF (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                  KDS08257
               OR JCBMAST-JOB-STATUS = A OR K)                          KDS08257
           THEN                                                         KDS08257
              IF DATECNTL-QTREND-IND = WS-YES                           KDS08257
                 IF JCBMAST-EXEC-TIME NOT = WS-000000                   KDS08257
                    COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +          KDS08257
                            JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS      KDS08257
                    COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                KDS08257
                            WS-CUR-MM * 60 + WS-CUR-SS                  KDS08257
                    IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND   KDS08257
                       WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME       KDS08257
                    THEN                                                KDS08257
                       MOVE WS-YES          TO WS-RUN                   KDS08257
                    ELSE                                                KDS08257
                       PERFORM UNTIL WS-RESP = WS-YES OR WS-NO          KDS08257
                      DISPLAY JCBMAST-JOB ' Scheduler run time is '     KDS08257
                      JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2) KDS08257
                      ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '    KDS08257
                       WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'        KDS08257
                      WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'KDS08257
                      UPON CONSOLE                                      KDS08257
                      ACCEPT WS-RESP FROM CONSOLE                       KDS08257
                       END-PERFORM                                      KDS08257
                       IF WS-RESP = WS-YES                              KDS08257
                          MOVE WS-YES       TO WS-RUN                   KDS08257
                       END-IF                                           KDS08257
                    END-IF                                              KDS08257
                 ELSE                                                   KDS08257
                    MOVE WS-YES             TO WS-RUN                   KDS08257
                 END-IF                                                 KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D1A0-CHECK-YAR-END.                                              KDS08257
           IF (DATECNTL-TWD NOT = JCBMAST-EXEC-ST-DATE                  KDS08257
               OR JCBMAST-JOB-STATUS = A OR K)                          KDS08257
           THEN                                                         KDS08257
              IF DATECNTL-YREND-IND = WS-YES                            KDS08257
                 IF JCBMAST-EXEC-TIME NOT = WS-000000                   KDS08257
                    COMPUTE WS-NUM2 = JCBMAST-EXEC-HH * 3600 +          KDS08257
                            JCBMAST-EXEC-MM * 60 + JCBMAST-EXEC-SS      KDS08257
                    COMPUTE WS-NUM1 = WS-CUR-HH * 3600 +                KDS08257
                            WS-CUR-MM * 60 + WS-CUR-SS                  KDS08257
                    IF WS-NUM1 >= WS-NUM2 - JCBMAST-EXEC-VAR-TIME AND   KDS08257
                       WS-NUM1 <= WS-NUM2 + JCBMAST-EXEC-VAR-TIME       KDS08257
                    THEN                                                KDS08257
                       MOVE WS-YES          TO WS-RUN                   KDS08257
                    ELSE                                                KDS08257
                       PERFORM UNTIL WS-RESP =  WS-YES OR WS-NO         KDS08257
                      DISPLAY JCBMAST-JOB ' Scheduler run time is '     KDS08257
                      JCBMAST-EXEC-TIME(1:2) ':' JCBMAST-EXEC-TIME(3:2) KDS08257
                      ':' JCBMAST-EXEC-TIME(5:2) ' but now time is '    KDS08257
                       WS-CUR-TIME(1:2) ':' WS-CUR-TIME(3:2) ':'        KDS08257
                      WS-CUR-TIME(5:2) ' are you sure to start it?(Y/N)'KDS08257
                      UPON CONSOLE                                      KDS08257
                      ACCEPT WS-RESP FROM CONSOLE                       KDS08257
                       END-PERFORM                                      KDS08257
                       IF WS-RESP = WS-YES                              KDS08257
                          MOVE WS-YES       TO WS-RUN                   KDS08257
                       END-IF                                           KDS08257
                    END-IF                                              KDS08257
                 ELSE                                                   KDS08257
                    MOVE WS-YES             TO WS-RUN                   KDS08257
                 END-IF                                                 KDS08257
              END-IF                                                    KDS08257
           END-IF                                                       KDS08257
           EXIT.                                                        KDS08257
       D1B0-CHECK-ANY.                                                  KDS08257
           MOVE WS-YES                      TO WS-RUN                   KDS08257
           EXIT.                                                        KDS08257
