PROFS to OfficeVision migration

Recently, we converted from IBM's PROFS system to the new
offering, OfficeVision/VM.  We encountered quite a few
problems with the changes involved, including the new method
of sending notes.  In PROFS, notes were sent to users' reader
queues.  This had some inherent problems, including filling up
spool space, and being too accessible to the wrong people.  So,
IBM changed OfficeVision to include a new service machine
(PROMBX) which would hold all notes in a form much less
accessible to unauthorized users.

In PROFS, a user knew that he had outstanding notes ready to
be read when the 'MAIL WAITING' light appeared on his
screen.  This 'MAIL WAITING' light was turned on by the
presence of entries in the user's reader.  In OfficeVision the
notes are no longer stored in the user's reader: this caused
something of a problem.  IBM's solution was to create an entry
in the user's reader queue (the ZIPD record) whenever new
mail was generated for a user.

Unfortunately, this was not a complete solution, because
problems with the service machine (PROMBX) or the
'INBASKET' could cause the ZIPD record to be erased even
though there was still mail outstanding for a user.  If this
happened, the ZIPD record would not be re-generated by new
mail until the old mail was cleared, and, since there was no
ZIPD record to turn on the 'MAIL WAITING' light, users were
unaware they had any mail at all.

When I placed a call to the IBM support centre, I received the
above explanation of why and how the 'MAIL WAITING' light
might not be turned on even when a user had mail waiting.
They also gave me some good suggestions on how to prevent
the ZIPD record from being lost.  They did not, however, have
any real solution for re-building the ZIPD once it had been lost.
So, I built the following EXEC, which is now run once a day,
to check PROMBX for New_Mail entries and issue the ZIPD
record if the user's reader queue is empty.

/*        This EXEC verifies a "Mail-Waiting" light      */
/*        for all users with "New-mail".                 */
'EXECIO 0 CP ( SKIP STRING LINK PROMBX 5FF 001 RR RCMS'
TRACE O
'ACC 001 B'
'LISTF * * B (FIFO'
DO QUEUED()
      PULL USERID ft fm
      MAKEBUF
      'Q RDR ' USERID ' (LIFO'
      PULL R1 R2 R3
      IF R1 = 'NO' THEN DO
         queue 'ZIPD'
         'EXECIO' 1 'DISKW $$ZIPD$$ $$FILE$$ A 1 F 80 (FINIS'
         'cp tag dev pu ' userid
         'cp spool pun to RSCSV2 class M'
         'PUNCH $$ZIPD$$ $$FILE$$ A (noheader'
         'erase $$ZIPD$$ $$FILE$$ A'
         end
      DROPBUF
    END
'REL B (DET'
EXIT

Mary Snyder
Senior Technical Specialist
Compusource (USA)                        c Compusource 1991

