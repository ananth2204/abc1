//CBTUSER1 JOB (ACCT),'PGMR',NOTIFY=CBTUSER,
//         MSGLEVEL=(1,1),MSGCLASS=H
//*       COMPILE WITH FORTRAN G
//*       OBJECT DECK FOR MD5 IS IN MD5.OBJ
//FORT   EXEC PGM=IEYFORT,PARM=(OBJ,NODECK,TERM,NOXREF,BATCH,
//             ASA,NODX,NOMX,NORX,RLD,NOUS,'PC(NOUHD)')
//STEPLIB  DD  DSN=CBTUSER.FORT.LOAD,DISP=SHR
//SYSPRINT DD  SYSOUT=*
//SYSLIN   DD  DSNAME=&&OBJ,DISP=(NEW,PASS),
//             UNIT=SYSDA,SPACE=(TRK,(3,0)),
//             DCB=(BLKSIZE=3200)
//SYSIN    DD  *
C - TEST THE MD5 SUBROUTINE
C - READ DATA FROM DDNAME FT05F001, AT END WRITE MD5 SUM TO DD FT06F001
      DIMENSION IREC(20),ICTX(22),IRES(8),IWRK(44)
      DO 10 I=1,22
   10 ICTX(I) = 0
   20 READ (5,21,END=30) (IREC(I),I=1,20)
   21 FORMAT(20A4)
      CALL MD5(IREC,80,ICTX,IRES,IWRK)
      GOTO 20
   30 CALL MD5(IREC, 0,ICTX,IRES,IWRK)
C - 16-BYTE BINARY RESULT IN 1ST 4 WORDS OF CTX
      WRITE(6,100) (ICTX(I),I=1,4)
  100 FORMAT(1X,4Z8)
C - 32-BYTE PRINTABLE HEX RESULT IN 8 WORDS OF IRES
      WRITE(6,200) (IRES(I),I=1,8)
  200 FORMAT(1X,8A4)
      STOP
      END
//LKED   EXEC PGM=HEWLDIA,PARM='MAP',
//             COND=(0,NE)
//SYSLOUT  DD  SYSOUT=*
//SYSLIN   DD  DSNAME=&&OBJ,DISP=(OLD,DELETE)
//         DD  DSNAME=CBTUSER.MD5.OBJ,DISP=SHR
//SYSUT1   DD  UNIT=SYSALLDA,SPACE=(TRK,(10,0))
//SYSLIB   DD  DSN=CBTUSER.FORT.LOAD,DISP=SHR
//FT05F001 DD  *
HELLO
//FT06F001 DD  SYSOUT=*
