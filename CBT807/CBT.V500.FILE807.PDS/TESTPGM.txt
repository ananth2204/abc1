CIR      START 0
         USING *,R15      USE R15 TEMPORARILY AS A BASE
         STM   R14,R12,12(R13)      SAVE SYSTEM REGISTERS
         ST    R13,SAVEAREA+4 STORE ADDR OF SYSTEM SAVE AREA IN SAVEARE
         LR    R3,R13       LOAD R3 WITH ADDRESS OF SYSTEM SAVE AREA
         CNOP  0,4        TO ALIGN THE BAL INSTR ON A FULLWORD
         BAL   R13,JUMPSAVE    STORE THE ADDRESS OF SAVEAREA IN R13
SAVEAREA DS    18F                   AND BRANCH TO JUMPSAVE
JUMPSAVE ST    R13,8(R3)  STORE ADDR OF SAVEAREA IN SYSTEM SAVE AREA
         USING SAVEAREA,R13
         DROP  R15
         L     R3,0(0,R1) LOAD THE CONTENTS OF ADDR POINTED TO BY R1
         LH    R4,0(R3)    GET LENGTH
         MVC   CIROPT(1),2(R3)     SET UP OPTION FLAG
         BCTR  R4,0       SUB 1
         BCTR  R4,0       SUB 1
         STC   R4,MVCPARM+1
MVCPARM  MVC   SRCHARG(*-*),3(R3)     SET UP SEARCH ARG
         LA    R1,CIRPARM
         LINK  EP=IKJEHCIR
         SPACE 2
         ABEND 100,DUMP,STEP,SYSTEM   CAUSE A DUMP
EXIT     L     R13,SAVEAREA+4
         LM    R14,R12,12(R13)
SETRC    LA    R15,0
         BR    R14
         SPACE
CIRPARM  DS    0F
CIROPT   DS    X             OPTION FLAG (FROM PARM)
         DS    XL2
CIRLOCRC DS    X
CIRSRCH  DC    A(SRCHARG)
CIRCVOL  DS    A             <==========
CIRWA    DC    A(WKAREA)
CIRSAVE  DC    A(SVAREA)
CIRPSWD  DC    A(PASSWORD)
         SPACE
SVAREA   DS    18F
PASSWORD DC    D'0'
VOLADDR  DS    CL6           <===========
SRCHARG  DC    CL44' '       <=== MUST BE REINIT TO BLANK
WKAREA   DC    AL2(65000),H'0'
         DS    65000X
R0       EQU   0
R1       EQU   1
R2       EQU   2
R3       EQU   3
R4       EQU   4
R5       EQU   5
R6       EQU   6
R7       EQU   7
R8       EQU   8
R9       EQU   9
R10      EQU   10
R11      EQU   11
R12      EQU   12
R13      EQU   13
R14      EQU   14
R15      EQU   15
         END
