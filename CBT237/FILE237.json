{"INMR01": {"INMLRECL": 80, "INMFNODE": "N1", "INMFUID": "SBGOLOB", "INMTNODE": "A", "INMTUID": "A", "INMFTIME": "20201220011542000000", "INMNUMF": 1}, "INMR02": {"1": {"INMUTILN": "IEBCOPY", "INMSIZE": 587860, "INMDSORG": "PO", "INMTYPE": "None", "INMLRECL": 80, "INMBLKSZ": 5600, "INMRECFM": "FB", "INMDIR": 6, "INMDSNAM": "CBT.V500.FILE237.PDS", "numfile": 1}, "2": {"INMUTILN": "INMCOPY", "INMSIZE": 587860, "INMDSORG": "PS", "INMLRECL": 32756, "INMBLKSZ": 3120, "INMRECFM": "VS", "numfile": 1}}, "INMR03": {"1": {"INMSIZE": 587860, "INMDSORG": "PS", "INMLRECL": 80, "INMRECFM": "?"}}, "file": {"CBT.V500.FILE237.PDS": {"COPYR1": {"type": "PDS", "DS1DSORG": 512, "DS1BLKL": 5600, "DS1LRECL": 80, "DS1RECFM": "FB", "DS1KEYL": 0, "DS1OPTCD": 0, "DS1SMSFG": 0, "file_tape_blocksize": 3120, "DVAOPTS": 12336, "DVACLASS": 32, "DVAUNIT": 15, "DVAMAXRC": 32760, "DVACYL": 3340, "DVATRK": 15, "DVATRKLN": 58786, "DVAOVHD": 0, "num_header_records": 2, "DS1REFD": "200354", "DS1SCEXT": "b'\\x00\\x00\\x00'", "DS1SCALO": "b'\\x80\\x00\\x00\\xbe'", "DS1LSTAR": "b'\\x00\\n\\n'", "DS1TRBAL": "b'\\x0f\\xce'"}, "COPYR2": {"deb": "b'\\x01\\x00\\x00\\x00\\xff\\x00\\x00\\x00\\x8f\\x03\\x90\\x00\\x04\\x9a\\xc0\\xd8'", "extents": ["b'\\x01\\x00\\x00\\x00\\xff\\x00\\x00\\x00\\x8f\\x03\\x90\\x00\\x04\\x9a\\xc0\\xd8'", "b'X\\xf4\\xfd\\xd0\\x00\\x00\\x01\\xa9\\x00\\x05\\x01\\xaa\\x00\\x00\\x00\\x0b'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'"]}, "members": {"GETPDSDD": {"ttr": 516, "alias": false, "halfwords": 0, "notes": 0, "parms": "b''", "ispf": false, "text": "*          DATA SET CBT840     AT LEVEL 001 AS OF 09/29/77\n         MACRO                                                          00001\n&N       DTIME &FIELD                                                   00002\n&N       TIME  DEC                                                      00003\n         CNOP  0,4                                                      00004\n         STM   0,1,*+8                                                  00005\n         B     *+12                                                     00006\n         DC    2F'0'                                                    00007\n         EDIT  TO=&FIELD,FROM=*-14,MASK=' 99/99/99.99F ZZ99.999'        00008\n         MEND                                                           00009\n         MACRO                                                          00010\n&NAME    EDIT  &TO=,&FROM=,&MASK=                                       00011\n.*                                                                      00012\n.*             MACRO-ID. 'EDIT'.                                        00013\n.*             AUTHOR.   DON HIGGINS.                                   00014\n.*             DATE WRITTEN.  07/18/70.                                 00015\n.*             REMARKS.                                                 00016\n.*                  FUNCTION - GENERATE MASK AND/OR INSTRUCTIONS TO     00017\n.*                             EDIT PACKED DECIMAL DATA FOR PRINTING.   00018\n.*                  OPERANDS                                            00019\n.*                   TO=   LABEL OF DISPLAY FIELD INTO WHICH THE EDITED 00020\n.*                         DATA WILL BE PLACED IF SPECIFIED.            00021\n.*                   FROM= LABEL OF PACKED DECIMAL DATA TO BE EDITED    00022\n.*                         IF SPECIFIED.                                00023\n.*                   MASK= STRING OF UP TO 48 CHARACTERS IN SINGLE      00024\n.*                         QUOTES DEFINING EDIT MASK SIMILAR            00025\n.*                         TO A COBOL PICTURE.  THIS OPERAND IS         00026\n.*                         REQUIRED.  IF THE OTHER TWO OPERANDS ARE NOT 00027\n.*                         DEFINED, A DC WITH THE DESIRED MASK IS       00028\n.*                         GENERATED.  SPECIAL EDIT CHARACTERS ARE AS   00029\n.*                         FOLLOWS:                                     00030\n.*                            Z - DIGIT SELECT WITH ZERO SURPRESSION    00031\n.*                            9 - DIGIT SELECT WITHOUT ZERO SURPRESSION 00032\n.*                            F - FIELD SELECT RESETS SIGNIFICANCE TO   00033\n.*                                ALLOW MULTIPLE FIELD EDITING          00034\n.*                            $ - DIGIT SELECT WITH ZERO SURPRESSION    00035\n.*                                AND FLOATING DOLLAR SIGN.             00036\n.*                  NOTES:                                              00037\n.*                   1.  THE FIRST MASK CHARACTER IS USED AS THE FILL   00038\n.*                       CHARACTER IN ALL FIELDS.                       00039\n.*                   2.  THE FOLLOWING EXAMPLE WOULD EDIT BOTH THE TIME 00040\n.*                       AND DATE OBTAINED USING THE TIME MACRO         00041\n.*                            .                                         00042\n.*                            TIME DEC                                  00043\n.*                            STM  0,1,PDATA                            00044\n.*                            EDIT TO=LINE+10,FROM=PDATA,               00045\n.*                                 MASK=' 99/99/99.99F ZZ99.999'        00046\n.*                            .                                         00047\n.*                       PDATA DS  2F     (HHMMSSTH00YYDDDC)            00048\n.*                       LINE  DC  CL133' '                             00049\n.*                            .                                         00050\n.*                   3.  THE FOLLOWING EXAMPLE WOULD GENERATE A DC      00051\n.*                       LABELED MASKPAY TO BE USED AS A MASK FOR       00052\n.*                       EDITING DIFFERENT FILEDS.                      00053\n.*                            .                                         00054\n.*                       MASKPAY   EDIT MASK=' Z,ZZZ,ZZ9.99 CR'         00055\n.*                            .                                         00056\n.*                   4.  THE MASK CHARACTERS DETERMINE EXPLICIT LENGTH. 00057\n.*                   5.  MULTIPLE FIELDS CANNOT CONTAIN FLOATING        00058\n.*                       DOLLAR SIGNS.                                  00059\n.*                                                                      00060\n         LCLA  &LMASK,&SIGNF,&NEXT,&FIELDS,&FLOAT                       00061\n         LCLC  &C,&C1,&C2,&C3,&C4,&C5,&C6                               00062\n         AIF   (T'&MASK NE 'U').BADMASK                                 00063\n&LMASK   SETA  K'&MASK-2                                                00064\n         AIF   (&LMASK GT 48).BADMASK                                   00065\n         AIF   (&LMASK LT 1).BADMASK                                    00066\n         AIF   ('&MASK'(1,1) NE '''').BADMASK                           00067\n         AIF   ('&MASK'(&LMASK+2,1) NE '''').BADMASK                    00068\n.LOOP    ANOP                                                           00069\n&NEXT    SETA  &NEXT+1                                                  00070\n         AIF   (&NEXT GT &LMASK).GEN                                    00071\n&C       SETC  '&MASK'(&NEXT+1,1)                                       00072\n         AIF   ('&C' EQ '9').NINE                                       00073\n         AIF   ('&C' EQ 'Z').ZZZZ                                       00074\n         AIF   ('&C' EQ '$').DOLLAR                                     00075\n         AIF   ('&C' EQ 'F').FIELD                                      00076\n.AD1     AIF   ('&C1' GT '9999999').AD2                                 00077\n&C1      SETC  '&C1&C'                                                  00078\n         AGO   .LOOP                                                    00079\n.AD2     AIF   ('&C2' GT '9999999').AD3                                 00080\n&C2      SETC  '&C2&C'                                                  00081\n         AGO   .LOOP                                                    00082\n.AD3     AIF   ('&C3' GT '9999999').AD4                                 00083\n&C3      SETC  '&C3&C'                                                  00084\n         AGO   .LOOP                                                    00085\n.AD4     AIF   ('&C4' GT '9999999').AD5                                 00086\n&C4      SETC  '&C4&C'                                                  00087\n         AGO   .LOOP                                                    00088\n.AD5     AIF   ('&C5' GT '9999999').AD6                                 00089\n&C5      SETC  '&C5&C'                                                  00090\n         AGO   .LOOP                                                    00091\n.AD6     AIF   ('&C6' GT '9999999').BADMASK                             00092\n&C6      SETC  '&C6&C'                                                  00093\n         AGO   .LOOP                                                    00094\n.NINE    AIF   (&SIGNF EQ 0).SETSIG                                     00095\n.ZZZZ    ANOP                                                           00096\n&C       SETC  '\u0080'       (11-0-1-8-9)=X'20'  DIGIT SELECT               00097\n         AGO   .AD1                                                     00098\n.DOLLAR  ANOP                                                           00099\n&FLOAT   SETA  1                                                        00100\n         AGO   .ZZZZ                                                    00101\n.FIELD   ANOP                                                           00102\n&C       SETC  '\u0082'       (0-2-9)=X'22'       FIELD SELECT               00103\n&SIGNF   SETA  0                                                        00104\n&FIELDS  SETA  1                                                        00105\n         AGO   .AD1                                                     00106\n.SETSIG  ANOP                                                           00107\n&C       SETC  '\u0081'       (0-1-9)=X'21'       SIGNIFICANCE STARTER       00108\n&SIGNF   SETA  &NEXT                                                    00109\n         AGO   .AD1                                                     00110\n.GEN     AIF   (T'&TO EQ 'O').GENDC                                     00111\n         AIF   (T'&FROM EQ 'O').BADFROM                                 00112\n         AIF   (&FLOAT EQ 1).GENFL                                      00113\n&NAME    MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00114\n         ED    &TO.(&LMASK.),&FROM                                      00115\n         MEXIT                                                          00116\n.GENDC   AIF   (T'&FROM NE 'O').BADTO                                   00117\n&NAME    DC    CL&LMASK.'&C1&C2&C3&C4&C5&C6'                            00118\n         MEXIT                                                          00119\n.GENFL   AIF   (&FIELDS NE 0).BADMIX                                    00120\n         AIF   (&SIGNF  GT 0).GENLA                                     00121\n&NAME    LA    1,1                                                      00122\n         MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00123\n         EDMK  &TO.(&LMASK.),&FROM                                      00124\n         BCT   1,*+8                                                    00125\n         B     *+8                                                      00126\n         MVI   0(1),C'$'                                                00127\n         MEXIT                                                          00128\n.GENLA   ANOP                                                           00129\n&NAME    LA    1,&TO.+&SIGNF                                            00130\n         MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00131\n         EDMK  &TO.(&LMASK.),&FROM                                      00132\n         BCTR  1,0                                                      00133\n         MVI   0(1),C'$'                                                00134\n         MEXIT                                                          00135\n.BADMIX  MNOTE 0,'MULTIPLE FIELDS CANNOT CONTAIN FLOATING DOLLAR SIGNS' 00136\n         MEXIT                                                          00137\n.BADMASK MNOTE 0,'INVALID MASK (1-48 CHARACTERS IN SINGLE QUOTES)'      00138\n         MEXIT                                                          00139\n.BADTO   MNOTE 0,'MISSING TO FIELD'                                     00140\n         MEXIT                                                          00141\n.BADFROM MNOTE 0,'MISSING FROM FIELD'                                   00142\n         MEXIT                                                          00143\n         MEND                                                           00144\n         MACRO                                                          00145\n         EQUREGS &LIMITS                                                00146\n.*                                                                      00147\n.*             MACRO-ID. 'EQUREGS'.                                     00148\n.*             AUTHOR. DON HIGGINS.                                     00149\n.*             DATE WRITTEN. 08/04/70.                                  00150\n.*             REMARKS.                                                 00151\n.*                 THIS MACRO GENERATES EQU STATEMENTS FOR 1 TO 16      00152\n.*                 SYMBOLIC REGISTER NAMES OF THE FORM R0 UP TO R15     00153\n.*             THE REGISTER EQU DESIRED CAN BE SPECIFIED IN THE FORM    00154\n.*             OF  (0,15), (14,1), (2,6), ETC.                          00155\n         LCLA  &LOW,&HIGH                                               00156\n         AIF   (N'&SYSLIST EQ 1).GETLIM                                 00157\n.DEFAULT ANOP                                                           00158\n&LOW     SETA  0                                                        00159\n&HIGH    SETA  15                                                       00160\n.GEN     ANOP                                                           00161\nR&LOW    EQU   &LOW                                                     00162\n         AIF   (&LOW EQ &HIGH).DONE                                     00163\n&LOW     SETA  &LOW+1                                                   00164\n         AIF   (&LOW LE 15).GEN                                         00165\n&LOW     SETA  0                                                        00166\n         AGO   .GEN                                                     00167\n.GETLIM  AIF   (N'&SYSLIST(1) NE 2).DEFAULT                             00168\n         AIF   (T'&SYSLIST(1,1) NE 'N').DEFAULT                         00169\n         AIF   (T'&SYSLIST(1,2) NE 'N').DEFAULT                         00170\n&LOW     SETA  &SYSLIST(1,1)                                            00171\n         AIF   (&LOW LT 0).DEFAULT                                      00172\n         AIF   (&LOW GT 15).DEFAULT                                     00173\n&HIGH    SETA  &SYSLIST(1,2)                                            00174\n         AIF   (&HIGH LT 0).DEFAULT                                     00175\n         AIF   (&HIGH GT 15).DEFAULT                                    00176\n         AGO   .GEN                                                     00177\n.DONE    MEXIT                                                          00178\n         MEND                                                           00179\n         MACRO                                                          00180\n         FILL   &TAG,&FILL=C' '                                         00181\n         LCLA  &LTAG                                                    00182\n.*             AUTHOR.   DON HIGGINS.                                   00183\n.*             DATE.     09/16/71.                                      00184\n.*             REMARKS.  FILL REMAINDER OF AREA WITH FILL CHARACTER.    00185\n&LTAG    SETA  L'&TAG                                                   00186\n         DC    (&LTAG)&FILL                                             00187\n         ORG   &TAG+&LTAG                                               00188\n         MEND                                                           00189\n         MACRO                                                          00190\n&NAME    IOB   &FLAGS=,&ECB=,&CCW=,&DCB=,&ID=                           00191\n.*             AUTHOR.   DON HIGGINS.                                   00192\n.*             DATE.     11/23                                          00193\n.*             REMARKS.  INPUT/OUTPUT CONTROL BLOCK MACRO.              00194\n.*                       REF. SYS. PROG. GUIDE C28-6550-6 PG 139        00195\n.*                                                                      00196\n&NAME    DS    0F                                                       00197\n         DC    &FLAGS         FLAGS 1  0-CD 1-CC 6-NOT REL 23457-RESV   00198\n         DC    XL1'00'        FLAGS 2  RESERVED                         00199\nSNS&ID   DC    XL2'00'        FIRST TWO SENSE BYTES AFTER UNIT CHECK    00200\n         DC    XL1'00'        ECB CODE                                  00201\nECB&ID   DC    AL3(&ECB)      EVENT CONTROL BLOCK ADDRESS               00202\n         DC    XL1'00'        FLAGS 3 RESERVED                          00203\nCSW&ID   DC    XL7'00'        CHANNEL STATUS WORD (LOW ORDER 7 BYTES)   00204\n         DC    XL1'00'        SIO CODE (INS LENGTH X CONDITION CODE)    00205\nCCW&ID   DC    AL3(&CCW)      CHANNEL COMMAND WORD ADDRESS              00206\n         DC    XL1'00'        RESERVED                                  00207\nDCB&ID   DC    AL3(&DCB)      DATA CONTROL BLOCK ADDRESS                00208\n         DC    XL1'00'        REPOSITION MODIFIER                       00209\n         DC    AL3(0)         RESTART ADDRESS                           00210\n         DC    H'0'           BLOCK COUNT INCREMENT                     00211\n         DC    H'0'           ERROR COUNTS                              00212\n         DC    XL1'00'        M - EXTENT ENTRY IN DEB                   00213\n         DC    XL7'00'        SEEK ADDRESS BBCCHHR                      00214\n         MEND                                                           00215\n         MACRO                                                          00216\n&N       PENTRY                                                         00217\n.*             AUTHOR.   DON HIGGINS.                                   00218\n.*             DATE.     01/06/75.                                      00219\n.*             REMARKS.  PERFORM ROUTINE ENTRY POINT WITH TRACE OPTION. 00220\n.*                       SEE PTRACE MACRO FOR TRACE INFO.               00221\n         GBLB  &PTRACE                                                  00222\n         GBLC  &PTNAME                                                  00223\n         GBLC  &PENAME                                                  00224\n&PENAME  SETC  '&N'                                                     00225\n         DC    0H'0',CL8'&N'                                            00226\n         B     *+4                                                      00227\n&N       EQU   *                                                        00228\n         AIF   (&PTRACE EQ 0).NOTRACE                                   00229\n         PM    &PTNAME                                                  00230\n.NOTRACE ANOP                                                           00231\n         MEND                                                           00232\n         MACRO                                                          00233\n&N       PERFORM &PENTRY                                                00234\n&N       MVC   &PENTRY-2(2),*+10                                        00235\n         B     &PENTRY                                                  00236\n         DC    S(*+2)                                                   00237\n         MEND                                                           00238\n         MACRO                                                          00239\n&N       PEXIT                                                          00240\n         GBLC  &PENAME                                                  00241\n&N       B     &PENAME-4                                                00242\n         MEND                                                           00243\n         MACRO                                                          00244\n&NAME    SCALL &SUBNAME,&ARGLIST                                        00245\n.*             AUTHOR.   DON HIGGINS.                                   00246\n.*             DATE.     11/09/70.                                      00247\n.*             REMARKS.  SHORT FORM OF IBM CALL MACRO WITH NO VL.       00248\n         AIF   (T'&ARGLIST EQ 'O').NOARG                                00249\n&NAME    LA    1,=A&ARGLIST        LOAD ARGUMENT LIST ADDRESS           00250\n         L     15,=V(&SUBNAME)     LOAD SUBPROGRAM ENTRY ADDRESS        00251\n         BALR  14,15               BRANCH AND LINK                      00252\n         MEXIT                                                          00253\n.NOARG   ANOP                                                           00254\n&NAME    L     15,=V(&SUBNAME)     LOAD SUBPROGRAM ENTRY ADDRESS        00255\n         BALR  14,15               BRANCH AND LINK                      00256\n         MEND                                                           00257\n         MACRO                                                          00258\n&NAME    SUBENTRY &CSECT=YES,&BASES=(13),                              X00259\n               &RENT=NO,&RWA=,&RWALNG=0,&SP=0                           00260\n         LCLA  &NBASE,&S,&OFFSET                                        00261\n.*             MACRO-ID. 'SUBENTRY'                                     00262\n.*             AUTHOR.   DON HIGGINS.                                   00263\n.*             DATE WRITTEN.  07/28/70.                                 00264\n.*             REMARKS.  THIS MACRO GENERATES THE CODE TO ESTABLISH A   00265\n.*                       CSECT WITH SAVE AREA AND BASE REGISTER USING   00266\n.*                       STANDARD OS LINKAGE CONVENTIONS.               00267\n.*             REV1 11/14/74 ADD REENTRANT OPTION WITH WORK AREA        00268\n.*                 1.  FOR REENTRANT LINKAGE YOU MUST SPECIFY           00269\n.*                     A.  RENT=YES                                     00270\n.*                     B.  AT LEAST ONE BASE REGISTER OTHER THAN 13     00271\n.*                         SUCH AS BASES=(R12)                          00272\n.*                 2.  OPTIONALLY YOU CAN SPECIFY A DSECT NAME AND      00273\n.*                     LENGTH FOR A WORK AREA BUILT BEHIND SAVE AREA.   00274\n.*                     FOR EXAMPLE  RWADSECT=MYWORK,RWALNG=8            00275\n.*                     NOTE THAT THIS WORK AREA LENGTH MUST ALSO BE     00276\n.*                     SPECIFIED AT SUBEXIT TIME TO CORRECTLY CALCULATE 00277\n.*                     THE FREEMAIN LENGTH.                             00278\n.*             REV2 02/10/76 DSH - ADD SUBPOOL OPTION                   00279\n         AIF   ('&CSECT'(1,1) EQ 'N').NOCSECT                           00280\n&NAME    CSECT                                                          00281\n         AGO   .STM                                                     00282\n.NOCSECT ANOP                                                           00283\n&NAME    DS    0D                                                       00284\n.STM     ANOP                                                           00285\n         AIF   ('&RENT'(1,1) EQ 'N').NORENT                             00286\n.RENT    ANOP                                                           00287\n         STM   14,12,12(13)                                             00288\n         BAL   &BASES(1),16(15)                                         00289\n         USING &NAME+8,&BASES(1)                                        00290\n         DC    CL8'&NAME'                                               00291\n         LA    0,72+&RWALNG                                             00292\n         AIF   ('&SP' EQ '0').SKIPSP                                    00293\n         LA    1,&SP                                                    00294\n         SLL   1,24                                                     00295\n         OR    0,1                                                      00296\n.SKIPSP  ANOP                                                           00297\n         GETMAIN R,LV=(0)                                               00298\n         ST    1,8(13)                                                  00299\n         ST    13,4(1)                                                  00300\n         LM    14,1,12(13)                                              00301\n         L     13,8(13)                                                 00302\n         AIF   ('&RWALNG' EQ '0').GEN                                   00303\n         USING &RWA-72,13                                               00304\n         AGO   .GEN                                                     00305\n.NORENT  ANOP                                                           00306\n         STM   14,12,12(13)                                             00307\n         BAL   15,88(15)                                                00308\n         DC    9D'0'                                                    00309\n         DC    CL8'&NAME'                                               00310\n         ST    15,8(13)                                                 00311\n         ST    13,4(15)                                                 00312\n         LR    13,15                                                    00313\n         AIF   (T'&BASES(1) NE 'N').CHKR13                              00314\n         AIF   (&BASES(1) EQ 13).GENB13                                 00315\n         AGO   .GENBX                                                   00316\n.CHKR13  ANOP                                                           00317\n         AIF   ('&BASES'(2,3) EQ 'R13').GENB13                          00318\n.GENBX   ANOP                                                           00319\n         LR    &BASES(1),13                                             00320\n         USING &NAME+8,&BASES(1)                                        00321\n         AGO   .GEN                                                     00322\n.GENB13  ANOP                                                           00323\n         USING &NAME+8,13                                               00324\n.GEN     ANOP                                                           00325\n&NBASE   SETA  N'&BASES                                                 00326\n&S       SETA  1                                                        00327\n.L1      ANOP                                                           00328\n&S       SETA  &S+1                                                     00329\n         AIF   (&S GT &NBASE).EXIT                                      00330\n&OFFSET  SETA  &OFFSET+4095                                             00331\n         LA    &BASES(&S),4095(&BASES(&S-1))                            00332\n         USING &NAME+8+&OFFSET,&BASES(&S)                               00333\n         AGO   .L1                                                      00334\n.EXIT    ANOP                                                           00335\n         MEND                                                           00336\n         MACRO                                                          00337\n&NAME    SUBEXIT &RC=0,&RENT=NO,&RWALNG=0,&SP=0                         00338\n.*             MACRO-ID. 'SUBEXIT'.                                     00339\n.*             AUTHOR.   DON HIGGINS.                                   00340\n.*             DATE WRITTEN.  07/28/70.                                 00341\n.*             REMARKS.  THIS MACRO GENERATES THE CODE TO RESTORE       00342\n.*                       REGISTERS AND RETURN FROM A CSECT.  A RETURN   00343\n.*                       CODE OF ZERO IS RETURNED UNLESS A DIFFERENT    00344\n.*                       CODE IS SPECIFIED USING THE KEY WORD RC=.      00345\n.*             REV1 11/14/74 ADD REENTRANT OPTION. SEE SUBENTRY.        00346\n.*             REV2 12/09/74 ADD REG OPTION FOR RC OPERAND.             00347\n.*             REV3 02/10/76 DSH - ADD SUBPOOL OPTION                   00348\n         AIF   ('&RC'(1,1) EQ '(').RCREG                                00349\n         LA    15,&RC                                                   00350\n         AGO   .CHKRENT                                                 00351\n.RCREG   ANOP                                                           00352\n         LR    15,&RC                                                   00353\n.CHKRENT ANOP                                                           00354\n         AIF   ('&RENT'(1,1) EQ 'N').NORENT                             00355\n.RENT    ANOP                                                           00356\n&NAME    L     13,4(13)                                                 00357\n         STM   15,1,16(13)                                              00358\n         LA    0,72+&RWALNG                                             00359\n         AIF   ('&SP' EQ '0').SKIPSP                                    00360\n         LA    1,&SP                                                    00361\n         SLL   1,24                                                     00362\n         OR    0,1                                                      00363\n.SKIPSP  ANOP                                                           00364\n         L     1,8(13)                                                  00365\n         FREEMAIN R,LV=(0),A=(1)                                        00366\n         LM    14,12,12(13)                                             00367\n         BR    14                                                       00368\n         AGO   .EXIT                                                    00369\n.NORENT  ANOP                                                           00370\n&NAME    L     13,4(13)                                                 00371\n         L     14,12(13)                                                00372\n         LM    2,12,28(13)                                              00373\n         BR    14                                                       00374\n.EXIT    ANOP                                                           00375\n         MEND                                                           00376\n         MACRO                                                          00377\n&N       SYSIN                                                          00378\n&N       DCB   DSORG=PS,MACRF=GM,DDNAME=&N,RECFM=FB,LRECL=80            00379\n         MEND                                                           00380\n         MACRO                                                          00381\n&N       SYSPRINT                                                       00382\n&N       DCB   DSORG=PS,MACRF=PM,DDNAME=&N,RECFM=FA,BLKSIZE=133         00383\n         MEND                                                           00384\n         MACRO                                                          00385\n&NAME    TAG                                                            00386\n&NAME    DS    0H                                                       00387\n         MEND                                                           00388\n         MACRO                                                          00389\n&M       MOVE  &A,&B                                                    00390\n         LCLA  &S,&L                                                    00391\n&L       SETA  L'&A                                                     00392\n.LOOP    ANOP                                                           00393\n         AIF   (&L LE 256).LAST                                         00394\n&M       MVC   &A+&S.(256),&B+&S                                        00395\n&S       SETA  &S+256                                                   00396\n&L       SETA  &L-256                                                   00397\n         AGO   .LOOP                                                    00398\n.LAST    ANOP                                                           00399\n         MVC   &A+&S.(&L),&B+&S                                         00400\n         MEND                                                           00401\n         MACRO                                                          00402\n&N       LT    &R,&X                                                    00403\n&N       L     &R,&X                                                    00404\n         LTR   &R,&R                                                    00405\n         MEND                                                           00406\n         MACRO                                                          00407\n         EQUAL                                                          00408\n*              COMMON EQU'S AND LITERALS                                00409\n*                                                                       00410\n*              EQU'S FOR REGISTERS                                      00411\n         EQUREGS                                                        00412\n*              EQU'S FOR IMMEDIATE DATA INSTRUCTIONS                    00413\n         EQUI                                                           00414\n*              LITERAL POOL                                             00415\n*              EQU'S FOR BRANCH ON CONDITIONS                           00416\n         EQUBC                                                          00417\n         LTORG                                                          00418\n         MEND                                                           00419\n         MACRO                                                          00420\n         EQUI                                                           00421\n         GBLA  &N,&V(20)                                                00422\n.LOOP    ANOP                                                           00423\n         AIF   (&N EQ 0).EXIT                                           00424\n#&V(&N)  EQU   &V(&N)                                                   00425\n&N       SETA  &N-1                                                     00426\n         AGO   .LOOP                                                    00427\n.EXIT    MEND                                                           00428\n         MACRO                                                          00429\n         XREFI &I                                                       00430\n         GBLA  &N,&V(20)                                                00431\n         LCLA  &S,&K,&NK                                                00432\n&NK      SETA  N'&I                                                     00433\n.LOOP1   ANOP                                                           00434\n&K       SETA  &K+1                                                     00435\n         AIF   (&K GT &NK).EXIT                                         00436\n         AIF   (&N EQ 0).ADD                                            00437\n&S       SETA  0                                                        00438\n.LOOP2   ANOP                                                           00439\n&S       SETA  &S+1                                                     00440\n         AIF   (&I(&K) EQ &V(&S)).REF                                   00441\n         AIF   (&S LT &N).LOOP2                                         00442\n.ADD     ANOP                                                           00443\n         AIF   (&N EQ 20).ERR                                           00444\n&N       SETA  &N+1                                                     00445\n&V(&N)   SETA  &I(&K)                                                   00446\n.REF     ANOP                                                           00447\n         AGO   .LOOP1                                                   00448\n.ERR     MNOTE 4,'IMMEDIATE DATA XREF TABLE OVERFLOW'                   00449\n.EXIT    MEND                                                           00450\n         MACRO                                                          00451\n&N       LI    &R,&I                                                    00452\n         AIF   (&I LT 1).ERR                                            00453\n         AIF   (&I GT 32767).ERR                                        00454\n         XREFI &I                                                       00455\n         AIF   (&I GT 4095).LHI                                         00456\n&N       LA    &R,#&I                                                   00457\n         MEXIT                                                          00458\n.LHI     ANOP                                                           00459\n&N       LH    &R,*+6                                                   00460\n         DC    X'4700',AL2(#&I)                                         00461\n         MEXIT                                                          00462\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00463\n         MEND                                                           00464\n         MACRO                                                          00465\n&N       AI    &R,&I                                                    00466\n         AIF   (&I LT 1).ERR                                            00467\n         AIF   (&I GT 32767).ERR                                        00468\n         XREFI &I                                                       00469\n&N       AH    &R,*+6                                                   00470\n         DC    X'4700',AL2(#&I)                                         00471\n         MEXIT                                                          00472\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00473\n         MEND                                                           00474\n         MACRO                                                          00475\n&N       SI    &R,&I                                                    00476\n         AIF   (&I LT 1).ERR                                            00477\n         AIF   (&I GT 32767).ERR                                        00478\n         XREFI &I                                                       00479\n         AIF   (&I GT 2).SHI                                            00480\n&N       BCTR  &R,0                                                     00481\n         DC    0AL2(#&I)                                                00482\n         AIF   (&I EQ 1).EXIT                                           00483\n         BCTR  &R,0                                                     00484\n.EXIT    MEXIT                                                          00485\n.SHI     ANOP                                                           00486\n&N       SH    &R,*+6                                                   00487\n         DC    X'4700',AL2(#&I)                                         00488\n         MEXIT                                                          00489\n.ERR     ANOP                                                           00490\n         MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00491\n         MEND                                                           00492\n         MACRO                                                          00493\n&N       TB    &FIELD,&BITS                                             00494\n         LCLA  &NBITS,&B(8),&S                                          00495\n&NBITS   SETA  N'&BITS                                                  00496\n         AIF   (&NBITS LT 1).ERR                                        00497\n         AIF   (&NBITS GT 8).ERR                                        00498\n.LOOP    ANOP                                                           00499\n&S       SETA  &BITS(&NBITS)                                            00500\n         AIF   (&S LT 0).ERR                                            00501\n         AIF   (&S GT 7).ERR                                            00502\n&B(&S+1) SETA  1                                                        00503\n&NBITS   SETA  &NBITS-1                                                 00504\n         AIF   (&NBITS GT 0).LOOP                                       00505\n&N       TM    &FIELD,B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)'       00506\n         MEXIT                                                          00507\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00508\n         MEND                                                           00509\n         MACRO                                                          00510\n&N       SB    &FIELD,&BITS                                             00511\n         LCLA  &NBITS,&B(8),&S                                          00512\n&NBITS   SETA  N'&BITS                                                  00513\n         AIF   (&NBITS LT 1).ERR                                        00514\n         AIF   (&NBITS GT 8).ERR                                        00515\n.LOOP    ANOP                                                           00516\n&S       SETA  &BITS(&NBITS)                                            00517\n         AIF   (&S LT 0).ERR                                            00518\n         AIF   (&S GT 7).ERR                                            00519\n&B(&S+1) SETA  1                                                        00520\n&NBITS   SETA  &NBITS-1                                                 00521\n         AIF   (&NBITS GT 0).LOOP                                       00522\n&N       OI    &FIELD,B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)'       00523\n         MEXIT                                                          00524\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00525\n         MEND                                                           00526\n         MACRO                                                          00527\n&N       ZB    &FIELD,&BITS                                             00528\n         LCLA  &NBITS,&B(8),&S                                          00529\n&NBITS   SETA  N'&BITS                                                  00530\n         AIF   (&NBITS LT 1).ERR                                        00531\n         AIF   (&NBITS GT 8).ERR                                        00532\n.LOOP    ANOP                                                           00533\n&S       SETA  &BITS(&NBITS)                                            00534\n         AIF   (&S LT 0).ERR                                            00535\n         AIF   (&S GT 7).ERR                                            00536\n&B(&S+1) SETA  1                                                        00537\n&NBITS   SETA  &NBITS-1                                                 00538\n         AIF   (&NBITS GT 0).LOOP                                       00539\n&N       NI    &FIELD,X'FF'-B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)' 00540\n         MEXIT                                                          00541\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00542\n         MEND                                                           00543\n         MACRO                                                          00544\n&N       XCH   &A,&B                                                    00545\n&N       XC    &A,&B                                                    00546\n         XC    &B,&A                                                    00547\n         XC    &A,&B                                                    00548\n         MEND                                                           00549\n         MACRO                                                          00550\n&N       XCHR  &A,&B                                                    00551\n&N       XR    &A,&B                                                    00552\n         XR    &B,&A                                                    00553\n         XR    &A,&B                                                    00554\n         MEND                                                           00555\n         MACRO                                                          00556\n&N       ZR    &R                                                       00557\n&N       SR    &R,&R                                                    00558\n         MEND                                                           00559\n         MACRO                                                          00560\n&N       AAI   &R,&I                                                    00561\n         AIF   (&I LT 1).ERR                                            00562\n         AIF   (&I GT 32767).ERR                                        00563\n         XREFI &I                                                       00564\n         AIF   (&I GT 4095).AHI                                         00565\n&N       LA    &R,#&I.(&R)                                              00566\n         MEXIT                                                          00567\n.AHI     ANOP                                                           00568\n&N       AH    &R,*+6                                                   00569\n         DC    X'4700',AL2(#&I)                                         00570\n         MEXIT                                                          00571\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00572\n         MEND                                                           00573\n         MACRO                                                          00574\n&N       SRC   &R                                                       00575\n         LTR   &R,&R                                                    00576\n         MEND                                                           00577\n         MACRO                                                          00578\n&N       ZHB   &R                                                       00579\n&N       LA    &R,0(&R)                                                 00580\n         MEND                                                           00581\n         MACRO                                                          00582\n         SPOOLDAT                                                       00583\n.*             AUTHOR.   DON HIGGINS.                                   00584\n.*             DATE.     03/12/73.                                      00585\n.*             REMARKS.  DEFINE HASP 3.1 CHECKPOINT DATA AREAS ON 2314. 00586\n.*             REFERENCES.                                              00587\n.*                 1.    GY27-7255 HASP V4 PLM                          00588\n.*                 2.    GC27-6992 HASP SYS. PGMR. GUIDE                00589\n.*                 3.    SEE GU019800 FOR SAMPLE PROGRAM USING THIS.    00590\n.*             REV1 01/28/74 - REVISE FOR 3330 DISKS.                   00591\n.*             REV2 01/09/75 - REVISE FOR HASP V4.0 (VS2-R1.7)          00592\n*              REV3 /                                                   00593\n*              REV3 03/15/76 DSH - MAKE CHECKPOINT MTTRS RELATIVE       00594\n*                                                                       00595\n*              THE FOLLOWING STATEMENTS MUST PRECEED THIS MACRO         00596\n*                                                                       00597\n*              COPY $GLOBAL                                             00598\n*              COPY $HASPGEN                                            00599\n*              $HASPCB JOT,PRC (OTHER CONTROL BLOCKS ARE OPTIONAL)      00600\n*                                                                       00601\n*              SEE GY27-7255 HASP PLM 7-49 FOR FURTHER INFO.            00602\n*                                                                       00603\n         GBLA  &MAXJOBS  MAXIMUM JOBS ALLOWED IN HASP SYSTEM AT ONCE    00604\n         GBLA  &NUMPRC   NUMBER OF PRINT/PUNCH CHECKPOINT RECORDS       00605\n         GBLA  &JITSIZE  JOB INFORMATION TABLE ELEMENT SIZE             00606\n*                                                                       00607\n*              CHECKPOINT MTTRS                                         00608\n*                                                                       00609\n*                   THESE MTTRS ARE CODED AS RELATIVE TRACK AND         00610\n*                   ARE CONVERTED TO ABSOLUTE TRACK BY HASPXDAP         00611\n*                   (GU019600) ON FIRST CALL.                           00612\n*                   HIGH BIT ON INDICATES RELATIVE TRACK.               00613\n*                                                                       00614\nCKP1MTTR DC    X'80000001'    JOBQUE AND MISC. ON FIRST TRACK           00615\nCKP2MTTR DC    X'80000101'    JIT                                       00616\nCKP3MTTR DC    X'80000201'    JOT                                       00617\n*                                                                       00618\n*              CHECKPOINT RECORD AREAS                                  00619\n*                                                                       00620\nCKP1REC  DS    0D        JOB QUEUE AND MISC INFO                        00621\n$JOBQUE  DC    (&MAXJOBS)XL16'00'                                       00622\n$SAVEBEG DS    0F                                                       00623\n$JOBQPTR DC    A(*-*)    CORE ADDRESS OF HASP JOB QUEUE                 00624\n$JQFREE  DC    A(*-*)    FREE QUEUE CHAIN                               00625\n$JQENT   DC    A(*-*)    ACTIVE QUEUE CHAIN                             00626\n$DATAKEY DC    F'0'      MASTER PERIPHERAL DATA SET KEY                 00627\n$JOBNO   DC    H'0'      HASP JOB NUMBER                                00628\n$MSGRPNO DC    H'0'      LAST CONSOLE MESSAGE TRACK GROUP               00629\n$DACKPT  DC    1XL6'0'   DA CHECKPOINT FOR WARM START                   00630\n$SAVEEND EQU   *                                                        00631\n$SAVELEN EQU   $SAVEEND-$SAVEBEG                                        00632\n$PRCRECS DC    (&NUMPRC)XL(PRCSIZE)'00'                                 00633\nCKP1LNG  EQU   *-CKP1REC                                                00634\nCKP2REC  DS    0D        JOB INFORMATION TABLE                          00635\n$JIT     DC    (&MAXJOBS)XL(&JITSIZE)'00'                               00636\nCKP2LNG  EQU   *-CKP2REC                                                00637\nCKP3REC  DS    0D        JOB OUTPUT TABLE                               00638\n$JOTREC  DC    (JOTSIZE)X'00'                                           00639\nCKP3LNG  EQU   *-CKP3REC                                                00640\n         MEND                                                           00641\n         MACRO                                                          00642\n&N       XCP   &IOB,&CCW,&ERR                                           00643\n&N       LA    R0,&CCW                                                  00644\n         ST    R0,&IOB+16                                               00645\n         EXCP  &IOB                                                     00646\n         L     R1,&IOB+4                                                00647\n         WAIT  ECB=(1)                                                  00648\n         TM    &IOB+12,X'03'                                            00649\n         BNZ   &ERR                                                     00650\n         TM    &IOB+13,X'FF'                                            00651\n         BNZ   &ERR                                                     00652\n         MEND                                                           00653\n         MACRO                                                          00654\n&N       MC    &S1,&I2                                                  00655\n&N       CLI   &S1,&I2                                                  00656\n         ORG   *-4                                                      00657\n         DC    X'AF'                                                    00658\n         ORG   *+3                                                      00659\n         MEND                                                           00660\n         MACRO                                                          00661\n&N       CDS   &R1,&R3,&S                                               00662\n&N       LM    &R1,&R3,&S                                               00663\n         ORG   *-4                                                      00664\n         DC    X'BB'                                                    00665\n         ORG   *+3                                                      00666\n         MEND                                                           00667\n         MACRO                                                          00668\n&N       CS    &R1,&R3,&S2                                              00669\n&N       LM    &R1,&R3,&S2                                              00670\n         ORG   *-4                                                      00671\n         DC    X'BA'                                                    00672\n         ORG   *+3                                                      00673\n         MEND                                                           00674\n         MACRO                                                          00675\n         IF                                                             00676\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00677\n         GBLA  &ELSEIF(10)                                              00678\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     00679\n         LCLC  &OP,&OPR                                                 00680\n         LCLB  &TESTSW                                                  00681\n.*             AUTHOR.   DON HIGGINS.                                   00682\n.*             DATE.     03/27/74.                                      00683\n.*             REMARKS.  CONTROL STRUCTURE FOR CONDITIONAL EXECUTION.   00684\n.*             REV1 05/23/76 DSH - SUPPORT ELSEIF.                      00685\n         AIF   (&LEVEL EQ 10).ERR1                                      00686\n&LEVEL   SETA  &LEVEL+1                                                 00687\n&ELSEIF(&LEVEL) SETA 0                                                  00688\n&SEQ(&LEVEL) SETA 1                                                     00689\n&LAB     SETA  &LAB+1                                                   00690\n&ELSE(&LEVEL) SETA &LAB                                                 00691\n&N       SETA N'&SYSLIST                                                00692\n.NEXTAND ANOP                                                           00693\n&TESTSW  SETB  0                                                        00694\n.TEST    ANOP                                                           00695\n&S       SETA  &S+1                                                     00696\n         AIF   (&S GT &N).ERR2                                          00697\n&M       SETA  N'&SYSLIST(&S)                                           00698\n         AIF   (&M EQ 1).TESTEND                                        00699\n         AIF   (&M LT 2).ERR3                                           00700\n         AIF   (&M GT 5).ERR4                                           00701\n&I       SETA  2                                                        00702\n&OPR     SETC  ''                                                       00703\n&OP      SETC  '&SYSLIST(&S,1)'                                         00704\n         AIF   (&M GT 2).TESTOPR                                        00705\n         &OP                                                            00706\n         AGO   .TESTEND                                                 00707\n.TESTOPR ANOP                                                           00708\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   00709\n&L       SETA  K'&SYSLIST(&S,&I)                                        00710\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         00711\n         AGO   .NEXTOPR                                                 00712\n.NOLIT   ANOP                                                           00713\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 00714\n.NEXTOPR ANOP                                                           00715\n&I       SETA  &I+1                                                     00716\n         AIF   (&I EQ &M).TESTGEN                                       00717\n&OPR     SETC  '&OPR'.','                                               00718\n         AGO   .TESTOPR                                                 00719\n.TESTGEN ANOP                                                           00720\n         &OP   &OPR                                                     00721\n.TESTEND ANOP                                                           00722\n         AIF   (&TESTSW EQ 1).ORBC                                      00723\n.AMBC    ANOP                                                           00724\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00725\n.CONNECT ANOP                                                           00726\n&S       SETA  &S+1                                                     00727\n         AIF   (&S GT &N).EXIT                                          00728\n&M       SETA  N'&SYSLIST(&S)                                           00729\n         AIF   (&M NE 1).ERR5  BAD CONNECTOR                            00730\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        00731\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR5  BAD CONNECTOR             00732\n.NEXTOR   ANOP                                                          00733\n&LAB1    SETA  &LAB+1                                                   00734\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     00735\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      00736\n&LAB     SETA  &LAB+2                                                   00737\n&ELSE(&LEVEL) SETA &LAB                                                 00738\n&TESTSW  SETB  1                                                        00739\n         AGO   .TEST                                                    00740\n.ORBC    ANOP                                                           00741\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00742\nIF0&LAB1 EQU *                                                          00743\n         AGO   .CONNECT                                                 00744\n.ERR1    MNOTE 8,'IF - LEVEL OVERFLOW'                                  00745\n         AGO   .EXIT                                                    00746\n.ERR2    MNOTE 8,'IF - MISSING TEST LIST'                               00747\n         AGO   .EXIT                                                    00748\n.ERR3    MNOTE 8,'IF - TEST LIST TOO SHORT'                             00749\n         AGO   .EXIT                                                    00750\n.ERR4    MNOTE 8,'IF - TEST LIST TOO LONG'                              00751\n         AGO   .EXIT                                                    00752\n.ERR5    MNOTE 8,'IF - INVALID CONNECTOR'                               00753\n.EXIT    ANOP                                                           00754\n         MEND                                                           00755\n         MACRO                                                          00756\n         THEN  &OPT                                                     00757\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00758\n.*             AUTHOR.   DON HIGGINS.                                   00759\n.*             DATE.     03/27/74.                                      00760\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00761\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00762\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00763\n         AIF   (&LEVEL EQ 0).ERR0                                       00764\n         AIF   ('&OPT' EQ 'BEGIN').BEGIN                                00765\n         AIF   ('&OPT' EQ 'END').END                                    00766\n         MNOTE 4,'THEN - INVALID OPERAND - IGNORED'                     00767\n         AGO   .EXIT                                                    00768\n.BEGIN   ANOP                                                           00769\n         AIF   (&SEQ(&LEVEL) NE 1).ERR1                                 00770\n&SEQ(&LEVEL) SETA 2                                                     00771\n         AGO   .EXIT                                                    00772\n.END     ANOP                                                           00773\n         AIF   (&SEQ(&LEVEL) NE 2).ERR2                                 00774\n&SEQ(&LEVEL) SETA 3                                                     00775\n         AGO   .EXIT                                                    00776\n.ERR0    MNOTE 8,'THEN - MISSING IF'                                    00777\n         AGO   .EXIT                                                    00778\n.ERR1    MNOTE 4,'THEN BEGIN - OUT OF SEQUENCE'                         00779\n         AGO   .EXIT                                                    00780\n.ERR2    MNOTE 4,'THEN END - OUT OF SEQUENCE'                           00781\n.EXIT    ANOP                                                           00782\n         MEND                                                           00783\n         MACRO                                                          00784\n         ELSE  &OPT                                                     00785\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00786\n         GBLA  &ELSEIF(10)                                              00787\n.*             AUTHOR.   DON HIGGINS.                                   00788\n.*             DATE.     03/27/74.                                      00789\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00790\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00791\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00792\n.*             REV1 05/23/76 DSH - SUPPORT ELSEIF                       00793\n         AIF   (&LEVEL EQ 0).ERR0                                       00794\n         AIF   (T'&OPT EQ 'O').BEGIN                                    00795\n         AIF   ('&OPT' EQ 'BEGIN').BEGIN                                00796\n         AIF   ('&OPT' EQ 'END').END                                    00797\n         AIF   ('&OPT' EQ 'CONTINUE').CONT                              00798\n         MNOTE 8,'ELSE - INVALID OPERAND'                               00799\n         AGO   .EXIT                                                    00800\n.BEGIN   ANOP                                                           00801\n         AIF   (&SEQ(&LEVEL) GT 3).ERR1                                 00802\n&LAB     SETA  &LAB+1                                                   00803\n         B     IF0&LAB                                                  00804\nIF0&ELSE(&LEVEL) EQU *                                                  00805\n&ELSE(&LEVEL) SETA &LAB                                                 00806\n&SEQ(&LEVEL) SETA 4                                                     00807\n         AGO .EXIT                                                      00808\n.END     ANOP                                                           00809\n         AIF   (&SEQ(&LEVEL) NE 4).ERR2                                 00810\n.DEQUE   ANOP                                                           00811\nIF0&ELSE(&LEVEL) EQU *                                                  00812\n&LEVEL   SETA &LEVEL-1                                                  00813\n         AIF   (&ELSEIF(&LEVEL+1) EQ 1).DEQUE                           00814\n         AGO   .EXIT                                                    00815\n.CONT    ANOP                                                           00816\n         AIF   (&SEQ(&LEVEL) GT 3).ERR3                                 00817\n         AGO   .DEQUE                                                   00818\n.ERR0    MNOTE 8,'ELSE - MISSING IF'                                    00819\n         AGO   .EXIT                                                    00820\n.ERR1    MNOTE 8,'ELSE BEGIN - OUT OF SEQUENCE'                         00821\n         AGO   .EXIT                                                    00822\n.ERR2    MNOTE 8,'ELSE END - OUT OF SEQUENCE'                           00823\n         AGO   .EXIT                                                    00824\n.ERR3    MNOTE 8,'ELSE CONTINUE - OUT OF SEQUENCE'                      00825\n.EXIT    ANOP                                                           00826\n         MEND                                                           00827\n         MACRO                                                          00828\n         DO                                                             00829\n         GBLA  &DO(10),&DOSEQ(10),&DOLVL,&DOLAB                         00830\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00831\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     00832\n         LCLA  &UNTIL                                                   00833\n         LCLC  &OP,&OPR                                                 00834\n         LCLB  &TESTSW                                                  00835\n.*             AUTHOR.   DON HIGGINS.                                   00836\n.*             DATE.     03/27/74.                                      00837\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00838\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00839\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00840\n         AIF   (&DOLVL EQ 10).ERR1                                      00841\n&N       SETA  N'&SYSLIST                                               00842\n         AIF   (&N LT 1).ERR2                                           00843\n         AIF   ('&SYSLIST(1)' EQ 'END').END                             00844\n         AIF   ('&SYSLIST(1)' EQ 'FOREVER').WHILE                       00845\n         AIF   (&N LT 2).ERR2                                           00846\n         AIF   ('&SYSLIST(1)' EQ 'WHILE').WHILE                         00847\n         AIF   ('&SYSLIST(1)' NE 'UNTIL').ERR3                          00848\n.UNTIL   ANOP                                                           00849\n&DOLVL   SETA  &DOLVL+1                                                 00850\n&UNTIL   SETA  &DOLAB+1                                                 00851\n&DOLAB   SETA  &DOLAB+2                                                 00852\n         B     DO&UNTIL                                                 00853\n         AGO   .COMM                                                    00854\n.WHILE   ANOP                                                           00855\n&DOLVL   SETA  &DOLVL+1                                                 00856\n&DOLAB   SETA  &DOLAB+1                                                 00857\n.COMM    ANOP                                                           00858\n&DOSEQ(&DOLVL) SETA 1                                                   00859\n&DO(&DOLVL) SETA &DOLAB                                                 00860\nDO&DOLAB EQU   *                                                        00861\n         AIF   (&LEVEL EQ 10).ERR1                                      00862\n&LEVEL   SETA  &LEVEL+1                                                 00863\n&SEQ(&LEVEL) SETA 1                                                     00864\n&LAB     SETA  &LAB+1                                                   00865\n&ELSE(&LEVEL) SETA &LAB                                                 00866\n         AIF   ('&SYSLIST(1)' EQ 'FOREVER').EXIT                        00867\n&S       SETA  1                                                        00868\n.NEXTAND ANOP                                                           00869\n&TESTSW  SETB  0                                                        00870\n.TEST    ANOP                                                           00871\n&S       SETA  &S+1                                                     00872\n         AIF   (&S GT &N).ERR2                                          00873\n&M       SETA  N'&SYSLIST(&S)                                           00874\n         AIF   (&M LT 2).ERR3                                           00875\n         AIF   (&M GT 5).ERR3                                           00876\n&I       SETA  2                                                        00877\n&OPR     SETC  ''                                                       00878\n&OP      SETC  '&SYSLIST(&S,1)'                                         00879\n         AIF   (&M GT 2).TESTOPR                                        00880\n         &OP                                                            00881\n         AGO   .TESTEND                                                 00882\n.TESTOPR ANOP                                                           00883\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   00884\n&L       SETA  K'&SYSLIST(&S,&I)                                        00885\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         00886\n         AGO   .NEXTOPR                                                 00887\n.NOLIT   ANOP                                                           00888\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 00889\n.NEXTOPR ANOP                                                           00890\n&I       SETA  &I+1                                                     00891\n         AIF   (&I EQ &M).TESTGEN                                       00892\n&OPR     SETC  '&OPR'.','                                               00893\n         AGO   .TESTOPR                                                 00894\n.TESTGEN ANOP                                                           00895\n         &OP   &OPR                                                     00896\n.TESTEND ANOP                                                           00897\n         AIF   (&TESTSW EQ 1).ORBC                                      00898\n.AMBC    ANOP                                                           00899\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00900\n.CONNECT ANOP                                                           00901\n&S       SETA  &S+1                                                     00902\n         AIF   (&S GT &N).CHKUNTL                                       00903\n&M       SETA  N'&SYSLIST(&S)                                           00904\n         AIF   (&M NE 1).ERR3  BAD CONNECTOR                            00905\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        00906\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR3  BAD CONNECTOR             00907\n.NEXTOR   ANOP                                                          00908\n&LAB1    SETA  &LAB+1                                                   00909\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     00910\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      00911\n&LAB     SETA  &LAB+2                                                   00912\n&ELSE(&LEVEL) SETA &LAB                                                 00913\n&TESTSW  SETB  1                                                        00914\n         AGO   .TEST                                                    00915\n.ORBC    ANOP                                                           00916\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00917\nIF0&LAB1 EQU *                                                          00918\n         AGO   .CONNECT                                                 00919\n.CHKUNTL ANOP                                                           00920\n         AIF   (&UNTIL EQ 0).EXIT                                       00921\n&LAB     SETA  &LAB+1                                                   00922\n         B     IF0&LAB                                                  00923\nIF0&ELSE(&LEVEL) EQU *                                                  00924\n&ELSE(&LEVEL) SETA &LAB                                                 00925\nDO&UNTIL EQU *                                                          00926\n         AGO   .EXIT                                                    00927\n.END     ANOP                                                           00928\n         AIF   (&N GT 1).ERR3                                           00929\n         AIF   (&DOLVL EQ 0).ERR4                                       00930\n         AIF   (&DOSEQ(&DOLVL) NE 1).ERR4                               00931\n&DOSEQ(&DOLVL) SETA 0                                                   00932\n         B     DO&DO(&DOLVL)                                            00933\n&DOLVL   SETA  &DOLVL-1                                                 00934\nIF0&ELSE(&LEVEL) EQU *                                                  00935\n&LEVEL   SETA  &LEVEL-1                                                 00936\n         AGO   .EXIT                                                    00937\n.ERR1    MNOTE 8,'DO - LEVEL OVERFLOW'                                  00938\n         AGO   .EXIT                                                    00939\n.ERR2    MNOTE 8,'DO - MISSING OPERAND'                                 00940\n         AGO   .EXIT                                                    00941\n.ERR3    MNOTE 8,'DO - INVALID OPERAND'                                 00942\n         AGO   .EXIT                                                    00943\n.ERR4    MNOTE 8,'DO - END OUT OF SEQUENCE'                             00944\n.EXIT    ANOP                                                           00945\n         MEND                                                           00946\n         MACRO                                                          00947\n         EQUBC                                                          00948\nH        EQU   2                                                        00949\nL        EQU   4                                                        00950\nE        EQU   8                                                        00951\nNH       EQU   13                                                       00952\nNL       EQU   11                                                       00953\nNE       EQU   7                                                        00954\nO        EQU   1                                                        00955\nP        EQU   2                                                        00956\nM        EQU   4                                                        00957\nZ        EQU   8                                                        00958\nNP       EQU   13                                                       00959\nNM       EQU   11                                                       00960\nNZ       EQU   7                                                        00961\nNO       EQU   14                                                       00962\nEQ       EQU   8                                                        00963\nGT       EQU   2                                                        00964\nLT       EQU   4                                                        00965\nGE       EQU   11                                                       00966\nLE       EQU   13                                                       00967\n         MEND                                                           00968\n         MACRO                                                          00969\n&N       FI                                                             00970\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00971\n         AIF   (&SEQ(&LEVEL) NE 4).CONT                                 00972\n&N       ELSE  END                                                      00973\n         MEXIT                                                          00974\n.CONT    ANOP                                                           00975\n&N       ELSE  CONTINUE                                                 00976\n         MEND                                                           00977\n         MACRO                                                          00978\n&N       PM    &PENTRY                                                  00979\n&N       MVC   &PENTRY-2(2),*+10                                        00980\n         B     &PENTRY                                                  00981\n         DC    S(*+2)                                                   00982\n         MEND                                                           00983\n         MACRO                                                          00984\n&N       OD                                                             00985\n&N       DO    END                                                      00986\n         MEND                                                           00987\n         MACRO                                                          00988\n&N       DOCASE &INDEX                                                  00989\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       00990\n.*             AUTHOR.   DON HIGGINS.                                   00991\n.*             DATE.     07/02/74.                                      00992\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   00993\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            00994\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         00995\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          00996\n         AIF   (T'&INDEX EQ 'U').REG                                    00997\n&N       ZR    R15                                                      00998\n         IC    R15,&INDEX                                               00999\n         AGO   .PROC                                                    01000\n.REG     ANOP                                                           01001\n&N       LR    R15,&INDEX                                               01002\n.PROC    ANOP                                                           01003\n         AIF   (&DOCLVL EQ 10).ERR1                                     01004\n&DOCLVL  SETA  &DOCLVL+1                                                01005\n&DOCNT   SETA  &DOCNT+1                                                 01006\n&DOCNO(&DOCLVL) SETA &DOCNT                                             01007\n&CASENO(&DOCLVL) SETA 0                                                 01008\n&DOCELSE(&DOCLVL) SETA 0                                                01009\n         IC    R15,CASEI&DOCNO(&DOCLVL).(R15)                           01010\n         L     R15,CASEA&DOCNO(&DOCLVL).(R15)                           01011\n         BR    R15                                                      01012\nCASEI&DOCNO(&DOCLVL) DC 256X'00'                                        01013\n         MEXIT                                                          01014\n.ERR1    MNOTE 8,'DOCASE NESTED LEVELS EXCEEDED'                        01015\n         MEND                                                           01016\n         MACRO                                                          01017\n         CASE                                                           01018\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01019\n         LCLA  &N,&M,&L,&H                                              01020\n.*             AUTHOR.   DON HIGGINS.                                   01021\n.*             DATE.     07/02/74.                                      01022\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01023\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01024\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01025\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01026\n.*             REV1 05/24/76 DSH - ALLOW SYMBOLIC FOR CASE VALUE.       01027\n         AIF   (&DOCLVL LT 1).ERR1                                      01028\n&N       SETA  N'&SYSLIST                                               01029\n         AIF   (&N GT 1).CHKN                                           01030\n&N       SETA  N'&SYSLIST(1)                                            01031\n         AIF   (&N GT 1).CHKN                                           01032\n         AIF   ('&SYSLIST(1)' EQ 'ELSE').ELSE                           01033\n         AIF   ('&SYSLIST(1)' NE 'MISC').CHKN                           01034\n.ELSE    AIF   (&DOCELSE(&DOCLVL) GT 0).ERR3                            01035\n&DOCELSE(&DOCLVL) SETA 1                                                01036\nDC&DOCNO(&DOCLVL)ELSE DS 0H                                             01037\n         MEXIT                                                          01038\n.CHKN    ANOP                                                           01039\n         AIF   (&CASENO(&DOCLVL) EQ 63).ERR7                            01040\n&CASENO(&DOCLVL) SETA &CASENO(&DOCLVL)+1                                01041\n.MLOOP   ANOP                                                           01042\n&M       SETA  &M+1                                                     01043\n         AIF   (&M GT &N).GENL                                          01044\n&L       SETA  N'&SYSLIST(&M)                                           01045\n         AIF   (&L LT 1).MLOOP                                          01046\n         AIF   (&L GT 2).ERR4                                           01047\n         AIF   (&L EQ 1).GEN1                                           01048\n         AIF   (T'&SYSLIST(&M,1) NE 'N').ERR5                           01049\n         AIF   (T'&SYSLIST(&M,2) NE 'N').ERR5                           01050\n&L       SETA  &SYSLIST(&M,1)                                           01051\n&H       SETA  &SYSLIST(&M,2)                                           01052\n         AIF   (&L GT &H).ERR6                                          01053\n         AIF   (&H GT 255).ERR6                                         01054\n         AIF   (&L LT 1).ERR6                                           01055\n         ORG   CASEI&DOCNO(&DOCLVL)+&L                                  01056\n         DC    (&H-&L+1)AL1(&CASENO(&DOCLVL)*4)                         01057\n         AGO   .MLOOP                                                   01058\n.GEN1    ANOP                                                           01059\n         ORG   CASEI&DOCNO(&DOCLVL)+&SYSLIST(&M)                        01060\n         DC    AL1(&CASENO(&DOCLVL)*4)                                  01061\n         AGO   .MLOOP                                                   01062\n.GENL    ANOP                                                           01063\n         ORG                                                            01064\nDC&DOCNO(&DOCLVL)C&CASENO(&DOCLVL) DS 0H                                01065\n         MEXIT                                                          01066\n.ERR1    MNOTE 8,'CASE - MISSING DOCASE'                                01067\n         MEXIT                                                          01068\n.ERR2    MNOTE 8,'CASE - INVALID OPERAND'                               01069\n         MEXIT                                                          01070\n.ERR3    MNOTE 8,'CASE - DUPLICATE ELSE CASE'                           01071\n         MEXIT                                                          01072\n.ERR4    MNOTE 8,'CASE - MORE THAN 2 SUBLIST OPERANDS'                  01073\n         MEXIT                                                          01074\n.ERR5    MNOTE 8,'CASE - OPERAND NOT SELF DEFINING TERM'                01075\n         MEXIT                                                          01076\n.ERR6    MNOTE 8,'CASE - OPERAND NOT IN RANGE 1-255'                    01077\n         MEXIT                                                          01078\n.ERR7    MNOTE 8,'CASE - MAXIMUM OF 63 CASES EXCEEDED'                  01079\n         MEXIT                                                          01080\n         MEND                                                           01081\n         MACRO                                                          01082\n&N       ESAC                                                           01083\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01084\n.*             AUTHOR.   DON HIGGINS.                                   01085\n.*             DATE.     07/02/74.                                      01086\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01087\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01088\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01089\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01090\n&N       B     DC&DOCNO(&DOCLVL).END                                    01091\n         MEND                                                           01092\n         MACRO                                                          01093\n         ESACOD                                                         01094\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01095\n.*             AUTHOR.   DON HIGGINS.                                   01096\n.*             DATE.     07/02/74.                                      01097\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01098\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01099\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01100\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01101\n         LCLA  &C                                                       01102\n         AIF   (&DOCLVL LT 1).ERR1                                      01103\nCASEA&DOCNO(&DOCLVL) DS 0F                                              01104\n         AIF   (&DOCELSE(&DOCLVL) GT 0).GENELSE                         01105\n         DC    A(DC&DOCNO(&DOCLVL).END)                                 01106\n         AGO   .GENCASE                                                 01107\n.GENELSE ANOP                                                           01108\n         DC    A(DC&DOCNO(&DOCLVL).ELSE)                                01109\n.GENCASE ANOP                                                           01110\n&C       SETA  &C+1                                                     01111\n         AIF   (&C GT &CASENO(&DOCLVL)).GEND                            01112\n         DC    A(DC&DOCNO(&DOCLVL).C&C)                                 01113\n         AGO   .GENCASE                                                 01114\n.GEND    ANOP                                                           01115\nDC&DOCNO(&DOCLVL).END EQU *                                             01116\n&DOCLVL SETA &DOCLVL-1                                                  01117\n         MEXIT                                                          01118\n.ERR1    MNOTE 8,'ESACOD - MISSING DOCASE'                              01119\n         MEND                                                           01120\n         MACRO                                                          01121\n&NAME    LOGICAL                                                        01122\n.*             PGMID.    LOGICAL VARIABLE DEFINITION AND ENUMERATION    01123\n.*             AUTHOR.   DON HIGGINS.                                   01124\n.*             DATE.     09/27/74.                                      01125\n.*             REMARKS.  DEFINES A LOGICAL VARIABLE AS A ONE BYTE       01126\n.*                       AL1 FIELD WITH AN INITIAL VALUE AND STORES     01127\n.*                       IN GLOBAL TABLE POSSIBLE VALUES BY NAME.       01128\n.*                       ALL NAMES ARE EQUATED TO UNIQUE VALUES FOR     01129\n.*                       USE IN TEST AND SET STATEMENTS.                01130\n         GBLC  &LOGICN(100)                                             01131\n         GBLA  &LOGICV                                                  01132\n         LCLA  &N,&S,&SL                                                01133\n&N       SETA  N'&SYSLIST(2)                                            01134\n.L1      ANOP                                                           01135\n&S       SETA  &S+1                                                     01136\n         AIF   (&S GT &N).GENDC                                         01137\n&SL      SETA  0                                                        01138\n.L2      ANOP                                                           01139\n&SL      SETA  &SL+1                                                    01140\n         AIF   (&SL GT &LOGICV).GENEQU                                  01141\n         AIF   ('&SYSLIST(2,&S)' EQ '&LOGICN(&SL)').L1                  01142\n         AGO   .L2                                                      01143\n.GENEQU  ANOP                                                           01144\n&LOGICV  SETA  &LOGICV+1                                                01145\n&LOGICN(&LOGICV) SETC '&SYSLIST(2,&S)'                                  01146\n&SYSLIST(2,&S) EQU &LOGICV                                              01147\n         AGO   .L1                                                      01148\n.GENDC   ANOP                                                           01149\n&NAME    DC    AL1(&SYSLIST(1))                                         01150\n         MEND                                                           01151\n         MACRO                                                          01152\n&VLABEL  DCWV  &VNAME                                                   01153\n.*             AUTHOR.   DON HIGGINS.                                   01154\n.*             DATE.     11/03/74.                                      01155\n.*             REMARKS.  DEFINE VERY WEAK V TYPE ADDRESS WHICH IS       01156\n.*                       SET BY DYNAMICALLY LOADING NAMED MODULE        01157\n.*                       THE FIRST TIME THE V ADDRESS IS USED.          01158\nDCWV&SYSNDX DS 0H                                                       01159\n         USING DCWV&SYSNDX,R15     ENTER HERE ON FIRST USE OF VLABEL    01160\n         STM   R14,R2,&VLABEL+12   SAVE REGS USED BY LOAD               01161\n         LR    R2,R15              NEW BASE                             01162\n         DROP  R15                                                      01163\n         USING DCWV&SYSNDX,R2                                           01164\n         FINDCDE EPLOC=&VLABEL+4                                        01165\n         IF    (LTR,R1,R1,Z)                                            01166\n               LOAD EPLOC=&VLABEL+4                                     01167\n         ELSE                                                           01168\n               L    R0,16(R1) GET CDE ENTRY                             01169\n         FI                                                             01170\n         ST    R0,&VLABEL          STORE ENTRY POINT IN VLABEL          01171\n         LR    R15,R0              SET R15 TO CORRECT ENTRY POINT       01172\n         L     R14,&VLABEL+12      RESTORE REGS                         01173\n         LM    R0,R2,&VLABEL+20                                         01174\n         BR    R15                 ENTER VNAME FIRST TIME               01175\n&VLABEL  DC    A(DCWV&SYSNDX)      VERY WEAK V ADDRESS                  01176\n         DC    CL8'&VNAME'         NAME OF MODULE                       01177\n         DC    5F'0'               SAVE AREA                            01178\n         MEND                                                           01179\n         MACRO                                                          01180\n&N       LOADTCB &R                                                     01181\n&N       L     &R,16     CVT                                            01182\n         L     &R,0(&R)  TCB WORDS                                      01183\n         L     &R,4(&R)  TCB                                            01184\n         MEND                                                           01185\n         MACRO                                                          01186\n&N       LOADTIOT &R                                                    01187\n&N       LOADTCB &R                                                     01188\n         L     &R,12(&R) TIOT ADDRESS FROM TCB                          01189\n         MEND                                                           01190\n         MACRO                                                          01191\n&N       FINDDD &DDNAME                                                 01192\n.*             AUTHOR.   DON HIGGINS.                                   01193\n.*             DATE.     11/06/74.                                      01194\n.*             REMARKS.  SET R1 TO ADDRESS OF TIOT DDNAME ENTRY OR 0.   01195\n.*             EXAMPLE.  FINDDD =CL8'CALLLIB'                           01196\n&N       LOADTIOT R14                                                   01197\n         AAI   R14,24                                                   01198\n         LA    R15,&DDNAME                                              01199\n         ZR    R0                                                       01200\n         ZR    R1                                                       01201\n         IC    R0,0(R14)                                                01202\n         DO    WHILE,(LTR,R0,R0,P)                                      01203\n               IF   (CLC,4(8,R14),0(R15),EQ)                            01204\n                    LR   R1,R14                                         01205\n                    ZR   R0                                             01206\n               ELSE                                                     01207\n                    AR   R14,R0                                         01208\n                    IC   R0,0(R14)                                      01209\n               FI                                                       01210\n         OD                                                             01211\n         MEND                                                           01212\n         MACRO                                                          01213\n&NAME    ACCEPT &REC,&DDNAME=SYSIN                                      01214\n.*             AUTHOR.   DON HIGGINS.                                   01215\n.*             DATE.     11/19/74.                                      01216\n.*             REMARKS.  ACCEPT RECORD IF DD AVAILABLE.                 01217\n.*                       REC MAY GE REGISTER OR LABEL OF RECORD AREA.   01218\n.*                      R15=0 SUCCESSFUL READ.                          01219\n.*                      R15=4 EOF OR NO DD FOUND.                       01220\n&NAME    TAG                                                            01221\nACC1&SYSNDX B  *+4                                                      01222\n         FINDDD =CL8'&DDNAME'                                           01223\n         IF    (LTR,R1,R1,Z)                                            01224\n               WTO  '&DDNAME NOT FOUND'                                 01225\nACC2&SYSNDX    LA   R15,4                                               01226\n               MVC  ACC1&SYSNDX+2(2),=S(ACC2&SYSNDX)                    01227\n               B    ACC4&SYSNDX                                         01228\n         FI                                                             01229\n         MVC   ACC1&SYSNDX+2(2),=S(ACC3&SYSNDX)                         01230\n         OPEN  (&DDNAME)                                                01231\n         B     ACC3&SYSNDX                                              01232\n&DDNAME  DCB   DSORG=PS,MACRF=GL,DDNAME=&DDNAME,EODAD=ACC2&SYSNDX       01233\nACC3&SYSNDX GET &DDNAME                                                 01234\n         AIF   ('&REC'(1,1) EQ '(').REG                                 01235\n         MVC   &REC,0(R1)                                               01236\n         ZR    R15                                                      01237\n         AGO   .EXIT                                                    01238\n.REG     ANOP                                                           01239\n         LR    &REC,R1                                                  01240\n         ZR    R15                                                      01241\n.EXIT    ANOP                                                           01242\nACC4&SYSNDX TAG                                                         01243\n         MEND                                                           01244\n         MACRO                                                          01245\n&NAME    DISPLAY &REC,&DDNAME=SYSOUT,&RECFM=FA,&BLKSIZE=133             01246\n.*             AUTHOR.   DON HIGGINS.                                   01247\n.*             DATE.     11/18/74.                                      01248\n.*             REMARKS.  DISPLAY RECORD IF DD AVAILABLE.                01249\n.*                       REC MAY BE REGISTER OR LABEL OF REC.           01250\n.*                      R15=0 IS SUCCESSFUL                             01251\n.*                      R15=4 NO DD FOUND                               01252\n&NAME    TAG                                                            01253\nDSP1&SYSNDX B  *+4                                                      01254\n         FINDDD =CL8'&DDNAME'                                           01255\n         IF    (LTR,R1,R1,Z)                                            01256\n               WTO  '&DDNAME NOT FOUND'                                 01257\n               MVC  DSP1&SYSNDX+2(2),=S(DSP2&SYSNDX)                    01258\nDSP2&SYSNDX    LA   R15,4                                               01259\n               B    DSP4&SYSNDX                                         01260\n         FI                                                             01261\n         MVC   DSP1&SYSNDX+2(2),=S(DSP3&SYSNDX)                         01262\n         OPEN  (&DDNAME,(OUTPUT))                                       01263\n         B     DSP3&SYSNDX                                              01264\n&DDNAME  DCB   DSORG=PS,MACRF=PM,DDNAME=&DDNAME,                       X01265\n               RECFM=&RECFM,BLKSIZE=&BLKSIZE                            01266\nDSP3&SYSNDX TAG                                                         01267\n         AIF   ('&REC'(1,1) EQ '(').REG                                 01268\n         LA    R0,&REC                                                  01269\n         AGO   .PUT                                                     01270\n.REG     ANOP                                                           01271\n         LR    R0,&REC                                                  01272\n.PUT     ANOP                                                           01273\n         PUT   &DDNAME                                                  01274\n         ZR    R15                                                      01275\nDSP4&SYSNDX TAG                                                         01276\n         MEND                                                           01277\n         MACRO                                                          01278\n&N      TPPUTMSG &TERM,&MSG,&LMSG                                       01279\n.*             AUTHOR.   DON HIGGINS.                                   01280\n.*             DATE.     11/27/74.                                      01281\n.*             REMARKS.  ROUTE TERMINAL MESSAGE TO TPPUT.               01282\n.*                            TERM - TERMINAL NAME FIELD OR LITERAL     01283\n.*                            MSG  - MESSAGE FIELD OR LITERAL           01284\n.*                            LMSG - FULL WORD BINARY LENGTH (OPTIONAL) 01285\n         LCLA  &L                                                       01286\n         CNOP  0,4                                                      01287\n&N       BAL   1,*+16                                                   01288\n.CHKT1   AIF   ('&TERM'(1,1) EQ '''').TERMLIT                           01289\n         DC    A(&TERM)                                                 01290\n         AGO   .CHKM1                                                   01291\n.TERMLIT ANOP                                                           01292\n         DC    A(0)                                                     01293\n.CHKM1   AIF   ('&MSG'(1,1) EQ '''').MSGLIT                             01294\n         DC    A(&MSG)                                                  01295\n         AGO   .CHKL                                                    01296\n.MSGLIT  ANOP                                                           01297\n         DC    A(0)                                                     01298\n.CHKL    AIF   (T'&LMSG EQ 'O').LCALC                                   01299\n         DC    A(&LMSG)                                                 01300\n         AGO   .CHKT2                                                   01301\n.LCALC   ANOP                                                           01302\n         DC    A(0)                                                     01303\n         AIF   ('&MSG'(1,1) EQ '''').LCALCL                             01304\n&L       SETA  L'&MSG                                                   01305\n         LA    0,=A(&L)                                                 01306\n         ST    0,8(1)                                                   01307\n         AGO   .CHKT2                                                   01308\n.LCALCL  ANOP                                                           01309\n&L       SETA  K'&MSG-2                                                 01310\n         LA    0,=A(&L)                                                 01311\n         ST    0,8(1)                                                   01312\n.CHKT2   AIF   ('&TERM'(1,1) NE '''').CHKM2                             01313\n         LA    0,=C&TERM                                                01314\n         ST    0,0(1)                                                   01315\n         AGO   .CALL                                                    01316\n.CHKM2   AIF   ('&MSG'(1,1) NE '''').CALL                               01317\n         LA    0,=C&MSG                                                 01318\n         ST    0,4(1)                                                   01319\n.CALL    ANOP                                                           01320\n         L     15,=V(TPPUT)                                             01321\n         BALR  14,15                                                    01322\n         MEND                                                           01323\n         MACRO                                                          01324\n&N       TRTTAB &TYPE,&BAD=X'FF',&GOOD=X'00',&SKIP=,&FIND=,&FILL=C' '   01325\n         AIF   ('&TYPE' EQ 'PRINT').PRINT                               01326\n         AIF   ('&TYPE' EQ 'NUMERIC').NUMERIC                           01327\n         AIF   ('&TYPE' EQ 'ALPHA').ALPHA                               01328\n         AIF   ('&TYPE' EQ 'ALPHANUM').ALPHAN                           01329\n         AIF   ('&TYPE' EQ 'ZFILL').ZFILL                               01330\n         AIF   ('&TYPE' EQ 'BAD').BAD                                   01331\n         AIF   ('&TYPE' EQ 'GOOD').GOOD                                 01332\n         AIF   ('&TYPE' EQ 'SCAN').SCAN                                 01333\n         MNOTE 8,'TABLE TYPE INVALID'                                   01334\n         MEXIT                                                          01335\n.PRINT   ANOP                                                           01336\n&N       DC    (X'49'-X'00'+1)&FILL                                     01337\n         DC    (X'50'-X'4A'+1)AL1(*-&N)                                 01338\n         DC    (X'59'-X'51'+1)&FILL                                     01339\n         DC    (X'61'-X'5A'+1)AL1(*-&N)                                 01340\n         DC    (X'6A'-X'62'+1)&FILL                                     01341\n         DC    (X'6F'-X'6B'+1)AL1(*-&N)                                 01342\n         DC    (X'79'-X'70'+1)&FILL                                     01343\n         DC    (X'7F'-X'7A'+1)AL1(*-&N)                                 01344\n         DC    (X'C0'-X'80'+1)&FILL                                     01345\n         DC    (X'C9'-X'C1'+1)AL1(*-&N)                                 01346\n         DC    (X'D0'-X'CA'+1)&FILL                                     01347\n         DC    (X'D9'-X'D1'+1)AL1(*-&N)                                 01348\n         DC    (X'E1'-X'DA'+1)&FILL                                     01349\n         DC    (X'E9'-X'E2'+1)AL1(*-&N)                                 01350\n         DC    (X'EF'-X'EA'+1)&FILL                                     01351\n         DC    (X'F9'-X'F0'+1)AL1(*-&N)                                 01352\n         DC    (X'FF'-X'FA'+1)&FILL                                     01353\n         MEXIT                                                          01354\n.NUMERIC ANOP                                                           01355\n&N       DC    240&BAD,10&GOOD,6&BAD                                    01356\n         MEXIT                                                          01357\n.ALPHA   ANOP                                                           01358\n&N       DC    193&BAD,9&GOOD,7&BAD,9&GOOD,8&BAD,8&GOOD                 01359\n         DC    22&BAD                                                   01360\n         MEXIT                                                          01361\n.ALPHAN  ANOP                                                           01362\n&N       DC    193&BAD,9&GOOD,7&BAD,9&GOOD,8&BAD,8&GOOD                 01363\n         DC    6&BAD,10&GOOD,6&BAD                                      01364\n         MEXIT                                                          01365\n.ZFILL   ANOP                                                           01366\n&N       DC    64AL1(*-&N),C'0',191AL1(*-&N)                            01367\n         MEXIT                                                          01368\n.BAD     ANOP                                                           01369\n&N       DC    256&BAD                                                  01370\n         MEXIT                                                          01371\n.GOOD    ANOP                                                           01372\n&N       DC    256&GOOD                                                 01373\n         MEXIT                                                          01374\n.SCAN    ANOP                                                           01375\n         AIF   (T'&SKIP NE 'O').SKIP                                    01376\n         AIF   (T'&FIND NE 'O').FIND                                    01377\n         MNOTE 8,'TRT SCAN SKIP OR FIND CHARACTER NOT FOUND'            01378\n         MEXIT                                                          01379\n.SKIP    ANOP                                                           01380\n&N       DC    256&BAD                                                  01381\n         ORG   &N+&SKIP                                                 01382\n         DC    &GOOD                                                    01383\n         ORG                                                            01384\n         MEXIT                                                          01385\n.FIND    ANOP                                                           01386\n&N       DC    256&GOOD                                                 01387\n         ORG   &N+&FIND                                                 01388\n         DC    &BAD                                                     01389\n         ORG                                                            01390\n         MEXIT                                                          01391\n         MEND                                                           01392\n         MACRO                                                          01393\n&N       PTRACE &DDNAME=PTRACE                                          01394\n.*             AUTHOR.   DON HIGGINS.                                   01395\n.*             DATE.     01/06/75.                                      01396\n.*             REMARKS.  GENERATE TRACE OF EACH PENTRY NAME ENTERED.    01397\n.*                       THIS MACRO SHOULD BE PLACED AS FIRST           01398\n.*                       EXECUTABLE STATEMENT IN PROGRAM.               01399\n.*                       REMOVE AFTER TESTING TO ELIMINATE OVERHEAD.    01400\n         GBLB  &PTRACE                                                  01401\n         GBLC  &PTNAME                                                  01402\n&PTRACE  SETB  1                                                        01403\n&PTNAME  SETC  'PENT&SYSNDX'                                            01404\n&N       B     PEND&SYSNDX                                              01405\n         B     *+4                                                      01406\nPENT&SYSNDX  EQU *                                                      01407\n         STM   R14,R1,PSAV&SYSNDX                                       01408\n         MVC   *+6+2(2),PENT&SYSNDX-2                                   01409\n         LA    R1,*-*                                                   01410\n         SH    R1,=H'24'                                                01411\n         MVC   PMSG&SYSNDX+1(8),0(R1)                                   01412\n         DISPLAY PMSG&SYSNDX,DDNAME=&DDNAME                             01413\n         LM    R14,R1,PSAV&SYSNDX                                       01414\n         B     PENT&SYSNDX-4                                            01415\nPMSG&SYSNDX DC CL133' '                                                 01416\nPSAV&SYSNDX DC 4F'0'                                                    01417\nPEND&SYSNDX EQU *                                                       01418\n         MEND                                                           01419\n         MACRO                                                          01420\n&N       FINDCDE &EP=0,&EPLOC=0                                         01421\n.*             AUTHOR.   DON HIGGINS.                                   01422\n.*             DATE.     01/10/75.                                      01423\n.*             REMARKS.  SET R1 TO CDE ADDRESS OR ZERO                  01424\n         AIF   ('&EP'(1,1) EQ '0').EPLOC                                01425\n.EP      ANOP                                                           01426\n         BAL   R14,*+12                                                 01427\n         DC    CL8'&EP'                                                 01428\n         AGO   .FIND                                                    01429\n.EPLOC   ANOP                                                           01430\n         LA    R14,&EPLOC                                               01431\n.FIND    ANOP                                                           01432\n         LOADTCB R15                                                    01433\n         ZR    R1                                                       01434\n         L     R15,36(R15) TCBLLS FE PG 289                             01435\n         DO    WHILE,(LTR,R15,R15,NZ)                                   01436\n               L    R1,4(R15)      LLE CDE ADDRESS FE PG 280            01437\n               IF   (CLC,8(8,R1),0(R14),EQ)                             01438\n                    ZR   R15                                            01439\n               ELSE                                                     01440\n                    L    R15,0(R15)                                     01441\n                    ZR   R1                                             01442\n               FI                                                       01443\n         OD                                                             01444\n         MEND                                                           01445\n         MACRO                                                          01446\n&N       DOEXIT                                                         01447\n         GBLA  &DO(10),&DOSEQ(10),&DOLVL,&DOLAB                         01448\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           01449\n.*             AUTHOR.   DON HIGGINS.                                   01450\n.*             DATE.     01/29/75.                                      01451\n.*             REMARKS.  EXIT TO END OF CURRENT DO LOOP.                01452\n         AIF   (&DOLVL EQ 0).ERR1                                       01453\n         B     IF0&ELSE(&LEVEL)                                         01454\n         MEXIT                                                          01455\n.ERR1    MNOTE 8,'DOEXIT NOT WITHIN DO LOOP'                            01456\n         MEND                                                           01457\n         MACRO                                                          01458\n&N       HDC   &HLINE,&HCOL,&HDATA                                      01459\n         ORG   &HLINE+&HCOL                                             01460\n         AIF   (T'&HDATA EQ 'O').EXIT                                   01461\n&N       DC    &HDATA                                                   01462\n.EXIT    ANOP                                                           01463\n         MEND                                                           01464\n         MACRO                                                          01465\n&N       ABSP  &P                                                       01466\n         LCLA  &LP                                                      01467\n&LP      SETA  L'&P                                                     01468\n&N       OI    &P+&LP-1,X'0F' MAKE PACKED FIELD POSITIVE                01469\n         MEND                                                           01470\n         MACRO                                                          01471\n         XVBT3C                                                         01472\nCLGDSECT DSECT                                                          01473\n*              AUTHOR.   DON HIGGINS.                                   01474\n*              DATE.     04/04/75.                                      01475\n*              REMARKS.  RECORD CREATED BY GETCATLG (GU027000).         01476\nCLGVOL   DS    CL6       VOLUME                                         01477\nCLGDSN   DS    CL44      DATA SET NAME, CONNECT, INDEX, ALIAS, ETC.     01478\nCLGTYP   DS    CL1       1-DSN,2-CONNX,3-GDS,4-ALIAS,5-INDEX            01479\nCLGDEV   DS    XL4       DEVICE CODE                                    01480\nCLGDSNSQ DS    XL2       DATA SET SEQUENCE                              01481\nCLGVOLSQ DS    XL2       VOLUME SEQUENCE                                01482\nCLGGDSOP DS    BL1       X'02'-DELETE,X'01'-EMPTY OPTION                01483\nCLGGDSMX DS    XL1       MAXIMUM GDS DATA SET COUNT                     01484\nCLGGDSCR DS    XL2       CURRENT GDS DATA SET COUNT                     01485\n         MEND                                                           01486\n         MACRO                                                          01487\n         QCBD                                                           01488\n*                                                                       01489\n*              ENQ/DEQ CONTROL BLOCKS  (SEE IEAVENQ1 IGC056)            01490\n*                                                                       01491\n*                                                                       01492\n*              MAJOR QCB                                                01493\n*                                                                       01494\nQCBMAJ   DSECT                                                          01495\nQMJNEXT  DS    A    NEXT MAJOR QCB                                      01496\nQMJPREV  DS    A    PREVIOUS MAJOR QCB                                  01497\nQMJMINOR DS    A    FIRST MINOR QCB                                     01498\nQMJNAME  DS    CL8  MAJOR QCB NAME                                      01499\nQMJLNE   EQU   *-QCBMAJ                                                 01500\n*                                                                       01501\n*              MINOR QCB                                                01502\n*                                                                       01503\nQCBMIN   DSECT                                                          01504\nQMNQEL   DS    A    FIRST QUEUE ELEMENT                                 01505\nQMNPREV  DS    A    PREVIOUS MINOR QCB                                  01506\nQMNNEXT  DS    A    NEXT MINOR QCB                                      01507\nQMNLNM   DS    B    LENGTH OF RANME                                     01508\nQMNLSQA  DS    X    TYPE OF ENG                                         01509\nQMNSYS   EQU   255                                                      01510\nQMNSYSMS EQU   254                                                      01511\n*                   ANY OTHER VALUE IS STEP (TCBLSQA VALUE)             01512\nQMNNAME  DS    C                                                        01513\n*                                                                       01514\n*              QUEUE ELEMENT                                            01515\n*                                                                       01516\nQEL      DSECT                                                          01517\nQELNQEL  DS    A    NEXT QEL                                            01518\nQELSMC   EQU   QELNQEL       MUST COMPLETE INDICATORS                   01519\nQELSYSMC EQU   X'20'     SYSTEM MUST COMPLETE                           01520\nQELSTPMC EQU   X'10'     STEP MUST COMPLETE                             01521\nQELLQEL  DS    A    PREVIOUS QEL                                        01522\nQELCODE  EQU   QELLQEL   TYPE OF REQUEST                                01523\nQELSHAR  EQU   X'80'     SHARED                                         01524\nQELRESV  EQU   X'40'     RESERVED                                       01525\nQELRBWT  EQU   X'20'     DEFER SVRB PROCESSING UNTIL SWAP               01526\nQELNQECB EQU   X'10'     ENQ WITH ECB FOR WAIT                          01527\nQELRLSE  EQU   X'08'     DELAYED RELEASE                                01528\nQELEXCP  EQU   X'04'     EXCP INITIATED TO RELEASE DEVICE               01529\nQELSTAT  EQU   X'02'     STATUS SET PENDING                             01530\nQELABND  EQU   X'01'     QEL FOR TASK IN ABEND                          01531\nQELTCB   DS    A    TCB FOR ENQ                                         01532\nQELTJID1 EQU   QELTCB    FIRST BYTE OF TSO USER ID                      01533\nQELSVRB  DS    A    SVRB/UCB FOR ENQ                                    01534\nQELTJID2 EQU   QELSVRB   SECOND BYTE OF TSO USER ID                     01535\n         MEND                                                           01536\n         MACRO                                                          01537\n&N       SDCB  &M=PM,&R=FBA,&L=133,&B=0,&E=1                            01538\n.*             AUTHOR.   DON HIGGINS.                                   01539\n.*             DATE.     09/29/75.                                      01540\n.*             REMARKS.  SHORT FORM OF COMMONLY USED DCB WITH EXIT TO   01541\n.*                       PLUG ZERO BLKSIZE WITH LRECL.                  01542\n         DS    0A                                                       01543\n         DC    X'85',AL3(*+3) DCB EXIT LIST                             01544\n         OC    62(2,1),62(1)       IS BLKSIZE = 0                       01545\n         BCR   7,14                NO, EXIT NOW                         01546\n         MVC   62(2,1),82(1)       YES, BLKSIZE=LRECL                   01547\n         BR    14                  EXIT                                 01548\n         DC    CL8'&N'        DCB NAME FOR DUMP VERIFICATION            01549\n&N       DCB   EXLST=&N-28,DSORG=PS,DDNAME=&N,                         X01550\n               MACRF=&M,RECFM=&R,LRECL=&L,BLKSIZE=&B,EODAD=&E           01551\n         MEND                                                           01552\n         MACRO                                                          01553\n         ELSEIF                                                         01554\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           01555\n         GBLA  &ELSEIF(10)                                              01556\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     01557\n         LCLC  &OP,&OPR                                                 01558\n         LCLB  &TESTSW                                                  01559\n.*             AUTHOR.   DON HIGGINS.                                   01560\n.*             DATE.     05/23/76.                                      01561\n.*             REMARKS.  CONTROL STRUCTURE FOR CONDITIONAL EXECUTION.   01562\n         AIF   (&LEVEL EQ 10).ERR1                                      01563\n         ELSE                                                           01564\n&LEVEL   SETA  &LEVEL+1                                                 01565\n&ELSEIF(&LEVEL) SETA 1                                                  01566\n&SEQ(&LEVEL) SETA 1                                                     01567\n&LAB     SETA  &LAB+1                                                   01568\n&ELSE(&LEVEL) SETA &LAB                                                 01569\n&N       SETA N'&SYSLIST                                                01570\n.NEXTAND ANOP                                                           01571\n&TESTSW  SETB  0                                                        01572\n.TEST    ANOP                                                           01573\n&S       SETA  &S+1                                                     01574\n         AIF   (&S GT &N).ERR2                                          01575\n&M       SETA  N'&SYSLIST(&S)                                           01576\n         AIF   (&M EQ 1).TESTEND                                        01577\n         AIF   (&M LT 2).ERR3                                           01578\n         AIF   (&M GT 5).ERR4                                           01579\n&I       SETA  2                                                        01580\n&OPR     SETC  ''                                                       01581\n&OP      SETC  '&SYSLIST(&S,1)'                                         01582\n         AIF   (&M GT 2).TESTOPR                                        01583\n         &OP                                                            01584\n         AGO   .TESTEND                                                 01585\n.TESTOPR ANOP                                                           01586\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   01587\n&L       SETA  K'&SYSLIST(&S,&I)                                        01588\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         01589\n         AGO   .NEXTOPR                                                 01590\n.NOLIT   ANOP                                                           01591\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 01592\n.NEXTOPR ANOP                                                           01593\n&I       SETA  &I+1                                                     01594\n         AIF   (&I EQ &M).TESTGEN                                       01595\n&OPR     SETC  '&OPR'.','                                               01596\n         AGO   .TESTOPR                                                 01597\n.TESTGEN ANOP                                                           01598\n         &OP   &OPR                                                     01599\n.TESTEND ANOP                                                           01600\n         AIF   (&TESTSW EQ 1).ORBC                                      01601\n.AMBC    ANOP                                                           01602\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               01603\n.CONNECT ANOP                                                           01604\n&S       SETA  &S+1                                                     01605\n         AIF   (&S GT &N).EXIT                                          01606\n&M       SETA  N'&SYSLIST(&S)                                           01607\n         AIF   (&M NE 1).ERR5  BAD CONNECTOR                            01608\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        01609\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR5  BAD CONNECTOR             01610\n.NEXTOR   ANOP                                                          01611\n&LAB1    SETA  &LAB+1                                                   01612\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     01613\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      01614\n&LAB     SETA  &LAB+2                                                   01615\n&ELSE(&LEVEL) SETA &LAB                                                 01616\n&TESTSW  SETB  1                                                        01617\n         AGO   .TEST                                                    01618\n.ORBC    ANOP                                                           01619\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               01620\nIF0&LAB1 EQU *                                                          01621\n         AGO   .CONNECT                                                 01622\n.ERR1    MNOTE 8,'IF - LEVEL OVERFLOW'                                  01623\n         AGO   .EXIT                                                    01624\n.ERR2    MNOTE 8,'IF - MISSING TEST LIST'                               01625\n         AGO   .EXIT                                                    01626\n.ERR3    MNOTE 8,'IF - TEST LIST TOO SHORT'                             01627\n         AGO   .EXIT                                                    01628\n.ERR4    MNOTE 8,'IF - TEST LIST TOO LONG'                              01629\n         AGO   .EXIT                                                    01630\n.ERR5    MNOTE 8,'IF - INVALID CONNECTOR'                               01631\n.EXIT    ANOP                                                           01632\n         MEND                                                           01633\n*          DATA SET CBT847     AT LEVEL 003 AS OF 10/02/77\n*          DATA SET GU024600   AT LEVEL 005 AS OF 12/14/73              00001\nGETPDSDD SUBENTRY                                                       00002\n*              AUTHOR.   DON HIGGINS.                                   00003\n*              DATE.     10/30/73 2 AM WITH SORE THROAT.                00004\n*              REMARKS.  SUBROUTINE TO OBTAIN ADDRESS OF PDS INFO       00005\n*                        IN THE FOLLOWING SEQUENCE.                     00006\n*                             CALL   ARGUMENT VALUES                    00007\n*                              1       A(JFCB FOR FIRST DD NAMED        00008\n*                                        PDSLIBXX. ZERO IF NONE FOUND.) 00009\n*                              2       A(NEXT DE ENTRY FOR PDSLIBXX)    00010\n*                              N       A(LAST DE FOR PDSLIBXX)          00011\n*                              N+1     A(ZERO TO INDICATE END OF DE'S)  00012\n*                              N+2     A(NEXT JFCB FOR NEXT DD WITH     00013\n*                                        PDSLIBXX. ZERO IF NONE FOUND)  00014\n*                        FIRST ARGUMENT IS JFCB ADDR OR ZERO.           00015\n*                        SECOND ARGUMENT IS ADDRESS OF DE OR ZERO.      00016\n*                        SUBROUTINE MUST NOT BE CALLED AGAIN AFTER ZERO 00017\n*                        IS RETURNED INSTEAD OF JFCB ADDRESS.           00018\n* REV1 DSH 10/08/73 ADD OPTIONAL CONTROL CARD FACILITY                  00019\n* A CARD FILE NAMED PDSCTL AND A SYSOUT FILE PDSOUT MAY BE ADDED.       00020\n* IF PDSCTL IS USED, IT MAY DEFINE DEGINNING (COL. 1-8) AND ENDING      00021\n* (COL. 9-16) MEMBER NAMES TO BE RETURNED TO THE CALLING PGM.           00022\n* IF 9-16 IS BLANK, THE MEMBER NAMED IN COL. 1-8 ONLY WILL BE RETURNED. 00023\n* MULTIPLE CARDS MUST BE INSEQUENCE.  ALL CARDS AND ANY SEQUENCE        00024\n* ERRORS WILL BE LISTED ON PDSOUT.  ANY ERROR WILL FORCE EOF/EOJ.       00025\n* IF PDSCTL DD IS DUMMY, OR OMITTED, OR IS VOID OF RECORDS,             00026\n* ALL NAMES WILL BE RETURNED.                                           00027\n* IF 1 OR MORE RECORDS ARE PRESENT, ONLY DE'S WITHIN RANGE WILL BE      00028\n* RETURNED.  THIS OPTION WILL FUNCTION ONLY FOR THE FIRST PDSLIB.       00029\n* ADDITIONAL PDSLIB'S WILL BE IGNORED.                                  00030\n*              REGISTERS.                                               00031\n*                        R0-R2 WORK                                     00032\n*                        R3-R4 ARGUMENT ADDRESSES                       00033\n*                        R5    DCB ADDRESS FOR IHADCB                   00034\n*                        R13   BASE                                     00035\n*                        R14-R15 LINKAGE                                00036\n         LM    R3,R4,0(R1)         ARG ADDRESSES                        00037\nM010     NOP   M020                                                     00038\n         OI    M010+1,X'F0'        SET FIRST TIME NOP TO BRANCH         00039\n         PERFORM R100SET,R190EXIT                                       00040\n         B     M030                                                     00041\nM020     TAG                                                            00042\n         OC    ADDRJFCB,ADDRJFCB                                        00043\n         BZ    M060                ABEND IF ZERO JFCB HAS BEEN RETURNED 00044\n         OC    ADDRDE,ADDRDE                                            00045\n         BNZ   M040                GET NEXT DE IF LAST DE NOT ZERO      00046\n         CLOSE (PDSDCB)                                                 00047\nM030     TAG                                                            00048\n         PERFORM R200DD,R290EXIT   GET NEXT DD                          00049\n         B     M050                EXIT WITH JFCB OR ZERO ADDRESS       00050\nM040     TAG                                                            00051\n         SCALL GETPDSDE,(PDSDCB,M070,ADDRDE)                            00052\n* REV1 - TO M050                                                        00053\n         CLI   CTLSTAT,ACTIVE                                           00054\n         BNE   M050                                                     00055\nR045     TAG                                                            00056\n         L     R2,ADDRDE           IS MEMBER IN CTL RANGE               00057\n         CLC   0(8,R2),CTLLOW                                           00058\n         BL    M040                                                     00059\n         CLC   0(8,R2),CTLHIGH                                          00060\n         BNH   M050                                                     00061\n         PERFORM R300GCTL,R390EXIT GET NEXT CTL CARD                    00062\n         CLI   CTLSTAT,CTLEOF                                           00063\n         BE    M070                                                     00064\n         B     R045                                                     00065\nM050     TAG                                                            00066\n         MVC   0(4,R3),ADDRJFCB                                         00067\n         MVC   0(4,R4),ADDRDE                                           00068\n         SUBEXIT                                                        00069\nM060     ABEND 101,DUMP                                                 00070\nM070     TAG                                                            00071\n* REV1 - M080                                                           00072\n         CLI   CTLSTAT,INACTIVE    IS CTL MODE ACTIVE                   00073\n         BE    M080                NO, ALLOW MULTIPLE PDSLIB DD'S       00074\n         MVC   NEXTDD,=A(TIOTEND)  FORCE END OF TIOT TO FORCE EOJ       00075\nM080     TAG                                                            00076\n         MVC   ADDRDE,=A(0)        SET END OF DIRECTORY INDICATOR       00077\n         B     M050                                                     00078\nR100SET  PENTRY                                                         00079\n         L     R1,16               CVT                                  00080\n         L     R1,0(R1)            TCB WORDS                            00081\n         L     R1,4(R1)            MY TCB                               00082\n         L     R1,12(R1)           MY TIOT                              00083\n         LA    R1,24(R1)           MY FIRST DD ENTRY IN TIOT            00084\n         ST    R1,NEXTDD                                                00085\n* REV1 - UP TO R190EXIT                                                 00086\nR110     TAG                                                            00087\n         LR    R2,R1                                                    00088\n         ZR    R1                                                       00089\n         IC    R1,0(R2)                                                 00090\n         SRC   R1                                                       00091\n         BZ    R190EXIT                                                 00092\n         LA    R1,0(R1,R2)                                              00093\n         CLC   4(8,R2),=CL8'PDSCTL'                                     00094\n         BNE   R110                                                     00095\n         OPEN  (PDSCTL,(INPUT),PDSOUT,(OUTPUT))                         00096\n         PUT   PDSOUT,HEAD1                                             00097\n         PUT   PDSOUT,HEAD2                                             00098\n         PERFORM R300GCTL,R390EXIT                                      00099\nR190EXIT PEXIT                                                          00100\nR200DD   PENTRY                                                         00101\n         MVC   ADDRJFCB,=A(0)      SET LAST JFCB ZERO                   00102\n         MVC   ADDRDE,=A(1)        SET LAST DE NOT ZERO                 00103\nR210     TAG                                                            00104\n         L     R2,NEXTDD                                                00105\n         ZR    R1                                                       00106\n         IC    R1,0(R2)                                                 00107\n         SRC   R1                                                       00108\n         BZ    R290EXIT            EXIT  WITH ZERO IF END OF TIOT       00109\n         LA    R1,0(R1,R2)                                              00110\n         ST    R1,NEXTDD                                                00111\n         CLC   4(6,R2),=C'PDSLIB'                                       00112\n         BNE   R210                                                     00113\n         LA    R5,PDSDCB                                                00114\n         USING IHADCB,R5                                                00115\n         MVC   DCBDDNAM,4(R2)                                           00116\n         RDJFCB PDSDCB                                                  00117\n         OPEN  (PDSDCB,(INPUT)),TYPE=J                                  00118\n         MVC   ADDRJFCB,=A(JFCB)                                        00119\nR290EXIT PEXIT                                                          00120\n* REV1 - R300-390                                                       00121\nR300GCTL PENTRY                                                         00122\n         GET   PDSCTL                                                   00123\n         LR    R2,R1                                                    00124\n         PUT   PDSOUT,(R2)         LIST CTL CARD AS IS                  00125\n         MVI   CTLSTAT,ACTIVE      SET CTL MODE ACTIVE (AT LEAST 1 CD)  00126\n         CLC   CTLHIGH,0(R2)       IS NEW LOW LESS THAN LAST HIGH       00127\n         BNL   R320ERR             YES,PRINT SEQ. ERR.                  00128\n         MVC   CTLREC(16),0(R2)    SAVE NEW LOW AND HIGH                00129\n         CLC   CTLHIGH,=CL8' '     IS NEW HIGH BLANK                    00130\n         BNE   R310                NO, GO TEST IT AGAINST NEW LOW       00131\n         MVC   CTLHIGH,CTLLOW      SET HIGH EQUAL TO LOW                00132\n         B     R390EXIT                                                 00133\nR310     TAG                                                            00134\n         CLC   CTLLOW,CTLHIGH      IS HIGH LESS THAN LOW                00135\n         BNH   R390EXIT            NO, EXIT                             00136\nR320ERR  TAG                                                            00137\n         PUT   PDSOUT,CTLERR       PRINT SEQ. EROR AND FORCE EOF/EOJ    00138\nR330EOF  TAG                                                            00139\n         CLI   CTLSTAT,INACTIVE    IS THIS EOF ON FIRST READ            00140\n         BE    R390EXIT            YES,LEAVE CTL MODE INACTIVE          00141\n         MVI   CTLSTAT,CTLEOF      NO,  SET EOF STATUS TO FORCE EOF/EOJ 00142\nR390EXIT PEXIT                                                          00143\n         EQUAL                                                          00144\nNEXTDD   DC    A(1)                                                     00145\nADDRJFCB DC    A(1)                                                     00146\nADDRDE   DC    A(1)                                                     00147\nJFCBLST  DC    0F'0',X'87',AL3(JFCB)                                    00148\nJFCB     DC    0F'0',XL176'00'                                          00149\nINACTIVE EQU   0                   PDSCTL MISSING OR EMPTY - FULL LIST  00150\nACTIVE   EQU   1                   PDSCTL IN USE - SELECTIVE LIST       00151\nCTLEOF   EQU   2                   PDSCTL AT EOF - FORCE EOF DE/JFCB    00152\nCTLSTAT  DC    AL1(INACTIVE)                                            00153\nTIOTEND  DC    X'00'                                                    00154\nCTLREC   DS    0CL80                                                    00155\nCTLLOW   DS    CL8                                                      00156\nCTLHIGH  DS    CL8                                                      00157\n         FILL  CTLREC                                                   00158\nHEAD1    DC    CL80'GETPDSDD PDSCTL CONTROL CARD LISTING'               00159\nHEAD2    DC    CL80'LLLLLLLLHHHHHHHH'                                   00160\nCTLERR   DC    CL80'*** ABOVE CARD FORCED EOF DUE TO SEQ. ERR. ***'     00161\nPDSOUT   DCB   DSORG=PS,MACRF=PM,DDNAME=PDSOUT,RECFM=F,BLKSIZE=80       00162\nPDSCTL   DCB   DSORG=PS,MACRF=GL,DDNAME=PDSCTL,EODAD=R330EOF,          X00163\n               RECFM=FB,LRECL=80                                        00164\nPDSDCB   DCB   DSORG=PS,MACRF=GL,DDNAME=PDSLIBXX,                      X00165\n               RECFM=F,LRECL=256,BLKSIZE=256,EXLST=JFCBLST              00166\n         DCBD  DSORG=PS                                                 00167\n#PAN$AUD CSECT                                                          001674\n$PAN#AUD DC    CL21'003CBT847    10/02/77'                              001675\n         END                                                            00168\n", "mimetype": "text/plain", "datatype": "iso-8859-1", "extension": ".txt"}, "GETPDSDE": {"ttr": 1281, "alias": false, "halfwords": 0, "notes": 0, "parms": "b''", "ispf": false, "text": "*          DATA SET CBT840     AT LEVEL 001 AS OF 09/29/77\n         MACRO                                                          00001\n&N       DTIME &FIELD                                                   00002\n&N       TIME  DEC                                                      00003\n         CNOP  0,4                                                      00004\n         STM   0,1,*+8                                                  00005\n         B     *+12                                                     00006\n         DC    2F'0'                                                    00007\n         EDIT  TO=&FIELD,FROM=*-14,MASK=' 99/99/99.99F ZZ99.999'        00008\n         MEND                                                           00009\n         MACRO                                                          00010\n&NAME    EDIT  &TO=,&FROM=,&MASK=                                       00011\n.*                                                                      00012\n.*             MACRO-ID. 'EDIT'.                                        00013\n.*             AUTHOR.   DON HIGGINS.                                   00014\n.*             DATE WRITTEN.  07/18/70.                                 00015\n.*             REMARKS.                                                 00016\n.*                  FUNCTION - GENERATE MASK AND/OR INSTRUCTIONS TO     00017\n.*                             EDIT PACKED DECIMAL DATA FOR PRINTING.   00018\n.*                  OPERANDS                                            00019\n.*                   TO=   LABEL OF DISPLAY FIELD INTO WHICH THE EDITED 00020\n.*                         DATA WILL BE PLACED IF SPECIFIED.            00021\n.*                   FROM= LABEL OF PACKED DECIMAL DATA TO BE EDITED    00022\n.*                         IF SPECIFIED.                                00023\n.*                   MASK= STRING OF UP TO 48 CHARACTERS IN SINGLE      00024\n.*                         QUOTES DEFINING EDIT MASK SIMILAR            00025\n.*                         TO A COBOL PICTURE.  THIS OPERAND IS         00026\n.*                         REQUIRED.  IF THE OTHER TWO OPERANDS ARE NOT 00027\n.*                         DEFINED, A DC WITH THE DESIRED MASK IS       00028\n.*                         GENERATED.  SPECIAL EDIT CHARACTERS ARE AS   00029\n.*                         FOLLOWS:                                     00030\n.*                            Z - DIGIT SELECT WITH ZERO SURPRESSION    00031\n.*                            9 - DIGIT SELECT WITHOUT ZERO SURPRESSION 00032\n.*                            F - FIELD SELECT RESETS SIGNIFICANCE TO   00033\n.*                                ALLOW MULTIPLE FIELD EDITING          00034\n.*                            $ - DIGIT SELECT WITH ZERO SURPRESSION    00035\n.*                                AND FLOATING DOLLAR SIGN.             00036\n.*                  NOTES:                                              00037\n.*                   1.  THE FIRST MASK CHARACTER IS USED AS THE FILL   00038\n.*                       CHARACTER IN ALL FIELDS.                       00039\n.*                   2.  THE FOLLOWING EXAMPLE WOULD EDIT BOTH THE TIME 00040\n.*                       AND DATE OBTAINED USING THE TIME MACRO         00041\n.*                            .                                         00042\n.*                            TIME DEC                                  00043\n.*                            STM  0,1,PDATA                            00044\n.*                            EDIT TO=LINE+10,FROM=PDATA,               00045\n.*                                 MASK=' 99/99/99.99F ZZ99.999'        00046\n.*                            .                                         00047\n.*                       PDATA DS  2F     (HHMMSSTH00YYDDDC)            00048\n.*                       LINE  DC  CL133' '                             00049\n.*                            .                                         00050\n.*                   3.  THE FOLLOWING EXAMPLE WOULD GENERATE A DC      00051\n.*                       LABELED MASKPAY TO BE USED AS A MASK FOR       00052\n.*                       EDITING DIFFERENT FILEDS.                      00053\n.*                            .                                         00054\n.*                       MASKPAY   EDIT MASK=' Z,ZZZ,ZZ9.99 CR'         00055\n.*                            .                                         00056\n.*                   4.  THE MASK CHARACTERS DETERMINE EXPLICIT LENGTH. 00057\n.*                   5.  MULTIPLE FIELDS CANNOT CONTAIN FLOATING        00058\n.*                       DOLLAR SIGNS.                                  00059\n.*                                                                      00060\n         LCLA  &LMASK,&SIGNF,&NEXT,&FIELDS,&FLOAT                       00061\n         LCLC  &C,&C1,&C2,&C3,&C4,&C5,&C6                               00062\n         AIF   (T'&MASK NE 'U').BADMASK                                 00063\n&LMASK   SETA  K'&MASK-2                                                00064\n         AIF   (&LMASK GT 48).BADMASK                                   00065\n         AIF   (&LMASK LT 1).BADMASK                                    00066\n         AIF   ('&MASK'(1,1) NE '''').BADMASK                           00067\n         AIF   ('&MASK'(&LMASK+2,1) NE '''').BADMASK                    00068\n.LOOP    ANOP                                                           00069\n&NEXT    SETA  &NEXT+1                                                  00070\n         AIF   (&NEXT GT &LMASK).GEN                                    00071\n&C       SETC  '&MASK'(&NEXT+1,1)                                       00072\n         AIF   ('&C' EQ '9').NINE                                       00073\n         AIF   ('&C' EQ 'Z').ZZZZ                                       00074\n         AIF   ('&C' EQ '$').DOLLAR                                     00075\n         AIF   ('&C' EQ 'F').FIELD                                      00076\n.AD1     AIF   ('&C1' GT '9999999').AD2                                 00077\n&C1      SETC  '&C1&C'                                                  00078\n         AGO   .LOOP                                                    00079\n.AD2     AIF   ('&C2' GT '9999999').AD3                                 00080\n&C2      SETC  '&C2&C'                                                  00081\n         AGO   .LOOP                                                    00082\n.AD3     AIF   ('&C3' GT '9999999').AD4                                 00083\n&C3      SETC  '&C3&C'                                                  00084\n         AGO   .LOOP                                                    00085\n.AD4     AIF   ('&C4' GT '9999999').AD5                                 00086\n&C4      SETC  '&C4&C'                                                  00087\n         AGO   .LOOP                                                    00088\n.AD5     AIF   ('&C5' GT '9999999').AD6                                 00089\n&C5      SETC  '&C5&C'                                                  00090\n         AGO   .LOOP                                                    00091\n.AD6     AIF   ('&C6' GT '9999999').BADMASK                             00092\n&C6      SETC  '&C6&C'                                                  00093\n         AGO   .LOOP                                                    00094\n.NINE    AIF   (&SIGNF EQ 0).SETSIG                                     00095\n.ZZZZ    ANOP                                                           00096\n&C       SETC  '\u0080'       (11-0-1-8-9)=X'20'  DIGIT SELECT               00097\n         AGO   .AD1                                                     00098\n.DOLLAR  ANOP                                                           00099\n&FLOAT   SETA  1                                                        00100\n         AGO   .ZZZZ                                                    00101\n.FIELD   ANOP                                                           00102\n&C       SETC  '\u0082'       (0-2-9)=X'22'       FIELD SELECT               00103\n&SIGNF   SETA  0                                                        00104\n&FIELDS  SETA  1                                                        00105\n         AGO   .AD1                                                     00106\n.SETSIG  ANOP                                                           00107\n&C       SETC  '\u0081'       (0-1-9)=X'21'       SIGNIFICANCE STARTER       00108\n&SIGNF   SETA  &NEXT                                                    00109\n         AGO   .AD1                                                     00110\n.GEN     AIF   (T'&TO EQ 'O').GENDC                                     00111\n         AIF   (T'&FROM EQ 'O').BADFROM                                 00112\n         AIF   (&FLOAT EQ 1).GENFL                                      00113\n&NAME    MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00114\n         ED    &TO.(&LMASK.),&FROM                                      00115\n         MEXIT                                                          00116\n.GENDC   AIF   (T'&FROM NE 'O').BADTO                                   00117\n&NAME    DC    CL&LMASK.'&C1&C2&C3&C4&C5&C6'                            00118\n         MEXIT                                                          00119\n.GENFL   AIF   (&FIELDS NE 0).BADMIX                                    00120\n         AIF   (&SIGNF  GT 0).GENLA                                     00121\n&NAME    LA    1,1                                                      00122\n         MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00123\n         EDMK  &TO.(&LMASK.),&FROM                                      00124\n         BCT   1,*+8                                                    00125\n         B     *+8                                                      00126\n         MVI   0(1),C'$'                                                00127\n         MEXIT                                                          00128\n.GENLA   ANOP                                                           00129\n&NAME    LA    1,&TO.+&SIGNF                                            00130\n         MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00131\n         EDMK  &TO.(&LMASK.),&FROM                                      00132\n         BCTR  1,0                                                      00133\n         MVI   0(1),C'$'                                                00134\n         MEXIT                                                          00135\n.BADMIX  MNOTE 0,'MULTIPLE FIELDS CANNOT CONTAIN FLOATING DOLLAR SIGNS' 00136\n         MEXIT                                                          00137\n.BADMASK MNOTE 0,'INVALID MASK (1-48 CHARACTERS IN SINGLE QUOTES)'      00138\n         MEXIT                                                          00139\n.BADTO   MNOTE 0,'MISSING TO FIELD'                                     00140\n         MEXIT                                                          00141\n.BADFROM MNOTE 0,'MISSING FROM FIELD'                                   00142\n         MEXIT                                                          00143\n         MEND                                                           00144\n         MACRO                                                          00145\n         EQUREGS &LIMITS                                                00146\n.*                                                                      00147\n.*             MACRO-ID. 'EQUREGS'.                                     00148\n.*             AUTHOR. DON HIGGINS.                                     00149\n.*             DATE WRITTEN. 08/04/70.                                  00150\n.*             REMARKS.                                                 00151\n.*                 THIS MACRO GENERATES EQU STATEMENTS FOR 1 TO 16      00152\n.*                 SYMBOLIC REGISTER NAMES OF THE FORM R0 UP TO R15     00153\n.*             THE REGISTER EQU DESIRED CAN BE SPECIFIED IN THE FORM    00154\n.*             OF  (0,15), (14,1), (2,6), ETC.                          00155\n         LCLA  &LOW,&HIGH                                               00156\n         AIF   (N'&SYSLIST EQ 1).GETLIM                                 00157\n.DEFAULT ANOP                                                           00158\n&LOW     SETA  0                                                        00159\n&HIGH    SETA  15                                                       00160\n.GEN     ANOP                                                           00161\nR&LOW    EQU   &LOW                                                     00162\n         AIF   (&LOW EQ &HIGH).DONE                                     00163\n&LOW     SETA  &LOW+1                                                   00164\n         AIF   (&LOW LE 15).GEN                                         00165\n&LOW     SETA  0                                                        00166\n         AGO   .GEN                                                     00167\n.GETLIM  AIF   (N'&SYSLIST(1) NE 2).DEFAULT                             00168\n         AIF   (T'&SYSLIST(1,1) NE 'N').DEFAULT                         00169\n         AIF   (T'&SYSLIST(1,2) NE 'N').DEFAULT                         00170\n&LOW     SETA  &SYSLIST(1,1)                                            00171\n         AIF   (&LOW LT 0).DEFAULT                                      00172\n         AIF   (&LOW GT 15).DEFAULT                                     00173\n&HIGH    SETA  &SYSLIST(1,2)                                            00174\n         AIF   (&HIGH LT 0).DEFAULT                                     00175\n         AIF   (&HIGH GT 15).DEFAULT                                    00176\n         AGO   .GEN                                                     00177\n.DONE    MEXIT                                                          00178\n         MEND                                                           00179\n         MACRO                                                          00180\n         FILL   &TAG,&FILL=C' '                                         00181\n         LCLA  &LTAG                                                    00182\n.*             AUTHOR.   DON HIGGINS.                                   00183\n.*             DATE.     09/16/71.                                      00184\n.*             REMARKS.  FILL REMAINDER OF AREA WITH FILL CHARACTER.    00185\n&LTAG    SETA  L'&TAG                                                   00186\n         DC    (&LTAG)&FILL                                             00187\n         ORG   &TAG+&LTAG                                               00188\n         MEND                                                           00189\n         MACRO                                                          00190\n&NAME    IOB   &FLAGS=,&ECB=,&CCW=,&DCB=,&ID=                           00191\n.*             AUTHOR.   DON HIGGINS.                                   00192\n.*             DATE.     11/23                                          00193\n.*             REMARKS.  INPUT/OUTPUT CONTROL BLOCK MACRO.              00194\n.*                       REF. SYS. PROG. GUIDE C28-6550-6 PG 139        00195\n.*                                                                      00196\n&NAME    DS    0F                                                       00197\n         DC    &FLAGS         FLAGS 1  0-CD 1-CC 6-NOT REL 23457-RESV   00198\n         DC    XL1'00'        FLAGS 2  RESERVED                         00199\nSNS&ID   DC    XL2'00'        FIRST TWO SENSE BYTES AFTER UNIT CHECK    00200\n         DC    XL1'00'        ECB CODE                                  00201\nECB&ID   DC    AL3(&ECB)      EVENT CONTROL BLOCK ADDRESS               00202\n         DC    XL1'00'        FLAGS 3 RESERVED                          00203\nCSW&ID   DC    XL7'00'        CHANNEL STATUS WORD (LOW ORDER 7 BYTES)   00204\n         DC    XL1'00'        SIO CODE (INS LENGTH X CONDITION CODE)    00205\nCCW&ID   DC    AL3(&CCW)      CHANNEL COMMAND WORD ADDRESS              00206\n         DC    XL1'00'        RESERVED                                  00207\nDCB&ID   DC    AL3(&DCB)      DATA CONTROL BLOCK ADDRESS                00208\n         DC    XL1'00'        REPOSITION MODIFIER                       00209\n         DC    AL3(0)         RESTART ADDRESS                           00210\n         DC    H'0'           BLOCK COUNT INCREMENT                     00211\n         DC    H'0'           ERROR COUNTS                              00212\n         DC    XL1'00'        M - EXTENT ENTRY IN DEB                   00213\n         DC    XL7'00'        SEEK ADDRESS BBCCHHR                      00214\n         MEND                                                           00215\n         MACRO                                                          00216\n&N       PENTRY                                                         00217\n.*             AUTHOR.   DON HIGGINS.                                   00218\n.*             DATE.     01/06/75.                                      00219\n.*             REMARKS.  PERFORM ROUTINE ENTRY POINT WITH TRACE OPTION. 00220\n.*                       SEE PTRACE MACRO FOR TRACE INFO.               00221\n         GBLB  &PTRACE                                                  00222\n         GBLC  &PTNAME                                                  00223\n         GBLC  &PENAME                                                  00224\n&PENAME  SETC  '&N'                                                     00225\n         DC    0H'0',CL8'&N'                                            00226\n         B     *+4                                                      00227\n&N       EQU   *                                                        00228\n         AIF   (&PTRACE EQ 0).NOTRACE                                   00229\n         PM    &PTNAME                                                  00230\n.NOTRACE ANOP                                                           00231\n         MEND                                                           00232\n         MACRO                                                          00233\n&N       PERFORM &PENTRY                                                00234\n&N       MVC   &PENTRY-2(2),*+10                                        00235\n         B     &PENTRY                                                  00236\n         DC    S(*+2)                                                   00237\n         MEND                                                           00238\n         MACRO                                                          00239\n&N       PEXIT                                                          00240\n         GBLC  &PENAME                                                  00241\n&N       B     &PENAME-4                                                00242\n         MEND                                                           00243\n         MACRO                                                          00244\n&NAME    SCALL &SUBNAME,&ARGLIST                                        00245\n.*             AUTHOR.   DON HIGGINS.                                   00246\n.*             DATE.     11/09/70.                                      00247\n.*             REMARKS.  SHORT FORM OF IBM CALL MACRO WITH NO VL.       00248\n         AIF   (T'&ARGLIST EQ 'O').NOARG                                00249\n&NAME    LA    1,=A&ARGLIST        LOAD ARGUMENT LIST ADDRESS           00250\n         L     15,=V(&SUBNAME)     LOAD SUBPROGRAM ENTRY ADDRESS        00251\n         BALR  14,15               BRANCH AND LINK                      00252\n         MEXIT                                                          00253\n.NOARG   ANOP                                                           00254\n&NAME    L     15,=V(&SUBNAME)     LOAD SUBPROGRAM ENTRY ADDRESS        00255\n         BALR  14,15               BRANCH AND LINK                      00256\n         MEND                                                           00257\n         MACRO                                                          00258\n&NAME    SUBENTRY &CSECT=YES,&BASES=(13),                              X00259\n               &RENT=NO,&RWA=,&RWALNG=0,&SP=0                           00260\n         LCLA  &NBASE,&S,&OFFSET                                        00261\n.*             MACRO-ID. 'SUBENTRY'                                     00262\n.*             AUTHOR.   DON HIGGINS.                                   00263\n.*             DATE WRITTEN.  07/28/70.                                 00264\n.*             REMARKS.  THIS MACRO GENERATES THE CODE TO ESTABLISH A   00265\n.*                       CSECT WITH SAVE AREA AND BASE REGISTER USING   00266\n.*                       STANDARD OS LINKAGE CONVENTIONS.               00267\n.*             REV1 11/14/74 ADD REENTRANT OPTION WITH WORK AREA        00268\n.*                 1.  FOR REENTRANT LINKAGE YOU MUST SPECIFY           00269\n.*                     A.  RENT=YES                                     00270\n.*                     B.  AT LEAST ONE BASE REGISTER OTHER THAN 13     00271\n.*                         SUCH AS BASES=(R12)                          00272\n.*                 2.  OPTIONALLY YOU CAN SPECIFY A DSECT NAME AND      00273\n.*                     LENGTH FOR A WORK AREA BUILT BEHIND SAVE AREA.   00274\n.*                     FOR EXAMPLE  RWADSECT=MYWORK,RWALNG=8            00275\n.*                     NOTE THAT THIS WORK AREA LENGTH MUST ALSO BE     00276\n.*                     SPECIFIED AT SUBEXIT TIME TO CORRECTLY CALCULATE 00277\n.*                     THE FREEMAIN LENGTH.                             00278\n.*             REV2 02/10/76 DSH - ADD SUBPOOL OPTION                   00279\n         AIF   ('&CSECT'(1,1) EQ 'N').NOCSECT                           00280\n&NAME    CSECT                                                          00281\n         AGO   .STM                                                     00282\n.NOCSECT ANOP                                                           00283\n&NAME    DS    0D                                                       00284\n.STM     ANOP                                                           00285\n         AIF   ('&RENT'(1,1) EQ 'N').NORENT                             00286\n.RENT    ANOP                                                           00287\n         STM   14,12,12(13)                                             00288\n         BAL   &BASES(1),16(15)                                         00289\n         USING &NAME+8,&BASES(1)                                        00290\n         DC    CL8'&NAME'                                               00291\n         LA    0,72+&RWALNG                                             00292\n         AIF   ('&SP' EQ '0').SKIPSP                                    00293\n         LA    1,&SP                                                    00294\n         SLL   1,24                                                     00295\n         OR    0,1                                                      00296\n.SKIPSP  ANOP                                                           00297\n         GETMAIN R,LV=(0)                                               00298\n         ST    1,8(13)                                                  00299\n         ST    13,4(1)                                                  00300\n         LM    14,1,12(13)                                              00301\n         L     13,8(13)                                                 00302\n         AIF   ('&RWALNG' EQ '0').GEN                                   00303\n         USING &RWA-72,13                                               00304\n         AGO   .GEN                                                     00305\n.NORENT  ANOP                                                           00306\n         STM   14,12,12(13)                                             00307\n         BAL   15,88(15)                                                00308\n         DC    9D'0'                                                    00309\n         DC    CL8'&NAME'                                               00310\n         ST    15,8(13)                                                 00311\n         ST    13,4(15)                                                 00312\n         LR    13,15                                                    00313\n         AIF   (T'&BASES(1) NE 'N').CHKR13                              00314\n         AIF   (&BASES(1) EQ 13).GENB13                                 00315\n         AGO   .GENBX                                                   00316\n.CHKR13  ANOP                                                           00317\n         AIF   ('&BASES'(2,3) EQ 'R13').GENB13                          00318\n.GENBX   ANOP                                                           00319\n         LR    &BASES(1),13                                             00320\n         USING &NAME+8,&BASES(1)                                        00321\n         AGO   .GEN                                                     00322\n.GENB13  ANOP                                                           00323\n         USING &NAME+8,13                                               00324\n.GEN     ANOP                                                           00325\n&NBASE   SETA  N'&BASES                                                 00326\n&S       SETA  1                                                        00327\n.L1      ANOP                                                           00328\n&S       SETA  &S+1                                                     00329\n         AIF   (&S GT &NBASE).EXIT                                      00330\n&OFFSET  SETA  &OFFSET+4095                                             00331\n         LA    &BASES(&S),4095(&BASES(&S-1))                            00332\n         USING &NAME+8+&OFFSET,&BASES(&S)                               00333\n         AGO   .L1                                                      00334\n.EXIT    ANOP                                                           00335\n         MEND                                                           00336\n         MACRO                                                          00337\n&NAME    SUBEXIT &RC=0,&RENT=NO,&RWALNG=0,&SP=0                         00338\n.*             MACRO-ID. 'SUBEXIT'.                                     00339\n.*             AUTHOR.   DON HIGGINS.                                   00340\n.*             DATE WRITTEN.  07/28/70.                                 00341\n.*             REMARKS.  THIS MACRO GENERATES THE CODE TO RESTORE       00342\n.*                       REGISTERS AND RETURN FROM A CSECT.  A RETURN   00343\n.*                       CODE OF ZERO IS RETURNED UNLESS A DIFFERENT    00344\n.*                       CODE IS SPECIFIED USING THE KEY WORD RC=.      00345\n.*             REV1 11/14/74 ADD REENTRANT OPTION. SEE SUBENTRY.        00346\n.*             REV2 12/09/74 ADD REG OPTION FOR RC OPERAND.             00347\n.*             REV3 02/10/76 DSH - ADD SUBPOOL OPTION                   00348\n         AIF   ('&RC'(1,1) EQ '(').RCREG                                00349\n         LA    15,&RC                                                   00350\n         AGO   .CHKRENT                                                 00351\n.RCREG   ANOP                                                           00352\n         LR    15,&RC                                                   00353\n.CHKRENT ANOP                                                           00354\n         AIF   ('&RENT'(1,1) EQ 'N').NORENT                             00355\n.RENT    ANOP                                                           00356\n&NAME    L     13,4(13)                                                 00357\n         STM   15,1,16(13)                                              00358\n         LA    0,72+&RWALNG                                             00359\n         AIF   ('&SP' EQ '0').SKIPSP                                    00360\n         LA    1,&SP                                                    00361\n         SLL   1,24                                                     00362\n         OR    0,1                                                      00363\n.SKIPSP  ANOP                                                           00364\n         L     1,8(13)                                                  00365\n         FREEMAIN R,LV=(0),A=(1)                                        00366\n         LM    14,12,12(13)                                             00367\n         BR    14                                                       00368\n         AGO   .EXIT                                                    00369\n.NORENT  ANOP                                                           00370\n&NAME    L     13,4(13)                                                 00371\n         L     14,12(13)                                                00372\n         LM    2,12,28(13)                                              00373\n         BR    14                                                       00374\n.EXIT    ANOP                                                           00375\n         MEND                                                           00376\n         MACRO                                                          00377\n&N       SYSIN                                                          00378\n&N       DCB   DSORG=PS,MACRF=GM,DDNAME=&N,RECFM=FB,LRECL=80            00379\n         MEND                                                           00380\n         MACRO                                                          00381\n&N       SYSPRINT                                                       00382\n&N       DCB   DSORG=PS,MACRF=PM,DDNAME=&N,RECFM=FA,BLKSIZE=133         00383\n         MEND                                                           00384\n         MACRO                                                          00385\n&NAME    TAG                                                            00386\n&NAME    DS    0H                                                       00387\n         MEND                                                           00388\n         MACRO                                                          00389\n&M       MOVE  &A,&B                                                    00390\n         LCLA  &S,&L                                                    00391\n&L       SETA  L'&A                                                     00392\n.LOOP    ANOP                                                           00393\n         AIF   (&L LE 256).LAST                                         00394\n&M       MVC   &A+&S.(256),&B+&S                                        00395\n&S       SETA  &S+256                                                   00396\n&L       SETA  &L-256                                                   00397\n         AGO   .LOOP                                                    00398\n.LAST    ANOP                                                           00399\n         MVC   &A+&S.(&L),&B+&S                                         00400\n         MEND                                                           00401\n         MACRO                                                          00402\n&N       LT    &R,&X                                                    00403\n&N       L     &R,&X                                                    00404\n         LTR   &R,&R                                                    00405\n         MEND                                                           00406\n         MACRO                                                          00407\n         EQUAL                                                          00408\n*              COMMON EQU'S AND LITERALS                                00409\n*                                                                       00410\n*              EQU'S FOR REGISTERS                                      00411\n         EQUREGS                                                        00412\n*              EQU'S FOR IMMEDIATE DATA INSTRUCTIONS                    00413\n         EQUI                                                           00414\n*              LITERAL POOL                                             00415\n*              EQU'S FOR BRANCH ON CONDITIONS                           00416\n         EQUBC                                                          00417\n         LTORG                                                          00418\n         MEND                                                           00419\n         MACRO                                                          00420\n         EQUI                                                           00421\n         GBLA  &N,&V(20)                                                00422\n.LOOP    ANOP                                                           00423\n         AIF   (&N EQ 0).EXIT                                           00424\n#&V(&N)  EQU   &V(&N)                                                   00425\n&N       SETA  &N-1                                                     00426\n         AGO   .LOOP                                                    00427\n.EXIT    MEND                                                           00428\n         MACRO                                                          00429\n         XREFI &I                                                       00430\n         GBLA  &N,&V(20)                                                00431\n         LCLA  &S,&K,&NK                                                00432\n&NK      SETA  N'&I                                                     00433\n.LOOP1   ANOP                                                           00434\n&K       SETA  &K+1                                                     00435\n         AIF   (&K GT &NK).EXIT                                         00436\n         AIF   (&N EQ 0).ADD                                            00437\n&S       SETA  0                                                        00438\n.LOOP2   ANOP                                                           00439\n&S       SETA  &S+1                                                     00440\n         AIF   (&I(&K) EQ &V(&S)).REF                                   00441\n         AIF   (&S LT &N).LOOP2                                         00442\n.ADD     ANOP                                                           00443\n         AIF   (&N EQ 20).ERR                                           00444\n&N       SETA  &N+1                                                     00445\n&V(&N)   SETA  &I(&K)                                                   00446\n.REF     ANOP                                                           00447\n         AGO   .LOOP1                                                   00448\n.ERR     MNOTE 4,'IMMEDIATE DATA XREF TABLE OVERFLOW'                   00449\n.EXIT    MEND                                                           00450\n         MACRO                                                          00451\n&N       LI    &R,&I                                                    00452\n         AIF   (&I LT 1).ERR                                            00453\n         AIF   (&I GT 32767).ERR                                        00454\n         XREFI &I                                                       00455\n         AIF   (&I GT 4095).LHI                                         00456\n&N       LA    &R,#&I                                                   00457\n         MEXIT                                                          00458\n.LHI     ANOP                                                           00459\n&N       LH    &R,*+6                                                   00460\n         DC    X'4700',AL2(#&I)                                         00461\n         MEXIT                                                          00462\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00463\n         MEND                                                           00464\n         MACRO                                                          00465\n&N       AI    &R,&I                                                    00466\n         AIF   (&I LT 1).ERR                                            00467\n         AIF   (&I GT 32767).ERR                                        00468\n         XREFI &I                                                       00469\n&N       AH    &R,*+6                                                   00470\n         DC    X'4700',AL2(#&I)                                         00471\n         MEXIT                                                          00472\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00473\n         MEND                                                           00474\n         MACRO                                                          00475\n&N       SI    &R,&I                                                    00476\n         AIF   (&I LT 1).ERR                                            00477\n         AIF   (&I GT 32767).ERR                                        00478\n         XREFI &I                                                       00479\n         AIF   (&I GT 2).SHI                                            00480\n&N       BCTR  &R,0                                                     00481\n         DC    0AL2(#&I)                                                00482\n         AIF   (&I EQ 1).EXIT                                           00483\n         BCTR  &R,0                                                     00484\n.EXIT    MEXIT                                                          00485\n.SHI     ANOP                                                           00486\n&N       SH    &R,*+6                                                   00487\n         DC    X'4700',AL2(#&I)                                         00488\n         MEXIT                                                          00489\n.ERR     ANOP                                                           00490\n         MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00491\n         MEND                                                           00492\n         MACRO                                                          00493\n&N       TB    &FIELD,&BITS                                             00494\n         LCLA  &NBITS,&B(8),&S                                          00495\n&NBITS   SETA  N'&BITS                                                  00496\n         AIF   (&NBITS LT 1).ERR                                        00497\n         AIF   (&NBITS GT 8).ERR                                        00498\n.LOOP    ANOP                                                           00499\n&S       SETA  &BITS(&NBITS)                                            00500\n         AIF   (&S LT 0).ERR                                            00501\n         AIF   (&S GT 7).ERR                                            00502\n&B(&S+1) SETA  1                                                        00503\n&NBITS   SETA  &NBITS-1                                                 00504\n         AIF   (&NBITS GT 0).LOOP                                       00505\n&N       TM    &FIELD,B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)'       00506\n         MEXIT                                                          00507\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00508\n         MEND                                                           00509\n         MACRO                                                          00510\n&N       SB    &FIELD,&BITS                                             00511\n         LCLA  &NBITS,&B(8),&S                                          00512\n&NBITS   SETA  N'&BITS                                                  00513\n         AIF   (&NBITS LT 1).ERR                                        00514\n         AIF   (&NBITS GT 8).ERR                                        00515\n.LOOP    ANOP                                                           00516\n&S       SETA  &BITS(&NBITS)                                            00517\n         AIF   (&S LT 0).ERR                                            00518\n         AIF   (&S GT 7).ERR                                            00519\n&B(&S+1) SETA  1                                                        00520\n&NBITS   SETA  &NBITS-1                                                 00521\n         AIF   (&NBITS GT 0).LOOP                                       00522\n&N       OI    &FIELD,B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)'       00523\n         MEXIT                                                          00524\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00525\n         MEND                                                           00526\n         MACRO                                                          00527\n&N       ZB    &FIELD,&BITS                                             00528\n         LCLA  &NBITS,&B(8),&S                                          00529\n&NBITS   SETA  N'&BITS                                                  00530\n         AIF   (&NBITS LT 1).ERR                                        00531\n         AIF   (&NBITS GT 8).ERR                                        00532\n.LOOP    ANOP                                                           00533\n&S       SETA  &BITS(&NBITS)                                            00534\n         AIF   (&S LT 0).ERR                                            00535\n         AIF   (&S GT 7).ERR                                            00536\n&B(&S+1) SETA  1                                                        00537\n&NBITS   SETA  &NBITS-1                                                 00538\n         AIF   (&NBITS GT 0).LOOP                                       00539\n&N       NI    &FIELD,X'FF'-B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)' 00540\n         MEXIT                                                          00541\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00542\n         MEND                                                           00543\n         MACRO                                                          00544\n&N       XCH   &A,&B                                                    00545\n&N       XC    &A,&B                                                    00546\n         XC    &B,&A                                                    00547\n         XC    &A,&B                                                    00548\n         MEND                                                           00549\n         MACRO                                                          00550\n&N       XCHR  &A,&B                                                    00551\n&N       XR    &A,&B                                                    00552\n         XR    &B,&A                                                    00553\n         XR    &A,&B                                                    00554\n         MEND                                                           00555\n         MACRO                                                          00556\n&N       ZR    &R                                                       00557\n&N       SR    &R,&R                                                    00558\n         MEND                                                           00559\n         MACRO                                                          00560\n&N       AAI   &R,&I                                                    00561\n         AIF   (&I LT 1).ERR                                            00562\n         AIF   (&I GT 32767).ERR                                        00563\n         XREFI &I                                                       00564\n         AIF   (&I GT 4095).AHI                                         00565\n&N       LA    &R,#&I.(&R)                                              00566\n         MEXIT                                                          00567\n.AHI     ANOP                                                           00568\n&N       AH    &R,*+6                                                   00569\n         DC    X'4700',AL2(#&I)                                         00570\n         MEXIT                                                          00571\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00572\n         MEND                                                           00573\n         MACRO                                                          00574\n&N       SRC   &R                                                       00575\n         LTR   &R,&R                                                    00576\n         MEND                                                           00577\n         MACRO                                                          00578\n&N       ZHB   &R                                                       00579\n&N       LA    &R,0(&R)                                                 00580\n         MEND                                                           00581\n         MACRO                                                          00582\n         SPOOLDAT                                                       00583\n.*             AUTHOR.   DON HIGGINS.                                   00584\n.*             DATE.     03/12/73.                                      00585\n.*             REMARKS.  DEFINE HASP 3.1 CHECKPOINT DATA AREAS ON 2314. 00586\n.*             REFERENCES.                                              00587\n.*                 1.    GY27-7255 HASP V4 PLM                          00588\n.*                 2.    GC27-6992 HASP SYS. PGMR. GUIDE                00589\n.*                 3.    SEE GU019800 FOR SAMPLE PROGRAM USING THIS.    00590\n.*             REV1 01/28/74 - REVISE FOR 3330 DISKS.                   00591\n.*             REV2 01/09/75 - REVISE FOR HASP V4.0 (VS2-R1.7)          00592\n*              REV3 /                                                   00593\n*              REV3 03/15/76 DSH - MAKE CHECKPOINT MTTRS RELATIVE       00594\n*                                                                       00595\n*              THE FOLLOWING STATEMENTS MUST PRECEED THIS MACRO         00596\n*                                                                       00597\n*              COPY $GLOBAL                                             00598\n*              COPY $HASPGEN                                            00599\n*              $HASPCB JOT,PRC (OTHER CONTROL BLOCKS ARE OPTIONAL)      00600\n*                                                                       00601\n*              SEE GY27-7255 HASP PLM 7-49 FOR FURTHER INFO.            00602\n*                                                                       00603\n         GBLA  &MAXJOBS  MAXIMUM JOBS ALLOWED IN HASP SYSTEM AT ONCE    00604\n         GBLA  &NUMPRC   NUMBER OF PRINT/PUNCH CHECKPOINT RECORDS       00605\n         GBLA  &JITSIZE  JOB INFORMATION TABLE ELEMENT SIZE             00606\n*                                                                       00607\n*              CHECKPOINT MTTRS                                         00608\n*                                                                       00609\n*                   THESE MTTRS ARE CODED AS RELATIVE TRACK AND         00610\n*                   ARE CONVERTED TO ABSOLUTE TRACK BY HASPXDAP         00611\n*                   (GU019600) ON FIRST CALL.                           00612\n*                   HIGH BIT ON INDICATES RELATIVE TRACK.               00613\n*                                                                       00614\nCKP1MTTR DC    X'80000001'    JOBQUE AND MISC. ON FIRST TRACK           00615\nCKP2MTTR DC    X'80000101'    JIT                                       00616\nCKP3MTTR DC    X'80000201'    JOT                                       00617\n*                                                                       00618\n*              CHECKPOINT RECORD AREAS                                  00619\n*                                                                       00620\nCKP1REC  DS    0D        JOB QUEUE AND MISC INFO                        00621\n$JOBQUE  DC    (&MAXJOBS)XL16'00'                                       00622\n$SAVEBEG DS    0F                                                       00623\n$JOBQPTR DC    A(*-*)    CORE ADDRESS OF HASP JOB QUEUE                 00624\n$JQFREE  DC    A(*-*)    FREE QUEUE CHAIN                               00625\n$JQENT   DC    A(*-*)    ACTIVE QUEUE CHAIN                             00626\n$DATAKEY DC    F'0'      MASTER PERIPHERAL DATA SET KEY                 00627\n$JOBNO   DC    H'0'      HASP JOB NUMBER                                00628\n$MSGRPNO DC    H'0'      LAST CONSOLE MESSAGE TRACK GROUP               00629\n$DACKPT  DC    1XL6'0'   DA CHECKPOINT FOR WARM START                   00630\n$SAVEEND EQU   *                                                        00631\n$SAVELEN EQU   $SAVEEND-$SAVEBEG                                        00632\n$PRCRECS DC    (&NUMPRC)XL(PRCSIZE)'00'                                 00633\nCKP1LNG  EQU   *-CKP1REC                                                00634\nCKP2REC  DS    0D        JOB INFORMATION TABLE                          00635\n$JIT     DC    (&MAXJOBS)XL(&JITSIZE)'00'                               00636\nCKP2LNG  EQU   *-CKP2REC                                                00637\nCKP3REC  DS    0D        JOB OUTPUT TABLE                               00638\n$JOTREC  DC    (JOTSIZE)X'00'                                           00639\nCKP3LNG  EQU   *-CKP3REC                                                00640\n         MEND                                                           00641\n         MACRO                                                          00642\n&N       XCP   &IOB,&CCW,&ERR                                           00643\n&N       LA    R0,&CCW                                                  00644\n         ST    R0,&IOB+16                                               00645\n         EXCP  &IOB                                                     00646\n         L     R1,&IOB+4                                                00647\n         WAIT  ECB=(1)                                                  00648\n         TM    &IOB+12,X'03'                                            00649\n         BNZ   &ERR                                                     00650\n         TM    &IOB+13,X'FF'                                            00651\n         BNZ   &ERR                                                     00652\n         MEND                                                           00653\n         MACRO                                                          00654\n&N       MC    &S1,&I2                                                  00655\n&N       CLI   &S1,&I2                                                  00656\n         ORG   *-4                                                      00657\n         DC    X'AF'                                                    00658\n         ORG   *+3                                                      00659\n         MEND                                                           00660\n         MACRO                                                          00661\n&N       CDS   &R1,&R3,&S                                               00662\n&N       LM    &R1,&R3,&S                                               00663\n         ORG   *-4                                                      00664\n         DC    X'BB'                                                    00665\n         ORG   *+3                                                      00666\n         MEND                                                           00667\n         MACRO                                                          00668\n&N       CS    &R1,&R3,&S2                                              00669\n&N       LM    &R1,&R3,&S2                                              00670\n         ORG   *-4                                                      00671\n         DC    X'BA'                                                    00672\n         ORG   *+3                                                      00673\n         MEND                                                           00674\n         MACRO                                                          00675\n         IF                                                             00676\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00677\n         GBLA  &ELSEIF(10)                                              00678\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     00679\n         LCLC  &OP,&OPR                                                 00680\n         LCLB  &TESTSW                                                  00681\n.*             AUTHOR.   DON HIGGINS.                                   00682\n.*             DATE.     03/27/74.                                      00683\n.*             REMARKS.  CONTROL STRUCTURE FOR CONDITIONAL EXECUTION.   00684\n.*             REV1 05/23/76 DSH - SUPPORT ELSEIF.                      00685\n         AIF   (&LEVEL EQ 10).ERR1                                      00686\n&LEVEL   SETA  &LEVEL+1                                                 00687\n&ELSEIF(&LEVEL) SETA 0                                                  00688\n&SEQ(&LEVEL) SETA 1                                                     00689\n&LAB     SETA  &LAB+1                                                   00690\n&ELSE(&LEVEL) SETA &LAB                                                 00691\n&N       SETA N'&SYSLIST                                                00692\n.NEXTAND ANOP                                                           00693\n&TESTSW  SETB  0                                                        00694\n.TEST    ANOP                                                           00695\n&S       SETA  &S+1                                                     00696\n         AIF   (&S GT &N).ERR2                                          00697\n&M       SETA  N'&SYSLIST(&S)                                           00698\n         AIF   (&M EQ 1).TESTEND                                        00699\n         AIF   (&M LT 2).ERR3                                           00700\n         AIF   (&M GT 5).ERR4                                           00701\n&I       SETA  2                                                        00702\n&OPR     SETC  ''                                                       00703\n&OP      SETC  '&SYSLIST(&S,1)'                                         00704\n         AIF   (&M GT 2).TESTOPR                                        00705\n         &OP                                                            00706\n         AGO   .TESTEND                                                 00707\n.TESTOPR ANOP                                                           00708\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   00709\n&L       SETA  K'&SYSLIST(&S,&I)                                        00710\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         00711\n         AGO   .NEXTOPR                                                 00712\n.NOLIT   ANOP                                                           00713\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 00714\n.NEXTOPR ANOP                                                           00715\n&I       SETA  &I+1                                                     00716\n         AIF   (&I EQ &M).TESTGEN                                       00717\n&OPR     SETC  '&OPR'.','                                               00718\n         AGO   .TESTOPR                                                 00719\n.TESTGEN ANOP                                                           00720\n         &OP   &OPR                                                     00721\n.TESTEND ANOP                                                           00722\n         AIF   (&TESTSW EQ 1).ORBC                                      00723\n.AMBC    ANOP                                                           00724\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00725\n.CONNECT ANOP                                                           00726\n&S       SETA  &S+1                                                     00727\n         AIF   (&S GT &N).EXIT                                          00728\n&M       SETA  N'&SYSLIST(&S)                                           00729\n         AIF   (&M NE 1).ERR5  BAD CONNECTOR                            00730\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        00731\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR5  BAD CONNECTOR             00732\n.NEXTOR   ANOP                                                          00733\n&LAB1    SETA  &LAB+1                                                   00734\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     00735\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      00736\n&LAB     SETA  &LAB+2                                                   00737\n&ELSE(&LEVEL) SETA &LAB                                                 00738\n&TESTSW  SETB  1                                                        00739\n         AGO   .TEST                                                    00740\n.ORBC    ANOP                                                           00741\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00742\nIF0&LAB1 EQU *                                                          00743\n         AGO   .CONNECT                                                 00744\n.ERR1    MNOTE 8,'IF - LEVEL OVERFLOW'                                  00745\n         AGO   .EXIT                                                    00746\n.ERR2    MNOTE 8,'IF - MISSING TEST LIST'                               00747\n         AGO   .EXIT                                                    00748\n.ERR3    MNOTE 8,'IF - TEST LIST TOO SHORT'                             00749\n         AGO   .EXIT                                                    00750\n.ERR4    MNOTE 8,'IF - TEST LIST TOO LONG'                              00751\n         AGO   .EXIT                                                    00752\n.ERR5    MNOTE 8,'IF - INVALID CONNECTOR'                               00753\n.EXIT    ANOP                                                           00754\n         MEND                                                           00755\n         MACRO                                                          00756\n         THEN  &OPT                                                     00757\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00758\n.*             AUTHOR.   DON HIGGINS.                                   00759\n.*             DATE.     03/27/74.                                      00760\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00761\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00762\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00763\n         AIF   (&LEVEL EQ 0).ERR0                                       00764\n         AIF   ('&OPT' EQ 'BEGIN').BEGIN                                00765\n         AIF   ('&OPT' EQ 'END').END                                    00766\n         MNOTE 4,'THEN - INVALID OPERAND - IGNORED'                     00767\n         AGO   .EXIT                                                    00768\n.BEGIN   ANOP                                                           00769\n         AIF   (&SEQ(&LEVEL) NE 1).ERR1                                 00770\n&SEQ(&LEVEL) SETA 2                                                     00771\n         AGO   .EXIT                                                    00772\n.END     ANOP                                                           00773\n         AIF   (&SEQ(&LEVEL) NE 2).ERR2                                 00774\n&SEQ(&LEVEL) SETA 3                                                     00775\n         AGO   .EXIT                                                    00776\n.ERR0    MNOTE 8,'THEN - MISSING IF'                                    00777\n         AGO   .EXIT                                                    00778\n.ERR1    MNOTE 4,'THEN BEGIN - OUT OF SEQUENCE'                         00779\n         AGO   .EXIT                                                    00780\n.ERR2    MNOTE 4,'THEN END - OUT OF SEQUENCE'                           00781\n.EXIT    ANOP                                                           00782\n         MEND                                                           00783\n         MACRO                                                          00784\n         ELSE  &OPT                                                     00785\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00786\n         GBLA  &ELSEIF(10)                                              00787\n.*             AUTHOR.   DON HIGGINS.                                   00788\n.*             DATE.     03/27/74.                                      00789\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00790\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00791\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00792\n.*             REV1 05/23/76 DSH - SUPPORT ELSEIF                       00793\n         AIF   (&LEVEL EQ 0).ERR0                                       00794\n         AIF   (T'&OPT EQ 'O').BEGIN                                    00795\n         AIF   ('&OPT' EQ 'BEGIN').BEGIN                                00796\n         AIF   ('&OPT' EQ 'END').END                                    00797\n         AIF   ('&OPT' EQ 'CONTINUE').CONT                              00798\n         MNOTE 8,'ELSE - INVALID OPERAND'                               00799\n         AGO   .EXIT                                                    00800\n.BEGIN   ANOP                                                           00801\n         AIF   (&SEQ(&LEVEL) GT 3).ERR1                                 00802\n&LAB     SETA  &LAB+1                                                   00803\n         B     IF0&LAB                                                  00804\nIF0&ELSE(&LEVEL) EQU *                                                  00805\n&ELSE(&LEVEL) SETA &LAB                                                 00806\n&SEQ(&LEVEL) SETA 4                                                     00807\n         AGO .EXIT                                                      00808\n.END     ANOP                                                           00809\n         AIF   (&SEQ(&LEVEL) NE 4).ERR2                                 00810\n.DEQUE   ANOP                                                           00811\nIF0&ELSE(&LEVEL) EQU *                                                  00812\n&LEVEL   SETA &LEVEL-1                                                  00813\n         AIF   (&ELSEIF(&LEVEL+1) EQ 1).DEQUE                           00814\n         AGO   .EXIT                                                    00815\n.CONT    ANOP                                                           00816\n         AIF   (&SEQ(&LEVEL) GT 3).ERR3                                 00817\n         AGO   .DEQUE                                                   00818\n.ERR0    MNOTE 8,'ELSE - MISSING IF'                                    00819\n         AGO   .EXIT                                                    00820\n.ERR1    MNOTE 8,'ELSE BEGIN - OUT OF SEQUENCE'                         00821\n         AGO   .EXIT                                                    00822\n.ERR2    MNOTE 8,'ELSE END - OUT OF SEQUENCE'                           00823\n         AGO   .EXIT                                                    00824\n.ERR3    MNOTE 8,'ELSE CONTINUE - OUT OF SEQUENCE'                      00825\n.EXIT    ANOP                                                           00826\n         MEND                                                           00827\n         MACRO                                                          00828\n         DO                                                             00829\n         GBLA  &DO(10),&DOSEQ(10),&DOLVL,&DOLAB                         00830\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00831\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     00832\n         LCLA  &UNTIL                                                   00833\n         LCLC  &OP,&OPR                                                 00834\n         LCLB  &TESTSW                                                  00835\n.*             AUTHOR.   DON HIGGINS.                                   00836\n.*             DATE.     03/27/74.                                      00837\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00838\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00839\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00840\n         AIF   (&DOLVL EQ 10).ERR1                                      00841\n&N       SETA  N'&SYSLIST                                               00842\n         AIF   (&N LT 1).ERR2                                           00843\n         AIF   ('&SYSLIST(1)' EQ 'END').END                             00844\n         AIF   ('&SYSLIST(1)' EQ 'FOREVER').WHILE                       00845\n         AIF   (&N LT 2).ERR2                                           00846\n         AIF   ('&SYSLIST(1)' EQ 'WHILE').WHILE                         00847\n         AIF   ('&SYSLIST(1)' NE 'UNTIL').ERR3                          00848\n.UNTIL   ANOP                                                           00849\n&DOLVL   SETA  &DOLVL+1                                                 00850\n&UNTIL   SETA  &DOLAB+1                                                 00851\n&DOLAB   SETA  &DOLAB+2                                                 00852\n         B     DO&UNTIL                                                 00853\n         AGO   .COMM                                                    00854\n.WHILE   ANOP                                                           00855\n&DOLVL   SETA  &DOLVL+1                                                 00856\n&DOLAB   SETA  &DOLAB+1                                                 00857\n.COMM    ANOP                                                           00858\n&DOSEQ(&DOLVL) SETA 1                                                   00859\n&DO(&DOLVL) SETA &DOLAB                                                 00860\nDO&DOLAB EQU   *                                                        00861\n         AIF   (&LEVEL EQ 10).ERR1                                      00862\n&LEVEL   SETA  &LEVEL+1                                                 00863\n&SEQ(&LEVEL) SETA 1                                                     00864\n&LAB     SETA  &LAB+1                                                   00865\n&ELSE(&LEVEL) SETA &LAB                                                 00866\n         AIF   ('&SYSLIST(1)' EQ 'FOREVER').EXIT                        00867\n&S       SETA  1                                                        00868\n.NEXTAND ANOP                                                           00869\n&TESTSW  SETB  0                                                        00870\n.TEST    ANOP                                                           00871\n&S       SETA  &S+1                                                     00872\n         AIF   (&S GT &N).ERR2                                          00873\n&M       SETA  N'&SYSLIST(&S)                                           00874\n         AIF   (&M LT 2).ERR3                                           00875\n         AIF   (&M GT 5).ERR3                                           00876\n&I       SETA  2                                                        00877\n&OPR     SETC  ''                                                       00878\n&OP      SETC  '&SYSLIST(&S,1)'                                         00879\n         AIF   (&M GT 2).TESTOPR                                        00880\n         &OP                                                            00881\n         AGO   .TESTEND                                                 00882\n.TESTOPR ANOP                                                           00883\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   00884\n&L       SETA  K'&SYSLIST(&S,&I)                                        00885\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         00886\n         AGO   .NEXTOPR                                                 00887\n.NOLIT   ANOP                                                           00888\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 00889\n.NEXTOPR ANOP                                                           00890\n&I       SETA  &I+1                                                     00891\n         AIF   (&I EQ &M).TESTGEN                                       00892\n&OPR     SETC  '&OPR'.','                                               00893\n         AGO   .TESTOPR                                                 00894\n.TESTGEN ANOP                                                           00895\n         &OP   &OPR                                                     00896\n.TESTEND ANOP                                                           00897\n         AIF   (&TESTSW EQ 1).ORBC                                      00898\n.AMBC    ANOP                                                           00899\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00900\n.CONNECT ANOP                                                           00901\n&S       SETA  &S+1                                                     00902\n         AIF   (&S GT &N).CHKUNTL                                       00903\n&M       SETA  N'&SYSLIST(&S)                                           00904\n         AIF   (&M NE 1).ERR3  BAD CONNECTOR                            00905\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        00906\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR3  BAD CONNECTOR             00907\n.NEXTOR   ANOP                                                          00908\n&LAB1    SETA  &LAB+1                                                   00909\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     00910\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      00911\n&LAB     SETA  &LAB+2                                                   00912\n&ELSE(&LEVEL) SETA &LAB                                                 00913\n&TESTSW  SETB  1                                                        00914\n         AGO   .TEST                                                    00915\n.ORBC    ANOP                                                           00916\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00917\nIF0&LAB1 EQU *                                                          00918\n         AGO   .CONNECT                                                 00919\n.CHKUNTL ANOP                                                           00920\n         AIF   (&UNTIL EQ 0).EXIT                                       00921\n&LAB     SETA  &LAB+1                                                   00922\n         B     IF0&LAB                                                  00923\nIF0&ELSE(&LEVEL) EQU *                                                  00924\n&ELSE(&LEVEL) SETA &LAB                                                 00925\nDO&UNTIL EQU *                                                          00926\n         AGO   .EXIT                                                    00927\n.END     ANOP                                                           00928\n         AIF   (&N GT 1).ERR3                                           00929\n         AIF   (&DOLVL EQ 0).ERR4                                       00930\n         AIF   (&DOSEQ(&DOLVL) NE 1).ERR4                               00931\n&DOSEQ(&DOLVL) SETA 0                                                   00932\n         B     DO&DO(&DOLVL)                                            00933\n&DOLVL   SETA  &DOLVL-1                                                 00934\nIF0&ELSE(&LEVEL) EQU *                                                  00935\n&LEVEL   SETA  &LEVEL-1                                                 00936\n         AGO   .EXIT                                                    00937\n.ERR1    MNOTE 8,'DO - LEVEL OVERFLOW'                                  00938\n         AGO   .EXIT                                                    00939\n.ERR2    MNOTE 8,'DO - MISSING OPERAND'                                 00940\n         AGO   .EXIT                                                    00941\n.ERR3    MNOTE 8,'DO - INVALID OPERAND'                                 00942\n         AGO   .EXIT                                                    00943\n.ERR4    MNOTE 8,'DO - END OUT OF SEQUENCE'                             00944\n.EXIT    ANOP                                                           00945\n         MEND                                                           00946\n         MACRO                                                          00947\n         EQUBC                                                          00948\nH        EQU   2                                                        00949\nL        EQU   4                                                        00950\nE        EQU   8                                                        00951\nNH       EQU   13                                                       00952\nNL       EQU   11                                                       00953\nNE       EQU   7                                                        00954\nO        EQU   1                                                        00955\nP        EQU   2                                                        00956\nM        EQU   4                                                        00957\nZ        EQU   8                                                        00958\nNP       EQU   13                                                       00959\nNM       EQU   11                                                       00960\nNZ       EQU   7                                                        00961\nNO       EQU   14                                                       00962\nEQ       EQU   8                                                        00963\nGT       EQU   2                                                        00964\nLT       EQU   4                                                        00965\nGE       EQU   11                                                       00966\nLE       EQU   13                                                       00967\n         MEND                                                           00968\n         MACRO                                                          00969\n&N       FI                                                             00970\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00971\n         AIF   (&SEQ(&LEVEL) NE 4).CONT                                 00972\n&N       ELSE  END                                                      00973\n         MEXIT                                                          00974\n.CONT    ANOP                                                           00975\n&N       ELSE  CONTINUE                                                 00976\n         MEND                                                           00977\n         MACRO                                                          00978\n&N       PM    &PENTRY                                                  00979\n&N       MVC   &PENTRY-2(2),*+10                                        00980\n         B     &PENTRY                                                  00981\n         DC    S(*+2)                                                   00982\n         MEND                                                           00983\n         MACRO                                                          00984\n&N       OD                                                             00985\n&N       DO    END                                                      00986\n         MEND                                                           00987\n         MACRO                                                          00988\n&N       DOCASE &INDEX                                                  00989\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       00990\n.*             AUTHOR.   DON HIGGINS.                                   00991\n.*             DATE.     07/02/74.                                      00992\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   00993\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            00994\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         00995\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          00996\n         AIF   (T'&INDEX EQ 'U').REG                                    00997\n&N       ZR    R15                                                      00998\n         IC    R15,&INDEX                                               00999\n         AGO   .PROC                                                    01000\n.REG     ANOP                                                           01001\n&N       LR    R15,&INDEX                                               01002\n.PROC    ANOP                                                           01003\n         AIF   (&DOCLVL EQ 10).ERR1                                     01004\n&DOCLVL  SETA  &DOCLVL+1                                                01005\n&DOCNT   SETA  &DOCNT+1                                                 01006\n&DOCNO(&DOCLVL) SETA &DOCNT                                             01007\n&CASENO(&DOCLVL) SETA 0                                                 01008\n&DOCELSE(&DOCLVL) SETA 0                                                01009\n         IC    R15,CASEI&DOCNO(&DOCLVL).(R15)                           01010\n         L     R15,CASEA&DOCNO(&DOCLVL).(R15)                           01011\n         BR    R15                                                      01012\nCASEI&DOCNO(&DOCLVL) DC 256X'00'                                        01013\n         MEXIT                                                          01014\n.ERR1    MNOTE 8,'DOCASE NESTED LEVELS EXCEEDED'                        01015\n         MEND                                                           01016\n         MACRO                                                          01017\n         CASE                                                           01018\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01019\n         LCLA  &N,&M,&L,&H                                              01020\n.*             AUTHOR.   DON HIGGINS.                                   01021\n.*             DATE.     07/02/74.                                      01022\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01023\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01024\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01025\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01026\n.*             REV1 05/24/76 DSH - ALLOW SYMBOLIC FOR CASE VALUE.       01027\n         AIF   (&DOCLVL LT 1).ERR1                                      01028\n&N       SETA  N'&SYSLIST                                               01029\n         AIF   (&N GT 1).CHKN                                           01030\n&N       SETA  N'&SYSLIST(1)                                            01031\n         AIF   (&N GT 1).CHKN                                           01032\n         AIF   ('&SYSLIST(1)' EQ 'ELSE').ELSE                           01033\n         AIF   ('&SYSLIST(1)' NE 'MISC').CHKN                           01034\n.ELSE    AIF   (&DOCELSE(&DOCLVL) GT 0).ERR3                            01035\n&DOCELSE(&DOCLVL) SETA 1                                                01036\nDC&DOCNO(&DOCLVL)ELSE DS 0H                                             01037\n         MEXIT                                                          01038\n.CHKN    ANOP                                                           01039\n         AIF   (&CASENO(&DOCLVL) EQ 63).ERR7                            01040\n&CASENO(&DOCLVL) SETA &CASENO(&DOCLVL)+1                                01041\n.MLOOP   ANOP                                                           01042\n&M       SETA  &M+1                                                     01043\n         AIF   (&M GT &N).GENL                                          01044\n&L       SETA  N'&SYSLIST(&M)                                           01045\n         AIF   (&L LT 1).MLOOP                                          01046\n         AIF   (&L GT 2).ERR4                                           01047\n         AIF   (&L EQ 1).GEN1                                           01048\n         AIF   (T'&SYSLIST(&M,1) NE 'N').ERR5                           01049\n         AIF   (T'&SYSLIST(&M,2) NE 'N').ERR5                           01050\n&L       SETA  &SYSLIST(&M,1)                                           01051\n&H       SETA  &SYSLIST(&M,2)                                           01052\n         AIF   (&L GT &H).ERR6                                          01053\n         AIF   (&H GT 255).ERR6                                         01054\n         AIF   (&L LT 1).ERR6                                           01055\n         ORG   CASEI&DOCNO(&DOCLVL)+&L                                  01056\n         DC    (&H-&L+1)AL1(&CASENO(&DOCLVL)*4)                         01057\n         AGO   .MLOOP                                                   01058\n.GEN1    ANOP                                                           01059\n         ORG   CASEI&DOCNO(&DOCLVL)+&SYSLIST(&M)                        01060\n         DC    AL1(&CASENO(&DOCLVL)*4)                                  01061\n         AGO   .MLOOP                                                   01062\n.GENL    ANOP                                                           01063\n         ORG                                                            01064\nDC&DOCNO(&DOCLVL)C&CASENO(&DOCLVL) DS 0H                                01065\n         MEXIT                                                          01066\n.ERR1    MNOTE 8,'CASE - MISSING DOCASE'                                01067\n         MEXIT                                                          01068\n.ERR2    MNOTE 8,'CASE - INVALID OPERAND'                               01069\n         MEXIT                                                          01070\n.ERR3    MNOTE 8,'CASE - DUPLICATE ELSE CASE'                           01071\n         MEXIT                                                          01072\n.ERR4    MNOTE 8,'CASE - MORE THAN 2 SUBLIST OPERANDS'                  01073\n         MEXIT                                                          01074\n.ERR5    MNOTE 8,'CASE - OPERAND NOT SELF DEFINING TERM'                01075\n         MEXIT                                                          01076\n.ERR6    MNOTE 8,'CASE - OPERAND NOT IN RANGE 1-255'                    01077\n         MEXIT                                                          01078\n.ERR7    MNOTE 8,'CASE - MAXIMUM OF 63 CASES EXCEEDED'                  01079\n         MEXIT                                                          01080\n         MEND                                                           01081\n         MACRO                                                          01082\n&N       ESAC                                                           01083\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01084\n.*             AUTHOR.   DON HIGGINS.                                   01085\n.*             DATE.     07/02/74.                                      01086\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01087\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01088\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01089\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01090\n&N       B     DC&DOCNO(&DOCLVL).END                                    01091\n         MEND                                                           01092\n         MACRO                                                          01093\n         ESACOD                                                         01094\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01095\n.*             AUTHOR.   DON HIGGINS.                                   01096\n.*             DATE.     07/02/74.                                      01097\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01098\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01099\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01100\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01101\n         LCLA  &C                                                       01102\n         AIF   (&DOCLVL LT 1).ERR1                                      01103\nCASEA&DOCNO(&DOCLVL) DS 0F                                              01104\n         AIF   (&DOCELSE(&DOCLVL) GT 0).GENELSE                         01105\n         DC    A(DC&DOCNO(&DOCLVL).END)                                 01106\n         AGO   .GENCASE                                                 01107\n.GENELSE ANOP                                                           01108\n         DC    A(DC&DOCNO(&DOCLVL).ELSE)                                01109\n.GENCASE ANOP                                                           01110\n&C       SETA  &C+1                                                     01111\n         AIF   (&C GT &CASENO(&DOCLVL)).GEND                            01112\n         DC    A(DC&DOCNO(&DOCLVL).C&C)                                 01113\n         AGO   .GENCASE                                                 01114\n.GEND    ANOP                                                           01115\nDC&DOCNO(&DOCLVL).END EQU *                                             01116\n&DOCLVL SETA &DOCLVL-1                                                  01117\n         MEXIT                                                          01118\n.ERR1    MNOTE 8,'ESACOD - MISSING DOCASE'                              01119\n         MEND                                                           01120\n         MACRO                                                          01121\n&NAME    LOGICAL                                                        01122\n.*             PGMID.    LOGICAL VARIABLE DEFINITION AND ENUMERATION    01123\n.*             AUTHOR.   DON HIGGINS.                                   01124\n.*             DATE.     09/27/74.                                      01125\n.*             REMARKS.  DEFINES A LOGICAL VARIABLE AS A ONE BYTE       01126\n.*                       AL1 FIELD WITH AN INITIAL VALUE AND STORES     01127\n.*                       IN GLOBAL TABLE POSSIBLE VALUES BY NAME.       01128\n.*                       ALL NAMES ARE EQUATED TO UNIQUE VALUES FOR     01129\n.*                       USE IN TEST AND SET STATEMENTS.                01130\n         GBLC  &LOGICN(100)                                             01131\n         GBLA  &LOGICV                                                  01132\n         LCLA  &N,&S,&SL                                                01133\n&N       SETA  N'&SYSLIST(2)                                            01134\n.L1      ANOP                                                           01135\n&S       SETA  &S+1                                                     01136\n         AIF   (&S GT &N).GENDC                                         01137\n&SL      SETA  0                                                        01138\n.L2      ANOP                                                           01139\n&SL      SETA  &SL+1                                                    01140\n         AIF   (&SL GT &LOGICV).GENEQU                                  01141\n         AIF   ('&SYSLIST(2,&S)' EQ '&LOGICN(&SL)').L1                  01142\n         AGO   .L2                                                      01143\n.GENEQU  ANOP                                                           01144\n&LOGICV  SETA  &LOGICV+1                                                01145\n&LOGICN(&LOGICV) SETC '&SYSLIST(2,&S)'                                  01146\n&SYSLIST(2,&S) EQU &LOGICV                                              01147\n         AGO   .L1                                                      01148\n.GENDC   ANOP                                                           01149\n&NAME    DC    AL1(&SYSLIST(1))                                         01150\n         MEND                                                           01151\n         MACRO                                                          01152\n&VLABEL  DCWV  &VNAME                                                   01153\n.*             AUTHOR.   DON HIGGINS.                                   01154\n.*             DATE.     11/03/74.                                      01155\n.*             REMARKS.  DEFINE VERY WEAK V TYPE ADDRESS WHICH IS       01156\n.*                       SET BY DYNAMICALLY LOADING NAMED MODULE        01157\n.*                       THE FIRST TIME THE V ADDRESS IS USED.          01158\nDCWV&SYSNDX DS 0H                                                       01159\n         USING DCWV&SYSNDX,R15     ENTER HERE ON FIRST USE OF VLABEL    01160\n         STM   R14,R2,&VLABEL+12   SAVE REGS USED BY LOAD               01161\n         LR    R2,R15              NEW BASE                             01162\n         DROP  R15                                                      01163\n         USING DCWV&SYSNDX,R2                                           01164\n         FINDCDE EPLOC=&VLABEL+4                                        01165\n         IF    (LTR,R1,R1,Z)                                            01166\n               LOAD EPLOC=&VLABEL+4                                     01167\n         ELSE                                                           01168\n               L    R0,16(R1) GET CDE ENTRY                             01169\n         FI                                                             01170\n         ST    R0,&VLABEL          STORE ENTRY POINT IN VLABEL          01171\n         LR    R15,R0              SET R15 TO CORRECT ENTRY POINT       01172\n         L     R14,&VLABEL+12      RESTORE REGS                         01173\n         LM    R0,R2,&VLABEL+20                                         01174\n         BR    R15                 ENTER VNAME FIRST TIME               01175\n&VLABEL  DC    A(DCWV&SYSNDX)      VERY WEAK V ADDRESS                  01176\n         DC    CL8'&VNAME'         NAME OF MODULE                       01177\n         DC    5F'0'               SAVE AREA                            01178\n         MEND                                                           01179\n         MACRO                                                          01180\n&N       LOADTCB &R                                                     01181\n&N       L     &R,16     CVT                                            01182\n         L     &R,0(&R)  TCB WORDS                                      01183\n         L     &R,4(&R)  TCB                                            01184\n         MEND                                                           01185\n         MACRO                                                          01186\n&N       LOADTIOT &R                                                    01187\n&N       LOADTCB &R                                                     01188\n         L     &R,12(&R) TIOT ADDRESS FROM TCB                          01189\n         MEND                                                           01190\n         MACRO                                                          01191\n&N       FINDDD &DDNAME                                                 01192\n.*             AUTHOR.   DON HIGGINS.                                   01193\n.*             DATE.     11/06/74.                                      01194\n.*             REMARKS.  SET R1 TO ADDRESS OF TIOT DDNAME ENTRY OR 0.   01195\n.*             EXAMPLE.  FINDDD =CL8'CALLLIB'                           01196\n&N       LOADTIOT R14                                                   01197\n         AAI   R14,24                                                   01198\n         LA    R15,&DDNAME                                              01199\n         ZR    R0                                                       01200\n         ZR    R1                                                       01201\n         IC    R0,0(R14)                                                01202\n         DO    WHILE,(LTR,R0,R0,P)                                      01203\n               IF   (CLC,4(8,R14),0(R15),EQ)                            01204\n                    LR   R1,R14                                         01205\n                    ZR   R0                                             01206\n               ELSE                                                     01207\n                    AR   R14,R0                                         01208\n                    IC   R0,0(R14)                                      01209\n               FI                                                       01210\n         OD                                                             01211\n         MEND                                                           01212\n         MACRO                                                          01213\n&NAME    ACCEPT &REC,&DDNAME=SYSIN                                      01214\n.*             AUTHOR.   DON HIGGINS.                                   01215\n.*             DATE.     11/19/74.                                      01216\n.*             REMARKS.  ACCEPT RECORD IF DD AVAILABLE.                 01217\n.*                       REC MAY GE REGISTER OR LABEL OF RECORD AREA.   01218\n.*                      R15=0 SUCCESSFUL READ.                          01219\n.*                      R15=4 EOF OR NO DD FOUND.                       01220\n&NAME    TAG                                                            01221\nACC1&SYSNDX B  *+4                                                      01222\n         FINDDD =CL8'&DDNAME'                                           01223\n         IF    (LTR,R1,R1,Z)                                            01224\n               WTO  '&DDNAME NOT FOUND'                                 01225\nACC2&SYSNDX    LA   R15,4                                               01226\n               MVC  ACC1&SYSNDX+2(2),=S(ACC2&SYSNDX)                    01227\n               B    ACC4&SYSNDX                                         01228\n         FI                                                             01229\n         MVC   ACC1&SYSNDX+2(2),=S(ACC3&SYSNDX)                         01230\n         OPEN  (&DDNAME)                                                01231\n         B     ACC3&SYSNDX                                              01232\n&DDNAME  DCB   DSORG=PS,MACRF=GL,DDNAME=&DDNAME,EODAD=ACC2&SYSNDX       01233\nACC3&SYSNDX GET &DDNAME                                                 01234\n         AIF   ('&REC'(1,1) EQ '(').REG                                 01235\n         MVC   &REC,0(R1)                                               01236\n         ZR    R15                                                      01237\n         AGO   .EXIT                                                    01238\n.REG     ANOP                                                           01239\n         LR    &REC,R1                                                  01240\n         ZR    R15                                                      01241\n.EXIT    ANOP                                                           01242\nACC4&SYSNDX TAG                                                         01243\n         MEND                                                           01244\n         MACRO                                                          01245\n&NAME    DISPLAY &REC,&DDNAME=SYSOUT,&RECFM=FA,&BLKSIZE=133             01246\n.*             AUTHOR.   DON HIGGINS.                                   01247\n.*             DATE.     11/18/74.                                      01248\n.*             REMARKS.  DISPLAY RECORD IF DD AVAILABLE.                01249\n.*                       REC MAY BE REGISTER OR LABEL OF REC.           01250\n.*                      R15=0 IS SUCCESSFUL                             01251\n.*                      R15=4 NO DD FOUND                               01252\n&NAME    TAG                                                            01253\nDSP1&SYSNDX B  *+4                                                      01254\n         FINDDD =CL8'&DDNAME'                                           01255\n         IF    (LTR,R1,R1,Z)                                            01256\n               WTO  '&DDNAME NOT FOUND'                                 01257\n               MVC  DSP1&SYSNDX+2(2),=S(DSP2&SYSNDX)                    01258\nDSP2&SYSNDX    LA   R15,4                                               01259\n               B    DSP4&SYSNDX                                         01260\n         FI                                                             01261\n         MVC   DSP1&SYSNDX+2(2),=S(DSP3&SYSNDX)                         01262\n         OPEN  (&DDNAME,(OUTPUT))                                       01263\n         B     DSP3&SYSNDX                                              01264\n&DDNAME  DCB   DSORG=PS,MACRF=PM,DDNAME=&DDNAME,                       X01265\n               RECFM=&RECFM,BLKSIZE=&BLKSIZE                            01266\nDSP3&SYSNDX TAG                                                         01267\n         AIF   ('&REC'(1,1) EQ '(').REG                                 01268\n         LA    R0,&REC                                                  01269\n         AGO   .PUT                                                     01270\n.REG     ANOP                                                           01271\n         LR    R0,&REC                                                  01272\n.PUT     ANOP                                                           01273\n         PUT   &DDNAME                                                  01274\n         ZR    R15                                                      01275\nDSP4&SYSNDX TAG                                                         01276\n         MEND                                                           01277\n         MACRO                                                          01278\n&N      TPPUTMSG &TERM,&MSG,&LMSG                                       01279\n.*             AUTHOR.   DON HIGGINS.                                   01280\n.*             DATE.     11/27/74.                                      01281\n.*             REMARKS.  ROUTE TERMINAL MESSAGE TO TPPUT.               01282\n.*                            TERM - TERMINAL NAME FIELD OR LITERAL     01283\n.*                            MSG  - MESSAGE FIELD OR LITERAL           01284\n.*                            LMSG - FULL WORD BINARY LENGTH (OPTIONAL) 01285\n         LCLA  &L                                                       01286\n         CNOP  0,4                                                      01287\n&N       BAL   1,*+16                                                   01288\n.CHKT1   AIF   ('&TERM'(1,1) EQ '''').TERMLIT                           01289\n         DC    A(&TERM)                                                 01290\n         AGO   .CHKM1                                                   01291\n.TERMLIT ANOP                                                           01292\n         DC    A(0)                                                     01293\n.CHKM1   AIF   ('&MSG'(1,1) EQ '''').MSGLIT                             01294\n         DC    A(&MSG)                                                  01295\n         AGO   .CHKL                                                    01296\n.MSGLIT  ANOP                                                           01297\n         DC    A(0)                                                     01298\n.CHKL    AIF   (T'&LMSG EQ 'O').LCALC                                   01299\n         DC    A(&LMSG)                                                 01300\n         AGO   .CHKT2                                                   01301\n.LCALC   ANOP                                                           01302\n         DC    A(0)                                                     01303\n         AIF   ('&MSG'(1,1) EQ '''').LCALCL                             01304\n&L       SETA  L'&MSG                                                   01305\n         LA    0,=A(&L)                                                 01306\n         ST    0,8(1)                                                   01307\n         AGO   .CHKT2                                                   01308\n.LCALCL  ANOP                                                           01309\n&L       SETA  K'&MSG-2                                                 01310\n         LA    0,=A(&L)                                                 01311\n         ST    0,8(1)                                                   01312\n.CHKT2   AIF   ('&TERM'(1,1) NE '''').CHKM2                             01313\n         LA    0,=C&TERM                                                01314\n         ST    0,0(1)                                                   01315\n         AGO   .CALL                                                    01316\n.CHKM2   AIF   ('&MSG'(1,1) NE '''').CALL                               01317\n         LA    0,=C&MSG                                                 01318\n         ST    0,4(1)                                                   01319\n.CALL    ANOP                                                           01320\n         L     15,=V(TPPUT)                                             01321\n         BALR  14,15                                                    01322\n         MEND                                                           01323\n         MACRO                                                          01324\n&N       TRTTAB &TYPE,&BAD=X'FF',&GOOD=X'00',&SKIP=,&FIND=,&FILL=C' '   01325\n         AIF   ('&TYPE' EQ 'PRINT').PRINT                               01326\n         AIF   ('&TYPE' EQ 'NUMERIC').NUMERIC                           01327\n         AIF   ('&TYPE' EQ 'ALPHA').ALPHA                               01328\n         AIF   ('&TYPE' EQ 'ALPHANUM').ALPHAN                           01329\n         AIF   ('&TYPE' EQ 'ZFILL').ZFILL                               01330\n         AIF   ('&TYPE' EQ 'BAD').BAD                                   01331\n         AIF   ('&TYPE' EQ 'GOOD').GOOD                                 01332\n         AIF   ('&TYPE' EQ 'SCAN').SCAN                                 01333\n         MNOTE 8,'TABLE TYPE INVALID'                                   01334\n         MEXIT                                                          01335\n.PRINT   ANOP                                                           01336\n&N       DC    (X'49'-X'00'+1)&FILL                                     01337\n         DC    (X'50'-X'4A'+1)AL1(*-&N)                                 01338\n         DC    (X'59'-X'51'+1)&FILL                                     01339\n         DC    (X'61'-X'5A'+1)AL1(*-&N)                                 01340\n         DC    (X'6A'-X'62'+1)&FILL                                     01341\n         DC    (X'6F'-X'6B'+1)AL1(*-&N)                                 01342\n         DC    (X'79'-X'70'+1)&FILL                                     01343\n         DC    (X'7F'-X'7A'+1)AL1(*-&N)                                 01344\n         DC    (X'C0'-X'80'+1)&FILL                                     01345\n         DC    (X'C9'-X'C1'+1)AL1(*-&N)                                 01346\n         DC    (X'D0'-X'CA'+1)&FILL                                     01347\n         DC    (X'D9'-X'D1'+1)AL1(*-&N)                                 01348\n         DC    (X'E1'-X'DA'+1)&FILL                                     01349\n         DC    (X'E9'-X'E2'+1)AL1(*-&N)                                 01350\n         DC    (X'EF'-X'EA'+1)&FILL                                     01351\n         DC    (X'F9'-X'F0'+1)AL1(*-&N)                                 01352\n         DC    (X'FF'-X'FA'+1)&FILL                                     01353\n         MEXIT                                                          01354\n.NUMERIC ANOP                                                           01355\n&N       DC    240&BAD,10&GOOD,6&BAD                                    01356\n         MEXIT                                                          01357\n.ALPHA   ANOP                                                           01358\n&N       DC    193&BAD,9&GOOD,7&BAD,9&GOOD,8&BAD,8&GOOD                 01359\n         DC    22&BAD                                                   01360\n         MEXIT                                                          01361\n.ALPHAN  ANOP                                                           01362\n&N       DC    193&BAD,9&GOOD,7&BAD,9&GOOD,8&BAD,8&GOOD                 01363\n         DC    6&BAD,10&GOOD,6&BAD                                      01364\n         MEXIT                                                          01365\n.ZFILL   ANOP                                                           01366\n&N       DC    64AL1(*-&N),C'0',191AL1(*-&N)                            01367\n         MEXIT                                                          01368\n.BAD     ANOP                                                           01369\n&N       DC    256&BAD                                                  01370\n         MEXIT                                                          01371\n.GOOD    ANOP                                                           01372\n&N       DC    256&GOOD                                                 01373\n         MEXIT                                                          01374\n.SCAN    ANOP                                                           01375\n         AIF   (T'&SKIP NE 'O').SKIP                                    01376\n         AIF   (T'&FIND NE 'O').FIND                                    01377\n         MNOTE 8,'TRT SCAN SKIP OR FIND CHARACTER NOT FOUND'            01378\n         MEXIT                                                          01379\n.SKIP    ANOP                                                           01380\n&N       DC    256&BAD                                                  01381\n         ORG   &N+&SKIP                                                 01382\n         DC    &GOOD                                                    01383\n         ORG                                                            01384\n         MEXIT                                                          01385\n.FIND    ANOP                                                           01386\n&N       DC    256&GOOD                                                 01387\n         ORG   &N+&FIND                                                 01388\n         DC    &BAD                                                     01389\n         ORG                                                            01390\n         MEXIT                                                          01391\n         MEND                                                           01392\n         MACRO                                                          01393\n&N       PTRACE &DDNAME=PTRACE                                          01394\n.*             AUTHOR.   DON HIGGINS.                                   01395\n.*             DATE.     01/06/75.                                      01396\n.*             REMARKS.  GENERATE TRACE OF EACH PENTRY NAME ENTERED.    01397\n.*                       THIS MACRO SHOULD BE PLACED AS FIRST           01398\n.*                       EXECUTABLE STATEMENT IN PROGRAM.               01399\n.*                       REMOVE AFTER TESTING TO ELIMINATE OVERHEAD.    01400\n         GBLB  &PTRACE                                                  01401\n         GBLC  &PTNAME                                                  01402\n&PTRACE  SETB  1                                                        01403\n&PTNAME  SETC  'PENT&SYSNDX'                                            01404\n&N       B     PEND&SYSNDX                                              01405\n         B     *+4                                                      01406\nPENT&SYSNDX  EQU *                                                      01407\n         STM   R14,R1,PSAV&SYSNDX                                       01408\n         MVC   *+6+2(2),PENT&SYSNDX-2                                   01409\n         LA    R1,*-*                                                   01410\n         SH    R1,=H'24'                                                01411\n         MVC   PMSG&SYSNDX+1(8),0(R1)                                   01412\n         DISPLAY PMSG&SYSNDX,DDNAME=&DDNAME                             01413\n         LM    R14,R1,PSAV&SYSNDX                                       01414\n         B     PENT&SYSNDX-4                                            01415\nPMSG&SYSNDX DC CL133' '                                                 01416\nPSAV&SYSNDX DC 4F'0'                                                    01417\nPEND&SYSNDX EQU *                                                       01418\n         MEND                                                           01419\n         MACRO                                                          01420\n&N       FINDCDE &EP=0,&EPLOC=0                                         01421\n.*             AUTHOR.   DON HIGGINS.                                   01422\n.*             DATE.     01/10/75.                                      01423\n.*             REMARKS.  SET R1 TO CDE ADDRESS OR ZERO                  01424\n         AIF   ('&EP'(1,1) EQ '0').EPLOC                                01425\n.EP      ANOP                                                           01426\n         BAL   R14,*+12                                                 01427\n         DC    CL8'&EP'                                                 01428\n         AGO   .FIND                                                    01429\n.EPLOC   ANOP                                                           01430\n         LA    R14,&EPLOC                                               01431\n.FIND    ANOP                                                           01432\n         LOADTCB R15                                                    01433\n         ZR    R1                                                       01434\n         L     R15,36(R15) TCBLLS FE PG 289                             01435\n         DO    WHILE,(LTR,R15,R15,NZ)                                   01436\n               L    R1,4(R15)      LLE CDE ADDRESS FE PG 280            01437\n               IF   (CLC,8(8,R1),0(R14),EQ)                             01438\n                    ZR   R15                                            01439\n               ELSE                                                     01440\n                    L    R15,0(R15)                                     01441\n                    ZR   R1                                             01442\n               FI                                                       01443\n         OD                                                             01444\n         MEND                                                           01445\n         MACRO                                                          01446\n&N       DOEXIT                                                         01447\n         GBLA  &DO(10),&DOSEQ(10),&DOLVL,&DOLAB                         01448\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           01449\n.*             AUTHOR.   DON HIGGINS.                                   01450\n.*             DATE.     01/29/75.                                      01451\n.*             REMARKS.  EXIT TO END OF CURRENT DO LOOP.                01452\n         AIF   (&DOLVL EQ 0).ERR1                                       01453\n         B     IF0&ELSE(&LEVEL)                                         01454\n         MEXIT                                                          01455\n.ERR1    MNOTE 8,'DOEXIT NOT WITHIN DO LOOP'                            01456\n         MEND                                                           01457\n         MACRO                                                          01458\n&N       HDC   &HLINE,&HCOL,&HDATA                                      01459\n         ORG   &HLINE+&HCOL                                             01460\n         AIF   (T'&HDATA EQ 'O').EXIT                                   01461\n&N       DC    &HDATA                                                   01462\n.EXIT    ANOP                                                           01463\n         MEND                                                           01464\n         MACRO                                                          01465\n&N       ABSP  &P                                                       01466\n         LCLA  &LP                                                      01467\n&LP      SETA  L'&P                                                     01468\n&N       OI    &P+&LP-1,X'0F' MAKE PACKED FIELD POSITIVE                01469\n         MEND                                                           01470\n         MACRO                                                          01471\n         XVBT3C                                                         01472\nCLGDSECT DSECT                                                          01473\n*              AUTHOR.   DON HIGGINS.                                   01474\n*              DATE.     04/04/75.                                      01475\n*              REMARKS.  RECORD CREATED BY GETCATLG (GU027000).         01476\nCLGVOL   DS    CL6       VOLUME                                         01477\nCLGDSN   DS    CL44      DATA SET NAME, CONNECT, INDEX, ALIAS, ETC.     01478\nCLGTYP   DS    CL1       1-DSN,2-CONNX,3-GDS,4-ALIAS,5-INDEX            01479\nCLGDEV   DS    XL4       DEVICE CODE                                    01480\nCLGDSNSQ DS    XL2       DATA SET SEQUENCE                              01481\nCLGVOLSQ DS    XL2       VOLUME SEQUENCE                                01482\nCLGGDSOP DS    BL1       X'02'-DELETE,X'01'-EMPTY OPTION                01483\nCLGGDSMX DS    XL1       MAXIMUM GDS DATA SET COUNT                     01484\nCLGGDSCR DS    XL2       CURRENT GDS DATA SET COUNT                     01485\n         MEND                                                           01486\n         MACRO                                                          01487\n         QCBD                                                           01488\n*                                                                       01489\n*              ENQ/DEQ CONTROL BLOCKS  (SEE IEAVENQ1 IGC056)            01490\n*                                                                       01491\n*                                                                       01492\n*              MAJOR QCB                                                01493\n*                                                                       01494\nQCBMAJ   DSECT                                                          01495\nQMJNEXT  DS    A    NEXT MAJOR QCB                                      01496\nQMJPREV  DS    A    PREVIOUS MAJOR QCB                                  01497\nQMJMINOR DS    A    FIRST MINOR QCB                                     01498\nQMJNAME  DS    CL8  MAJOR QCB NAME                                      01499\nQMJLNE   EQU   *-QCBMAJ                                                 01500\n*                                                                       01501\n*              MINOR QCB                                                01502\n*                                                                       01503\nQCBMIN   DSECT                                                          01504\nQMNQEL   DS    A    FIRST QUEUE ELEMENT                                 01505\nQMNPREV  DS    A    PREVIOUS MINOR QCB                                  01506\nQMNNEXT  DS    A    NEXT MINOR QCB                                      01507\nQMNLNM   DS    B    LENGTH OF RANME                                     01508\nQMNLSQA  DS    X    TYPE OF ENG                                         01509\nQMNSYS   EQU   255                                                      01510\nQMNSYSMS EQU   254                                                      01511\n*                   ANY OTHER VALUE IS STEP (TCBLSQA VALUE)             01512\nQMNNAME  DS    C                                                        01513\n*                                                                       01514\n*              QUEUE ELEMENT                                            01515\n*                                                                       01516\nQEL      DSECT                                                          01517\nQELNQEL  DS    A    NEXT QEL                                            01518\nQELSMC   EQU   QELNQEL       MUST COMPLETE INDICATORS                   01519\nQELSYSMC EQU   X'20'     SYSTEM MUST COMPLETE                           01520\nQELSTPMC EQU   X'10'     STEP MUST COMPLETE                             01521\nQELLQEL  DS    A    PREVIOUS QEL                                        01522\nQELCODE  EQU   QELLQEL   TYPE OF REQUEST                                01523\nQELSHAR  EQU   X'80'     SHARED                                         01524\nQELRESV  EQU   X'40'     RESERVED                                       01525\nQELRBWT  EQU   X'20'     DEFER SVRB PROCESSING UNTIL SWAP               01526\nQELNQECB EQU   X'10'     ENQ WITH ECB FOR WAIT                          01527\nQELRLSE  EQU   X'08'     DELAYED RELEASE                                01528\nQELEXCP  EQU   X'04'     EXCP INITIATED TO RELEASE DEVICE               01529\nQELSTAT  EQU   X'02'     STATUS SET PENDING                             01530\nQELABND  EQU   X'01'     QEL FOR TASK IN ABEND                          01531\nQELTCB   DS    A    TCB FOR ENQ                                         01532\nQELTJID1 EQU   QELTCB    FIRST BYTE OF TSO USER ID                      01533\nQELSVRB  DS    A    SVRB/UCB FOR ENQ                                    01534\nQELTJID2 EQU   QELSVRB   SECOND BYTE OF TSO USER ID                     01535\n         MEND                                                           01536\n         MACRO                                                          01537\n&N       SDCB  &M=PM,&R=FBA,&L=133,&B=0,&E=1                            01538\n.*             AUTHOR.   DON HIGGINS.                                   01539\n.*             DATE.     09/29/75.                                      01540\n.*             REMARKS.  SHORT FORM OF COMMONLY USED DCB WITH EXIT TO   01541\n.*                       PLUG ZERO BLKSIZE WITH LRECL.                  01542\n         DS    0A                                                       01543\n         DC    X'85',AL3(*+3) DCB EXIT LIST                             01544\n         OC    62(2,1),62(1)       IS BLKSIZE = 0                       01545\n         BCR   7,14                NO, EXIT NOW                         01546\n         MVC   62(2,1),82(1)       YES, BLKSIZE=LRECL                   01547\n         BR    14                  EXIT                                 01548\n         DC    CL8'&N'        DCB NAME FOR DUMP VERIFICATION            01549\n&N       DCB   EXLST=&N-28,DSORG=PS,DDNAME=&N,                         X01550\n               MACRF=&M,RECFM=&R,LRECL=&L,BLKSIZE=&B,EODAD=&E           01551\n         MEND                                                           01552\n         MACRO                                                          01553\n         ELSEIF                                                         01554\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           01555\n         GBLA  &ELSEIF(10)                                              01556\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     01557\n         LCLC  &OP,&OPR                                                 01558\n         LCLB  &TESTSW                                                  01559\n.*             AUTHOR.   DON HIGGINS.                                   01560\n.*             DATE.     05/23/76.                                      01561\n.*             REMARKS.  CONTROL STRUCTURE FOR CONDITIONAL EXECUTION.   01562\n         AIF   (&LEVEL EQ 10).ERR1                                      01563\n         ELSE                                                           01564\n&LEVEL   SETA  &LEVEL+1                                                 01565\n&ELSEIF(&LEVEL) SETA 1                                                  01566\n&SEQ(&LEVEL) SETA 1                                                     01567\n&LAB     SETA  &LAB+1                                                   01568\n&ELSE(&LEVEL) SETA &LAB                                                 01569\n&N       SETA N'&SYSLIST                                                01570\n.NEXTAND ANOP                                                           01571\n&TESTSW  SETB  0                                                        01572\n.TEST    ANOP                                                           01573\n&S       SETA  &S+1                                                     01574\n         AIF   (&S GT &N).ERR2                                          01575\n&M       SETA  N'&SYSLIST(&S)                                           01576\n         AIF   (&M EQ 1).TESTEND                                        01577\n         AIF   (&M LT 2).ERR3                                           01578\n         AIF   (&M GT 5).ERR4                                           01579\n&I       SETA  2                                                        01580\n&OPR     SETC  ''                                                       01581\n&OP      SETC  '&SYSLIST(&S,1)'                                         01582\n         AIF   (&M GT 2).TESTOPR                                        01583\n         &OP                                                            01584\n         AGO   .TESTEND                                                 01585\n.TESTOPR ANOP                                                           01586\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   01587\n&L       SETA  K'&SYSLIST(&S,&I)                                        01588\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         01589\n         AGO   .NEXTOPR                                                 01590\n.NOLIT   ANOP                                                           01591\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 01592\n.NEXTOPR ANOP                                                           01593\n&I       SETA  &I+1                                                     01594\n         AIF   (&I EQ &M).TESTGEN                                       01595\n&OPR     SETC  '&OPR'.','                                               01596\n         AGO   .TESTOPR                                                 01597\n.TESTGEN ANOP                                                           01598\n         &OP   &OPR                                                     01599\n.TESTEND ANOP                                                           01600\n         AIF   (&TESTSW EQ 1).ORBC                                      01601\n.AMBC    ANOP                                                           01602\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               01603\n.CONNECT ANOP                                                           01604\n&S       SETA  &S+1                                                     01605\n         AIF   (&S GT &N).EXIT                                          01606\n&M       SETA  N'&SYSLIST(&S)                                           01607\n         AIF   (&M NE 1).ERR5  BAD CONNECTOR                            01608\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        01609\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR5  BAD CONNECTOR             01610\n.NEXTOR   ANOP                                                          01611\n&LAB1    SETA  &LAB+1                                                   01612\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     01613\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      01614\n&LAB     SETA  &LAB+2                                                   01615\n&ELSE(&LEVEL) SETA &LAB                                                 01616\n&TESTSW  SETB  1                                                        01617\n         AGO   .TEST                                                    01618\n.ORBC    ANOP                                                           01619\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               01620\nIF0&LAB1 EQU *                                                          01621\n         AGO   .CONNECT                                                 01622\n.ERR1    MNOTE 8,'IF - LEVEL OVERFLOW'                                  01623\n         AGO   .EXIT                                                    01624\n.ERR2    MNOTE 8,'IF - MISSING TEST LIST'                               01625\n         AGO   .EXIT                                                    01626\n.ERR3    MNOTE 8,'IF - TEST LIST TOO SHORT'                             01627\n         AGO   .EXIT                                                    01628\n.ERR4    MNOTE 8,'IF - TEST LIST TOO LONG'                              01629\n         AGO   .EXIT                                                    01630\n.ERR5    MNOTE 8,'IF - INVALID CONNECTOR'                               01631\n.EXIT    ANOP                                                           01632\n         MEND                                                           01633\n*          DATA SET CBT848     AT LEVEL 003 AS OF 10/02/77\n*          DATA SET GU014300   AT LEVEL 007 AS OF 01/25/73              00001\nGETPDSDE SUBENTRY                                                       00002\n*              AUTHOR.   DON HIGGINS.                                   00003\n*              DATE.     11/11/72.                                      00004\n*              REMARKS.  GET NEXT DIRECTORY ENTRY NAME FROM PDS         00005\n*                        DIRECTORY.                                     00006\n*                                                                       00007\n*                        ARGUMENTS                                      00008\n*                                                                       00009\n*                          1. ADDRESS OF DCB FOR PDS DIRECTORY. IT      00010\n*                             MUST HAVE FOLLOWING CHARACTERISTICS AND   00011\n*                             BE OPEN FOR INPUT WITH NO EDDAD           00012\n*                                                                       00013\n*                             PDSDCB DCB DSORG=PS,MACRF=GL,         X   00014\n*                                        RECFM=F,BLKSIZE=256,       X   00015\n*                                            LRECL=256                  00016\n*                                        DDNAME=XXXXXXXX                00017\n*                          2. ADDRESS OF END OF DIRECTORY ROUTINE       00018\n*                                                                       00019\n*                          3.  ADDRESS OF FULL WORD WHERE ADDRESS OF    00020\n*                              NEXT DE ENTRY NAME WILL BE PLACED.       00021\n*                                                                       00022\n*                        THIS ROUTINE IS REUSEABLE AND MAY BE USED      00023\n*                        TO READ SEVERAL DIRECTORIES CONCURRENTLY.      00024\n*                                                                       00025\n*                                                                       00026\n         LM    R2,R4,0(R1)                                              00027\n         USING IHADCB,R2                                                00028\n         L     R5,DCBEODAD                                              00029\n         TM    DCBEODAD+3,X'03'         IS IT ODD                       00030\n         BZ    RELOAD                   NO, RELOAD LOD REGS             00031\n         LA    R0,WKLENGTH                                              00032\n         GETMAIN R,LV=(0)          NO,  GET WORKAREA                    00033\n         LR    R5,R1                                                    00034\n         USING WORKAREA,R5         R5=A(ADDR OF AREA SAVED IN EODAD)    00035\n         ST    R5,WKADDR           PUT ADDRESS OF AREA IN AREA FOR MVC  00036\n         XC    WKREGS,WKREGS       CLEAR AREA FOR WORK REGS             00037\nRELOAD   TAG                                                            00038\n         LM    R6,R9,WKREGS        RELOAD                               00039\n         AR    R6,R9               R6=A(NEXT ENTRY)                     00040\nTESTEOB  CR    R6,R7               IS IT END OF BLOCK                   00041\n         BNL   NEXTBLK             YES, GET NEXT BLOCK                  00042\n         CLI   0(R6),X'FF'              IS IT END OF DIRECTORY          00043\n         BE    EOF                      YES, GO TO EOF                  00044\n         ST    R6,0(R4)            STORE ADDRESS OF DE                  00045\n         NI    11(R6),X'1F'        TURN OFF ALIAS AND POINT CNT BITS    00046\n         IC    R8,11(R6)                                                00047\n         LA    R9,12(R8,R8)        R9=12 + 2 X (HALF WORDS)             00048\n         STM   R6,R9,WKREGS        SAVE WORK REGS                       00049\n         SUBEXIT                                                        00050\nNEXTBLK  TAG                                                            00051\n         MVC   DCBEODAD+1(3),=AL3(EOF)  SET LOCAL EOF IN DCB            00052\n         GET   (R2)                     GET NEXT BLOCK                  00053\n         LR    R6,R1                    R6=A(BLOCK)                     00054\n         MVC   WKREGS(2),0(R6)          ALIGN HALF WORK BLOCK LENGTH    00055\n         LH    R9,WKREGS           R9=LENGTH OF BLOCK                   00056\n         LA    R7,0(R6,R9)         R7=A(END OF BLOCK)                   00057\n         LA    R6,2(R6)            R6=A(FIRST ENTRY)                    00058\n         MVC   DCBEODAD+1(3),WKADDR+1   SAVE WORK AREA ADDR IN EODAD    00059\n         B     TESTEOB                  PROCESS BLOCK                   00060\nEOF      TAG                                                            00061\n         MVC   DCBEODAD+1(3),=AL3(1) RESET EODAD                        00062\n         LA    R0,WKLENGTH                                              00063\n         LR    R1,R5                                                    00064\n         FREEMAIN R,LV=(0),A=(1)        FREE WORKAREA                   00065\n         L     R13,4(R13)                                               00066\n         LM    R14,R12,12(R13)                                          00067\n         L     R14,4(R1)                                                00068\n         BR    R14                 EXIT TO EOF ADDRESS                  00069\n         LTORG                                                          00070\n         EQUREGS                                                        00071\n         DCBD  DSORG=PS                                                 00072\nWORKAREA DSECT                                                          00073\nWKADDR   DS    F                   ADDRESS OF GETMAIN WORKAREA          00074\nWKREGS   DS    0XL16                                                    00075\n         DS    F                   R6=A(CURRENT DE)                     00076\n         DS    F                   R7=A(END OF BLOCK)                   00077\n         DS    F                   R8=INSERT WORK REG                   00078\n         DS    F                   R9=LENGTH OF DE                      00079\nWKLENGTH EQU   *-WORKAREA                                               00080\n#PAN$AUD CSECT                                                          000804\n$PAN#AUD DC    CL21'003CBT848    10/02/77'                              000805\n         END   GETPDSDE                                                 00081\n", "mimetype": "text/plain", "datatype": "iso-8859-1", "extension": ".txt"}, "JCL": {"ttr": 1801, "alias": false, "halfwords": 0, "notes": 0, "parms": "b''", "ispf": false, "text": "//PDSXREF    PROC   SO=1,LIB='SYS2.TLINKLIB',V1=\n//*\n//* THIS PROCEDURE WILL READ A PDS AND PRODUCE TWO REPORTS\n//*\n//*  1. LIST ALL CSECT NAMES WITHIN EACH MEMBER\n//*\n//*  2. LIST ALL MEMBERS WHICH REFERENCE EACH CSECT NAME\n//*\n//PDSXREF    EXEC   PGM=CBT842,REGION=384K\n//PDSLIB     DD     DSN=&LIB,DISP=SHR,UNIT=SYSALLDA,VOL=SER=&V1\n//PDSMEM     DD     DSN=&LIB,DISP=SHR,UNIT=SYSALLDA,VOL=SER=&V1\n//NAMEIN     DD     UNIT=SYSDA,SPACE=(CYL,(10,1)),DCB=BLKSIZE=1600\n//NAMEOUT    DD     UNIT=SYSDA,SPACE=(CYL,(10,1)),DCB=BLKSIZE=1600\n//SORTLIB    DD     DSN=SYS1.SORTLIB,DISP=SHR\n//SYSOUT     DD     SYSOUT=&SO\n//LSTMEMBR   DD     SYSOUT=&SO\n//LSTCSECT   DD     SYSOUT=&SO\n//NAMEWK01   DD     UNIT=SYSDA,SPACE=(CYL,(10,10))\n//NAMEWK01   DD     UNIT=SYSDA,SPACE=(CYL,(10,10))\n//NAMEWK02   DD     UNIT=SYSDA,SPACE=(CYL,(10,10))\n//NAMEWK03   DD     UNIT=SYSDA,SPACE=(CYL,(10,10))\n//NAMEWK04   DD     UNIT=SYSDA,SPACE=(CYL,(10,10))\n//NAMEWK05   DD     UNIT=SYSDA,SPACE=(CYL,(10,10))\n//NAMEWK06   DD     UNIT=SYSDA,SPACE=(CYL,(10,10))\n", "mimetype": "text/plain", "datatype": "iso-8859-1", "extension": ".txt"}, "OBJECT": {"ttr": 1803, "alias": false, "halfwords": 0, "notes": 0, "parms": "b''", "ispf": false, "mimetype": "application/octet-stream", "datatype": "binary", "extension": ".bin"}, "PDSCLIST": {"ttr": 2049, "alias": false, "halfwords": 0, "notes": 0, "parms": "b''", "ispf": false, "text": "*          DATA SET CBT840     AT LEVEL 001 AS OF 09/29/77\n         MACRO                                                          00001\n&N       DTIME &FIELD                                                   00002\n&N       TIME  DEC                                                      00003\n         CNOP  0,4                                                      00004\n         STM   0,1,*+8                                                  00005\n         B     *+12                                                     00006\n         DC    2F'0'                                                    00007\n         EDIT  TO=&FIELD,FROM=*-14,MASK=' 99/99/99.99F ZZ99.999'        00008\n         MEND                                                           00009\n         MACRO                                                          00010\n&NAME    EDIT  &TO=,&FROM=,&MASK=                                       00011\n.*                                                                      00012\n.*             MACRO-ID. 'EDIT'.                                        00013\n.*             AUTHOR.   DON HIGGINS.                                   00014\n.*             DATE WRITTEN.  07/18/70.                                 00015\n.*             REMARKS.                                                 00016\n.*                  FUNCTION - GENERATE MASK AND/OR INSTRUCTIONS TO     00017\n.*                             EDIT PACKED DECIMAL DATA FOR PRINTING.   00018\n.*                  OPERANDS                                            00019\n.*                   TO=   LABEL OF DISPLAY FIELD INTO WHICH THE EDITED 00020\n.*                         DATA WILL BE PLACED IF SPECIFIED.            00021\n.*                   FROM= LABEL OF PACKED DECIMAL DATA TO BE EDITED    00022\n.*                         IF SPECIFIED.                                00023\n.*                   MASK= STRING OF UP TO 48 CHARACTERS IN SINGLE      00024\n.*                         QUOTES DEFINING EDIT MASK SIMILAR            00025\n.*                         TO A COBOL PICTURE.  THIS OPERAND IS         00026\n.*                         REQUIRED.  IF THE OTHER TWO OPERANDS ARE NOT 00027\n.*                         DEFINED, A DC WITH THE DESIRED MASK IS       00028\n.*                         GENERATED.  SPECIAL EDIT CHARACTERS ARE AS   00029\n.*                         FOLLOWS:                                     00030\n.*                            Z - DIGIT SELECT WITH ZERO SURPRESSION    00031\n.*                            9 - DIGIT SELECT WITHOUT ZERO SURPRESSION 00032\n.*                            F - FIELD SELECT RESETS SIGNIFICANCE TO   00033\n.*                                ALLOW MULTIPLE FIELD EDITING          00034\n.*                            $ - DIGIT SELECT WITH ZERO SURPRESSION    00035\n.*                                AND FLOATING DOLLAR SIGN.             00036\n.*                  NOTES:                                              00037\n.*                   1.  THE FIRST MASK CHARACTER IS USED AS THE FILL   00038\n.*                       CHARACTER IN ALL FIELDS.                       00039\n.*                   2.  THE FOLLOWING EXAMPLE WOULD EDIT BOTH THE TIME 00040\n.*                       AND DATE OBTAINED USING THE TIME MACRO         00041\n.*                            .                                         00042\n.*                            TIME DEC                                  00043\n.*                            STM  0,1,PDATA                            00044\n.*                            EDIT TO=LINE+10,FROM=PDATA,               00045\n.*                                 MASK=' 99/99/99.99F ZZ99.999'        00046\n.*                            .                                         00047\n.*                       PDATA DS  2F     (HHMMSSTH00YYDDDC)            00048\n.*                       LINE  DC  CL133' '                             00049\n.*                            .                                         00050\n.*                   3.  THE FOLLOWING EXAMPLE WOULD GENERATE A DC      00051\n.*                       LABELED MASKPAY TO BE USED AS A MASK FOR       00052\n.*                       EDITING DIFFERENT FILEDS.                      00053\n.*                            .                                         00054\n.*                       MASKPAY   EDIT MASK=' Z,ZZZ,ZZ9.99 CR'         00055\n.*                            .                                         00056\n.*                   4.  THE MASK CHARACTERS DETERMINE EXPLICIT LENGTH. 00057\n.*                   5.  MULTIPLE FIELDS CANNOT CONTAIN FLOATING        00058\n.*                       DOLLAR SIGNS.                                  00059\n.*                                                                      00060\n         LCLA  &LMASK,&SIGNF,&NEXT,&FIELDS,&FLOAT                       00061\n         LCLC  &C,&C1,&C2,&C3,&C4,&C5,&C6                               00062\n         AIF   (T'&MASK NE 'U').BADMASK                                 00063\n&LMASK   SETA  K'&MASK-2                                                00064\n         AIF   (&LMASK GT 48).BADMASK                                   00065\n         AIF   (&LMASK LT 1).BADMASK                                    00066\n         AIF   ('&MASK'(1,1) NE '''').BADMASK                           00067\n         AIF   ('&MASK'(&LMASK+2,1) NE '''').BADMASK                    00068\n.LOOP    ANOP                                                           00069\n&NEXT    SETA  &NEXT+1                                                  00070\n         AIF   (&NEXT GT &LMASK).GEN                                    00071\n&C       SETC  '&MASK'(&NEXT+1,1)                                       00072\n         AIF   ('&C' EQ '9').NINE                                       00073\n         AIF   ('&C' EQ 'Z').ZZZZ                                       00074\n         AIF   ('&C' EQ '$').DOLLAR                                     00075\n         AIF   ('&C' EQ 'F').FIELD                                      00076\n.AD1     AIF   ('&C1' GT '9999999').AD2                                 00077\n&C1      SETC  '&C1&C'                                                  00078\n         AGO   .LOOP                                                    00079\n.AD2     AIF   ('&C2' GT '9999999').AD3                                 00080\n&C2      SETC  '&C2&C'                                                  00081\n         AGO   .LOOP                                                    00082\n.AD3     AIF   ('&C3' GT '9999999').AD4                                 00083\n&C3      SETC  '&C3&C'                                                  00084\n         AGO   .LOOP                                                    00085\n.AD4     AIF   ('&C4' GT '9999999').AD5                                 00086\n&C4      SETC  '&C4&C'                                                  00087\n         AGO   .LOOP                                                    00088\n.AD5     AIF   ('&C5' GT '9999999').AD6                                 00089\n&C5      SETC  '&C5&C'                                                  00090\n         AGO   .LOOP                                                    00091\n.AD6     AIF   ('&C6' GT '9999999').BADMASK                             00092\n&C6      SETC  '&C6&C'                                                  00093\n         AGO   .LOOP                                                    00094\n.NINE    AIF   (&SIGNF EQ 0).SETSIG                                     00095\n.ZZZZ    ANOP                                                           00096\n&C       SETC  '\u0080'       (11-0-1-8-9)=X'20'  DIGIT SELECT               00097\n         AGO   .AD1                                                     00098\n.DOLLAR  ANOP                                                           00099\n&FLOAT   SETA  1                                                        00100\n         AGO   .ZZZZ                                                    00101\n.FIELD   ANOP                                                           00102\n&C       SETC  '\u0082'       (0-2-9)=X'22'       FIELD SELECT               00103\n&SIGNF   SETA  0                                                        00104\n&FIELDS  SETA  1                                                        00105\n         AGO   .AD1                                                     00106\n.SETSIG  ANOP                                                           00107\n&C       SETC  '\u0081'       (0-1-9)=X'21'       SIGNIFICANCE STARTER       00108\n&SIGNF   SETA  &NEXT                                                    00109\n         AGO   .AD1                                                     00110\n.GEN     AIF   (T'&TO EQ 'O').GENDC                                     00111\n         AIF   (T'&FROM EQ 'O').BADFROM                                 00112\n         AIF   (&FLOAT EQ 1).GENFL                                      00113\n&NAME    MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00114\n         ED    &TO.(&LMASK.),&FROM                                      00115\n         MEXIT                                                          00116\n.GENDC   AIF   (T'&FROM NE 'O').BADTO                                   00117\n&NAME    DC    CL&LMASK.'&C1&C2&C3&C4&C5&C6'                            00118\n         MEXIT                                                          00119\n.GENFL   AIF   (&FIELDS NE 0).BADMIX                                    00120\n         AIF   (&SIGNF  GT 0).GENLA                                     00121\n&NAME    LA    1,1                                                      00122\n         MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00123\n         EDMK  &TO.(&LMASK.),&FROM                                      00124\n         BCT   1,*+8                                                    00125\n         B     *+8                                                      00126\n         MVI   0(1),C'$'                                                00127\n         MEXIT                                                          00128\n.GENLA   ANOP                                                           00129\n&NAME    LA    1,&TO.+&SIGNF                                            00130\n         MVC   &TO.(&LMASK.),=CL&LMASK.'&C1&C2&C3&C4&C5&C6'             00131\n         EDMK  &TO.(&LMASK.),&FROM                                      00132\n         BCTR  1,0                                                      00133\n         MVI   0(1),C'$'                                                00134\n         MEXIT                                                          00135\n.BADMIX  MNOTE 0,'MULTIPLE FIELDS CANNOT CONTAIN FLOATING DOLLAR SIGNS' 00136\n         MEXIT                                                          00137\n.BADMASK MNOTE 0,'INVALID MASK (1-48 CHARACTERS IN SINGLE QUOTES)'      00138\n         MEXIT                                                          00139\n.BADTO   MNOTE 0,'MISSING TO FIELD'                                     00140\n         MEXIT                                                          00141\n.BADFROM MNOTE 0,'MISSING FROM FIELD'                                   00142\n         MEXIT                                                          00143\n         MEND                                                           00144\n         MACRO                                                          00145\n         EQUREGS &LIMITS                                                00146\n.*                                                                      00147\n.*             MACRO-ID. 'EQUREGS'.                                     00148\n.*             AUTHOR. DON HIGGINS.                                     00149\n.*             DATE WRITTEN. 08/04/70.                                  00150\n.*             REMARKS.                                                 00151\n.*                 THIS MACRO GENERATES EQU STATEMENTS FOR 1 TO 16      00152\n.*                 SYMBOLIC REGISTER NAMES OF THE FORM R0 UP TO R15     00153\n.*             THE REGISTER EQU DESIRED CAN BE SPECIFIED IN THE FORM    00154\n.*             OF  (0,15), (14,1), (2,6), ETC.                          00155\n         LCLA  &LOW,&HIGH                                               00156\n         AIF   (N'&SYSLIST EQ 1).GETLIM                                 00157\n.DEFAULT ANOP                                                           00158\n&LOW     SETA  0                                                        00159\n&HIGH    SETA  15                                                       00160\n.GEN     ANOP                                                           00161\nR&LOW    EQU   &LOW                                                     00162\n         AIF   (&LOW EQ &HIGH).DONE                                     00163\n&LOW     SETA  &LOW+1                                                   00164\n         AIF   (&LOW LE 15).GEN                                         00165\n&LOW     SETA  0                                                        00166\n         AGO   .GEN                                                     00167\n.GETLIM  AIF   (N'&SYSLIST(1) NE 2).DEFAULT                             00168\n         AIF   (T'&SYSLIST(1,1) NE 'N').DEFAULT                         00169\n         AIF   (T'&SYSLIST(1,2) NE 'N').DEFAULT                         00170\n&LOW     SETA  &SYSLIST(1,1)                                            00171\n         AIF   (&LOW LT 0).DEFAULT                                      00172\n         AIF   (&LOW GT 15).DEFAULT                                     00173\n&HIGH    SETA  &SYSLIST(1,2)                                            00174\n         AIF   (&HIGH LT 0).DEFAULT                                     00175\n         AIF   (&HIGH GT 15).DEFAULT                                    00176\n         AGO   .GEN                                                     00177\n.DONE    MEXIT                                                          00178\n         MEND                                                           00179\n         MACRO                                                          00180\n         FILL   &TAG,&FILL=C' '                                         00181\n         LCLA  &LTAG                                                    00182\n.*             AUTHOR.   DON HIGGINS.                                   00183\n.*             DATE.     09/16/71.                                      00184\n.*             REMARKS.  FILL REMAINDER OF AREA WITH FILL CHARACTER.    00185\n&LTAG    SETA  L'&TAG                                                   00186\n         DC    (&LTAG)&FILL                                             00187\n         ORG   &TAG+&LTAG                                               00188\n         MEND                                                           00189\n         MACRO                                                          00190\n&NAME    IOB   &FLAGS=,&ECB=,&CCW=,&DCB=,&ID=                           00191\n.*             AUTHOR.   DON HIGGINS.                                   00192\n.*             DATE.     11/23                                          00193\n.*             REMARKS.  INPUT/OUTPUT CONTROL BLOCK MACRO.              00194\n.*                       REF. SYS. PROG. GUIDE C28-6550-6 PG 139        00195\n.*                                                                      00196\n&NAME    DS    0F                                                       00197\n         DC    &FLAGS         FLAGS 1  0-CD 1-CC 6-NOT REL 23457-RESV   00198\n         DC    XL1'00'        FLAGS 2  RESERVED                         00199\nSNS&ID   DC    XL2'00'        FIRST TWO SENSE BYTES AFTER UNIT CHECK    00200\n         DC    XL1'00'        ECB CODE                                  00201\nECB&ID   DC    AL3(&ECB)      EVENT CONTROL BLOCK ADDRESS               00202\n         DC    XL1'00'        FLAGS 3 RESERVED                          00203\nCSW&ID   DC    XL7'00'        CHANNEL STATUS WORD (LOW ORDER 7 BYTES)   00204\n         DC    XL1'00'        SIO CODE (INS LENGTH X CONDITION CODE)    00205\nCCW&ID   DC    AL3(&CCW)      CHANNEL COMMAND WORD ADDRESS              00206\n         DC    XL1'00'        RESERVED                                  00207\nDCB&ID   DC    AL3(&DCB)      DATA CONTROL BLOCK ADDRESS                00208\n         DC    XL1'00'        REPOSITION MODIFIER                       00209\n         DC    AL3(0)         RESTART ADDRESS                           00210\n         DC    H'0'           BLOCK COUNT INCREMENT                     00211\n         DC    H'0'           ERROR COUNTS                              00212\n         DC    XL1'00'        M - EXTENT ENTRY IN DEB                   00213\n         DC    XL7'00'        SEEK ADDRESS BBCCHHR                      00214\n         MEND                                                           00215\n         MACRO                                                          00216\n&N       PENTRY                                                         00217\n.*             AUTHOR.   DON HIGGINS.                                   00218\n.*             DATE.     01/06/75.                                      00219\n.*             REMARKS.  PERFORM ROUTINE ENTRY POINT WITH TRACE OPTION. 00220\n.*                       SEE PTRACE MACRO FOR TRACE INFO.               00221\n         GBLB  &PTRACE                                                  00222\n         GBLC  &PTNAME                                                  00223\n         GBLC  &PENAME                                                  00224\n&PENAME  SETC  '&N'                                                     00225\n         DC    0H'0',CL8'&N'                                            00226\n         B     *+4                                                      00227\n&N       EQU   *                                                        00228\n         AIF   (&PTRACE EQ 0).NOTRACE                                   00229\n         PM    &PTNAME                                                  00230\n.NOTRACE ANOP                                                           00231\n         MEND                                                           00232\n         MACRO                                                          00233\n&N       PERFORM &PENTRY                                                00234\n&N       MVC   &PENTRY-2(2),*+10                                        00235\n         B     &PENTRY                                                  00236\n         DC    S(*+2)                                                   00237\n         MEND                                                           00238\n         MACRO                                                          00239\n&N       PEXIT                                                          00240\n         GBLC  &PENAME                                                  00241\n&N       B     &PENAME-4                                                00242\n         MEND                                                           00243\n         MACRO                                                          00244\n&NAME    SCALL &SUBNAME,&ARGLIST                                        00245\n.*             AUTHOR.   DON HIGGINS.                                   00246\n.*             DATE.     11/09/70.                                      00247\n.*             REMARKS.  SHORT FORM OF IBM CALL MACRO WITH NO VL.       00248\n         AIF   (T'&ARGLIST EQ 'O').NOARG                                00249\n&NAME    LA    1,=A&ARGLIST        LOAD ARGUMENT LIST ADDRESS           00250\n         L     15,=V(&SUBNAME)     LOAD SUBPROGRAM ENTRY ADDRESS        00251\n         BALR  14,15               BRANCH AND LINK                      00252\n         MEXIT                                                          00253\n.NOARG   ANOP                                                           00254\n&NAME    L     15,=V(&SUBNAME)     LOAD SUBPROGRAM ENTRY ADDRESS        00255\n         BALR  14,15               BRANCH AND LINK                      00256\n         MEND                                                           00257\n         MACRO                                                          00258\n&NAME    SUBENTRY &CSECT=YES,&BASES=(13),                              X00259\n               &RENT=NO,&RWA=,&RWALNG=0,&SP=0                           00260\n         LCLA  &NBASE,&S,&OFFSET                                        00261\n.*             MACRO-ID. 'SUBENTRY'                                     00262\n.*             AUTHOR.   DON HIGGINS.                                   00263\n.*             DATE WRITTEN.  07/28/70.                                 00264\n.*             REMARKS.  THIS MACRO GENERATES THE CODE TO ESTABLISH A   00265\n.*                       CSECT WITH SAVE AREA AND BASE REGISTER USING   00266\n.*                       STANDARD OS LINKAGE CONVENTIONS.               00267\n.*             REV1 11/14/74 ADD REENTRANT OPTION WITH WORK AREA        00268\n.*                 1.  FOR REENTRANT LINKAGE YOU MUST SPECIFY           00269\n.*                     A.  RENT=YES                                     00270\n.*                     B.  AT LEAST ONE BASE REGISTER OTHER THAN 13     00271\n.*                         SUCH AS BASES=(R12)                          00272\n.*                 2.  OPTIONALLY YOU CAN SPECIFY A DSECT NAME AND      00273\n.*                     LENGTH FOR A WORK AREA BUILT BEHIND SAVE AREA.   00274\n.*                     FOR EXAMPLE  RWADSECT=MYWORK,RWALNG=8            00275\n.*                     NOTE THAT THIS WORK AREA LENGTH MUST ALSO BE     00276\n.*                     SPECIFIED AT SUBEXIT TIME TO CORRECTLY CALCULATE 00277\n.*                     THE FREEMAIN LENGTH.                             00278\n.*             REV2 02/10/76 DSH - ADD SUBPOOL OPTION                   00279\n         AIF   ('&CSECT'(1,1) EQ 'N').NOCSECT                           00280\n&NAME    CSECT                                                          00281\n         AGO   .STM                                                     00282\n.NOCSECT ANOP                                                           00283\n&NAME    DS    0D                                                       00284\n.STM     ANOP                                                           00285\n         AIF   ('&RENT'(1,1) EQ 'N').NORENT                             00286\n.RENT    ANOP                                                           00287\n         STM   14,12,12(13)                                             00288\n         BAL   &BASES(1),16(15)                                         00289\n         USING &NAME+8,&BASES(1)                                        00290\n         DC    CL8'&NAME'                                               00291\n         LA    0,72+&RWALNG                                             00292\n         AIF   ('&SP' EQ '0').SKIPSP                                    00293\n         LA    1,&SP                                                    00294\n         SLL   1,24                                                     00295\n         OR    0,1                                                      00296\n.SKIPSP  ANOP                                                           00297\n         GETMAIN R,LV=(0)                                               00298\n         ST    1,8(13)                                                  00299\n         ST    13,4(1)                                                  00300\n         LM    14,1,12(13)                                              00301\n         L     13,8(13)                                                 00302\n         AIF   ('&RWALNG' EQ '0').GEN                                   00303\n         USING &RWA-72,13                                               00304\n         AGO   .GEN                                                     00305\n.NORENT  ANOP                                                           00306\n         STM   14,12,12(13)                                             00307\n         BAL   15,88(15)                                                00308\n         DC    9D'0'                                                    00309\n         DC    CL8'&NAME'                                               00310\n         ST    15,8(13)                                                 00311\n         ST    13,4(15)                                                 00312\n         LR    13,15                                                    00313\n         AIF   (T'&BASES(1) NE 'N').CHKR13                              00314\n         AIF   (&BASES(1) EQ 13).GENB13                                 00315\n         AGO   .GENBX                                                   00316\n.CHKR13  ANOP                                                           00317\n         AIF   ('&BASES'(2,3) EQ 'R13').GENB13                          00318\n.GENBX   ANOP                                                           00319\n         LR    &BASES(1),13                                             00320\n         USING &NAME+8,&BASES(1)                                        00321\n         AGO   .GEN                                                     00322\n.GENB13  ANOP                                                           00323\n         USING &NAME+8,13                                               00324\n.GEN     ANOP                                                           00325\n&NBASE   SETA  N'&BASES                                                 00326\n&S       SETA  1                                                        00327\n.L1      ANOP                                                           00328\n&S       SETA  &S+1                                                     00329\n         AIF   (&S GT &NBASE).EXIT                                      00330\n&OFFSET  SETA  &OFFSET+4095                                             00331\n         LA    &BASES(&S),4095(&BASES(&S-1))                            00332\n         USING &NAME+8+&OFFSET,&BASES(&S)                               00333\n         AGO   .L1                                                      00334\n.EXIT    ANOP                                                           00335\n         MEND                                                           00336\n         MACRO                                                          00337\n&NAME    SUBEXIT &RC=0,&RENT=NO,&RWALNG=0,&SP=0                         00338\n.*             MACRO-ID. 'SUBEXIT'.                                     00339\n.*             AUTHOR.   DON HIGGINS.                                   00340\n.*             DATE WRITTEN.  07/28/70.                                 00341\n.*             REMARKS.  THIS MACRO GENERATES THE CODE TO RESTORE       00342\n.*                       REGISTERS AND RETURN FROM A CSECT.  A RETURN   00343\n.*                       CODE OF ZERO IS RETURNED UNLESS A DIFFERENT    00344\n.*                       CODE IS SPECIFIED USING THE KEY WORD RC=.      00345\n.*             REV1 11/14/74 ADD REENTRANT OPTION. SEE SUBENTRY.        00346\n.*             REV2 12/09/74 ADD REG OPTION FOR RC OPERAND.             00347\n.*             REV3 02/10/76 DSH - ADD SUBPOOL OPTION                   00348\n         AIF   ('&RC'(1,1) EQ '(').RCREG                                00349\n         LA    15,&RC                                                   00350\n         AGO   .CHKRENT                                                 00351\n.RCREG   ANOP                                                           00352\n         LR    15,&RC                                                   00353\n.CHKRENT ANOP                                                           00354\n         AIF   ('&RENT'(1,1) EQ 'N').NORENT                             00355\n.RENT    ANOP                                                           00356\n&NAME    L     13,4(13)                                                 00357\n         STM   15,1,16(13)                                              00358\n         LA    0,72+&RWALNG                                             00359\n         AIF   ('&SP' EQ '0').SKIPSP                                    00360\n         LA    1,&SP                                                    00361\n         SLL   1,24                                                     00362\n         OR    0,1                                                      00363\n.SKIPSP  ANOP                                                           00364\n         L     1,8(13)                                                  00365\n         FREEMAIN R,LV=(0),A=(1)                                        00366\n         LM    14,12,12(13)                                             00367\n         BR    14                                                       00368\n         AGO   .EXIT                                                    00369\n.NORENT  ANOP                                                           00370\n&NAME    L     13,4(13)                                                 00371\n         L     14,12(13)                                                00372\n         LM    2,12,28(13)                                              00373\n         BR    14                                                       00374\n.EXIT    ANOP                                                           00375\n         MEND                                                           00376\n         MACRO                                                          00377\n&N       SYSIN                                                          00378\n&N       DCB   DSORG=PS,MACRF=GM,DDNAME=&N,RECFM=FB,LRECL=80            00379\n         MEND                                                           00380\n         MACRO                                                          00381\n&N       SYSPRINT                                                       00382\n&N       DCB   DSORG=PS,MACRF=PM,DDNAME=&N,RECFM=FA,BLKSIZE=133         00383\n         MEND                                                           00384\n         MACRO                                                          00385\n&NAME    TAG                                                            00386\n&NAME    DS    0H                                                       00387\n         MEND                                                           00388\n         MACRO                                                          00389\n&M       MOVE  &A,&B                                                    00390\n         LCLA  &S,&L                                                    00391\n&L       SETA  L'&A                                                     00392\n.LOOP    ANOP                                                           00393\n         AIF   (&L LE 256).LAST                                         00394\n&M       MVC   &A+&S.(256),&B+&S                                        00395\n&S       SETA  &S+256                                                   00396\n&L       SETA  &L-256                                                   00397\n         AGO   .LOOP                                                    00398\n.LAST    ANOP                                                           00399\n         MVC   &A+&S.(&L),&B+&S                                         00400\n         MEND                                                           00401\n         MACRO                                                          00402\n&N       LT    &R,&X                                                    00403\n&N       L     &R,&X                                                    00404\n         LTR   &R,&R                                                    00405\n         MEND                                                           00406\n         MACRO                                                          00407\n         EQUAL                                                          00408\n*              COMMON EQU'S AND LITERALS                                00409\n*                                                                       00410\n*              EQU'S FOR REGISTERS                                      00411\n         EQUREGS                                                        00412\n*              EQU'S FOR IMMEDIATE DATA INSTRUCTIONS                    00413\n         EQUI                                                           00414\n*              LITERAL POOL                                             00415\n*              EQU'S FOR BRANCH ON CONDITIONS                           00416\n         EQUBC                                                          00417\n         LTORG                                                          00418\n         MEND                                                           00419\n         MACRO                                                          00420\n         EQUI                                                           00421\n         GBLA  &N,&V(20)                                                00422\n.LOOP    ANOP                                                           00423\n         AIF   (&N EQ 0).EXIT                                           00424\n#&V(&N)  EQU   &V(&N)                                                   00425\n&N       SETA  &N-1                                                     00426\n         AGO   .LOOP                                                    00427\n.EXIT    MEND                                                           00428\n         MACRO                                                          00429\n         XREFI &I                                                       00430\n         GBLA  &N,&V(20)                                                00431\n         LCLA  &S,&K,&NK                                                00432\n&NK      SETA  N'&I                                                     00433\n.LOOP1   ANOP                                                           00434\n&K       SETA  &K+1                                                     00435\n         AIF   (&K GT &NK).EXIT                                         00436\n         AIF   (&N EQ 0).ADD                                            00437\n&S       SETA  0                                                        00438\n.LOOP2   ANOP                                                           00439\n&S       SETA  &S+1                                                     00440\n         AIF   (&I(&K) EQ &V(&S)).REF                                   00441\n         AIF   (&S LT &N).LOOP2                                         00442\n.ADD     ANOP                                                           00443\n         AIF   (&N EQ 20).ERR                                           00444\n&N       SETA  &N+1                                                     00445\n&V(&N)   SETA  &I(&K)                                                   00446\n.REF     ANOP                                                           00447\n         AGO   .LOOP1                                                   00448\n.ERR     MNOTE 4,'IMMEDIATE DATA XREF TABLE OVERFLOW'                   00449\n.EXIT    MEND                                                           00450\n         MACRO                                                          00451\n&N       LI    &R,&I                                                    00452\n         AIF   (&I LT 1).ERR                                            00453\n         AIF   (&I GT 32767).ERR                                        00454\n         XREFI &I                                                       00455\n         AIF   (&I GT 4095).LHI                                         00456\n&N       LA    &R,#&I                                                   00457\n         MEXIT                                                          00458\n.LHI     ANOP                                                           00459\n&N       LH    &R,*+6                                                   00460\n         DC    X'4700',AL2(#&I)                                         00461\n         MEXIT                                                          00462\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00463\n         MEND                                                           00464\n         MACRO                                                          00465\n&N       AI    &R,&I                                                    00466\n         AIF   (&I LT 1).ERR                                            00467\n         AIF   (&I GT 32767).ERR                                        00468\n         XREFI &I                                                       00469\n&N       AH    &R,*+6                                                   00470\n         DC    X'4700',AL2(#&I)                                         00471\n         MEXIT                                                          00472\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00473\n         MEND                                                           00474\n         MACRO                                                          00475\n&N       SI    &R,&I                                                    00476\n         AIF   (&I LT 1).ERR                                            00477\n         AIF   (&I GT 32767).ERR                                        00478\n         XREFI &I                                                       00479\n         AIF   (&I GT 2).SHI                                            00480\n&N       BCTR  &R,0                                                     00481\n         DC    0AL2(#&I)                                                00482\n         AIF   (&I EQ 1).EXIT                                           00483\n         BCTR  &R,0                                                     00484\n.EXIT    MEXIT                                                          00485\n.SHI     ANOP                                                           00486\n&N       SH    &R,*+6                                                   00487\n         DC    X'4700',AL2(#&I)                                         00488\n         MEXIT                                                          00489\n.ERR     ANOP                                                           00490\n         MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00491\n         MEND                                                           00492\n         MACRO                                                          00493\n&N       TB    &FIELD,&BITS                                             00494\n         LCLA  &NBITS,&B(8),&S                                          00495\n&NBITS   SETA  N'&BITS                                                  00496\n         AIF   (&NBITS LT 1).ERR                                        00497\n         AIF   (&NBITS GT 8).ERR                                        00498\n.LOOP    ANOP                                                           00499\n&S       SETA  &BITS(&NBITS)                                            00500\n         AIF   (&S LT 0).ERR                                            00501\n         AIF   (&S GT 7).ERR                                            00502\n&B(&S+1) SETA  1                                                        00503\n&NBITS   SETA  &NBITS-1                                                 00504\n         AIF   (&NBITS GT 0).LOOP                                       00505\n&N       TM    &FIELD,B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)'       00506\n         MEXIT                                                          00507\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00508\n         MEND                                                           00509\n         MACRO                                                          00510\n&N       SB    &FIELD,&BITS                                             00511\n         LCLA  &NBITS,&B(8),&S                                          00512\n&NBITS   SETA  N'&BITS                                                  00513\n         AIF   (&NBITS LT 1).ERR                                        00514\n         AIF   (&NBITS GT 8).ERR                                        00515\n.LOOP    ANOP                                                           00516\n&S       SETA  &BITS(&NBITS)                                            00517\n         AIF   (&S LT 0).ERR                                            00518\n         AIF   (&S GT 7).ERR                                            00519\n&B(&S+1) SETA  1                                                        00520\n&NBITS   SETA  &NBITS-1                                                 00521\n         AIF   (&NBITS GT 0).LOOP                                       00522\n&N       OI    &FIELD,B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)'       00523\n         MEXIT                                                          00524\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00525\n         MEND                                                           00526\n         MACRO                                                          00527\n&N       ZB    &FIELD,&BITS                                             00528\n         LCLA  &NBITS,&B(8),&S                                          00529\n&NBITS   SETA  N'&BITS                                                  00530\n         AIF   (&NBITS LT 1).ERR                                        00531\n         AIF   (&NBITS GT 8).ERR                                        00532\n.LOOP    ANOP                                                           00533\n&S       SETA  &BITS(&NBITS)                                            00534\n         AIF   (&S LT 0).ERR                                            00535\n         AIF   (&S GT 7).ERR                                            00536\n&B(&S+1) SETA  1                                                        00537\n&NBITS   SETA  &NBITS-1                                                 00538\n         AIF   (&NBITS GT 0).LOOP                                       00539\n&N       NI    &FIELD,X'FF'-B'&B(1)&B(2)&B(3)&B(4)&B(5)&B(6)&B(7)&B(8)' 00540\n         MEXIT                                                          00541\n.ERR     MNOTE 8,'INVALID BIT SPECIFICATION'                            00542\n         MEND                                                           00543\n         MACRO                                                          00544\n&N       XCH   &A,&B                                                    00545\n&N       XC    &A,&B                                                    00546\n         XC    &B,&A                                                    00547\n         XC    &A,&B                                                    00548\n         MEND                                                           00549\n         MACRO                                                          00550\n&N       XCHR  &A,&B                                                    00551\n&N       XR    &A,&B                                                    00552\n         XR    &B,&A                                                    00553\n         XR    &A,&B                                                    00554\n         MEND                                                           00555\n         MACRO                                                          00556\n&N       ZR    &R                                                       00557\n&N       SR    &R,&R                                                    00558\n         MEND                                                           00559\n         MACRO                                                          00560\n&N       AAI   &R,&I                                                    00561\n         AIF   (&I LT 1).ERR                                            00562\n         AIF   (&I GT 32767).ERR                                        00563\n         XREFI &I                                                       00564\n         AIF   (&I GT 4095).AHI                                         00565\n&N       LA    &R,#&I.(&R)                                              00566\n         MEXIT                                                          00567\n.AHI     ANOP                                                           00568\n&N       AH    &R,*+6                                                   00569\n         DC    X'4700',AL2(#&I)                                         00570\n         MEXIT                                                          00571\n.ERR     MNOTE 4,'IMMEDIATE DATA NOT 1-32767'                           00572\n         MEND                                                           00573\n         MACRO                                                          00574\n&N       SRC   &R                                                       00575\n         LTR   &R,&R                                                    00576\n         MEND                                                           00577\n         MACRO                                                          00578\n&N       ZHB   &R                                                       00579\n&N       LA    &R,0(&R)                                                 00580\n         MEND                                                           00581\n         MACRO                                                          00582\n         SPOOLDAT                                                       00583\n.*             AUTHOR.   DON HIGGINS.                                   00584\n.*             DATE.     03/12/73.                                      00585\n.*             REMARKS.  DEFINE HASP 3.1 CHECKPOINT DATA AREAS ON 2314. 00586\n.*             REFERENCES.                                              00587\n.*                 1.    GY27-7255 HASP V4 PLM                          00588\n.*                 2.    GC27-6992 HASP SYS. PGMR. GUIDE                00589\n.*                 3.    SEE GU019800 FOR SAMPLE PROGRAM USING THIS.    00590\n.*             REV1 01/28/74 - REVISE FOR 3330 DISKS.                   00591\n.*             REV2 01/09/75 - REVISE FOR HASP V4.0 (VS2-R1.7)          00592\n*              REV3 /                                                   00593\n*              REV3 03/15/76 DSH - MAKE CHECKPOINT MTTRS RELATIVE       00594\n*                                                                       00595\n*              THE FOLLOWING STATEMENTS MUST PRECEED THIS MACRO         00596\n*                                                                       00597\n*              COPY $GLOBAL                                             00598\n*              COPY $HASPGEN                                            00599\n*              $HASPCB JOT,PRC (OTHER CONTROL BLOCKS ARE OPTIONAL)      00600\n*                                                                       00601\n*              SEE GY27-7255 HASP PLM 7-49 FOR FURTHER INFO.            00602\n*                                                                       00603\n         GBLA  &MAXJOBS  MAXIMUM JOBS ALLOWED IN HASP SYSTEM AT ONCE    00604\n         GBLA  &NUMPRC   NUMBER OF PRINT/PUNCH CHECKPOINT RECORDS       00605\n         GBLA  &JITSIZE  JOB INFORMATION TABLE ELEMENT SIZE             00606\n*                                                                       00607\n*              CHECKPOINT MTTRS                                         00608\n*                                                                       00609\n*                   THESE MTTRS ARE CODED AS RELATIVE TRACK AND         00610\n*                   ARE CONVERTED TO ABSOLUTE TRACK BY HASPXDAP         00611\n*                   (GU019600) ON FIRST CALL.                           00612\n*                   HIGH BIT ON INDICATES RELATIVE TRACK.               00613\n*                                                                       00614\nCKP1MTTR DC    X'80000001'    JOBQUE AND MISC. ON FIRST TRACK           00615\nCKP2MTTR DC    X'80000101'    JIT                                       00616\nCKP3MTTR DC    X'80000201'    JOT                                       00617\n*                                                                       00618\n*              CHECKPOINT RECORD AREAS                                  00619\n*                                                                       00620\nCKP1REC  DS    0D        JOB QUEUE AND MISC INFO                        00621\n$JOBQUE  DC    (&MAXJOBS)XL16'00'                                       00622\n$SAVEBEG DS    0F                                                       00623\n$JOBQPTR DC    A(*-*)    CORE ADDRESS OF HASP JOB QUEUE                 00624\n$JQFREE  DC    A(*-*)    FREE QUEUE CHAIN                               00625\n$JQENT   DC    A(*-*)    ACTIVE QUEUE CHAIN                             00626\n$DATAKEY DC    F'0'      MASTER PERIPHERAL DATA SET KEY                 00627\n$JOBNO   DC    H'0'      HASP JOB NUMBER                                00628\n$MSGRPNO DC    H'0'      LAST CONSOLE MESSAGE TRACK GROUP               00629\n$DACKPT  DC    1XL6'0'   DA CHECKPOINT FOR WARM START                   00630\n$SAVEEND EQU   *                                                        00631\n$SAVELEN EQU   $SAVEEND-$SAVEBEG                                        00632\n$PRCRECS DC    (&NUMPRC)XL(PRCSIZE)'00'                                 00633\nCKP1LNG  EQU   *-CKP1REC                                                00634\nCKP2REC  DS    0D        JOB INFORMATION TABLE                          00635\n$JIT     DC    (&MAXJOBS)XL(&JITSIZE)'00'                               00636\nCKP2LNG  EQU   *-CKP2REC                                                00637\nCKP3REC  DS    0D        JOB OUTPUT TABLE                               00638\n$JOTREC  DC    (JOTSIZE)X'00'                                           00639\nCKP3LNG  EQU   *-CKP3REC                                                00640\n         MEND                                                           00641\n         MACRO                                                          00642\n&N       XCP   &IOB,&CCW,&ERR                                           00643\n&N       LA    R0,&CCW                                                  00644\n         ST    R0,&IOB+16                                               00645\n         EXCP  &IOB                                                     00646\n         L     R1,&IOB+4                                                00647\n         WAIT  ECB=(1)                                                  00648\n         TM    &IOB+12,X'03'                                            00649\n         BNZ   &ERR                                                     00650\n         TM    &IOB+13,X'FF'                                            00651\n         BNZ   &ERR                                                     00652\n         MEND                                                           00653\n         MACRO                                                          00654\n&N       MC    &S1,&I2                                                  00655\n&N       CLI   &S1,&I2                                                  00656\n         ORG   *-4                                                      00657\n         DC    X'AF'                                                    00658\n         ORG   *+3                                                      00659\n         MEND                                                           00660\n         MACRO                                                          00661\n&N       CDS   &R1,&R3,&S                                               00662\n&N       LM    &R1,&R3,&S                                               00663\n         ORG   *-4                                                      00664\n         DC    X'BB'                                                    00665\n         ORG   *+3                                                      00666\n         MEND                                                           00667\n         MACRO                                                          00668\n&N       CS    &R1,&R3,&S2                                              00669\n&N       LM    &R1,&R3,&S2                                              00670\n         ORG   *-4                                                      00671\n         DC    X'BA'                                                    00672\n         ORG   *+3                                                      00673\n         MEND                                                           00674\n         MACRO                                                          00675\n         IF                                                             00676\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00677\n         GBLA  &ELSEIF(10)                                              00678\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     00679\n         LCLC  &OP,&OPR                                                 00680\n         LCLB  &TESTSW                                                  00681\n.*             AUTHOR.   DON HIGGINS.                                   00682\n.*             DATE.     03/27/74.                                      00683\n.*             REMARKS.  CONTROL STRUCTURE FOR CONDITIONAL EXECUTION.   00684\n.*             REV1 05/23/76 DSH - SUPPORT ELSEIF.                      00685\n         AIF   (&LEVEL EQ 10).ERR1                                      00686\n&LEVEL   SETA  &LEVEL+1                                                 00687\n&ELSEIF(&LEVEL) SETA 0                                                  00688\n&SEQ(&LEVEL) SETA 1                                                     00689\n&LAB     SETA  &LAB+1                                                   00690\n&ELSE(&LEVEL) SETA &LAB                                                 00691\n&N       SETA N'&SYSLIST                                                00692\n.NEXTAND ANOP                                                           00693\n&TESTSW  SETB  0                                                        00694\n.TEST    ANOP                                                           00695\n&S       SETA  &S+1                                                     00696\n         AIF   (&S GT &N).ERR2                                          00697\n&M       SETA  N'&SYSLIST(&S)                                           00698\n         AIF   (&M EQ 1).TESTEND                                        00699\n         AIF   (&M LT 2).ERR3                                           00700\n         AIF   (&M GT 5).ERR4                                           00701\n&I       SETA  2                                                        00702\n&OPR     SETC  ''                                                       00703\n&OP      SETC  '&SYSLIST(&S,1)'                                         00704\n         AIF   (&M GT 2).TESTOPR                                        00705\n         &OP                                                            00706\n         AGO   .TESTEND                                                 00707\n.TESTOPR ANOP                                                           00708\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   00709\n&L       SETA  K'&SYSLIST(&S,&I)                                        00710\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         00711\n         AGO   .NEXTOPR                                                 00712\n.NOLIT   ANOP                                                           00713\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 00714\n.NEXTOPR ANOP                                                           00715\n&I       SETA  &I+1                                                     00716\n         AIF   (&I EQ &M).TESTGEN                                       00717\n&OPR     SETC  '&OPR'.','                                               00718\n         AGO   .TESTOPR                                                 00719\n.TESTGEN ANOP                                                           00720\n         &OP   &OPR                                                     00721\n.TESTEND ANOP                                                           00722\n         AIF   (&TESTSW EQ 1).ORBC                                      00723\n.AMBC    ANOP                                                           00724\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00725\n.CONNECT ANOP                                                           00726\n&S       SETA  &S+1                                                     00727\n         AIF   (&S GT &N).EXIT                                          00728\n&M       SETA  N'&SYSLIST(&S)                                           00729\n         AIF   (&M NE 1).ERR5  BAD CONNECTOR                            00730\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        00731\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR5  BAD CONNECTOR             00732\n.NEXTOR   ANOP                                                          00733\n&LAB1    SETA  &LAB+1                                                   00734\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     00735\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      00736\n&LAB     SETA  &LAB+2                                                   00737\n&ELSE(&LEVEL) SETA &LAB                                                 00738\n&TESTSW  SETB  1                                                        00739\n         AGO   .TEST                                                    00740\n.ORBC    ANOP                                                           00741\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00742\nIF0&LAB1 EQU *                                                          00743\n         AGO   .CONNECT                                                 00744\n.ERR1    MNOTE 8,'IF - LEVEL OVERFLOW'                                  00745\n         AGO   .EXIT                                                    00746\n.ERR2    MNOTE 8,'IF - MISSING TEST LIST'                               00747\n         AGO   .EXIT                                                    00748\n.ERR3    MNOTE 8,'IF - TEST LIST TOO SHORT'                             00749\n         AGO   .EXIT                                                    00750\n.ERR4    MNOTE 8,'IF - TEST LIST TOO LONG'                              00751\n         AGO   .EXIT                                                    00752\n.ERR5    MNOTE 8,'IF - INVALID CONNECTOR'                               00753\n.EXIT    ANOP                                                           00754\n         MEND                                                           00755\n         MACRO                                                          00756\n         THEN  &OPT                                                     00757\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00758\n.*             AUTHOR.   DON HIGGINS.                                   00759\n.*             DATE.     03/27/74.                                      00760\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00761\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00762\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00763\n         AIF   (&LEVEL EQ 0).ERR0                                       00764\n         AIF   ('&OPT' EQ 'BEGIN').BEGIN                                00765\n         AIF   ('&OPT' EQ 'END').END                                    00766\n         MNOTE 4,'THEN - INVALID OPERAND - IGNORED'                     00767\n         AGO   .EXIT                                                    00768\n.BEGIN   ANOP                                                           00769\n         AIF   (&SEQ(&LEVEL) NE 1).ERR1                                 00770\n&SEQ(&LEVEL) SETA 2                                                     00771\n         AGO   .EXIT                                                    00772\n.END     ANOP                                                           00773\n         AIF   (&SEQ(&LEVEL) NE 2).ERR2                                 00774\n&SEQ(&LEVEL) SETA 3                                                     00775\n         AGO   .EXIT                                                    00776\n.ERR0    MNOTE 8,'THEN - MISSING IF'                                    00777\n         AGO   .EXIT                                                    00778\n.ERR1    MNOTE 4,'THEN BEGIN - OUT OF SEQUENCE'                         00779\n         AGO   .EXIT                                                    00780\n.ERR2    MNOTE 4,'THEN END - OUT OF SEQUENCE'                           00781\n.EXIT    ANOP                                                           00782\n         MEND                                                           00783\n         MACRO                                                          00784\n         ELSE  &OPT                                                     00785\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00786\n         GBLA  &ELSEIF(10)                                              00787\n.*             AUTHOR.   DON HIGGINS.                                   00788\n.*             DATE.     03/27/74.                                      00789\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00790\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00791\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00792\n.*             REV1 05/23/76 DSH - SUPPORT ELSEIF                       00793\n         AIF   (&LEVEL EQ 0).ERR0                                       00794\n         AIF   (T'&OPT EQ 'O').BEGIN                                    00795\n         AIF   ('&OPT' EQ 'BEGIN').BEGIN                                00796\n         AIF   ('&OPT' EQ 'END').END                                    00797\n         AIF   ('&OPT' EQ 'CONTINUE').CONT                              00798\n         MNOTE 8,'ELSE - INVALID OPERAND'                               00799\n         AGO   .EXIT                                                    00800\n.BEGIN   ANOP                                                           00801\n         AIF   (&SEQ(&LEVEL) GT 3).ERR1                                 00802\n&LAB     SETA  &LAB+1                                                   00803\n         B     IF0&LAB                                                  00804\nIF0&ELSE(&LEVEL) EQU *                                                  00805\n&ELSE(&LEVEL) SETA &LAB                                                 00806\n&SEQ(&LEVEL) SETA 4                                                     00807\n         AGO .EXIT                                                      00808\n.END     ANOP                                                           00809\n         AIF   (&SEQ(&LEVEL) NE 4).ERR2                                 00810\n.DEQUE   ANOP                                                           00811\nIF0&ELSE(&LEVEL) EQU *                                                  00812\n&LEVEL   SETA &LEVEL-1                                                  00813\n         AIF   (&ELSEIF(&LEVEL+1) EQ 1).DEQUE                           00814\n         AGO   .EXIT                                                    00815\n.CONT    ANOP                                                           00816\n         AIF   (&SEQ(&LEVEL) GT 3).ERR3                                 00817\n         AGO   .DEQUE                                                   00818\n.ERR0    MNOTE 8,'ELSE - MISSING IF'                                    00819\n         AGO   .EXIT                                                    00820\n.ERR1    MNOTE 8,'ELSE BEGIN - OUT OF SEQUENCE'                         00821\n         AGO   .EXIT                                                    00822\n.ERR2    MNOTE 8,'ELSE END - OUT OF SEQUENCE'                           00823\n         AGO   .EXIT                                                    00824\n.ERR3    MNOTE 8,'ELSE CONTINUE - OUT OF SEQUENCE'                      00825\n.EXIT    ANOP                                                           00826\n         MEND                                                           00827\n         MACRO                                                          00828\n         DO                                                             00829\n         GBLA  &DO(10),&DOSEQ(10),&DOLVL,&DOLAB                         00830\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00831\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     00832\n         LCLA  &UNTIL                                                   00833\n         LCLC  &OP,&OPR                                                 00834\n         LCLB  &TESTSW                                                  00835\n.*             AUTHOR.   DON HIGGINS.                                   00836\n.*             DATE.     03/27/74.                                      00837\n.*             REMARKS.  MACRO TO ALLOW STRUCTURED PROGRAMMING USING    00838\n.*                       IF, THEN, ELSE, AND DO UP TO TEN LEVELS DEEP   00839\n.*                       AND NO BRANCH INSTRUCTIONS. SEE IF MACRO.      00840\n         AIF   (&DOLVL EQ 10).ERR1                                      00841\n&N       SETA  N'&SYSLIST                                               00842\n         AIF   (&N LT 1).ERR2                                           00843\n         AIF   ('&SYSLIST(1)' EQ 'END').END                             00844\n         AIF   ('&SYSLIST(1)' EQ 'FOREVER').WHILE                       00845\n         AIF   (&N LT 2).ERR2                                           00846\n         AIF   ('&SYSLIST(1)' EQ 'WHILE').WHILE                         00847\n         AIF   ('&SYSLIST(1)' NE 'UNTIL').ERR3                          00848\n.UNTIL   ANOP                                                           00849\n&DOLVL   SETA  &DOLVL+1                                                 00850\n&UNTIL   SETA  &DOLAB+1                                                 00851\n&DOLAB   SETA  &DOLAB+2                                                 00852\n         B     DO&UNTIL                                                 00853\n         AGO   .COMM                                                    00854\n.WHILE   ANOP                                                           00855\n&DOLVL   SETA  &DOLVL+1                                                 00856\n&DOLAB   SETA  &DOLAB+1                                                 00857\n.COMM    ANOP                                                           00858\n&DOSEQ(&DOLVL) SETA 1                                                   00859\n&DO(&DOLVL) SETA &DOLAB                                                 00860\nDO&DOLAB EQU   *                                                        00861\n         AIF   (&LEVEL EQ 10).ERR1                                      00862\n&LEVEL   SETA  &LEVEL+1                                                 00863\n&SEQ(&LEVEL) SETA 1                                                     00864\n&LAB     SETA  &LAB+1                                                   00865\n&ELSE(&LEVEL) SETA &LAB                                                 00866\n         AIF   ('&SYSLIST(1)' EQ 'FOREVER').EXIT                        00867\n&S       SETA  1                                                        00868\n.NEXTAND ANOP                                                           00869\n&TESTSW  SETB  0                                                        00870\n.TEST    ANOP                                                           00871\n&S       SETA  &S+1                                                     00872\n         AIF   (&S GT &N).ERR2                                          00873\n&M       SETA  N'&SYSLIST(&S)                                           00874\n         AIF   (&M LT 2).ERR3                                           00875\n         AIF   (&M GT 5).ERR3                                           00876\n&I       SETA  2                                                        00877\n&OPR     SETC  ''                                                       00878\n&OP      SETC  '&SYSLIST(&S,1)'                                         00879\n         AIF   (&M GT 2).TESTOPR                                        00880\n         &OP                                                            00881\n         AGO   .TESTEND                                                 00882\n.TESTOPR ANOP                                                           00883\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   00884\n&L       SETA  K'&SYSLIST(&S,&I)                                        00885\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         00886\n         AGO   .NEXTOPR                                                 00887\n.NOLIT   ANOP                                                           00888\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 00889\n.NEXTOPR ANOP                                                           00890\n&I       SETA  &I+1                                                     00891\n         AIF   (&I EQ &M).TESTGEN                                       00892\n&OPR     SETC  '&OPR'.','                                               00893\n         AGO   .TESTOPR                                                 00894\n.TESTGEN ANOP                                                           00895\n         &OP   &OPR                                                     00896\n.TESTEND ANOP                                                           00897\n         AIF   (&TESTSW EQ 1).ORBC                                      00898\n.AMBC    ANOP                                                           00899\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00900\n.CONNECT ANOP                                                           00901\n&S       SETA  &S+1                                                     00902\n         AIF   (&S GT &N).CHKUNTL                                       00903\n&M       SETA  N'&SYSLIST(&S)                                           00904\n         AIF   (&M NE 1).ERR3  BAD CONNECTOR                            00905\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        00906\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR3  BAD CONNECTOR             00907\n.NEXTOR   ANOP                                                          00908\n&LAB1    SETA  &LAB+1                                                   00909\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     00910\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      00911\n&LAB     SETA  &LAB+2                                                   00912\n&ELSE(&LEVEL) SETA &LAB                                                 00913\n&TESTSW  SETB  1                                                        00914\n         AGO   .TEST                                                    00915\n.ORBC    ANOP                                                           00916\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               00917\nIF0&LAB1 EQU *                                                          00918\n         AGO   .CONNECT                                                 00919\n.CHKUNTL ANOP                                                           00920\n         AIF   (&UNTIL EQ 0).EXIT                                       00921\n&LAB     SETA  &LAB+1                                                   00922\n         B     IF0&LAB                                                  00923\nIF0&ELSE(&LEVEL) EQU *                                                  00924\n&ELSE(&LEVEL) SETA &LAB                                                 00925\nDO&UNTIL EQU *                                                          00926\n         AGO   .EXIT                                                    00927\n.END     ANOP                                                           00928\n         AIF   (&N GT 1).ERR3                                           00929\n         AIF   (&DOLVL EQ 0).ERR4                                       00930\n         AIF   (&DOSEQ(&DOLVL) NE 1).ERR4                               00931\n&DOSEQ(&DOLVL) SETA 0                                                   00932\n         B     DO&DO(&DOLVL)                                            00933\n&DOLVL   SETA  &DOLVL-1                                                 00934\nIF0&ELSE(&LEVEL) EQU *                                                  00935\n&LEVEL   SETA  &LEVEL-1                                                 00936\n         AGO   .EXIT                                                    00937\n.ERR1    MNOTE 8,'DO - LEVEL OVERFLOW'                                  00938\n         AGO   .EXIT                                                    00939\n.ERR2    MNOTE 8,'DO - MISSING OPERAND'                                 00940\n         AGO   .EXIT                                                    00941\n.ERR3    MNOTE 8,'DO - INVALID OPERAND'                                 00942\n         AGO   .EXIT                                                    00943\n.ERR4    MNOTE 8,'DO - END OUT OF SEQUENCE'                             00944\n.EXIT    ANOP                                                           00945\n         MEND                                                           00946\n         MACRO                                                          00947\n         EQUBC                                                          00948\nH        EQU   2                                                        00949\nL        EQU   4                                                        00950\nE        EQU   8                                                        00951\nNH       EQU   13                                                       00952\nNL       EQU   11                                                       00953\nNE       EQU   7                                                        00954\nO        EQU   1                                                        00955\nP        EQU   2                                                        00956\nM        EQU   4                                                        00957\nZ        EQU   8                                                        00958\nNP       EQU   13                                                       00959\nNM       EQU   11                                                       00960\nNZ       EQU   7                                                        00961\nNO       EQU   14                                                       00962\nEQ       EQU   8                                                        00963\nGT       EQU   2                                                        00964\nLT       EQU   4                                                        00965\nGE       EQU   11                                                       00966\nLE       EQU   13                                                       00967\n         MEND                                                           00968\n         MACRO                                                          00969\n&N       FI                                                             00970\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           00971\n         AIF   (&SEQ(&LEVEL) NE 4).CONT                                 00972\n&N       ELSE  END                                                      00973\n         MEXIT                                                          00974\n.CONT    ANOP                                                           00975\n&N       ELSE  CONTINUE                                                 00976\n         MEND                                                           00977\n         MACRO                                                          00978\n&N       PM    &PENTRY                                                  00979\n&N       MVC   &PENTRY-2(2),*+10                                        00980\n         B     &PENTRY                                                  00981\n         DC    S(*+2)                                                   00982\n         MEND                                                           00983\n         MACRO                                                          00984\n&N       OD                                                             00985\n&N       DO    END                                                      00986\n         MEND                                                           00987\n         MACRO                                                          00988\n&N       DOCASE &INDEX                                                  00989\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       00990\n.*             AUTHOR.   DON HIGGINS.                                   00991\n.*             DATE.     07/02/74.                                      00992\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   00993\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            00994\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         00995\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          00996\n         AIF   (T'&INDEX EQ 'U').REG                                    00997\n&N       ZR    R15                                                      00998\n         IC    R15,&INDEX                                               00999\n         AGO   .PROC                                                    01000\n.REG     ANOP                                                           01001\n&N       LR    R15,&INDEX                                               01002\n.PROC    ANOP                                                           01003\n         AIF   (&DOCLVL EQ 10).ERR1                                     01004\n&DOCLVL  SETA  &DOCLVL+1                                                01005\n&DOCNT   SETA  &DOCNT+1                                                 01006\n&DOCNO(&DOCLVL) SETA &DOCNT                                             01007\n&CASENO(&DOCLVL) SETA 0                                                 01008\n&DOCELSE(&DOCLVL) SETA 0                                                01009\n         IC    R15,CASEI&DOCNO(&DOCLVL).(R15)                           01010\n         L     R15,CASEA&DOCNO(&DOCLVL).(R15)                           01011\n         BR    R15                                                      01012\nCASEI&DOCNO(&DOCLVL) DC 256X'00'                                        01013\n         MEXIT                                                          01014\n.ERR1    MNOTE 8,'DOCASE NESTED LEVELS EXCEEDED'                        01015\n         MEND                                                           01016\n         MACRO                                                          01017\n         CASE                                                           01018\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01019\n         LCLA  &N,&M,&L,&H                                              01020\n.*             AUTHOR.   DON HIGGINS.                                   01021\n.*             DATE.     07/02/74.                                      01022\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01023\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01024\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01025\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01026\n.*             REV1 05/24/76 DSH - ALLOW SYMBOLIC FOR CASE VALUE.       01027\n         AIF   (&DOCLVL LT 1).ERR1                                      01028\n&N       SETA  N'&SYSLIST                                               01029\n         AIF   (&N GT 1).CHKN                                           01030\n&N       SETA  N'&SYSLIST(1)                                            01031\n         AIF   (&N GT 1).CHKN                                           01032\n         AIF   ('&SYSLIST(1)' EQ 'ELSE').ELSE                           01033\n         AIF   ('&SYSLIST(1)' NE 'MISC').CHKN                           01034\n.ELSE    AIF   (&DOCELSE(&DOCLVL) GT 0).ERR3                            01035\n&DOCELSE(&DOCLVL) SETA 1                                                01036\nDC&DOCNO(&DOCLVL)ELSE DS 0H                                             01037\n         MEXIT                                                          01038\n.CHKN    ANOP                                                           01039\n         AIF   (&CASENO(&DOCLVL) EQ 63).ERR7                            01040\n&CASENO(&DOCLVL) SETA &CASENO(&DOCLVL)+1                                01041\n.MLOOP   ANOP                                                           01042\n&M       SETA  &M+1                                                     01043\n         AIF   (&M GT &N).GENL                                          01044\n&L       SETA  N'&SYSLIST(&M)                                           01045\n         AIF   (&L LT 1).MLOOP                                          01046\n         AIF   (&L GT 2).ERR4                                           01047\n         AIF   (&L EQ 1).GEN1                                           01048\n         AIF   (T'&SYSLIST(&M,1) NE 'N').ERR5                           01049\n         AIF   (T'&SYSLIST(&M,2) NE 'N').ERR5                           01050\n&L       SETA  &SYSLIST(&M,1)                                           01051\n&H       SETA  &SYSLIST(&M,2)                                           01052\n         AIF   (&L GT &H).ERR6                                          01053\n         AIF   (&H GT 255).ERR6                                         01054\n         AIF   (&L LT 1).ERR6                                           01055\n         ORG   CASEI&DOCNO(&DOCLVL)+&L                                  01056\n         DC    (&H-&L+1)AL1(&CASENO(&DOCLVL)*4)                         01057\n         AGO   .MLOOP                                                   01058\n.GEN1    ANOP                                                           01059\n         ORG   CASEI&DOCNO(&DOCLVL)+&SYSLIST(&M)                        01060\n         DC    AL1(&CASENO(&DOCLVL)*4)                                  01061\n         AGO   .MLOOP                                                   01062\n.GENL    ANOP                                                           01063\n         ORG                                                            01064\nDC&DOCNO(&DOCLVL)C&CASENO(&DOCLVL) DS 0H                                01065\n         MEXIT                                                          01066\n.ERR1    MNOTE 8,'CASE - MISSING DOCASE'                                01067\n         MEXIT                                                          01068\n.ERR2    MNOTE 8,'CASE - INVALID OPERAND'                               01069\n         MEXIT                                                          01070\n.ERR3    MNOTE 8,'CASE - DUPLICATE ELSE CASE'                           01071\n         MEXIT                                                          01072\n.ERR4    MNOTE 8,'CASE - MORE THAN 2 SUBLIST OPERANDS'                  01073\n         MEXIT                                                          01074\n.ERR5    MNOTE 8,'CASE - OPERAND NOT SELF DEFINING TERM'                01075\n         MEXIT                                                          01076\n.ERR6    MNOTE 8,'CASE - OPERAND NOT IN RANGE 1-255'                    01077\n         MEXIT                                                          01078\n.ERR7    MNOTE 8,'CASE - MAXIMUM OF 63 CASES EXCEEDED'                  01079\n         MEXIT                                                          01080\n         MEND                                                           01081\n         MACRO                                                          01082\n&N       ESAC                                                           01083\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01084\n.*             AUTHOR.   DON HIGGINS.                                   01085\n.*             DATE.     07/02/74.                                      01086\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01087\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01088\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01089\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01090\n&N       B     DC&DOCNO(&DOCLVL).END                                    01091\n         MEND                                                           01092\n         MACRO                                                          01093\n         ESACOD                                                         01094\n         GBLA  &DOCLVL,&DOCNO(10),&CASENO(10),&DOCELSE(10),&DOCNT       01095\n.*             AUTHOR.   DON HIGGINS.                                   01096\n.*             DATE.     07/02/74.                                      01097\n.*             REMARKS.  SELECTION CONTROL STRUCTURE.                   01098\n.*                       SEE DOCASE, CASE, ESAC, AND ESACOD.            01099\n.*                       SEE 'STRUCTURED FORTRAN TRANSLATOR' IN         01100\n.*                       IN 1975 FEBRUARY ACM SIGPLAN NOTICES.          01101\n         LCLA  &C                                                       01102\n         AIF   (&DOCLVL LT 1).ERR1                                      01103\nCASEA&DOCNO(&DOCLVL) DS 0F                                              01104\n         AIF   (&DOCELSE(&DOCLVL) GT 0).GENELSE                         01105\n         DC    A(DC&DOCNO(&DOCLVL).END)                                 01106\n         AGO   .GENCASE                                                 01107\n.GENELSE ANOP                                                           01108\n         DC    A(DC&DOCNO(&DOCLVL).ELSE)                                01109\n.GENCASE ANOP                                                           01110\n&C       SETA  &C+1                                                     01111\n         AIF   (&C GT &CASENO(&DOCLVL)).GEND                            01112\n         DC    A(DC&DOCNO(&DOCLVL).C&C)                                 01113\n         AGO   .GENCASE                                                 01114\n.GEND    ANOP                                                           01115\nDC&DOCNO(&DOCLVL).END EQU *                                             01116\n&DOCLVL SETA &DOCLVL-1                                                  01117\n         MEXIT                                                          01118\n.ERR1    MNOTE 8,'ESACOD - MISSING DOCASE'                              01119\n         MEND                                                           01120\n         MACRO                                                          01121\n&NAME    LOGICAL                                                        01122\n.*             PGMID.    LOGICAL VARIABLE DEFINITION AND ENUMERATION    01123\n.*             AUTHOR.   DON HIGGINS.                                   01124\n.*             DATE.     09/27/74.                                      01125\n.*             REMARKS.  DEFINES A LOGICAL VARIABLE AS A ONE BYTE       01126\n.*                       AL1 FIELD WITH AN INITIAL VALUE AND STORES     01127\n.*                       IN GLOBAL TABLE POSSIBLE VALUES BY NAME.       01128\n.*                       ALL NAMES ARE EQUATED TO UNIQUE VALUES FOR     01129\n.*                       USE IN TEST AND SET STATEMENTS.                01130\n         GBLC  &LOGICN(100)                                             01131\n         GBLA  &LOGICV                                                  01132\n         LCLA  &N,&S,&SL                                                01133\n&N       SETA  N'&SYSLIST(2)                                            01134\n.L1      ANOP                                                           01135\n&S       SETA  &S+1                                                     01136\n         AIF   (&S GT &N).GENDC                                         01137\n&SL      SETA  0                                                        01138\n.L2      ANOP                                                           01139\n&SL      SETA  &SL+1                                                    01140\n         AIF   (&SL GT &LOGICV).GENEQU                                  01141\n         AIF   ('&SYSLIST(2,&S)' EQ '&LOGICN(&SL)').L1                  01142\n         AGO   .L2                                                      01143\n.GENEQU  ANOP                                                           01144\n&LOGICV  SETA  &LOGICV+1                                                01145\n&LOGICN(&LOGICV) SETC '&SYSLIST(2,&S)'                                  01146\n&SYSLIST(2,&S) EQU &LOGICV                                              01147\n         AGO   .L1                                                      01148\n.GENDC   ANOP                                                           01149\n&NAME    DC    AL1(&SYSLIST(1))                                         01150\n         MEND                                                           01151\n         MACRO                                                          01152\n&VLABEL  DCWV  &VNAME                                                   01153\n.*             AUTHOR.   DON HIGGINS.                                   01154\n.*             DATE.     11/03/74.                                      01155\n.*             REMARKS.  DEFINE VERY WEAK V TYPE ADDRESS WHICH IS       01156\n.*                       SET BY DYNAMICALLY LOADING NAMED MODULE        01157\n.*                       THE FIRST TIME THE V ADDRESS IS USED.          01158\nDCWV&SYSNDX DS 0H                                                       01159\n         USING DCWV&SYSNDX,R15     ENTER HERE ON FIRST USE OF VLABEL    01160\n         STM   R14,R2,&VLABEL+12   SAVE REGS USED BY LOAD               01161\n         LR    R2,R15              NEW BASE                             01162\n         DROP  R15                                                      01163\n         USING DCWV&SYSNDX,R2                                           01164\n         FINDCDE EPLOC=&VLABEL+4                                        01165\n         IF    (LTR,R1,R1,Z)                                            01166\n               LOAD EPLOC=&VLABEL+4                                     01167\n         ELSE                                                           01168\n               L    R0,16(R1) GET CDE ENTRY                             01169\n         FI                                                             01170\n         ST    R0,&VLABEL          STORE ENTRY POINT IN VLABEL          01171\n         LR    R15,R0              SET R15 TO CORRECT ENTRY POINT       01172\n         L     R14,&VLABEL+12      RESTORE REGS                         01173\n         LM    R0,R2,&VLABEL+20                                         01174\n         BR    R15                 ENTER VNAME FIRST TIME               01175\n&VLABEL  DC    A(DCWV&SYSNDX)      VERY WEAK V ADDRESS                  01176\n         DC    CL8'&VNAME'         NAME OF MODULE                       01177\n         DC    5F'0'               SAVE AREA                            01178\n         MEND                                                           01179\n         MACRO                                                          01180\n&N       LOADTCB &R                                                     01181\n&N       L     &R,16     CVT                                            01182\n         L     &R,0(&R)  TCB WORDS                                      01183\n         L     &R,4(&R)  TCB                                            01184\n         MEND                                                           01185\n         MACRO                                                          01186\n&N       LOADTIOT &R                                                    01187\n&N       LOADTCB &R                                                     01188\n         L     &R,12(&R) TIOT ADDRESS FROM TCB                          01189\n         MEND                                                           01190\n         MACRO                                                          01191\n&N       FINDDD &DDNAME                                                 01192\n.*             AUTHOR.   DON HIGGINS.                                   01193\n.*             DATE.     11/06/74.                                      01194\n.*             REMARKS.  SET R1 TO ADDRESS OF TIOT DDNAME ENTRY OR 0.   01195\n.*             EXAMPLE.  FINDDD =CL8'CALLLIB'                           01196\n&N       LOADTIOT R14                                                   01197\n         AAI   R14,24                                                   01198\n         LA    R15,&DDNAME                                              01199\n         ZR    R0                                                       01200\n         ZR    R1                                                       01201\n         IC    R0,0(R14)                                                01202\n         DO    WHILE,(LTR,R0,R0,P)                                      01203\n               IF   (CLC,4(8,R14),0(R15),EQ)                            01204\n                    LR   R1,R14                                         01205\n                    ZR   R0                                             01206\n               ELSE                                                     01207\n                    AR   R14,R0                                         01208\n                    IC   R0,0(R14)                                      01209\n               FI                                                       01210\n         OD                                                             01211\n         MEND                                                           01212\n         MACRO                                                          01213\n&NAME    ACCEPT &REC,&DDNAME=SYSIN                                      01214\n.*             AUTHOR.   DON HIGGINS.                                   01215\n.*             DATE.     11/19/74.                                      01216\n.*             REMARKS.  ACCEPT RECORD IF DD AVAILABLE.                 01217\n.*                       REC MAY GE REGISTER OR LABEL OF RECORD AREA.   01218\n.*                      R15=0 SUCCESSFUL READ.                          01219\n.*                      R15=4 EOF OR NO DD FOUND.                       01220\n&NAME    TAG                                                            01221\nACC1&SYSNDX B  *+4                                                      01222\n         FINDDD =CL8'&DDNAME'                                           01223\n         IF    (LTR,R1,R1,Z)                                            01224\n               WTO  '&DDNAME NOT FOUND'                                 01225\nACC2&SYSNDX    LA   R15,4                                               01226\n               MVC  ACC1&SYSNDX+2(2),=S(ACC2&SYSNDX)                    01227\n               B    ACC4&SYSNDX                                         01228\n         FI                                                             01229\n         MVC   ACC1&SYSNDX+2(2),=S(ACC3&SYSNDX)                         01230\n         OPEN  (&DDNAME)                                                01231\n         B     ACC3&SYSNDX                                              01232\n&DDNAME  DCB   DSORG=PS,MACRF=GL,DDNAME=&DDNAME,EODAD=ACC2&SYSNDX       01233\nACC3&SYSNDX GET &DDNAME                                                 01234\n         AIF   ('&REC'(1,1) EQ '(').REG                                 01235\n         MVC   &REC,0(R1)                                               01236\n         ZR    R15                                                      01237\n         AGO   .EXIT                                                    01238\n.REG     ANOP                                                           01239\n         LR    &REC,R1                                                  01240\n         ZR    R15                                                      01241\n.EXIT    ANOP                                                           01242\nACC4&SYSNDX TAG                                                         01243\n         MEND                                                           01244\n         MACRO                                                          01245\n&NAME    DISPLAY &REC,&DDNAME=SYSOUT,&RECFM=FA,&BLKSIZE=133             01246\n.*             AUTHOR.   DON HIGGINS.                                   01247\n.*             DATE.     11/18/74.                                      01248\n.*             REMARKS.  DISPLAY RECORD IF DD AVAILABLE.                01249\n.*                       REC MAY BE REGISTER OR LABEL OF REC.           01250\n.*                      R15=0 IS SUCCESSFUL                             01251\n.*                      R15=4 NO DD FOUND                               01252\n&NAME    TAG                                                            01253\nDSP1&SYSNDX B  *+4                                                      01254\n         FINDDD =CL8'&DDNAME'                                           01255\n         IF    (LTR,R1,R1,Z)                                            01256\n               WTO  '&DDNAME NOT FOUND'                                 01257\n               MVC  DSP1&SYSNDX+2(2),=S(DSP2&SYSNDX)                    01258\nDSP2&SYSNDX    LA   R15,4                                               01259\n               B    DSP4&SYSNDX                                         01260\n         FI                                                             01261\n         MVC   DSP1&SYSNDX+2(2),=S(DSP3&SYSNDX)                         01262\n         OPEN  (&DDNAME,(OUTPUT))                                       01263\n         B     DSP3&SYSNDX                                              01264\n&DDNAME  DCB   DSORG=PS,MACRF=PM,DDNAME=&DDNAME,                       X01265\n               RECFM=&RECFM,BLKSIZE=&BLKSIZE                            01266\nDSP3&SYSNDX TAG                                                         01267\n         AIF   ('&REC'(1,1) EQ '(').REG                                 01268\n         LA    R0,&REC                                                  01269\n         AGO   .PUT                                                     01270\n.REG     ANOP                                                           01271\n         LR    R0,&REC                                                  01272\n.PUT     ANOP                                                           01273\n         PUT   &DDNAME                                                  01274\n         ZR    R15                                                      01275\nDSP4&SYSNDX TAG                                                         01276\n         MEND                                                           01277\n         MACRO                                                          01278\n&N      TPPUTMSG &TERM,&MSG,&LMSG                                       01279\n.*             AUTHOR.   DON HIGGINS.                                   01280\n.*             DATE.     11/27/74.                                      01281\n.*             REMARKS.  ROUTE TERMINAL MESSAGE TO TPPUT.               01282\n.*                            TERM - TERMINAL NAME FIELD OR LITERAL     01283\n.*                            MSG  - MESSAGE FIELD OR LITERAL           01284\n.*                            LMSG - FULL WORD BINARY LENGTH (OPTIONAL) 01285\n         LCLA  &L                                                       01286\n         CNOP  0,4                                                      01287\n&N       BAL   1,*+16                                                   01288\n.CHKT1   AIF   ('&TERM'(1,1) EQ '''').TERMLIT                           01289\n         DC    A(&TERM)                                                 01290\n         AGO   .CHKM1                                                   01291\n.TERMLIT ANOP                                                           01292\n         DC    A(0)                                                     01293\n.CHKM1   AIF   ('&MSG'(1,1) EQ '''').MSGLIT                             01294\n         DC    A(&MSG)                                                  01295\n         AGO   .CHKL                                                    01296\n.MSGLIT  ANOP                                                           01297\n         DC    A(0)                                                     01298\n.CHKL    AIF   (T'&LMSG EQ 'O').LCALC                                   01299\n         DC    A(&LMSG)                                                 01300\n         AGO   .CHKT2                                                   01301\n.LCALC   ANOP                                                           01302\n         DC    A(0)                                                     01303\n         AIF   ('&MSG'(1,1) EQ '''').LCALCL                             01304\n&L       SETA  L'&MSG                                                   01305\n         LA    0,=A(&L)                                                 01306\n         ST    0,8(1)                                                   01307\n         AGO   .CHKT2                                                   01308\n.LCALCL  ANOP                                                           01309\n&L       SETA  K'&MSG-2                                                 01310\n         LA    0,=A(&L)                                                 01311\n         ST    0,8(1)                                                   01312\n.CHKT2   AIF   ('&TERM'(1,1) NE '''').CHKM2                             01313\n         LA    0,=C&TERM                                                01314\n         ST    0,0(1)                                                   01315\n         AGO   .CALL                                                    01316\n.CHKM2   AIF   ('&MSG'(1,1) NE '''').CALL                               01317\n         LA    0,=C&MSG                                                 01318\n         ST    0,4(1)                                                   01319\n.CALL    ANOP                                                           01320\n         L     15,=V(TPPUT)                                             01321\n         BALR  14,15                                                    01322\n         MEND                                                           01323\n         MACRO                                                          01324\n&N       TRTTAB &TYPE,&BAD=X'FF',&GOOD=X'00',&SKIP=,&FIND=,&FILL=C' '   01325\n         AIF   ('&TYPE' EQ 'PRINT').PRINT                               01326\n         AIF   ('&TYPE' EQ 'NUMERIC').NUMERIC                           01327\n         AIF   ('&TYPE' EQ 'ALPHA').ALPHA                               01328\n         AIF   ('&TYPE' EQ 'ALPHANUM').ALPHAN                           01329\n         AIF   ('&TYPE' EQ 'ZFILL').ZFILL                               01330\n         AIF   ('&TYPE' EQ 'BAD').BAD                                   01331\n         AIF   ('&TYPE' EQ 'GOOD').GOOD                                 01332\n         AIF   ('&TYPE' EQ 'SCAN').SCAN                                 01333\n         MNOTE 8,'TABLE TYPE INVALID'                                   01334\n         MEXIT                                                          01335\n.PRINT   ANOP                                                           01336\n&N       DC    (X'49'-X'00'+1)&FILL                                     01337\n         DC    (X'50'-X'4A'+1)AL1(*-&N)                                 01338\n         DC    (X'59'-X'51'+1)&FILL                                     01339\n         DC    (X'61'-X'5A'+1)AL1(*-&N)                                 01340\n         DC    (X'6A'-X'62'+1)&FILL                                     01341\n         DC    (X'6F'-X'6B'+1)AL1(*-&N)                                 01342\n         DC    (X'79'-X'70'+1)&FILL                                     01343\n         DC    (X'7F'-X'7A'+1)AL1(*-&N)                                 01344\n         DC    (X'C0'-X'80'+1)&FILL                                     01345\n         DC    (X'C9'-X'C1'+1)AL1(*-&N)                                 01346\n         DC    (X'D0'-X'CA'+1)&FILL                                     01347\n         DC    (X'D9'-X'D1'+1)AL1(*-&N)                                 01348\n         DC    (X'E1'-X'DA'+1)&FILL                                     01349\n         DC    (X'E9'-X'E2'+1)AL1(*-&N)                                 01350\n         DC    (X'EF'-X'EA'+1)&FILL                                     01351\n         DC    (X'F9'-X'F0'+1)AL1(*-&N)                                 01352\n         DC    (X'FF'-X'FA'+1)&FILL                                     01353\n         MEXIT                                                          01354\n.NUMERIC ANOP                                                           01355\n&N       DC    240&BAD,10&GOOD,6&BAD                                    01356\n         MEXIT                                                          01357\n.ALPHA   ANOP                                                           01358\n&N       DC    193&BAD,9&GOOD,7&BAD,9&GOOD,8&BAD,8&GOOD                 01359\n         DC    22&BAD                                                   01360\n         MEXIT                                                          01361\n.ALPHAN  ANOP                                                           01362\n&N       DC    193&BAD,9&GOOD,7&BAD,9&GOOD,8&BAD,8&GOOD                 01363\n         DC    6&BAD,10&GOOD,6&BAD                                      01364\n         MEXIT                                                          01365\n.ZFILL   ANOP                                                           01366\n&N       DC    64AL1(*-&N),C'0',191AL1(*-&N)                            01367\n         MEXIT                                                          01368\n.BAD     ANOP                                                           01369\n&N       DC    256&BAD                                                  01370\n         MEXIT                                                          01371\n.GOOD    ANOP                                                           01372\n&N       DC    256&GOOD                                                 01373\n         MEXIT                                                          01374\n.SCAN    ANOP                                                           01375\n         AIF   (T'&SKIP NE 'O').SKIP                                    01376\n         AIF   (T'&FIND NE 'O').FIND                                    01377\n         MNOTE 8,'TRT SCAN SKIP OR FIND CHARACTER NOT FOUND'            01378\n         MEXIT                                                          01379\n.SKIP    ANOP                                                           01380\n&N       DC    256&BAD                                                  01381\n         ORG   &N+&SKIP                                                 01382\n         DC    &GOOD                                                    01383\n         ORG                                                            01384\n         MEXIT                                                          01385\n.FIND    ANOP                                                           01386\n&N       DC    256&GOOD                                                 01387\n         ORG   &N+&FIND                                                 01388\n         DC    &BAD                                                     01389\n         ORG                                                            01390\n         MEXIT                                                          01391\n         MEND                                                           01392\n         MACRO                                                          01393\n&N       PTRACE &DDNAME=PTRACE                                          01394\n.*             AUTHOR.   DON HIGGINS.                                   01395\n.*             DATE.     01/06/75.                                      01396\n.*             REMARKS.  GENERATE TRACE OF EACH PENTRY NAME ENTERED.    01397\n.*                       THIS MACRO SHOULD BE PLACED AS FIRST           01398\n.*                       EXECUTABLE STATEMENT IN PROGRAM.               01399\n.*                       REMOVE AFTER TESTING TO ELIMINATE OVERHEAD.    01400\n         GBLB  &PTRACE                                                  01401\n         GBLC  &PTNAME                                                  01402\n&PTRACE  SETB  1                                                        01403\n&PTNAME  SETC  'PENT&SYSNDX'                                            01404\n&N       B     PEND&SYSNDX                                              01405\n         B     *+4                                                      01406\nPENT&SYSNDX  EQU *                                                      01407\n         STM   R14,R1,PSAV&SYSNDX                                       01408\n         MVC   *+6+2(2),PENT&SYSNDX-2                                   01409\n         LA    R1,*-*                                                   01410\n         SH    R1,=H'24'                                                01411\n         MVC   PMSG&SYSNDX+1(8),0(R1)                                   01412\n         DISPLAY PMSG&SYSNDX,DDNAME=&DDNAME                             01413\n         LM    R14,R1,PSAV&SYSNDX                                       01414\n         B     PENT&SYSNDX-4                                            01415\nPMSG&SYSNDX DC CL133' '                                                 01416\nPSAV&SYSNDX DC 4F'0'                                                    01417\nPEND&SYSNDX EQU *                                                       01418\n         MEND                                                           01419\n         MACRO                                                          01420\n&N       FINDCDE &EP=0,&EPLOC=0                                         01421\n.*             AUTHOR.   DON HIGGINS.                                   01422\n.*             DATE.     01/10/75.                                      01423\n.*             REMARKS.  SET R1 TO CDE ADDRESS OR ZERO                  01424\n         AIF   ('&EP'(1,1) EQ '0').EPLOC                                01425\n.EP      ANOP                                                           01426\n         BAL   R14,*+12                                                 01427\n         DC    CL8'&EP'                                                 01428\n         AGO   .FIND                                                    01429\n.EPLOC   ANOP                                                           01430\n         LA    R14,&EPLOC                                               01431\n.FIND    ANOP                                                           01432\n         LOADTCB R15                                                    01433\n         ZR    R1                                                       01434\n         L     R15,36(R15) TCBLLS FE PG 289                             01435\n         DO    WHILE,(LTR,R15,R15,NZ)                                   01436\n               L    R1,4(R15)      LLE CDE ADDRESS FE PG 280            01437\n               IF   (CLC,8(8,R1),0(R14),EQ)                             01438\n                    ZR   R15                                            01439\n               ELSE                                                     01440\n                    L    R15,0(R15)                                     01441\n                    ZR   R1                                             01442\n               FI                                                       01443\n         OD                                                             01444\n         MEND                                                           01445\n         MACRO                                                          01446\n&N       DOEXIT                                                         01447\n         GBLA  &DO(10),&DOSEQ(10),&DOLVL,&DOLAB                         01448\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           01449\n.*             AUTHOR.   DON HIGGINS.                                   01450\n.*             DATE.     01/29/75.                                      01451\n.*             REMARKS.  EXIT TO END OF CURRENT DO LOOP.                01452\n         AIF   (&DOLVL EQ 0).ERR1                                       01453\n         B     IF0&ELSE(&LEVEL)                                         01454\n         MEXIT                                                          01455\n.ERR1    MNOTE 8,'DOEXIT NOT WITHIN DO LOOP'                            01456\n         MEND                                                           01457\n         MACRO                                                          01458\n&N       HDC   &HLINE,&HCOL,&HDATA                                      01459\n         ORG   &HLINE+&HCOL                                             01460\n         AIF   (T'&HDATA EQ 'O').EXIT                                   01461\n&N       DC    &HDATA                                                   01462\n.EXIT    ANOP                                                           01463\n         MEND                                                           01464\n         MACRO                                                          01465\n&N       ABSP  &P                                                       01466\n         LCLA  &LP                                                      01467\n&LP      SETA  L'&P                                                     01468\n&N       OI    &P+&LP-1,X'0F' MAKE PACKED FIELD POSITIVE                01469\n         MEND                                                           01470\n         MACRO                                                          01471\n         XVBT3C                                                         01472\nCLGDSECT DSECT                                                          01473\n*              AUTHOR.   DON HIGGINS.                                   01474\n*              DATE.     04/04/75.                                      01475\n*              REMARKS.  RECORD CREATED BY GETCATLG (GU027000).         01476\nCLGVOL   DS    CL6       VOLUME                                         01477\nCLGDSN   DS    CL44      DATA SET NAME, CONNECT, INDEX, ALIAS, ETC.     01478\nCLGTYP   DS    CL1       1-DSN,2-CONNX,3-GDS,4-ALIAS,5-INDEX            01479\nCLGDEV   DS    XL4       DEVICE CODE                                    01480\nCLGDSNSQ DS    XL2       DATA SET SEQUENCE                              01481\nCLGVOLSQ DS    XL2       VOLUME SEQUENCE                                01482\nCLGGDSOP DS    BL1       X'02'-DELETE,X'01'-EMPTY OPTION                01483\nCLGGDSMX DS    XL1       MAXIMUM GDS DATA SET COUNT                     01484\nCLGGDSCR DS    XL2       CURRENT GDS DATA SET COUNT                     01485\n         MEND                                                           01486\n         MACRO                                                          01487\n         QCBD                                                           01488\n*                                                                       01489\n*              ENQ/DEQ CONTROL BLOCKS  (SEE IEAVENQ1 IGC056)            01490\n*                                                                       01491\n*                                                                       01492\n*              MAJOR QCB                                                01493\n*                                                                       01494\nQCBMAJ   DSECT                                                          01495\nQMJNEXT  DS    A    NEXT MAJOR QCB                                      01496\nQMJPREV  DS    A    PREVIOUS MAJOR QCB                                  01497\nQMJMINOR DS    A    FIRST MINOR QCB                                     01498\nQMJNAME  DS    CL8  MAJOR QCB NAME                                      01499\nQMJLNE   EQU   *-QCBMAJ                                                 01500\n*                                                                       01501\n*              MINOR QCB                                                01502\n*                                                                       01503\nQCBMIN   DSECT                                                          01504\nQMNQEL   DS    A    FIRST QUEUE ELEMENT                                 01505\nQMNPREV  DS    A    PREVIOUS MINOR QCB                                  01506\nQMNNEXT  DS    A    NEXT MINOR QCB                                      01507\nQMNLNM   DS    B    LENGTH OF RANME                                     01508\nQMNLSQA  DS    X    TYPE OF ENG                                         01509\nQMNSYS   EQU   255                                                      01510\nQMNSYSMS EQU   254                                                      01511\n*                   ANY OTHER VALUE IS STEP (TCBLSQA VALUE)             01512\nQMNNAME  DS    C                                                        01513\n*                                                                       01514\n*              QUEUE ELEMENT                                            01515\n*                                                                       01516\nQEL      DSECT                                                          01517\nQELNQEL  DS    A    NEXT QEL                                            01518\nQELSMC   EQU   QELNQEL       MUST COMPLETE INDICATORS                   01519\nQELSYSMC EQU   X'20'     SYSTEM MUST COMPLETE                           01520\nQELSTPMC EQU   X'10'     STEP MUST COMPLETE                             01521\nQELLQEL  DS    A    PREVIOUS QEL                                        01522\nQELCODE  EQU   QELLQEL   TYPE OF REQUEST                                01523\nQELSHAR  EQU   X'80'     SHARED                                         01524\nQELRESV  EQU   X'40'     RESERVED                                       01525\nQELRBWT  EQU   X'20'     DEFER SVRB PROCESSING UNTIL SWAP               01526\nQELNQECB EQU   X'10'     ENQ WITH ECB FOR WAIT                          01527\nQELRLSE  EQU   X'08'     DELAYED RELEASE                                01528\nQELEXCP  EQU   X'04'     EXCP INITIATED TO RELEASE DEVICE               01529\nQELSTAT  EQU   X'02'     STATUS SET PENDING                             01530\nQELABND  EQU   X'01'     QEL FOR TASK IN ABEND                          01531\nQELTCB   DS    A    TCB FOR ENQ                                         01532\nQELTJID1 EQU   QELTCB    FIRST BYTE OF TSO USER ID                      01533\nQELSVRB  DS    A    SVRB/UCB FOR ENQ                                    01534\nQELTJID2 EQU   QELSVRB   SECOND BYTE OF TSO USER ID                     01535\n         MEND                                                           01536\n         MACRO                                                          01537\n&N       SDCB  &M=PM,&R=FBA,&L=133,&B=0,&E=1                            01538\n.*             AUTHOR.   DON HIGGINS.                                   01539\n.*             DATE.     09/29/75.                                      01540\n.*             REMARKS.  SHORT FORM OF COMMONLY USED DCB WITH EXIT TO   01541\n.*                       PLUG ZERO BLKSIZE WITH LRECL.                  01542\n         DS    0A                                                       01543\n         DC    X'85',AL3(*+3) DCB EXIT LIST                             01544\n         OC    62(2,1),62(1)       IS BLKSIZE = 0                       01545\n         BCR   7,14                NO, EXIT NOW                         01546\n         MVC   62(2,1),82(1)       YES, BLKSIZE=LRECL                   01547\n         BR    14                  EXIT                                 01548\n         DC    CL8'&N'        DCB NAME FOR DUMP VERIFICATION            01549\n&N       DCB   EXLST=&N-28,DSORG=PS,DDNAME=&N,                         X01550\n               MACRF=&M,RECFM=&R,LRECL=&L,BLKSIZE=&B,EODAD=&E           01551\n         MEND                                                           01552\n         MACRO                                                          01553\n         ELSEIF                                                         01554\n         GBLA  &ELSE(10),&SEQ(10),&LEVEL,&LAB                           01555\n         GBLA  &ELSEIF(10)                                              01556\n         LCLA  &N,&M,&S,&LAB1,&L,&I                                     01557\n         LCLC  &OP,&OPR                                                 01558\n         LCLB  &TESTSW                                                  01559\n.*             AUTHOR.   DON HIGGINS.                                   01560\n.*             DATE.     05/23/76.                                      01561\n.*             REMARKS.  CONTROL STRUCTURE FOR CONDITIONAL EXECUTION.   01562\n         AIF   (&LEVEL EQ 10).ERR1                                      01563\n         ELSE                                                           01564\n&LEVEL   SETA  &LEVEL+1                                                 01565\n&ELSEIF(&LEVEL) SETA 1                                                  01566\n&SEQ(&LEVEL) SETA 1                                                     01567\n&LAB     SETA  &LAB+1                                                   01568\n&ELSE(&LEVEL) SETA &LAB                                                 01569\n&N       SETA N'&SYSLIST                                                01570\n.NEXTAND ANOP                                                           01571\n&TESTSW  SETB  0                                                        01572\n.TEST    ANOP                                                           01573\n&S       SETA  &S+1                                                     01574\n         AIF   (&S GT &N).ERR2                                          01575\n&M       SETA  N'&SYSLIST(&S)                                           01576\n         AIF   (&M EQ 1).TESTEND                                        01577\n         AIF   (&M LT 2).ERR3                                           01578\n         AIF   (&M GT 5).ERR4                                           01579\n&I       SETA  2                                                        01580\n&OPR     SETC  ''                                                       01581\n&OP      SETC  '&SYSLIST(&S,1)'                                         01582\n         AIF   (&M GT 2).TESTOPR                                        01583\n         &OP                                                            01584\n         AGO   .TESTEND                                                 01585\n.TESTOPR ANOP                                                           01586\n         AIF   ('&SYSLIST(&S,&I)'(1,1) NE '''').NOLIT                   01587\n&L       SETA  K'&SYSLIST(&S,&I)                                        01588\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'(2,&L-2)                         01589\n         AGO   .NEXTOPR                                                 01590\n.NOLIT   ANOP                                                           01591\n&OPR     SETC  '&OPR'.'&SYSLIST(&S,&I)'                                 01592\n.NEXTOPR ANOP                                                           01593\n&I       SETA  &I+1                                                     01594\n         AIF   (&I EQ &M).TESTGEN                                       01595\n&OPR     SETC  '&OPR'.','                                               01596\n         AGO   .TESTOPR                                                 01597\n.TESTGEN ANOP                                                           01598\n         &OP   &OPR                                                     01599\n.TESTEND ANOP                                                           01600\n         AIF   (&TESTSW EQ 1).ORBC                                      01601\n.AMBC    ANOP                                                           01602\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               01603\n.CONNECT ANOP                                                           01604\n&S       SETA  &S+1                                                     01605\n         AIF   (&S GT &N).EXIT                                          01606\n&M       SETA  N'&SYSLIST(&S)                                           01607\n         AIF   (&M NE 1).ERR5  BAD CONNECTOR                            01608\n         AIF   ('&SYSLIST(&S)' EQ 'AND').NEXTAND                        01609\n         AIF   ('&SYSLIST(&S)' NE 'OR').ERR5  BAD CONNECTOR             01610\n.NEXTOR   ANOP                                                          01611\n&LAB1    SETA  &LAB+1                                                   01612\n         B     IF0&LAB1  SKIP TEST IF LAST ONE TRUE                     01613\nIF0&LAB   EQU *          DO TEST IF LAST ONE FALSE                      01614\n&LAB     SETA  &LAB+2                                                   01615\n&ELSE(&LEVEL) SETA &LAB                                                 01616\n&TESTSW  SETB  1                                                        01617\n         AGO   .TEST                                                    01618\n.ORBC    ANOP                                                           01619\n         BC    15-&SYSLIST(&S,&M),IF0&LAB                               01620\nIF0&LAB1 EQU *                                                          01621\n         AGO   .CONNECT                                                 01622\n.ERR1    MNOTE 8,'IF - LEVEL OVERFLOW'                                  01623\n         AGO   .EXIT                                                    01624\n.ERR2    MNOTE 8,'IF - MISSING TEST LIST'                               01625\n         AGO   .EXIT                                                    01626\n.ERR3    MNOTE 8,'IF - TEST LIST TOO SHORT'                             01627\n         AGO   .EXIT                                                    01628\n.ERR4    MNOTE 8,'IF - TEST LIST TOO LONG'                              01629\n         AGO   .EXIT                                                    01630\n.ERR5    MNOTE 8,'IF - INVALID CONNECTOR'                               01631\n.EXIT    ANOP                                                           01632\n         MEND                                                           01633\n*          DATA SET CBT842     AT LEVEL 001 AS OF 10/01/77\n*          DATA SET GU024900   AT LEVEL 006 AS OF 11/29/73              00001\n         PRINT NOGEN                                                    00002\nPDSCLIST SUBENTRY                                                       00003\n*              AUTHOR.   DON HIGGINS.                                   00004\n*              DATE.     11/22/73.                                      00005\n*              REMARKS.  PRINT TWO REPORTS FROM ANY PDS LOAD MODULE     00006\n*                        LIBRARY.                                       00007\n*                          1. LIST ALL CSECT NAMES WITHIN EACH MEMBER.  00008\n*                          2. LIST ALL MEMBERS WHICH REFERENCE EACH     00009\n*                             CSECT NAME.                               00010\n*              FILES.                                                   00011\n*                   PDSLIB -  PDS LIBRARY                               00012\n*                   PDSMEM -  PDS LIBRARY                               00013\n*                   LSTMEMBR- MEMBER REPORT                             00014\n*                   LSTCSECT- CSECT  REPORT                             00015\n*                   NAMEIN  - FILE CREATED AND SORTED FOR CSECT REPORT  00016\n*                   NAMEOUT  - OUTPUT FROM SORT FOR CSECT REPORT        00017\n*              REFERENCES.                                              00018\n*                   LINKAGE EDITOR F PLM  Y28-6667-0 PG 171             00019\n*                   FE HANDBOOK S229-3169-3 PG 96                       00020\n*              REGISTERS                                                00021\n*                   R2 - PDSLIB JFCB ADDRESS                            00022\n*                   R3 - PDSLIB DE   ADDRESS                            00023\n*                   R4 - REPORT DCB                                     00024\n*                   R5 - PDSMEM BUFFER ADDRESS                          00025\n*                   R6 - LENGTH CESD TEXT                               00026\n*                   R7 - A(CURRENT CESD ENTRY)                          00027\n*                   R8 - A(CURRENT PRINT LINE ENTRY)                    00028\n*                   R9 - FREE                                           00029\n*                   R10- FREE                                           00030\n*                   R11- FREE                                           00031\n*                   R12- PRINT ROUTINE LINKAGE                          00032\n         OPEN  (PDSMEM,(INPUT),LSTMEMBR,(OUTPUT),NAMEIN,(OUTPUT))       00033\n         LH    R0,PDSMEM+DCBBLKSI                                       00034\n         GETMAIN R,LV=(0)                                               00035\n         LR    R5,R1                                                    00036\n         SCALL GETPDSDD,(JFCB,DE)                                       00037\n         LT    R2,JFCB                                                  00038\n         BZ    NOPDSLIB                                                 00039\n         MVC   PDSDSN,0(R2)                                             00040\n         MVC   PDSVOL,118(R2)                                           00041\n         DTIME TIMEDATE                                                 00042\n         LA    R4,LSTMEMBR                                              00043\n         LA    R8,DLIST            R8=A(CSECT NAME LIST)                00044\n*                                                                       00045\n*              PRINT MEMBER REPORT AND CREATE NAMEFILE FOR SORT         00046\n*                                                                       00047\nM1       TAG                                                            00048\n         SCALL GETPDSDD,(JFCB,DE)                                       00049\n         LT    R3,DE                                                    00050\n         BZ    S1                  AT END OF DIRECTORY, GO SORT         00051\n         MVC   DNAME,0(R3)                                              00052\n         MVC   MEMBER,0(R3)                                             00053\n         MVC   TTRK(3),8(R3)                                            00054\n         FIND  PDSMEM,TTRK,C                                            00055\nM2       TAG                                                            00056\n         READ  DECB,SF,PDSMEM,(R5),'S'                                  00057\n         CHECK DECB                                                     00058\n         CLI   0(R5),CESD                                               00059\n         BE    M2CESD                                                   00060\n         TB    0(R5),(0,1,2,3)                                          00061\n         BZ    M2EXIT              EXIT IF CONTROL RECORD (NO MORE ESD) 00062\n         B     M2                  SKIP SYM OR SCATTER RECORDS          00063\nM2CESD   TAG                                                            00064\n         LH    R6,6(R5)            R6=LENGTH OF ESD DATA                00065\n         LA    R7,8(R5)            R7=A(CURRENT ESD ENTRY)              00066\nM3       TAG                                                            00067\n         LR    R0,R2               SAVE R2 FROM TRT                     00068\n         TRT   8(1,R7),CESDTYPE                                         00069\n         LR    R2,R0                                                    00070\n         BZ    M3NEXT                                                   00071\n         CLC   0(8,R7),=CL8' '                                          00072\n         BE    M3NEXT                                                   00073\n         MVC   0(8,R8),0(R7)                                            00074\n         MVC   CSECT,0(R7)                                              00075\n         PUT   NAMEIN,NAMEREC                                           00076\n         AP    SIZE,=P'1'                                               00077\n         LA    R8,9(R8)                                                 00078\n         CL    R8,=A(DLISTEND)                                          00079\n         BL    M3NEXT                                                   00080\n         BAL   R12,PRINT                                                00081\nM3NEXT   TAG                                                            00082\n         SH    R6,=H'16'                                                00083\n         BNP   M2                                                       00084\n         LA    R7,16(R7)                                                00085\n         B     M3                                                       00086\nM2EXIT   TAG                                                            00087\n         CLC   DLINE+1(132),DLINE                                       00088\n         BE    M1                                                       00089\n         BAL   R12,PRINT                                                00090\n         B     M1                                                       00091\n*                                                                       00092\n*              SORT  MEMBER NAMES WITHIN CSECT NAME                     00093\n*                                                                       00094\nS1       TAG                                                            00095\n         CLOSE (NAMEIN,,PDSMEM,,LSTMEMBR)                               00096\n         EDIT  TO=DSIZE,FROM=SIZE,MASK='099999'                         00097\n         LINK  EP=SORT,PARAM=(SORTPARM)                                 00098\n         OPEN  (NAMEOUT,(INPUT),LSTCSECT,(OUTPUT))                      00099\n*                                                                       00100\n*              PRINT CSECT REPORT                                       00101\n*                                                                       00102\n         LA    R4,LSTCSECT                                              00103\n         ZAP   PAGE,=P'0'                                               00104\n         ZAP   LINE,=P'0'                                               00105\n         MVC   HEAD2,HEAD2ALT                                           00106\nC1       TAG                                                            00107\n         GET   NAMEOUT,NAMEREC                                          00108\n         CLC   CSECT,LASTC                                              00109\n         BE    CADD                                                     00110\nCFLUSH   TAG                                                            00111\n         CLC   DLINE+1(132),DLINE                                       00112\n         BE    CNEW                                                     00113\n         BAL   R12,PRINT                                                00114\nCNEW     TAG                                                            00115\n         MVC   DNAME,CSECT                                              00116\n         MVC   LASTC,CSECT                                              00117\n         LA    R8,DLIST                                                 00118\nCADD     TAG                                                            00119\n         MVC   0(8,R8),MEMBER                                           00120\n         LA    R8,9(R8)                                                 00121\n         CL    R8,=A(DLISTEND)                                          00122\n         BL    C1                                                       00123\n         BAL   R12,PRINT                                                00124\n         B     C1                                                       00125\nCEND     TAG                                                            00126\n         CLC   DLINE+1(132),DLINE                                       00127\n         BE    CEND2                                                    00128\n         BAL   R12,PRINT                                                00129\nCEND2    TAG                                                            00130\n         CLOSE (NAMEOUT,,LSTCSECT)                                      00131\nEXIT     TAG                                                            00132\n         SUBEXIT                                                        00133\nNOPDSLIB TAG                                                            00134\n         WTO   'NO PDSLIB DD'                                           00135\n         B     EXIT                                                     00136\nPRINT    TAG                                                            00137\n         SP    LINE,=P'1'                                               00138\n         BP    PRINTD                                                   00139\n         ZAP   LINE,=P'60'                                              00140\n         AP    PAGE,=P'1'                                               00141\n         EDIT  TO=DPAGE,FROM=PAGE,MASK=' ZZZ'                           00142\n         PUT   (R4),HEAD1                                               00143\n         PUT   (R4),HEAD2                                               00144\n         PUT   (R4),HEAD3                                               00145\nPRINTD   TAG                                                            00146\n         PUT   (R4),DLINE                                               00147\n         MVC   DLINE+1(132),DLINE                                       00148\n         LA    R8,DLIST                                                 00149\n         BR    R12                                                      00150\n         EQUAL                                                          00151\nDCBBLKSI EQU   62                                                       00152\nPDSMEM   DCB   DSORG=PO,MACRF=R,DDNAME=PDSMEM,EODAD=M2EXIT              00153\nLSTMEMBR DCB   DSORG=PS,MACRF=PM,DDNAME=LSTMEMBR,RECFM=FA,BLKSIZE=133   00154\nLSTCSECT DCB   DSORG=PS,MACRF=PM,DDNAME=LSTCSECT,RECFM=FA,BLKSIZE=133   00155\nNAMEIN   DCB   DSORG=PS,MACRF=PM,DDNAME=NAMEIN,                        X00156\n               RECFM=FB,LRECL=16                                        00157\nNAMEOUT  DCB   DSORG=PS,MACRF=GM,DDNAME=NAMEOUT,EODAD=CEND              00158\nJFCB     DC    A(0)                                                     00159\nDE       DC    A(0)                                                     00160\nHEAD1    DS    0CL133                                                   00161\n         DC    C'1',20C' '                                              00162\nPDSDSN   DC    CL44' ',10C' '                                           00163\nPDSVOL   DC    CL6' ',10C' '                                            00164\nTIMEDATE DC    CL22' ',C' PAGE'                                         00165\nDPAGE    DC    CL3' '                                                   00166\n         FILL  HEAD1                                                    00167\nHEAD2    DS    0CL133                                                   00168\n         DC    C'0MEMBER  ',13C' CSECT   '                              00169\n         FILL  HEAD2                                                    00170\nHEAD2ALT DS    0CL133                                                   00171\n         DC    C'0CSECT   ',13C' MEMBER  '                              00172\n         FILL  HEAD2ALT                                                 00173\nHEAD3    DC    CL133' '                                                 00174\nDLINE    DS    0CL133                                                   00175\n         DC    C' '                                                     00176\nDNAME    DC    CL8' ',C' '                                              00177\nDLIST    DC    13CL9' '                                                 00178\nDLISTEND EQU   *                                                        00179\n         FILL  DLINE                                                    00180\nLINE     DC    PL2'0'                                                   00181\nPAGE     DC    PL2'0'                                                   00182\nSIZE     DC    PL3'0'                                                   00183\nNAMEREC  DS    0CL16                                                    00184\nCSECT    DC    CL8' '                                                   00185\nMEMBER   DC    CL8' '                                                   00186\nTTRK     DC    XL4'00'                                                  00187\nCESD     EQU   X'20'                                                    00188\nSD       EQU   X'00'                                                    00189\nPC       EQU   X'04'                                                    00190\nCM       EQU   X'05'                                                    00191\nPR       EQU   X'06'                                                    00192\nENTAB    EQU   X'14'                                                    00193\nAUTOCESD EQU   X'80'    THIS IS NOT DOCUMENTED IN THE PLM               00194\nCESDTYPE DC    AL1(1,0,0,0,1,1,1),13AL1(0),AL1(1),107AL1(0)             00195\n         DC    AL1(1),127AL1(0)                                         00196\n         CNOP  2,4                                                      00197\nSORTPARM DC    AL2(PARMEND-*-2)                                         00198\n         DC    A(BSORT,ESORT,BREC,EREC,0,0),C'NAME'                     00199\nPARMEND  EQU   *                                                        00200\nBSORT    DC    C' SORT FIELDS=(1,16,BI,A),SIZE='                        00201\nDSIZE    DC    CL6' '                                                   00202\nESORT    DC    C' '                                                     00203\nBREC     DC    C' RECORD TYPE=F,LENGTH=16'                              00204\nEREC     DC    C' '                                                     00205\nLASTC    DC    CL8' '                                                   00206\n#PAN$AUD CSECT                                                          002064\n$PAN#AUD DC    CL21'001CBT842    10/01/77'                              002065\n         END   PDSCLIST                                                 00207\n", "mimetype": "text/plain", "datatype": "iso-8859-1", "extension": ".txt"}}}}, "SCRIPTOPTIONS": {"filename": "./CBT237/FILE237.XMI", "LRECL": 80, "loglevel": 30, "outputfolder": "CBT237", "encoding": "cp1140", "unnum": true, "quiet": false, "force": false, "binary": false, "modifydate": true}}