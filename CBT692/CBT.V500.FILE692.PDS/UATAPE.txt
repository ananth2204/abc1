UATAPE   TITLE 'UATAPE -- TAPE LABEL UTILITY PROGRAM'                   UAT00010
*********************************************************************** UAT00020
*                                                                     * UAT00030
*                                                                     * UAT00040
*                             U A T A P E                             * UAT00050
*                                                                     * UAT00060
*                                                                     * UAT00070
*     PROGRAM NAME:  UATAPE                                           * UAT00080
*                                                                     * UAT00090
*     AUTHOR:        DAVID L. MERRIFIELD                              * UAT00100
*                    UNIVERSITY OF ARKANSAS                           * UAT00110
*                    COMPUTING SERVICES                               * UAT00120
*                    155 RAZORBACK ROAD                               * UAT00130
*                    FAYETTEVILLE, AR 72701                           * UAT00140
*                    PHONE:  479-575-5829                             * UAT00150
*                    FAX  :  479-575-4753                             * UAT00150
*                    email:  dlm@uark.edu                             * UAT00150
*                                                                     * UAT00160
*     VERSION:       1.0       SEPTEMBER 15, 1981                     * UAT00170
*                    1.1       OCTOBER   24, 1981                     * UAT00180
*                    1.2       MAY       10, 1982                     * UAT00190
*                    1.3       OCTOBER   27, 1982                     * UAT00200
*                    1.4       APRIL     05, 1983                     * UAT00210
*                    1.5       DECEMBER  29, 1985                     * UAT00220
*                    1.6       MARCH     28, 1987                     * UAT00230
*                    1.61      OCTOBER    1, 1990                     * UAT00240
*                    1.7       JULY      16, 1992 (3480 SUPPORT ADDED)* UAT00250
*                    1.71      JUNE       6, 1994 (FIX LTM PROBLEM)   * UAT00260
*                    1.72      AUGUST    23, 1996 (FIX LTM/NL PROBLEM)* UAT00270
*                    1.8       OCTOBER    3, 2004 (64K Blocks)     SBG* UAT00270
*                    1.81      DECEMBER   7, 2005 3490 AND 3590 ADDED * UAT00270
*                                                                     * UAT00280
*                                                                     * UAT00290
*     DESCRIPTION:                                                    * UAT00300
*         UATAPE IS A UTILITY PROGRAM THAT WILL READ AN ENTIRE        * UAT00310
*         MAGNETIC TAPE VOLUME AND PRINT THE CONTENTS OF THE          * UAT00320
*         VARIOUS FIELDS PRESENT IN THE LABEL RECORDS FOUND ON        * UAT00330
*         IBM STANDARD-LABELED TAPES.  THE LABELS AND/OR THE          * UAT00340
*         DATA FILES ON THE TAPE CAN BE PRINTED IN HEXADECIMAL        * UAT00350
*         FORMAT IF DESIRED.  ALSO, UATAPE WILL COPY THE ENTIRE       * UAT00360
*         TAPE VOLUME TO ANOTHER VOLUME.  NON-STANDARD OR NON-        * UAT00370
*         LABELED TAPES ARE ALSO SUPPORTED, BUT ONLY MINIMAL          * UAT00380
*         AMOUNTS OF INFORMATION CAN BE GLEANED FROM THESE TAPES.     * UAT00390
*                                                                     * UAT00400
*     PROGRAM REQUIREMENTS:                                           * UAT00410
*         THIS VERSION OF UATAPE HAS BEEN TAILORED FOR USE UNDER      * UAT00420
*         THE MVS/SP V1.3.5 OPERATING SYSTEM.  NO PROVISION HAS       * UAT00430
*         BEEN MADE FOR ANY OTHER OPERATING SYSTEM.  UATAPE USES      * UAT00440
*         ITS OWN INTERNAL CHANNEL PROGRAMS, WHICH IT EXECUTES        * UAT00450
*         USING THE EXCP ACCESS METHOD.  ALSO, UATAPE INTERNALLY      * UAT00460
*         FORCES THE TAPES THAT IT PROCESSES TO "BYPASS LABEL         * UAT00470
*         PROCESSING" SO THAT IT CAN READ THE VOLUME AND DATA         * UAT00480
*         SET LABELS WITHOUT INTERFERENCE FROM THE OPERATING          * UAT00490
*         SYSTEM.  IF THE HOST OPERATING SYSTEM HAS A TAPE            * UAT00500
*         MANAGEMENT SYSTEM INSTALLED (SUCH AS CA-1), IT WILL         * UAT00510
*         PROBABLY BE NECESSARY TO INDICATE IN THE JCL THAT THE       * UAT00520
*         TAPE BEING PROCESSED IS AN OUTSIDE, NON-TMS TAPE (SEE       * UAT00530
*         JCL COMMENTS BELOW).                                        * UAT00540
*                                                                     * UAT00550
*         Tested on z/OS 1.4.  Works fine.                            * UAT00550
*                                                                     * UAT00550
*********************************************************************** UAT00560
         EJECT                                                          UAT00570
*********************************************************************** UAT00580
*                                                                     * UAT00590
*     DD-STATEMENT REQUIREMENTS:                                      * UAT00600
*         DDNAME=STEPLIB  -- DEFINES THE LIBRARY IN WHICH UATAPE      * UAT00610
*                            RESIDES IF NOT IN SYS1.LINKLIB           * UAT00620
*         DDNAME=SYSPRINT -- DEFINES A SYSOUT=A PRINTED OUTPUT        * UAT00630
*                            DATA SET                                 * UAT00640
*         DDNAME=SYSUT1   -- DEFINES THE INPUT TAPE VOLUME            * UAT00650
*         DDNAME=SYSUT2   -- DEFINES THE OUTPUT TAPE VOLUME IF        * UAT00660
*                            COPYING TO BE DONE (OMITTED OTHERWISE)   * UAT00670
*                                                                     * UAT00680
*     SAMPLE JCL SETUP:                                               * UAT00690
*                                                                     * UAT00700
*         //AB123456 JOB (ACCOUNTING INFORMATION),'NAME',             * UAT00710
*         //    CLASS=A,TIME=(,59),MSGLEVEL=(1,1)                     * UAT00720
*         //   EXEC   PGM=UATAPE,PARM='...OPTIONS...'                 * UAT00730
*         //STEPLIB  DD UNIT=SYSDA,DISP=SHR,DSN=UATAPE.LIBRARY        * UAT00740
*         //SYSPRINT DD SYSOUT=A                                      * UAT00750
*         //SYSUT1   DD UNIT=TAPE,DISP=OLD,VOL=SER=INTAPE             * UAT00760
*         //SYSUT2   DD UNIT=TAPE,DISP=OLD,VOL=SER=OUTAPE,DCB=DEN=4   * UAT00770
*         //                                                          * UAT00780
*                                                                     * UAT00790
*     CA-1 TAPE MANAGEMENT SYSTEM REQUIREMENTS:                       * UAT00800
*                                                                     * UAT00810
*         MOST TAPE MANAGEMENT SYSTEMS WILL NOT PERMIT UATAPE TO      * UAT00820
*         RUN BECAUSE OF ITS POTENTIAL TO MOUNT, READ, AND WRITE      * UAT00830
*         TAPES THAT HAVE NOT BEEN PROPERLY LOGGED INTO THEIR         * UAT00840
*         TAPE CATALOGS.  CA-1 IS NO EXCEPTION.  IN ORDER FOR         * UAT00850
*         UATAPE TO RUN UNDER CA-1, YOU MUST SPECIFY TO THE TMS       * UAT00860
*         THAT THE TAPE BEING PROCESSED IS A NON-LIBRARIED TAPE.      * UAT00870
*         THIS IS DONE BY SPECIFYING LABEL=EXPDT=98000 ON EACH        * UAT00880
*         TAPE DD-STATEMENT:                                          * UAT00890
*                                                                     * UAT00900
*         //SYSUT1   DD UNIT=TAPE,DISP=OLD,VOL=SER=INTAPE,            * UAT00910
*         //            LABEL=EXPDT=98000                             * UAT00920
*         //SYSUT2   DD UNIT=TAPE,DISP=OLD,VOL=SER=OUTAPE,DCB=DEN=4,  * UAT00930
*         //            LABEL=EXPDT=98000                             * UAT00940
*                                                                     * UAT00950
*         OTHER TAPE MANAGEMENT SYSTEMS MAY REQUIRE A SIMILAR         * UAT00960
*         PROCEDURE, BUT THEY ARE NOT DISCUSSED HERE.                 * UAT00970
*                                                                     * UAT00980
*********************************************************************** UAT00990
         EJECT                                                          UAT01000
*********************************************************************** UAT01010
*                                                                     * UAT01020
*     PARM FIELD OPTIONS:                                             * UAT01030
*                                                                     * UAT01040
*         OPTIONS ARE SPECIFIED IN THE PARM= PARAMETER ON THE EXEC    * UAT01050
*         STATEMENT.  EACH OPTION SHOULD BE SEPARATED BY A SINGLE     * UAT01060
*         COMMA, WITH NO SPACES ALLOWED.  THE LIST OF VALID OPTIONS   * UAT01070
*         FOLLOWS:                                                    * UAT01080
*                                                                     * UAT01090
*         LIST     - PRINT LABEL RECORD INFORMATION (DEFAULT)         * UAT01100
*         COPY     - COPY SYSUT1 TAPE TO SYSUT2 TAPE                  * UAT01110
*         DUMP     - PRINT ALL DATA RECORDS IN HEX FORMAT             * UAT01120
*         DUMPLAB  - PRINT ALL LABEL RECORDS IN HEX FORMAT            * UAT01130
*         DUMPALL  - PRINT ALL LABEL RECORDS AND DATA RECORDS IN      * UAT01140
*                    HEXADECIMAL FORMAT                               * UAT01150
*         BLOCKS   - PRINT SIZE OF DATA RECORDS                       * UAT01160
*         PRINT    - PRINT ALL DATA RECORDS (EBCDIC FORMAT)           * UAT01170
*         CRT      - OUTPUT IS FORMATTED FOR 80-COLUMN CRT SCREEN     * UAT01180
*         ATOE     - ALL LABELS AND DATA ON SYSUT1 TRANSLATED FROM    * UAT01190
*                    ASCII TO EBCDIC                                  * UAT01200
*         ETOA     - ALL LABELS AND DATA ON SYSUT1 TRANSLATED FROM    * UAT01210
*                    EBCDIC TO ASCII                                  * UAT01220
*         BYPASS   - BYPASSES LABEL CHECKING FOR SYSUT2 TAPE IF       * UAT01230
*                    COPY ALSO SPECIFIED                              * UAT01240
*         VERBATIM - DOES NOT CHANGE CONTENT OF DATA RECORDS (E.G.,   * UAT01250
*                    WON'T CHANGE LABEL INFORMATION LIKE VOLUME       * UAT01260
*                    SERIAL, DENSITY FIELD, ETC.)                     * UAT01270
*         DUMPMAX=NNN  - SPECIFY MAXIMUM NUMBER OF BLOCKS TO DUMP IF  * UAT01280
*                        DUMP, DUMPLAB, OR DUMPALL IS ALSO SPECIFIED  * UAT01290
*         PRINTMAX=NNN - SPECIFY MAXIMUM NUMBER OF RECORDS TO PRINT   * UAT01300
*                        IF PRINT SPECIFIED                           * UAT01310
*         MAXFILES=NNN - SPECIFY MAXIMUM NUMBER OF FILES ON TAPE TO   * UAT01320
*                        TO PROCESS                                   * UAT01330
*         LTM      - IGNORE ANY LEADING TAPE MARKS ON THE SYSUT1 TAPE * UAT01340
*         SKIPLAB  - SKIP WRITING ANY LABELS ON THE SYSUT2 TAPE       * UAT01350
*                    WHILE COPYING IF COPY IS ALSO SPECIFIED.  IN     * UAT01360
*                    EFFECT, SYSUT2 TAPE WILL BE A NON-LABELED TAPE   * UAT01370
*                    AFTERWARDS                                       * UAT01380
*         SKIPBAD  - SKIP OVER ANY BLOCKS OF DATA ON INPUT TAPE THAT  * UAT01390
*                    CAUSE PERMANENT I/O ERRORS IN AN EFFORT TO       * UAT01400
*                    RECOVER ANY DATA THAT FOLLOWS THE BAD BLOCK(S).  * UAT01410
*                    (RECOMMEND USE WITH SKIPLAB AND COPY OPTIONS TO  * UAT01420
*                    BUILD A NON-LABELED TAPE CONTAINING ONLY THE     * UAT01430
*                    READABLE BLOCKS OF THE BAD TAPE.)                * UAT01440
*                                                                     * UAT01450
*********************************************************************** UAT01460
         EJECT                                                          UAT01470
*********************************************************************** UAT01480
*                                                                     * UAT01490
*     COPYING A TAPE:                                                 * UAT01500
*         UATAPE CAN BE USED TO COPY ONE TAPE VOLUME TO ANOTHER.      * UAT01510
*         TO DO SO, YOU WOULD HAVE TO SPECIFY THE "COPY" OPTION       * UAT01520
*         AND SUPPLY A SYSUT1 DDCARD FOR THE INPUT TAPE AND A         * UAT01530
*         SYSUT2 DDCARD FOR THE OUTPUT TAPE.  UATAPE REQUIRES         * UAT01540
*         THAT THE SYSUT2 TAPE BE A STANDARD-LABELED TAPE, AND        * UAT01550
*         WILL CHECK THE VOLUME SERIAL IN ITS LABEL WITH THE          * UAT01560
*         VOLUME SERIAL IN THE SYSUT2 DDCARD.  AN ERROR WILL BE       * UAT01570
*         PRINTED AND UATAPE WILL TERMINATE IF THE TWO DO NOT         * UAT01580
*         MATCH.  USE BYPASS OPTION TO SKIP THE SYSTEM VOLUME         * UAT01590
*         LABEL PROCESSING.  USE SKIPLAB TO CREATE A NON-LABELED      * UAT01600
*         TAPE FROM A STANDARD LABELED TAPE.                          * UAT01610
*                                                                     * UAT01620
*     OUTPUT TAPE VOLUME SERIAL:                                      * UAT01630
*         UATAPE WILL COPY ALL LABEL AND DATA RECORDS FROM THE        * UAT01640
*         SYSUT1 TAPE TO THE SYSUT2 TAPE INTACT, WITH THE ONE         * UAT01650
*         EXCEPTION THAT ALL REFERENCES TO THE SYSUT1 TAPE'S          * UAT01660
*         VOLUME SERIAL ARE CHANGED TO THE SYSUT2 TAPE'S VOLUME       * UAT01670
*         SERIAL.  IN EFFECT, THE OUTPUT TAPE'S VOLUME SERIAL         * UAT01680
*         IS NOT CHANGED BY THE COPY OPERATION.  TAPES WITHOUT        * UAT01690
*         LABELS, OR TAPES HAVING NON-STANDARD LABELS, ARE            * UAT01700
*         COPIED VERBATIM.  NO DATA OR INFORMATION IS CHANGED         * UAT01710
*         FOR SUCH TAPES DURING THE COPY OPERATION.  USE THE          * UAT01720
*         VERBATIM OPTION TO PREVENT CHANGING THE VOLUME SERIAL       * UAT01730
*         IN THE LABELS, THUS CREATING AN EXACT DUPLICATE OF THE      * UAT01740
*         INPUT TAPE.                                                 * UAT01750
*                                                                     * UAT01760
*     OUTPUT TAPE DENSITY:                                            * UAT01770
*         UATAPE WILL ALSO SET THE PROPER DENSITY FOR THE OUTPUT      * UAT01780
*         TAPE VOLUME.  IT USES THE DENSITY PRESENT IN THE SYSUT2     * UAT01790
*         DDCARD'S DCB DENSITY PARAMETER.  ALL REFERENCES TO THE      * UAT01800
*         DENSITY IN THE TAPE LABELS ARE MODIFIED TO REFLECT THE      * UAT01810
*         CORRECT VALUE, IF REQUIRED.  CURRENTLY, MODESET COMMANDS    * UAT01820
*         ARE PRESENT IN UATAPE FOR DENSITIES OF 800, 1600, AND       * UAT01830
*         6250 BPI ONLY.                                              * UAT01840
*                                                                     * UAT01850
*     TAPE DRIVE AND TAPE CONTROLLER:                                 * UAT01860
*         ALTHOUGH SEVERAL AREAS WITHIN UATAPE SUPPORT THE VARIOUS    * UAT01870
*         DENSITIES AND NUMBER OF TRACKS FOR ITEMS WITHIN A TAPE'S    * UAT01880
*         DATA SET LABELS, THE ACTUAL EXCP COMMAND STRUCTURE IS       * UAT01890
*         LIMITED TO IBM 3420 TAPE DRIVES WITH AN IBM 3803 TAPE       * UAT01900
*         CONTROLLER.  POSITION OF SENSE INFORMATION, AND THE         * UAT01910
*         ACTUAL CHANNEL COMMANDS MAY DIFFER FOR ANY OTHER TYPE       * UAT01920
*         OF CONTROLLER OR TAPE DRIVE.                                * UAT01930
*                                                                     * UAT01940
*********************************************************************** UAT01950
         EJECT                                                          UAT01960
*********************************************************************** UAT01970
*                                                                     * UAT01980
*     TAPE MARKS:                                                     * UAT01990
*         UATAPE ASSUMES THAT ALL TAPES HAVE TWO CONTIGUOUS           * UAT02000
*         TAPE MARKS RECORDED AT THE END OF ALL DATA AND              * UAT02010
*         LABEL INFORMATION.  ** WARNING ** IF YOU ATTEMPT            * UAT02020
*         TO PROCESS A TAPE HAVING ONLY ONE TAPE MARK AT              * UAT02030
*         THE END, UATAPE WILL PRODUCE UNPREDICTABLE RESULTS,         * UAT02040
*         IN PARTICULAR, THE TAPE VOLUME MAY RUN OFF THE END          * UAT02050
*         OF THE REEL.  IF YOU KNOW THAT A TAPE HAS ONLY A SINGLE     * UAT02060
*         TAPE MARK AT THE END OF ITS DATA, AND YOU ALSO KNOW THE     * UAT02070
*         NUMBER OF FILES ON THE TAPE, YOU CAN USE THE MAXFILES=      * UAT02080
*         OPTION TO PREVENT UATAPE FROM PROCESSING DATA BEYOND        * UAT02090
*         THE END OF THE LAST FILE.                                   * UAT02100
*                                                                     * UAT02110
*********************************************************************** UAT02120
         SPACE 4                                                        UAT02130
*********************************************************************** UAT02140
*                                                                     * UAT02150
*     DISCLAIMER:                                                     * UAT02160
*                                                                     * UAT02170
*         NEITHER THE AUTHOR, NOR THE UNIVERSITY OF ARKANSAS, CAN     * UAT02180
*         OR WILL ASSUME ANY RESPONSIBILITY FROM OR LIABILITY FOR     * UAT02190
*         THE USE AND OPERATION OF THIS PROGRAM, NOR ARE ANY          * UAT02200
*         WARRANTIES OR GUARANTEES, EITHER EXPRESSED OR IMPLIED,      * UAT02210
*         OFFERED FOR ITS USE OR RESULTS.  IT HAS BEEN TESTED AND     * UAT02220
*         IS IN PRODUCTION USE AT THE UNIVERSITY OF ARKANSAS, SO      * UAT02230
*         IT SHOULD BE REASONABLY FREE OF ERROR.  USE AT YOUR OWN     * UAT02240
*         RISK.                                                       * UAT02250
*                                                                     * UAT02260
*********************************************************************** UAT02270
         EJECT                                                          UAT02280
*  MACROS                                                               UAT02290
         MACRO                                                          UAT02300
&LABEL   MOVEMSG &NAME                                                  UAT02310
.* THIS MACRO MOVES A MESSAGE TO THE PRINT LINE                         UAT02320
&LABEL   L     R15,=A(&NAME)                                            UAT02330
         MVC   LINE(L'&NAME),0(R15)                                     UAT02340
         MEND                                                           UAT02350
         SPACE 2                                                        UAT02360
         MACRO                                                          UAT02370
&LABEL   STACK &REG                                                     UAT02380
.* THIS MACRO PLACES THE CONTENTS OF A REGISTER ON THE PROGRAM STACK    UAT02390
&LABEL   L     R15,STACKPTR                                             UAT02400
         ST    &REG,0(,R15)                                             UAT02410
         LA    R15,4(,R15)                                              UAT02420
         ST    R15,STACKPTR                                             UAT02430
         MEND                                                           UAT02440
         SPACE 2                                                        UAT02450
         MACRO                                                          UAT02460
&LABEL   UNSTACK &REG                                                   UAT02470
.* THIS MACRO RETRIEVES CONTENTS OF LAST STACK ENTRY TO A REGISTER      UAT02480
&LABEL   L     R15,STACKPTR                                             UAT02490
         S     R15,=F'4'                                                UAT02500
         L     &REG,0(,R15)                                             UAT02510
         ST    R15,STACKPTR                                             UAT02520
         MEND                                                           UAT02530
         SPACE 2                                                        UAT02540
         MACRO                                                          UAT02550
&LABEL   DISCARD                                                        UAT02560
.* THIS MACRO DISCARDS CONTENTS OF LAST STACK ENTRY                     UAT02570
&LABEL   L     R15,STACKPTR                                             UAT02580
         S     R15,=F'4'                                                UAT02590
         ST    R15,STACKPTR                                             UAT02600
         MEND                                                           UAT02610
         EJECT                                                          UAT02620
*********************************************************************** UAT02630
*                                                                     * UAT02640
*    PROGRAM INITIALIZATION SECTION:                                  * UAT02650
*                                                                     * UAT02660
*      (1) SETUP BASE REGISTERS AND SAVE AREA POINTERS                * UAT02670
*      (2) GET THE TIME OF DAY                                        * UAT02680
*      (3) OPEN SYSPRINT AND SYSUT1 DATA CONTROL BLOCKS               * UAT02690
*      (4) GET A 32K I/O BUFFER                                       * UAT02700
*      (5) PROCESS PROGRAM OPTIONS                                    * UAT02710
*      (6) OPEN SYSUT2 DATA CONTROL BLOCK (IF COPY OPTION)            * UAT02720
*      (7) PROCESS SYSUT1 AND SYSUT2 VOLUME LABELS (IF ANY)           * UAT02730
*                                                                     * UAT02740
*********************************************************************** UAT02750
         SPACE                                                          UAT02760
UATAPE   START 0                                                        UAT02770
         USING *,R15               SET UP TEMPORARY BASE                UAT02780
         B     GO                  SKIP AROUND IDENTIFIER               UAT02790
         DC    AL1(7),CL7'UATAPE'  DUMP IDENTIFIER                      UAT02800
BASES    DC    A(UATAPE,UATAPE+4096,UATAPE+8192)   BASE ADDRESSES       UAT02810
GO       DS    0H                  ALIGN TO HALFWORD                    UAT02820
         STM   R14,R12,12(R13)     SAVE REGISTERS                       UAT02830
         LM    R10,R12,BASES       LOAD 3 BASE REGISTERS                UAT02840
         DROP  R15                 DROP TEMPORARY BASE REGISTER         UAT02850
         USING UATAPE,R10,R11,R12  DECLARE PERMANENT BASES              UAT02860
         ST    R13,SAVE+4          PERFORM                              UAT02870
         LR    R15,R13               SAVE                               UAT02880
         LA    R13,SAVE                AREA                             UAT02890
         ST    R13,8(,R15)               CHAINING                       UAT02900
         ST    R1,PARMADDR         SAVE PARM FIELD ADDR                 UAT02910
         TIME  DEC                 GET THE TIME AND DATE                UAT02920
         ST    R0,DOUBLE           SAVE THE TIME                        UAT02930
         ED    TIME(9),DOUBLE      PLACE EDITED TIME IN LINE            UAT02940
         BAL   R9,DATECONV         CONVERT DATE                         UAT02950
         BAL   R9,OPEN1            GO OPEN SYSPRINT AND SYSUT1          UAT02960
         BAL   R9,GETPARMS         GO INTERPRET PARM FIELD              UAT02970
         BAL   R9,OPEN2            GO OPEN SYSUT2                       UAT02980
         BAL   R9,LABELS           GO PROCESS SYSUT1/SYSUT2 LABELS      UAT02990
         TM    FLAG,#SL            ARE THERE LABELS?                    UAT03000
         BNO   NEWFILE             NO - SKIP                            UAT03010
         TM    OPTIONS1,#SKIPLAB+#COPY                                  UAT03020
         BNO   NEWFILE             NO - SKIP                            UAT03030
         MOVEMSG MSG54             SKIPPING ALL LABELS ON OUTPUT        UAT03040
         OI    FLAG2,#NOSHIFT      DON'T SHIFT MSG OVER                 UAT03050
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT03060
         EJECT                                                          UAT03070
*********************************************************************** UAT03080
*                                                                     * UAT03090
*   IF THE SYSUT1 TAPE CONTAINS STANDARD LABELS, THIS SECTION OF      * UAT03100
*   CODE PROCESSES THE HDR1 AND HDR2 LABELS AT THE BEGINNING OF       * UAT03110
*   EACH DATA SET ON THE TAPE.  IF THE COPY OPTION IS IN EFFECT,      * UAT03120
*   THE LABEL INFORMATION IS MODIFIED TO MATCH THE SYSUT2 TAPE'S      * UAT03130
*   CHARACTERISTICS (E.G., DENSITY, VOLUME SERIAL), AND THE LABEL     * UAT03140
*   RECORDS ARE WRITTEN TO THAT TAPE.  IF THE DUMPLAB OR DUMPALL      * UAT03150
*   OPTIONS ARE IN EFFECT, THE LABEL RECORDS ARE DUMPED.              * UAT03160
*                                                                     * UAT03170
*********************************************************************** UAT03180
         SPACE                                                          UAT03190
NEWFILE  EQU   *                                                        UAT03200
         SR    R15,R15             MAKE SOMETHING ZERO                  UAT03210
         ST    R15,MXLABERR        SET LABEL ERROR COUNT TO ZERO        UAT03220
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT03230
         LA    R15,1(,R15)         INCREMENT BY ONE                     UAT03240
         ST    R15,FILECNT         SAVE THE FILE COUNTER                UAT03250
         CVD   R15,DOUBLE          CONVERT FILE COUNTER TO DECIMAL      UAT03260
         UNPK  FILENO(4),DOUBLE(8) ALSO TO CHARACTER                    UAT03270
         OI    FILENO+3,X'F0'      INSUIRE SIGN NIBBLE                  UAT03280
         OI    FLAG2,#PRTFLAG      SET FLAG TO PRINT MSG41              UAT03290
         TM    OPTIONS3,#MXFILES   WAS MAX FILES FLAG SET?              UAT03300
         BNO   NOMAX               NO - SKIP CHECK                      UAT03310
         C     R15,MAXFILES        ARE WE PAST MAXIMUM                  UAT03320
         BNH   NOMAX               NO - CONTINUE                        UAT03330
         CVD   R15,DOUBLE          CONVERT FILE COUNT                   UAT03340
         MOVEMSG MSG55             TERMINATING THIS TAPE: XXX FILES     UAT03350
         UNPK  LINE+MSG55C(5),DOUBLE(8)   TO CHARACTER                  UAT03360
         OI    LINE+MSG55C+4,X'F0' INSURE SIGN                          UAT03370
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT03380
         OI    FLAG,#TAPEMRK       LET'S WRITE A TAPE MARK              UAT03390
         BAL   R9,WRITE2           WRITE A LAST TAPE MARK               UAT03400
         B     EPISTAT             AND TERMINATE                        UAT03410
         SPACE                                                          UAT03420
NOMAX    EQU   *                                                        UAT03430
         TM    FLAG,#SL            IS THIS A STANDARD LABEL TAPE?       UAT03440
         BNO   DSSTART             NO - SKIP TO PROCESS THE DATA        UAT03450
         MVC   DBLKCT(4),DUMPMAX+OPTVALUE   RESTORE MAXIMUM DUMP VALUE  UAT03460
         MVC   PBLKCT(4),PRINTMAX+OPTVALUE  RESTORE MAXIMUM PRINT VALUE UAT03470
         SPACE                                                          UAT03480
LABLOOP1 EQU   *                                                        UAT03490
         OI    FLAG2,#LABREC       INDICATE PROCESSING LABEL RECORD     UAT03500
         BAL   R9,READ1            GO READ A BLOCK FROM SYSUT1          UAT03510
         BAL   R9,TRANSLAB         GO TRANSLATE ASCII/EBCDIC            UAT03520
         BAL   R9,FIXLAB           GO CHANGE VOLSER TO SYSUT2 VOLSER    UAT03530
         BAL   R9,PRTLABEL         GO PRINT LABEL INFORMATION           UAT03540
         BAL   R9,TRANSBCK         GO TRANSLATE EBCDIC/ASCII            UAT03550
         BAL   R9,DUMPLAB          GO PRINT DUMP OF BLOCK               UAT03560
         TM    OPTIONS1,#SKIPLAB   DO WE SKIP WRITING THE LABEL?        UAT03570
         BO    LABSKIP1            YES                                  UAT03580
         BAL   R9,WRITE2           GO WRITE TO SYSUT2                   UAT03590
LABSKIP1 EQU   *                                                        UAT03600
         TM    FLAG,#TAPEMRK       WAS THIS A TAPE MARK?                UAT03610
         BNO   LABLOOP1            NO - CONTINUE LABEL LOOKING          UAT03620
         MOVEMSG MSG8              --- TAPE MARK --- TAPE MARK ---      UAT03630
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT03640
         TM    FLAG,#ENDTAPE       ARE WE AT THE END OF THE TAPE?       UAT03650
         BO    EOT                 YES - GO TERMINATE                   UAT03660
         TM    FLAG2,#INITHDR      DID WE FIND AN IEHINITT HDR1?        UAT03670
         BO    EPILOG              YES - GOTTA QUIT NOW                 UAT03680
         EJECT                                                          UAT03690
*********************************************************************** UAT03700
*                                                                     * UAT03710
*    THE FOLLOWING SECTION READS THE DATA PORTION OF EACH DATA SET    * UAT03720
*    ON THE SYSUT1 TAPE.  IF THE COPY OPTION IS IN EFFECT, THE DATA   * UAT03730
*    IS WRITTEN TO THE SYSUT2 TAPE. IF THE DUMP OR DUMPALL OPTIONS    * UAT03740
*    ARE IN EFFECT, EACH DATA BLOCK IS DUMPED.                        * UAT03750
*    IF THE PRINT OPTION IS IN EFFECT, THE DATA IS PRINTED.  ALSO,    * UAT03760
*    STATISTICS SUCH AS NUMBER OF BLOCKS, MAXIMUM AND MINIMUM SIZE    * UAT03770
*    OF EACH BLOCK, NUMBER OF BYTES IN THE DATA SET, AND THE ACTUAL   * UAT03780
*    DENSITY OF THE DATA ARE MAINTAINED FOR LATER USE.                * UAT03790
*                                                                     * UAT03800
*********************************************************************** UAT03810
         SPACE                                                          UAT03820
DSSTART  EQU   *                                                        UAT03830
         NI    FLAG2,255-#LABREC   CLEAR LABEL PROCESSING FLAG          UAT03840
         SR    R15,15              CLEAR BLOCK COUNTER                  UAT03850
         ST    R15,BLOCKCNT        RESET BLOCK COUNTER                  UAT03860
         ST    R15,BYTECNT         RESET BYTE COUNTER                   UAT03870
         MVC   DBLKCT(4),DUMPMAX+OPTVALUE   RESTORE MAXIMUM DUMP VALUE  UAT03880
         MVC   PBLKCT(4),PRINTMAX+OPTVALUE  RESTORE MAXIMUM PRINT VALUE UAT03890
         SPACE                                                          UAT03900
*   LOOP OVER ALL RECORDS IN THE DATA FILE                              UAT03910
DSLOOP   EQU   *                                                        UAT03920
         BAL   R9,READ1            GO READ DATA SET BLOCK               UAT03930
         BAL   R9,TRANSLTE         GO PERFORM ANY TRANSLATIONS          UAT03940
         BAL   R9,WRITE2           GO WRITE IT TO SYSUT2                UAT03950
         TM    FLAG,#TAPEMRK       DID WE HIT TAPE MARK?                UAT03960
         BO    ENDDATA             YES - END OF DATA AREA               UAT03970
         NI    FLAG,255-#LTMPRES   NO  - SHOW THAT WE HAVE DATA         UAT03980
         TM    FLAG2,#PRTFLAG      ARE WE TO PRINT MSG41?               UAT03990
         BNO   NOMSG41B            NO - SKIP PRINTING IT                UAT04000
         NI    FLAG2,255-#PRTFLAG  RESET THE FLAG                       UAT04010
         MOVEMSG MSG41             MOVE MESSAGE TO PRINT LINE           UAT04020
         MVC   LINE+MSG41F(4),FILENO   MOVE IN FILE NUMBER              UAT04030
         OI    FLAG2,#NOSHIFT      INDICATE NO SHIFTING                 UAT04040
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT04050
NOMSG41B EQU   *                                                        UAT04060
         L     R15,BYTECNT         LOAD BYTE COUNTER                    UAT04070
         A     R15,RECLENF         ADD THIS BLOCK'S LENGTH              UAT04080
         ST    R15,BYTECNT         SAVE NEW BYTE COUNTER                UAT04090
         L     R15,TBYTECNT        LOAD BYTE COUNTER                    UAT04100
         A     R15,RECLENF         ADD THIS BLOCK'S LENGTH              UAT04110
         ST    R15,TBYTECNT        SAVE NEW BYTE COUNTER                UAT04120
         L     R15,BLOCKCNT        LOAD BLOCK COUNTER                   UAT04130
         LTR   R15,R15             IS BLOCK COUNT ZERO?                 UAT04140
         BNZ   NOTFIRST            NO - NOT FIRST BLOCK                 UAT04150
         MVC   MAXBLK(4),RECLENF   SAVE NEW MAXIMUM BLOCK SIZE          UAT04160
         MVC   MINBLK(4),RECLENF   SAVE NEW MINIMUM BLOCK SIZE          UAT04170
         SPACE                                                          UAT04180
*   MAINTAIN BLOCK COUNTER AND MIN/MAX BLOCK SIZES                      UAT04190
NOTFIRST EQU   *                                                        UAT04200
         LA    R15,1(,R15)         INCREMENT THE COUNTER BY 1           UAT04210
         ST    R15,BLOCKCNT        SAVE NEW COUNT                       UAT04220
*        LH    R15,RECLEN          LOAD BLOCK'S LENGTH                  UAT04230
         L     R15,RECLENF         Load fullword value of halfword
         C     R15,MAXBLK          IS IT LARGER THAN BEFORE?            UAT04240
         BNH   CHKMIN              NO - BRANCH                          UAT04250
         ST    R15,MAXBLK          SAVE NEW MAXIMUM                     UAT04260
CHKMIN   EQU   *                                                        UAT04270
         C     R15,MINBLK          IS IT SMALLER THAN BEFORE?           UAT04280
         BNL   DOBLOCKS            NO - BRANCH                          UAT04290
         ST    R15,MINBLK          SAVE NEW MINIMUM                     UAT04300
DOBLOCKS EQU   *                                                        UAT04310
         BAL   R9,BLOCKS           GO TO BLOCKS SUBROUTINE              UAT04320
         BAL   R9,DUMPBLK          GO DUMP THE BLOCK                    UAT04330
         BAL   R9,PRINTBLK         GO PRINT THE BLOCK                   UAT04340
         L     R15,BLOCKCNT        LOAD BLOCK COUNTER                   UAT04350
         BCT   R15,DSLOOP          IF NOT 1ST BLOCK, LOOP BACK          UAT04360
         SPACE                                                          UAT04370
         BAL   R9,SENSE1           GO GET SENSE INFORMATION FOR SYSUT1  UAT04380
*   IF CARTRIDGE, INDICATE WHETHER IN IDRC FORMAT                       UAT04390
         TM    FLAG2,#CART1        IS THIS A 3480 CART?                 UAT04400
         BNO   NOTCART1            NO - SKIP                            UAT04410
         MOVEMSG MSG60             IDRC DATA COMPRESSION IS OFF         UAT04420
         NI    FLAG3,255-#IDRC1    RESET IDRC FLAG                      UAT04430
         NI    #SENSE4,X'C0'       CLEAR BITS WE DON'T WANT             UAT04440
         CLI   #SENSE4,X'80'       IS IDRC ON?                          UAT04450
         BNE   NOIDRC1             NO - SKIP                            UAT04460
         OI    FLAG3,#IDRC1        SET IDRC FLAG                        UAT04470
         MVC   LINE+MSG60A(4),=C'ON. ' SWITCH MSG TO ON                 UAT04480
NOIDRC1  EQU   *                                                        UAT04490
         BAL   R9,PRINTIT          PRINT MSG                            UAT04500
         ICM   R15,15,DEN38K+DENTABB         38K BPI                    UAT04510
         MVC   DENSITY1(4),DEN38K+DENTABC    38K BPI                    UAT04520
         MVC   INIRG(6),DEN38K+DENTABN       IRG SIZE                   UAT04530
         B     PRINT27             AND LOOP OUT                         UAT04540
NOTCART1 EQU   *                                                        UAT04550
         ICM   R15,15,DEN1600+DENTABB        1600 BPI                   UAT04560
         MVC   DENSITY1(4),DEN1600+DENTABC   1600 BPI                   UAT04570
         MVC   INIRG(6),DEN1600+DENTABN      IRG SIZE                   UAT04580
         TM    #SENSE6,#BIT3       #BIT3=0 FOR 1600 BPI                 UAT04590
         BZ    PRINT27             SKIP TO PRINT THE MSG                UAT04600
         ICM   R15,15,DEN6250+DENTABB        6250 BPI                   UAT04610
         MVC   DENSITY1(4),DEN6250+DENTABC   6250 BPI                   UAT04620
         MVC   INIRG(6),DEN6250+DENTABN      IRG SIZE                   UAT04630
         TM    #SENSE6,#BIT4       #BIT4=1 FOR 6250, #BIT4=0 FOR 800    UAT04640
         BO    PRINT27             SKIP TO PRINT THE MSG                UAT04650
         ICM   R15,15,DEN800+DENTABB         800 BPI                    UAT04660
         MVC   DENSITY1(4),DEN800+DENTABC    800 BPI                    UAT04670
         MVC   INIRG(6),DEN800+DENTABN       IRG SIZE                   UAT04680
PRINT27  EQU   *                                                        UAT04690
         ST    R15,DENSYS1         SAVE BYTES PER FOOT                  UAT04700
         B     DSLOOP              LOOP BACK FOR NEXT BLOCK             UAT04710
         EJECT                                                          UAT04720
*********************************************************************** UAT04730
*                                                                     * UAT04740
*    WHEN A TAPE MARK HAS BEEN DETECTED SIGNALING END-OF-FILE ON      * UAT04750
*    THE DATA PORTION OF THE DATA SET ON SYSUT1, THE BLOCKS OPTION    * UAT04760
*    IS WRAPPED UP FOR THIS FILE, THE FILE LENGTH IS PRINTED FOR      * UAT04770
*    SYSUT1 (AND SYSUT2 IF THE COPY OPTION IS IN EFFECT), AND THE     * UAT04780
*    ACTUAL BLOCK COUNT FOR THE FILE IS PRINTED.                      * UAT04790
*                                                                     * UAT04800
*********************************************************************** UAT04810
         SPACE                                                          UAT04820
ENDDATA  EQU   *                                                        UAT04830
         MVC   DBLKCT(4),DUMPMAX+OPTVALUE   RESTORE MAXIMUM DUMP VALUE  UAT04840
         MVC   PBLKCT(4),PRINTMAX+OPTVALUE  RESTORE MAXIMUM PRINT VALUE UAT04850
         TM    FLAG,#SL+#ENDTAPE   STD LABEL AND TWO TAPE MARKS?        UAT04860
         BO    NULLFILE            YES - NULL DATA FILE                 UAT04870
         TM    FLAG,#SL            IS THIS A STD LABEL TAPE?            UAT04880
         BO    DATASTAT            YES - SKIP NL CHECK                  UAT04890
         TM    FLAG,#ENDTAPE       ARE WE AT THE END OF NL TAPE?        UAT04900
         BNO   DATASTAT            NO  - GO PRINT FILE STATS            UAT04910
         MOVEMSG MSG8              --- TAPE MARK ---                    UAT04920
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT04930
         B     EOT                 NOW TERMINATE PROGRAM                UAT04940
         SPACE                                                          UAT04950
NULLFILE EQU   *                                                        UAT04960
         NI    FLAG,255-#ENDTAPE   RESET 2-TAPE-MARK FLAG               UAT04970
         L     R15,BSTATBUF        LOAD CURRENT STAT ENTRY ADDR         UAT04980
         MVC   STATLEN(4,R15),=C'....' SHOW NULL FILE LENGTH            UAT04990
         MOVEMSG MSG43             NULL DATA FILE                       UAT05000
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT05010
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT05020
         UNPK  LINE+MSG43F(4),DOUBLE(8)    CONVERT TO CHARACTER         UAT05030
         OI    LINE+MSG43F+3,X'F0' INSURE SIGN NIBBLE                   UAT05040
         BAL   R9,PRINTIT          GO PRINT MSG                         UAT05050
         MOVEMSG MSG8              --- TAPE MARK ---                    UAT05060
         BAL   R9,PRINTIT          GO PRINT MSG                         UAT05070
         B     LABLOOP2            GO BEGIN PROCESSING EOF LABELS       UAT05080
         SPACE                                                          UAT05090
DATASTAT EQU   *                                                        UAT05100
         TM    FLAG,#LTMPRES       LEADING TAPE MARK?                   UAT05110
         BO    NOSTATS             YES - DON'T DO STATS                 UAT05120
         BAL   R9,BLOCKS           PRINT BLOCKS ACCUMULATION            UAT05130
         MOVEMSG MSG27             SYSUT1 DENSITY AND FILE LENGTH       UAT05140
         MVC   LINE+MSG27D(4),DENSITY1  MOVE IN SYSUT1 DENSITY          UAT05150
         L     R0,BYTECNT          NUMBER OF BYTES IN DATA SET          UAT05160
         SRDA  R0,32               PREPARE FOR DIVIDE                   UAT05170
         D     R0,DENSYS1          CALCULATE NO. OF INCHES              UAT05180
         L     R14,BLOCKCNT        NUMBER OF BLOCKS IN DATA SET         UAT05190
         MH    R14,INIRG           SIMULATE MULTIPLYING                 UAT05200
         SRDA  R14,32                  BY A                             UAT05210
         D     R14,INIRG+2                FRACTION                      UAT05220
         AR    R1,R15              ADD GAP LENGTH TO DATA LENGTH        UAT05230
         SR    R0,R0               PREPARE FOR DIVIDE                   UAT05240
         D     R0,=F'12'           CONVERT INCHES TO FEET               UAT05250
         LTR   R1,R1               ZERO FEET?                           UAT05260
         BNZ   NOTLT1              NO - SKIP                            UAT05270
         LA    R1,1                SHOW AT LEAST 1 FOOT                 UAT05280
         MVI   LINE+MSG27B-2,C'<'  SHOW LESS THAN                       UAT05290
NOTLT1   EQU   *                                                        UAT05300
         C     R1,=F'2'            LESS THAN TWO FEET?                  UAT05310
         BNL   NOTLT2              NO - SKIP                            UAT05320
         MVC   LINE+MSG27B+6(2),=C'OO'   MAKE FEET INTO FOOT            UAT05330
NOTLT2   EQU   *                                                        UAT05340
         CVD   R1,DOUBLE           MAKE IT DECIMAL                      UAT05350
         A     R1,TOTFEET          ADD TO CURRENT LENGTH CNTR           UAT05360
         ST    R1,TOTFEET          SAVE NEW VALUE                       UAT05370
         UNPK  LINE+MSG27B(4),DOUBLE(8)  MAKE IT CHARACTER              UAT05380
         OI    LINE+MSG27B+3,X'F0' INSURE SIGN NIBBLE                   UAT05390
         L     R15,BSTATBUF        LOAD CURRENT STAT BUF ADDR           UAT05400
         MVC   STATLEN(4,R15),LINE+MSG27B   SAVE LENGTH FOR STATS       UAT05410
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT05420
         TM    OPTIONS1,#COPY      IS COPY OPTION IN EFFECT?            UAT05430
         BNO   NO2LEN              NO - SKIP                            UAT05440
         MOVEMSG MSG40             SYSUT2 LENGTH                        UAT05450
         L     R0,BYTECNT          NUMBER OF BYTES IN DATA SET          UAT05460
         SRDA  R0,32               PREPARE FOR DIVIDE                   UAT05470
         D     R0,DENSYS2          CALCULATE LENGTH IN INCHES           UAT05480
         L     R14,BLOCKCNT        NUMBER OF BLOCKS IN DATA SET         UAT05490
         MH    R14,OUTIRG          SIMULATE MULTIPLYING                 UAT05500
         SRDA  R14,32                  BY A                             UAT05510
         D     R14,OUTIRG+2               FRACTION                      UAT05520
         AR    R1,R15              ADD GAP LENGTH TO DATA LENGTH        UAT05530
         SR    R0,R0               PREPARE FOR DIVIDE                   UAT05540
         D     R0,=F'12'           CONVERT LENGTH TO FEET               UAT05550
         LTR   R1,R1               ZERO FEET?                           UAT05560
         BNZ   NOTLT1B             NO - SKIP                            UAT05570
         LA    R1,1                SHOW AT LEAST 1 FOOT                 UAT05580
         MVI   LINE+MSG40B-2,C'<'  SHOW LESS THAN                       UAT05590
NOTLT1B  EQU   *                                                        UAT05600
         C     R1,=F'2'            LESS THAN TWO FEET?                  UAT05610
         BNL   NOTLT2B             NO - SKIP                            UAT05620
         MVC   LINE+MSG40B+6(2),=C'OO'   MAKE FEET INTO FOOT            UAT05630
NOTLT2B  EQU   *                                                        UAT05640
         CVD   R1,DOUBLE           MAKE IT DECIMAL                      UAT05650
         A     R1,TOTFEET2         ADD TO TOTAL SYSUT2 LENGTH           UAT05660
         ST    R1,TOTFEET2         SAVE NEW LENGTH                      UAT05670
         UNPK  LINE+MSG40B(4),DOUBLE(8)  MAKE IT CHARACTER              UAT05680
         OI    LINE+MSG40B+3,X'F0' INSURE SIGN NIBBLE                   UAT05690
         MVC   LINE+MSG40D(4),DENSITY2  MOVE IN SYSUT2 DENSITY          UAT05700
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT05710
NO2LEN   EQU   *                                                        UAT05720
         MOVEMSG MSG18             FILE XXXX CONTAINS YYYYY BLOCKS      UAT05730
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT05740
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT05750
         UNPK  LINE+MSG18F(4),DOUBLE(8)    CONVERT TO PRINTABLE         UAT05760
         OI    LINE+MSG18F+3,X'F0' MAKE LAST DIGIT PRINTABLE            UAT05770
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT05780
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT05790
         UNPK  LINE+MSG18F(4),DOUBLE(8)    CONVERT TO PRINTABLE         UAT05800
         OI    LINE+MSG18F+3,X'F0' MAKE LAST DIGIT PRINTABLE            UAT05810
         L     R15,BLOCKCNT        LOAD BLOCK COUNTER                   UAT05820
         CVD   R15,DOUBLE          CONVERT IT TO DECIMAL                UAT05830
         UNPK  LINE+MSG18D(6),DOUBLE(8)   CONVERT TO PRINTABLE          UAT05840
         OI    LINE+MSG18D+5,X'F0' MAKE LAST DIGIT PRINTABLE            UAT05850
         BCT   R15,NOTEQ1          BRANCH IF MORE THAN ONE BLOCK        UAT05860
         MVC   LINE+MSG18D+12(2),=C'. '   MAKE "BLOCKS" INTO "BLOCK"    UAT05870
NOTEQ1   EQU   *                                                        UAT05880
         L     R15,MAXBLK          LOAD MAXIMUM BLKSIZE                 UAT05890
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT05900
         UNPK  LINE+MSG18X(5),DOUBLE(8)    CONVERT TO PRINTABLE         UAT05910
         OI    LINE+MSG18X+4,X'F0' MAKE LAST DIGIT PRINTABLE            UAT05920
         L     R15,MINBLK          LOAD MINIMUM BLKSIZE                 UAT05930
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT05940
         UNPK  LINE+MSG18N(5),DOUBLE(8)    CONVERT TO PRINTABLE         UAT05950
         OI    LINE+MSG18N+4,X'F0' MAKE LAST DIGIT PRINTABLE            UAT05960
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT05970
         MOVEMSG MSG62             FILE XXXX CONTAINS XXXX BYTES        UAT05980
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT05990
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT06000
         UNPK  LINE+MSG62F(4),DOUBLE(8)    CONVERT TO PRINTABLE         UAT06010
         OI    LINE+MSG62F+3,X'F0' MAKE LAST DIGIT PRINTABLE            UAT06020
         L     R15,BYTECNT         GET TOTAL NUMBER OF BYTES            UAT06030
         CVD   R15,DOUBLE          CONVERT TO                           UAT06040
         MVC   LINE+MSG62D(15),=X'4020206B2020206B2020206B202120'       UAT06050
         EDMK  LINE+MSG62D(15),DOUBLE+2    PRINTABLE DECIMAL            UAT06060
         MVC   LINE+MSG62D(40),0(R1)    SHIFT OVER FOR APPEARANCE       UAT06070
*        UNPK  LINE+MSG62D(10),DOUBLE(8)   PRINTABLE DECIMAL            UAT06080
*        OI    LINE+MSG62D+9,X'F0'  MAKE LAST DIGIT PRINTABLE           UAT06090
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT06100
         MOVEMSG MSG8              --- TAPE MARK --- TAPE MARK ---      UAT06110
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT06120
NOSTATS  EQU   *                                                        UAT06130
         TM    FLAG,#SL            IS THIS STANDARD LABEL TAPE?         UAT06140
         BNO   NEWFILE             NO - DO NOT PROCESS LABELS           UAT06150
         EJECT                                                          UAT06160
*********************************************************************** UAT06170
*                                                                     * UAT06180
*    THIS SECTION OF CODE PROCESSES ANY END-OF-FILE LABELS ON THE     * UAT06190
*    SYSUT1 TAPE (IF IT CONTAINS STANDARD LABELS).  THE INFORMATION   * UAT06200
*    IN EACH EOF1 AND EOF2 (AND POSSIBLY EOV1 AND EOV2) LABEL IS      * UAT06210
*    PRINTED (SOME INFORMATION IS OMITTED SINCE IT DUPLICATES THAT    * UAT06220
*    FOUND IN THE HDR1 AND HDR2 LABEL RECORDS).  IF THE COPY OPTION   * UAT06230
*    IS IN EFFECT, THE LABEL RECORDS ARE WRITTEN TO THE SYSUT2        * UAT06240
*    TAPE.  IF THE DUMPLAB OR DUMPALL OPTIONS ARE IN EFFECT, THE      * UAT06250
*    LABEL RECORDS ARE DUMPED.                                        * UAT06260
*                                                                     * UAT06270
*********************************************************************** UAT06280
         SPACE                                                          UAT06290
LABLOOP2 EQU   *                                                        UAT06300
         OI    FLAG2,#LABREC       INDICATE PROCESSING LABEL RECORD     UAT06310
         BAL   R9,READ1            GO READ LABEL BLOCK                  UAT06320
         BAL   R9,TRANSLAB         GO PERFORM ANY TRANSLATIONS          UAT06330
         BAL   R9,FIXLAB           GO CHANGE VOLSER TO SYSUT2 VOLSER    UAT06340
         BAL   R9,PRTLABEL         GO PRINT LABEL INFORMATION           UAT06350
         BAL   R9,TRANSBCK         GO TRANSLATE ASCII LABEL BACK        UAT06360
         BAL   R9,DUMPLAB          GO DUMP LABEL INFORMATION            UAT06370
         TM    OPTIONS1,#SKIPLAB   DO WE SKIP WRITING LABEL?            UAT06380
         BO    LABSKIP2            YES                                  UAT06390
         BAL   R9,WRITE2           GO WRITE IT TO SYSUT2                UAT06400
LABSKIP2 EQU   *                                                        UAT06410
         TM    FLAG,#TAPEMRK       DID WE HIT TAPE MARK?                UAT06420
         BNO   LABLOOP2            NO - CONTINUE WITH NEXT BLOCK        UAT06430
         MOVEMSG MSG8              --- TAPE MARK -----------------      UAT06440
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT06450
         L     R15,BSTATBUF        LOAD STAT BUF ENTRY ADDR             UAT06460
         LA    R15,WSTATBUF(,R15)  POINT TO NEXT ENTRY                  UAT06470
         ST    R15,BSTATBUF        SAVE NEW ENTRY ADDR                  UAT06480
         TM    FLAG2,#EOV          WAS END-OF-VOLUME LABEL FOUND?       UAT06490
         BNO   NEWFILE             NO - CONTINUE TO NEXT FILE           UAT06500
EOT      EQU   *                                                        UAT06510
         MOVEMSG MSG1              END OF TAPE MESSAGE                  UAT06520
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT06530
         OI    FLAG,#TAPEMRK       GO WRITE A TAPE MARK                 UAT06540
         BAL   R9,WRITE2             FOR INSURANCE SAKE                 UAT06550
         SPACE                                                          UAT06560
EPISTAT  EQU   *                                                        UAT06570
         BAL   R9,EOTSTATS         GO PRINT END OF TAPE STATS           UAT06580
         MOVEMSG MSG68             UATAPE - NORMAL END OF EXECUTION'    UAT06590
         OI    FLAG2,#NOSHIFT      INDICATE NO SHIFTING                 UAT06600
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT06610
         EJECT                                                          UAT06620
*********************************************************************** UAT06630
*                                                                     * UAT06640
*   EPILOG --- PROGRAM TERMINATION SECTION                              UAT06650
*                                                                     * UAT06660
*********************************************************************** UAT06670
         SPACE                                                          UAT06680
EPILOG   EQU   *                                                        UAT06690
         CLOSE (SYSPRINT,,SYSUT1,REWIND,SYSUT2,REWIND)                  UAT06700
         L     R1,BUFADDR          LOAD BUFFER POINTER                  UAT06710
         LTR   R1,R1               DID WE EVER GET ONE?                 UAT06720
         BZ    NOFREE1             NO - SKIP FREEMAIN                   UAT06730
         FREEMAIN R,LV=66000,A=(1) FREE UP THE BUFFER                   UAT06740
NOFREE1  EQU   *                                                        UAT06750
         L     R1,ASTATBUF         LOAD BUFFER POINTER                  UAT06760
         LTR   R1,R1               DID WE EVER GET ONE?                 UAT06770
         BZ    NOFREE2             NO - SKIP FREEMAIN                   UAT06780
         FREEMAIN R,LV=LSTATBUF,A=(1) FREE UP THE BUFFER                UAT06790
NOFREE2  EQU   *                                                        UAT06800
         L     13,4(,13)           RESTORE SAVE REGISTER                UAT06810
         L     R14,12(,R13)        RESTORE RETURN ADDR                  UAT06820
         SR    R15,R15             CLEAR REGISTER 15                    UAT06830
         IC    R15,RETCODE         LOAD RETURN CODE                     UAT06840
         LM    R0,R12,20(R13)      RESTORE REMAINING REGS               UAT06850
         BR    R14                 RETURN TO SYSTEM                     UAT06860
         EJECT                                                          UAT06870
*********************************************************************** UAT06880
*                                                                     * UAT06890
*     DATECONV                                                        * UAT06900
*                                                                     * UAT06910
*           THIS ROUTINE CONVERTS THE PACKED 00YYDDDC JULIAN          * UAT06920
*           DATE FROM THE TIME MACRO TO CHARACTER YY/MM/DD.           * UAT06930
*                                                                     * UAT06940
*********************************************************************** UAT06950
         SPACE                                                          UAT06960
DATECONV EQU   *                                                        UAT06970
         STACK R9                  SAVE RETURN ADDRESS ON STACK         UAT06980
         ST    R1,DOUBLE+4         STICK PACKED DATE INTO WORK AREA     UAT06990
         XC    DOUBLE(6),DOUBLE    ZERO OUT YEAR TO LEAVE PACKED DAYS   UAT07000
         CVB   R0,DOUBLE           CONVERT DAY COUNT TO BINARY          UAT07010
         SRL   R1,12               LET'S GET THE DATE NOW               UAT07020
         ST    R1,DOUBLE+4         STICK PACKED YEAR INTO WORK AREA     UAT07030
         OI    DOUBLE+7,X'0F'      MAKE SURE SIGN IS OK                 UAT07040
         UNPK  @YEAR(2),DOUBLE(8)  CONVERT YEAR TO CHARACTER            UAT07050
         OI    @YEAR+1,X'F0'       INSURE SIGN                          UAT07060
         CVB   R1,DOUBLE           CONVERT YEAR TO BINARY               UAT07070
         ST    R1,DOUBLE           STORE YEAR FOR LEAP TEST             UAT07080
         LA    R15,28              28 DAYS IN FEB NON-LEAP              UAT07090
         TM    DOUBLE+3,X'03'      IS THIS A LEAP YEAR?                 UAT07100
         BNZ   NOTLEAP             NO - SKIP CORRECTING CODE            UAT07110
         LA    R15,29              29 DAYS IN FEB LEAP                  UAT07120
NOTLEAP  EQU   *                                                        UAT07130
         STH   R15,@FEB            SAVE NO. DAYS IN FEB                 UAT07140
         LA    R14,@JAN            POINT TO DAY COUNT LIST              UAT07150
DAYLOOP  EQU   *                                                        UAT07160
         SH    R0,0(,R14)          SUBTRACT DAY COUNT FOR MONTH         UAT07170
         BNP   DAYEND              IF <1 THEN WE FOUND MONTH            UAT07180
         LA    R14,2(,R14)         POINT TO NEXT DAY COUNT              UAT07190
         B     DAYLOOP             AND LOOP BACK                        UAT07200
DAYEND   EQU   *                                                        UAT07210
         AH    R0,0(,R14)          ADD DAY COUNT BACK                   UAT07220
         CVD   R0,DOUBLE           CONVERT DAY TO DECIMAL               UAT07230
         UNPK  @DAY(2),DOUBLE(8)   CONVERT DAY TO CHARACTER             UAT07240
         OI    @DAY+1,X'F0'        INSURE SIGN                          UAT07250
         LA    R15,@JAN-2          CALCULATE MONTH                      UAT07260
         SR    R14,R15               ...                                UAT07270
         SRL   R14,1                 ...                                UAT07280
         CVD   R14,DOUBLE          CONVERT MONTH TO DECIMAL             UAT07290
         UNPK  @MONTH(2),DOUBLE(8) CONVERT MONTH TO CHARACTER           UAT07300
         OI    @MONTH+1,X'F0'      INSURE SIGN                          UAT07310
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT07320
         BR    R9                  RETURN TO CALLER                     UAT07330
         EJECT                                                          UAT07340
*********************************************************************** UAT07350
*                                                                     * UAT07360
*     GETPARMS                                                        * UAT07370
*                                                                     * UAT07380
*           THIS ROUTINE PROCESSES THE PARM FIELD FOR ANY             * UAT07390
*           OPTIONS THAT THE USER MAY HAVE SPECIFIED.                 * UAT07400
*                                                                     * UAT07410
*********************************************************************** UAT07420
         SPACE                                                          UAT07430
GETPARMS EQU   *                                                        UAT07440
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT07450
         L     R3,PARMADDR         LOAD ORIGINAL PARM ADDRESS           UAT07460
         L     R3,0(,R3)           POINT TO PARM FIELD                  UAT07470
         LH    R6,0(,R3)           LOAD PARM FIELD LENGTH               UAT07480
         LTR   R6,R6               IS THE LENGTH ZERO?                  UAT07490
         BZ    PRTPARMS            YES - NO PARM FIELD                  UAT07500
         LA    R3,2(,R3)           POINT TO PARM FIELD TEXT             UAT07510
FINDCOMA EQU   *                                                        UAT07520
         LR    R15,R3              SAVE POINTER                         UAT07530
LOOPCOMA EQU   *                                                        UAT07540
         CLI   0(R15),C','         IS THIS CHARACTER A COMMA?           UAT07550
         BE    ENDCOMMA            YES - OUT OF LOOP                    UAT07560
         CLI   0(R15),C'='         IS THIS CHARACTER AN EQUALS?         UAT07570
         BE    ENDEQUAL            YES - OUT OF LOOP                    UAT07580
         LA    R15,1(,R15)         POINT TO NEXT CHARACTER              UAT07590
         BCT   R6,LOOPCOMA         LOOP BACK                            UAT07600
         LA    R6,1                MAKE LENGTH 1 FOR NEXT BCT           UAT07610
ENDCOMMA EQU   *                                                        UAT07620
         LR    R14,R15             COPY ADDR OF COMMA                   UAT07630
         SR    R14,R3              CALCULATE LENGTH OF PARAMETER        UAT07640
         BZ    PARMINV             IF ZERO, IT'S INVALID                UAT07650
         C     R14,=F'8'           IS LENGTH GREATER THAN 8?            UAT07660
         BH    PARMINV             YES - SHOW IT'S INVALID              UAT07670
         BCTR  R14,0               GET EXECUTABLE LENGTH                UAT07680
         MVC   PARM(8),=8C' '      FILL WORK AREA W/BLANKS              UAT07690
         EX    R14,MOVEIT          MOVE PARAMETER TO WORK AREA          UAT07700
         LA    R4,OPTLIST          POINT TO OPTION LIST                 UAT07710
         LA    R5,NUMOPTS          NUMBER OF VALID OPTIONS              UAT07720
OPTLOOP1 EQU   *                                                        UAT07730
         CLC   OPTNAME(8,R4),PARM  IS THIS THE SOUGHT FOR PARM?         UAT07740
         BE    HAVEOPT             YES - GO PROCESS IT                  UAT07750
         LA    R4,LENOPT(,R4)      POINT TO NEXT OPTION IN LIST         UAT07760
         BCT   R5,OPTLOOP1         LOOP BACK FOR THIS ONE               UAT07770
         B     PARMINV             PARAMETER IS INVALID                 UAT07780
HAVEOPT  EQU   *                                                        UAT07790
         CLI   OPTTYPE(R4),OPTKEYWD   IS THIS A KEYWORD OPTION?         UAT07800
         BNE   PARMINV             NO - PARAMETER IS INVALID            UAT07810
         B     THISOPT             YES- GO PROCESS IT                   UAT07820
         SPACE                                                          UAT07830
ENDEQUAL EQU   *                                                        UAT07840
         LR    R14,R15             COPY ADDR OF COMMA                   UAT07850
         SR    R14,R3              CALCULATE LENGTH OF PARAMETER        UAT07860
         BZ    PARMINV             IF ZERO, IT'S INVALID                UAT07870
         C     R14,=F'8'           IS LENGTH GREATER THAN 8?            UAT07880
         BH    PARMINV             YES - SHOW IT'S INVALID              UAT07890
         BCTR  R14,0               GET EXECUTABLE LENGTH                UAT07900
         MVC   PARM(8),=8C' '      FILL WORK AREA W/BLANKS              UAT07910
         EX    R14,MOVEIT          MOVE PARAMETER TO WORK AREA          UAT07920
         LA    R4,OPTLIST          POINT TO OPTION LIST                 UAT07930
         LA    R5,NUMOPTS          NUMBER OF VALID OPTIONS              UAT07940
OPTLOOP3 EQU   *                                                        UAT07950
         CLC   OPTNAME(8,R4),PARM  IS THIS THE SOUGHT FOR PARM?         UAT07960
         BE    THISOPTE            YES - GO PROCESS IT                  UAT07970
         LA    R4,LENOPT(,R4)      POINT TO NEXT OPTION IN LIST         UAT07980
         BCT   R5,OPTLOOP3         LOOP BACK FOR THIS ONE               UAT07990
         B     PARMINV             PARAMETER IS INVALID                 UAT08000
         SPACE                                                          UAT08010
THISOPTE EQU   *                                                        UAT08020
         SR    R14,R14             ZERO OUT ACCUMULATOR                 UAT08030
         B     NXTOPTE             GET INTO THE LOOP                    UAT08040
OPTLOOP4 EQU   *                                                        UAT08050
         CLI   0(R15),C','         A COMMA?                             UAT08060
         BE    STOREIT             YES - END OF FIELD                   UAT08070
         CLI   0(R15),C'0'         NUMERIC VALUE?                       UAT08080
         BL    PARMINV             NO - WE HAVE ERROR                   UAT08090
         CLI   0(R15),C'9'         NUMERIC VALUE?                       UAT08100
         BH    PARMINV             NO - WE HAVE ERROR                   UAT08110
         IC    R0,0(,R15)          GET THE CHARACTER                    UAT08120
         N     R0,=F'15'           ZAP OUT BAD BITS                     UAT08130
         MH    R14,=H'10'          SHIFT ACCUMULATOR                    UAT08140
         AR    R14,R0              ADD NEW DIGIT TO ACCUMULATOR         UAT08150
NXTOPTE  EQU   *                                                        UAT08160
         LA    R15,1(,R15)         POINT TO NUMERIC VALUE               UAT08170
         BCT   R6,OPTLOOP4         BRANCH IF NOT LAST PARM VALUE        UAT08180
         LA    R6,1                RESTORE COUNT BACK TO 1              UAT08190
STOREIT  EQU   *                                                        UAT08200
         ST    R14,OPTVALUE(,R4)   SAVE ACCUMULATOR VALUE               UAT08210
         CLI   OPTTYPE(R4),OPTVAR  IS THIS A VARIABLE-TYPE OPTION?      UAT08220
         BNE   PARMINV             NO - BRANCH TO ERROR ROUTINE         UAT08230
         SPACE                                                          UAT08240
THISOPT  EQU   *                                                        UAT08250
         L     R14,OPTADDR(,R4)    OPTION FLAG BYTE ADDRESS             UAT08260
         OC    0(1,R14),OPTON(R4)  SET FLAG                             UAT08270
         NC    0(1,R14),OPTOFF(R4) RESET FLAG                           UAT08280
NEXTOPT  EQU   *                                                        UAT08290
         LA    R3,1(,R15)          POINT TO NEXT PARAMETER              UAT08300
         BCT   R6,FINDCOMA         LOOP BACK AND DO IT                  UAT08310
PRTPARMS EQU   *                                                        UAT08320
         MOVEMSG MSG9              OPTIONS IN EFFECT:                   UAT08330
         LA    R3,LINE+MSG9O       POINT TO NEXT PLACE IN LINE          UAT08340
         LA    R4,OPTLIST          POINT TO OPTIONS LIST                UAT08350
         LA    R5,NUMOPTS          NUMBER OF POSSIBLE OPTIONS           UAT08360
OPTLOOP2 EQU   *                                                        UAT08370
         L     R15,OPTADDR(,R4)          LOAD OPTION BYTE ADDRESS       UAT08380
         MVC   TEMPFLAG(1),0(R15)  MOVE OPTIONS BYTE TO WORK AREA       UAT08390
         NC    TEMPFLAG(1),OPTON(R4)  AND OUT ALL BUT FLAG BIT          UAT08400
         BZ    NEXTOPT2            IF RESULT IS ZERO, NO OPTION         UAT08410
         MVC   0(8,R3),OPTNAME(R4) MOVE IN OPTION                       UAT08420
COMLOOPB EQU   *                                                        UAT08430
         CLI   0(R3),C' '          BLANK HERE?                          UAT08440
         BE    COMLOOPE            YES - GET OUT OF HERE                UAT08450
         LA    R3,1(,R3)           POINT TO NEXT CHARACTER              UAT08460
         B     COMLOOPB            LOOP BACK CHECK IT TOO               UAT08470
COMLOOPE EQU   *                                                        UAT08480
         CLI   OPTTYPE(R4),OPTKEYWD   IS THIS A KEYWORD OPTION?         UAT08490
         BNE   COMLOOPF            NO - MUST BE A VARIABLE OPTION       UAT08500
         MVI   0(R3),C','          PUT A COMMA THERE                    UAT08510
         LA    R3,1(,R3)           POINT TO NEXT CHARACTER              UAT08520
NEXTOPT2 EQU   *                                                        UAT08530
         LA    R4,LENOPT(,R4)      POINT TO NEXT OPTION IN LIST         UAT08540
         BCT   R5,OPTLOOP2         LOOP BACK FOR IT                     UAT08550
         BCTR  R3,0                BACK UP TO LAST COMMA                UAT08560
         MVI   0(R3),C' '          BLANK OUT LAST COMMA                 UAT08570
         OI    FLAG2,#NOSHIFT      DO NO SHIFT THIS OVER                UAT08580
         BAL   R9,PRINTIT          GO PRINT THE LINE                    UAT08590
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT08600
         BR    R9                  RETURN TO CALLER                     UAT08610
COMLOOPF EQU   *                                                        UAT08620
         MVI   0(R3),C'='          PUT EQUALS SIGN THERE                UAT08630
         L     R0,OPTVALUE(,R4)    LOAD VALUE OF OPTION                 UAT08640
         CVD   R0,DOUBLE           CONVERT TO PACKED DECIMAL            UAT08650
         MVC   1(9,R3),=X'40202020202021206B'  EDIT MASK, PLUS A COMMA  UAT08660
         LA    R1,8(,R3)           POINT TO LAST POSSIBLE DIGIT         UAT08670
         EDMK  1(8,R3),DOUBLE+4    CONVERT TO CHARACTER                 UAT08680
         MVC   1(10,R3),0(R1)      SHIFT OUT LEADING BLANKS             UAT08690
         LA    R0,11(,R3)          POINT PAST COMMA                     UAT08700
         SR    R0,R1               LENGTH OF NUMERIC VALUE              UAT08710
         AR    R3,R0               MOVE POINTER PAST COMMA              UAT08720
         B     NEXTOPT2            CONTINUE WITH NEXT OPTION            UAT08730
         SPACE                                                          UAT08740
MOVEIT   MVC   PARM(*-*),0(R3)     ***** EXECUTED INSTRUCTION *****     UAT08750
         EJECT                                                          UAT08760
*********************************************************************** UAT08770
*                                                                     * UAT08780
*    PRTLABEL                                                         * UAT08790
*                                                                     * UAT08800
*         THIS ROUTINE PRINTS A FORMATTED VERSION OF EACH             * UAT08810
*         TYPE OF VOLUME AND DATA SET LABEL (VOL1, HDR1,              * UAT08820
*         HDR2, EOF1, EOF2, EOV1, EOV2).  USER LABELS ARE             * UAT08830
*         IGNORED HERE.                                               * UAT08840
*                                                                     * UAT08850
*********************************************************************** UAT08860
         SPACE                                                          UAT08870
PRTLABEL EQU   *                                                        UAT08880
         TM    FLAG,#TAPEMRK       WAS THIS BLOCK A TAPE MARK?          UAT08890
         BOR   R9                  YES - RETURN TO CALLER               UAT08900
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT08910
         TM    FLAG2,#PRTFLAG      ARE WE TO PRINT MSG41?               UAT08920
         BNO   NOMSG41A            NO - SKIP PRINTING IT                UAT08930
         NI    FLAG2,255-#PRTFLAG  RESET THE FLAG                       UAT08940
         MOVEMSG MSG41             === FILE: XXXX ===================== UAT08950
         MVC   LINE+MSG41F(4),FILENO   MOVE IN FILE NUMBER              UAT08960
         OI    FLAG2,#NOSHIFT      INDICATE NO SHIFTING                 UAT08970
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT08980
NOMSG41A EQU   *                                                        UAT08990
         MVI   LINE,C'0'           DOUBLE SPACE                         UAT09000
         CLC   0(3,R7),=C'VOL'     IS THIS A VOLUME LABEL?              UAT09010
         BE    VOL                 YES - BRANCH                         UAT09020
         CLC   0(3,R7),=C'HDR'     IS THIS A DATA-SET LABEL?            UAT09030
         BE    HDR                 YES - BRANCH                         UAT09040
         CLC   0(3,R7),=C'EOF'     IS THIS END-OF-FILE LABEL?           UAT09050
         BE    EOF                 YES - BRANCH                         UAT09060
         CLC   0(3,R7),=C'EOV'     IS THIS END-OF-VOLUME LABEL?         UAT09070
         BE    EOV                 YES - BRANCH                         UAT09080
         CLC   0(3,R7),=C'UHL'     IS THIS USER-HEADER LABEL?           UAT09090
         BE    UHL                 YES - BRANCH                         UAT09100
         CLC   0(3,R7),=C'UTL'     IS THIS USER-TRAILER LABEL?          UAT09110
         BE    UTL                 YES - BRANCH                         UAT09120
         SPACE                                                          UAT09130
LABUNKN  EQU   *                                                        UAT09140
         L     R15,MXLABERR        LOAD MAXIMUM LABEL ERROR COUNT       UAT09150
         LA    R15,1(,R15)         INCREMENT COUNTER                    UAT09160
         ST    R15,MXLABERR        SAVE NEW ERROR COUNT                 UAT09170
         C     R15,MXLABCNT        COMPARE AGAINST MAXIMUM              UAT09180
         BE    MXEXCEED            BRANCH IF EQUAL TO MAXIMUM           UAT09190
         BH    PRTLABXT            RETURN TO CALLER IF EXCEEDED         UAT09200
         MOVEMSG MSG44             UNKNOWN LABEL RECORD                 UAT09210
         BAL   R9,PRINTIT          GO PRINT UNKNOWN LABEL MSG           UAT09220
         MVC   LINE+1(7),=C'----->|'  LEFT FRAMER                       UAT09230
         MVC   LINE+8(80),0(R7)    LABEL DATA                           UAT09240
         MVC   LINE+88(7),=C'|<-----' RIGHT FRAMER                      UAT09250
         BAL   R9,PRINTIT          GO PRINT UNKNOWN LABEL DATA          UAT09260
         B     PRTLABXT            RETURN TO CALLER                     UAT09270
         SPACE                                                          UAT09280
MXEXCEED EQU   *                                                        UAT09290
         MOVEMSG MSG48             MAXIMUM COUNT EXCEEDED               UAT09300
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT09310
         B     PRTLABXT            RETURN TO CALLER                     UAT09320
         SPACE 2                                                        UAT09330
*   VOL            VOLUME LABEL                                         UAT09340
VOL      EQU   *                                                        UAT09350
         USING VOL1D,R7            VOLUME LABEL ADDRESSING              UAT09360
         MOVEMSG MSG4              INPUT VOLUME SERIAL =                UAT09370
         MVC   LINE+MSG4V(6),VOLSER1    MOVE IN INPUT VOLSER            UAT09380
         MVC   LINE+MSG4O(10),VOL1OWNR  MOVE IN VOLUME'S OWNER          UAT09390
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT09400
         TM    OPTIONS1,#COPY      IS COPY OPTION IN EFFECT?            UAT09410
         BNO   PRTLABXT            NO - RETURN TO CALLER                UAT09420
         MOVEMSG MSG5              OUTPUT VOLUME SERIAL =               UAT09430
         MVC   LINE+MSG5V(6),VOLSER2    MOVE IN OUTPUT VOLSER           UAT09440
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT09450
         B     PRTLABXT            RETURN TO CALLER                     UAT09460
         DROP  R7                  DON'T NEED THIS NOW                  UAT09470
         SPACE 2                                                        UAT09480
HDR      EQU   *                                                        UAT09490
         CLI   3(R7),C'1'          DATA SET LABEL 1?                    UAT09500
         BE    HDR1                YES - BRANCH                         UAT09510
         CLI   3(R7),C'2'          DATA SET LABEL 2?                    UAT09520
         BE    HDR2                YES - BRANCH                         UAT09530
         B     LABUNKN             UNKNOWN LABEL                        UAT09540
         SPACE                                                          UAT09550
*   HDR1          DATA SET HEADER LABEL 1                               UAT09560
         SPACE                                                          UAT09570
HDR1     EQU   *                                                        UAT09580
         USING HDR1D,R7            DECLARE HDR1 ADDRESSABILITY          UAT09590
         LA    R0,HDR1DSN          CHECK FOR FRESHLY                    UAT09600
         LA    R1,76                 IEHINITT'ED TAPE                   UAT09610
         SR    R15,R15                 WHICH LOOKS LIKE:                UAT09620
         ICM   R15,8,=C'0'               HDR100000 ... 000              UAT09630
         CLCL  R0,R14                      ('HDR1' PLUS 76 ZEROES)      UAT09640
         BE    HDR1I               BRANCH IF WE FOUND IEHINITT HDR1     UAT09650
*                                                                       UAT09660
         MOVEMSG MSG11             DATA SET NAME = ....                 UAT09670
         L     R6,BSTATBUF         LOAD CURRENT STAT ENTRY ADDR         UAT09680
         MVC   LINE+MSG11D(17),HDR1DSN    MOVE IN DATA SET NAME         UAT09690
         MVC   STATDSN(17,R6),HDR1DSN     DSN TO STAT BUF               UAT09700
         MVC   LINE+MSG11V(6),HDR1SER     MOVE IN VOLUME SERIAL NUMBER  UAT09710
         BAL   R9,PRINTIT                 GO PRINT THE MESSAGE          UAT09720
         MOVEMSG MSG12                    FILE = XX VOLUME SEQ = YY     UAT09730
         MVC   LINE+MSG12F(4),HDR1DSEQ    FILE SEQUENCE NUMBER          UAT09740
         MVC   STATFILE(4,R6),HDR1DSEQ    FILE SEQ NO TO STAT BUF       UAT09750
         MVC   LINE+MSG12S(4),HDR1VSEQ    VOLUME SEQUENCE NUMBER        UAT09760
         BAL   R9,PRINTIT                 GO PRINT THE MESSAGE          UAT09770
         MOVEMSG MSG12#                   GENERATION=XXXX  VERSION=YY   UAT09780
         MVC   LINE+MSG12G(4),HDR1GEN     GENERATION NUMBER             UAT09790
         MVC   LINE+MSG12V(2),HDR1VER     VERSION NUMBER                UAT09800
         BAL   R9,PRINTIT                 GO PRINT THE MESSAGE          UAT09810
         MOVEMSG MSG13                    CREATION DATE, EXPIRATION     UAT09820
         MVC   LINE+MSG13C(2),HDR1CRDT+1       YEAR                     UAT09830
         MVC   LINE+MSG13C+3(3),HDR1CRDT+3     DAY                      UAT09840
         MVC   LINE+MSG13E(2),HDR1EXDT+1       YEAR                     UAT09850
         MVC   LINE+MSG13E+3(3),HDR1EXDT+3     DAY                      UAT09860
         BAL   R9,PRINTIT                 GO PRINT THE MESSAGE          UAT09870
         MOVEMSG MSG13#                   SYSTEM CODE=SSSS              UAT09880
         MVC   LINE+MSG13S(13),HDR1SYS    SYSTEM CODE                   UAT09890
         BAL   R9,PRINTIT                 GO PRINT THE MESSAGE          UAT09900
         B     PRTLABXT                   RETURN TO CALLER              UAT09910
         DROP R7                                                        UAT09920
         SPACE                                                          UAT09930
*   PROCESS FRESHLY IEHINITT'ED TAPE                                    UAT09940
HDR1I    EQU   *                                                        UAT09950
         OI    FLAG2,#INITHDR      SET FLAG SHOWING IEHINITT HDR1       UAT09960
         MOVEMSG MSG56             THIS IS IEHINITT'D TAPE              UAT09970
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT09980
         B     PRTLABXT            RETURN TO CALLER                     UAT09990
         SPACE 2                                                        UAT10000
*   HDR2          DATA SET HEADER LABEL 2                               UAT10010
         SPACE                                                          UAT10020
HDR2     EQU   *                                                        UAT10030
         USING HDR2D,R7                   HDR2 RECORD ADDRESSABILITY    UAT10040
         L     R6,BSTATBUF                LOAD CURRENT STAT ENTRY ADDR  UAT10050
         MOVEMSG MSG15                    LRECL=XXXX BLKSIZE=YYY        UAT10060
         MVC   LINE+MSG15L(5),HDR2LREC    LRECL                         UAT10070
         MVC   STATLREC(5,R6),HDR2LREC    LRECL                         UAT10080
         PACK  DOUBLE(8),HDR2LREC         PACK LRECL                    UAT10090
         CVB   0,DOUBLE                   CONVERT TO BINARY             UAT10100
         ST    0,CURLRECL                 SAVE CURRENT LRECL            UAT10110
         MVC   LINE+MSG15B(5),HDR2BLKL    BLKSIZE                       UAT10120
         MVC   STATBLKS(5,R6),HDR2BLKL    BLKSIZE                       UAT10130
         PACK  DOUBLE(8),HDR2BLKL         PACK BLKSIZE                  UAT10140
         CVB   0,DOUBLE                   CONVERT TO BINARY             UAT10150
         ST    0,CURBLKSI                 SAVE CURRENT BLKSIZE          UAT10160
         BAL   R9,PRINTIT                 GO PRINT THE MESSAGE          UAT10170
         MOVEMSG MSG15#                   RECFM=XX  DENSITY=U           UAT10180
         MVC   LINE+MSG15R(1),HDR2RECF    RECFM                         UAT10190
         MVC   CURRECFM(1),HDR2RECF       SAVE CURRENT RECORD FORMAT    UAT10200
         LA    R15,LINE+MSG15R+1          POINT TO FOLLOWING SPACE      UAT10210
         CLI   HDR2BLKF,C' '              IS BLOCKING ATTRIBUTE SET?    UAT10220
         BE    HDR2BB                     NO - SKIP                     UAT10230
         CLI   HDR2BLKF,C'R'              IS THE BLK ATTRIBUTE 'R'      UAT10240
         BE    HDR2AA                     YES - SPANNED AND BLOCKED     UAT10250
         MVC   0(1,R15),HDR2BLKF          BLOCKING ATTRIBUTE (B OR S)   UAT10260
         LA    R15,1(,R15)                INCREMENT POINTER 1 PLACE     UAT10270
         B     HDR2BB                     SKIP A FEW                    UAT10280
HDR2AA   EQU   *                                                        UAT10290
         MVC   0(2,R15),=C'BS'            BLOCKING ATTRIBUTE B AND S    UAT10300
         LA    R15,2(,R15)                INCREMENT POINTER 2 PLACES    UAT10310
HDR2BB   EQU   *                                                        UAT10320
         MVC   0(1,R15),HDR2CONC   CONTROL CHARACTER (' ' OR M OR A)    UAT10330
         MVC   STATRECF(4,R6),LINE+MSG15R RECORD FORMAT                 UAT10340
         SPACE                                                          UAT10350
         MVC   LINE+MSG15D1(1),HDR2DEN    TAPE DENSITY                  UAT10360
         TM    FLAG2,#CART1               IS THIS 3480?                 UAT10370
         BO    HDR2CART                   YES - DO IT DIFFERENTLY       UAT10380
         CLI   HDR2DEN,C'0'               DEN=0?                        UAT10390
         BNE   HDR2CC                     NO - CHECK NEXT               UAT10400
         MVC   LINE+MSG15D2(4),DEN200+DENTABC   200 BPI                 UAT10410
         B     HDR2HH                     SKIP                          UAT10420
HDR2CC   EQU   *                                                        UAT10430
         CLI   HDR2DEN,C'1'               DEN=1?                        UAT10440
         BNE   HDR2DD                     NO - CHECK NEXT               UAT10450
         MVC   LINE+MSG15D2(4),DEN556+DENTABC   556 BPI                 UAT10460
         B     HDR2HH                     SKIP                          UAT10470
HDR2DD   EQU   *                                                        UAT10480
         CLI   HDR2DEN,C'2'               DEN=2?                        UAT10490
         BNE   HDR2EE                     NO - CHECK NEXT               UAT10500
         MVC   LINE+MSG15D2(4),DEN800+DENTABC   800 BPI                 UAT10510
         B     HDR2HH                     SKIP                          UAT10520
HDR2EE   EQU   *                                                        UAT10530
         CLI   HDR2DEN,C'3'               DEN=3?                        UAT10540
         BNE   HDR2FF                     NO - CHECK NEXT               UAT10550
         MVC   LINE+MSG15D2(4),DEN1600+DENTABC  1600 BPI                UAT10560
         B     HDR2HH                     SKIP                          UAT10570
HDR2FF   EQU   *                                                        UAT10580
         CLI   HDR2DEN,C'4'               DEN=4?                        UAT10590
         BNE   HDR2GG                     NO - WHO KNOWS WHAT IT IS     UAT10600
         MVC   LINE+MSG15D2(4),DEN6250+DENTABC  6250 BPI                UAT10610
         B     HDR2HH                     SKIP                          UAT10620
HDR2GG   EQU   *                                                        UAT10630
         MVC   LINE+MSG15D2(9),=C'UNKNOWN) '  SHOW IT'S UNKNOWN         UAT10640
         B     HDR2HH                     SKIP                          UAT10650
HDR2CART EQU   *                          3480 CARTRIDGES ONLY HERE     UAT10660
         MVC   LINE+MSG15D2(4),DEN38K+DENTABC  38000 BPI                UAT10670
HDR2HH   EQU   *                                                        UAT10680
         BAL   R9,PRINTIT                 GO PRINT THE MESSAGE          UAT10690
         MOVEMSG MSG16                    CREATING JOB/JOBSTEP          UAT10700
         MVC   LINE+MSG16J(17),HDR2JOBI   JOBNAME/JOBSTEP               UAT10710
         MVC   LINE+MSG16R(2),HDR2TTRC    RECORDING TECHNIQUE (TTRCH    UAT10720
         BAL   R9,PRINTIT                 GO PRINT THE MESSAGE          UAT10730
*  PRINT WARNING ABOUT UNRELIABLE LENGTH VALUE IF IDRC IS ENABLED       UAT10740
         TM    FLAG2,#CART1        ARE WE READING A CART?               UAT10750
         BNO   HDR2II              NO - SKIP                            UAT10760
         TM    FLAG3,#IDRC1        IS IDRC ENABLED?                     UAT10770
         BNO   HDR2II              NO - SKIP                            UAT10780
         MOVEMSG MSG59             WARNING ABOUT IDRC AND LENGTH        UAT10790
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT10800
HDR2II   EQU   *                                                        UAT10810
         PACK  DOUBLE(8),HDR2LREC(5)      PACK THE LRECL                UAT10820
         CVB   R15,DOUBLE                 MAKE IT BINARY NOW            UAT10830
         ST    R15,BLRECL                 SAVE LRECL FOR PRINT OPTION   UAT10840
         B     PRTLABXT                   RETURN TO CALLER              UAT10850
         DROP  R7                         DON'T NEED THIS NOW           UAT10860
         SPACE 2                                                        UAT10870
EOF      EQU   *                                                        UAT10880
         CLI   3(R7),C'1'          END OF FILE LABEL 1?                 UAT10890
         BE    EOF1                YES - BRANCH                         UAT10900
         CLI   3(R7),C'2'          END OF FILE LABEL 2?                 UAT10910
         BE    EOF2                YES - BRANCH                         UAT10920
         B     LABUNKN             UNKNOWN LABEL                        UAT10930
         SPACE                                                          UAT10940
*   EOF1           END OF FILE (TRAILER) LABEL 1                        UAT10950
         SPACE                                                          UAT10960
EOF1     EQU   *                                                        UAT10970
         USING EOF1D,R7            EOF1 ADDRESSABILITY                  UAT10980
         L     R6,BSTATBUF         LOAD CURRENT STAT ENTRY ADDR         UAT10990
         MOVEMSG MSG19                  NUMBER OF BLOCKS =              UAT11000
         MVC   LINE+MSG19N(6),EOF1BLKC  DATA SET BLOCK COUNT            UAT11010
         MVC   STATNBLK(6,R6),EOF1BLKC  DATA SET BLOCK COUNT            UAT11020
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT11030
         PACK  DOUBLE(8),EOF1BLKC(6)    CONVERT COUNT TO PACKED         UAT11040
         CVB   R0,DOUBLE                AND THEN TO BINARY              UAT11050
         C     R0,BLOCKCNT         DOES IT MATCH ACTUAL?                UAT11060
         BE    EOF1RET             YES - SKIP MESSAGE                   UAT11070
         MOVEMSG MSG57             WARNING: BLOCK COUNT DOES NOT MATCH  UAT11080
         OI    FLAG2,#NOSHIFT      INDICATE NO SHIFTING                 UAT11090
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT11100
EOF1RET  EQU   *                                                        UAT11110
         B     PRTLABXT            RETURN TO CALLER                     UAT11120
         DROP  R7                  DON'T NEED THIS NOW                  UAT11130
         SPACE 2                                                        UAT11140
*   EOF2          END OF FILE TRAILER LABEL 2                           UAT11150
         SPACE                                                          UAT11160
EOF2     EQU   *                                                        UAT11170
         USING EOF2D,R7            MAKE EOF2 LABEL ADDRESSABLE          UAT11180
         MVC   LINE+1(4),EOF2EOF2  MOVE "EOF2" TO PRINT LINE            UAT11190
         MVI   LINE+5,C':'         PUT A : THERE TOO                    UAT11200
         BAL   R9,PRINTIT          GO PRINT EOF2                        UAT11210
         B     PRTLABXT            RETURN TO CALLER                     UAT11220
         DROP  R7                  DON'T NEED THIS NOW                  UAT11230
         SPACE 2                                                        UAT11240
EOV      EQU   *                                                        UAT11250
         CLI   3(R7),C'1'          END OF VOLUME LABEL 1?               UAT11260
         BE    EOV1                YES - BRANCH                         UAT11270
         CLI   3(R7),C'2'          END OF VOLUME LABEL 2?               UAT11280
         BE    EOV2                YES - BRANCH                         UAT11290
         B     LABUNKN             UNKNOWN LABEL                        UAT11300
         SPACE                                                          UAT11310
*   EOV1               END OF VOLUME LABEL 1                            UAT11320
         SPACE                                                          UAT11330
EOV1     EQU   *                                                        UAT11340
         USING EOV1D,R7            MAKE EOV1 RECORD ADDRESSABLE         UAT11350
         OI    FLAG2,#EOV          SHOW EOV LABEL FOUND                 UAT11360
         MOVEMSG MSG19                  NUMBER OF BLOCKS =              UAT11370
         MVC   LINE+1(4),EOV1EOV1  MOVE "EOV1" TO PRINT LINE            UAT11380
         L     R6,BSTATBUF         LOAD CURRENT STAT ENTRY ADDR         UAT11390
         MVC   LINE+MSG19N(6),EOV1BLKC  DATA SET BLOCK COUNT            UAT11400
         MVC   STATNBLK(6,R6),EOV1BLKC   DATA SET BLOCK COUNT           UAT11410
         BAL   R9,PRINTIT          GO PRINT EOV1                        UAT11420
         B     PRTLABXT            RETURN TO CALLER                     UAT11430
         DROP  R7                  DON'T NEED THIS NOW                  UAT11440
         SPACE 2                                                        UAT11450
*   EOV2                END OF VOLUME LABEL 2                           UAT11460
         SPACE                                                          UAT11470
EOV2     EQU   *                                                        UAT11480
         USING EOV2D,R7            MAKE EOV2 RECORD ADDRESSABLE         UAT11490
         OI    FLAG2,#EOV          SHOW EOV LABEL FOUND                 UAT11500
         MVC   LINE+1(4),EOV2EOV2  MOVE "EOV2" TO PRINT LINE            UAT11510
         MVI   LINE+5,C':'         PUT A : THERE TOO                    UAT11520
         BAL   R9,PRINTIT          GO PRINT EOV2                        UAT11530
         B     PRTLABXT            RETURN TO CALLER                     UAT11540
         DROP  R7                  DON'T NEED THIS NOW                  UAT11550
         SPACE 2                                                        UAT11560
*   UHL/UTL             USER HEADER/TRAILER LABELS                      UAT11570
         SPACE                                                          UAT11580
UHL      EQU   *                                                        UAT11590
UTL      EQU   *                                                        UAT11600
         MVC   LINE+1(4),0(R7)     MOVE "UHLN"/"UTLN" TO PRINT LINE     UAT11610
         MVI   LINE+5,C':'         PUT A : THERE TOO                    UAT11620
         MVC   LINE+8(80),0(R7)    MOVE CONTENTS OF LABEL               UAT11630
         BAL   R9,PRINTIT          AND PRINT IT                         UAT11640
         SPACE 2                                                        UAT11650
PRTLABXT EQU   *                                                        UAT11660
         UNSTACK R9                RETRIEVE THE RETURN ADDRESS          UAT11670
         BR    R9                  RETURN TO CALLER                     UAT11680
         EJECT                                                          UAT11690
*********************************************************************** UAT11700
*                                                                     * UAT11710
*    FIXLAB                                                           * UAT11720
*                                                                     * UAT11730
*           THIS ROUTINE CHANGES THE VOLUME SERIAL IN VARIOUS         * UAT11740
*           TAPE LABELS TO MATCH THE SYSUT2 TAPE'S VOLSER.            * UAT11750
*                                                                     * UAT11760
*********************************************************************** UAT11770
         SPACE                                                          UAT11780
FIXLAB   EQU   *                                                        UAT11790
         TM    OPTIONS1,#COPY      WAS COPY OPTION SPECIFIED?           UAT11800
         BNOR  R9                  NO - RETURN TO CALLER                UAT11810
         TM    OPTIONS2,#NOFIX     WAS NOFIX OPTION SPECIFIED?          UAT11820
         BOR   R9                  YES - RETURN TO CALLER               UAT11830
         TM    FLAG,#TAPEMRK       WAS THIS BLOCK A TAPE MARK?          UAT11840
         BOR   R9                  YES - RETURN TO CALLER               UAT11850
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT11860
         USING VOL1D,R7            VOLUME LABEL ADDRESSING              UAT11870
         CLC   VOL1VOL1(4),=C'VOL1'    IS THIS A VOLUME LABEL?          UAT11880
         BE    FIXVOL1             YES - BRANCH                         UAT11890
         DROP  R7                                                       UAT11900
         USING HDR1D,R7            DATA SET LABEL ADDRESSING            UAT11910
         CLC   HDR1HDR1(4),=C'HDR1'    IS THIS DATA SET LABEL?          UAT11920
         BE    FIXHDR1             YES - BRANCH                         UAT11930
         DROP  R7                                                       UAT11940
         USING EOF1D,R7            END OF FILE LABEL ADDRESSING         UAT11950
         CLC   EOF1EOF1(4),=C'EOF1'    IS THIS EOF LABEL?               UAT11960
         BE    FIXEOF1             YES - BRANCH                         UAT11970
         DROP  R7                                                       UAT11980
         USING EOV1D,R7            END OF VOLUME LABEL ADDRESSING       UAT11990
         CLC   EOV1EOV1(4),=C'EOV1'    IS THIS EOV LABEL?               UAT12000
         BE    FIXEOV1             YES - BRANCH                         UAT12010
         DROP  R7                                                       UAT12020
         USING EOV2D,R7            END OF VOLUME LABEL ADDRESSING       UAT12030
         CLC   EOV2EOV2(4),=C'EOV2'    IS THIS EOV LABEL?               UAT12040
         BE    FIXEOV2             YES - BRANCH                         UAT12050
         DROP  R7                                                       UAT12060
         USING EOF2D,R7            END OF FILE LABEL ADDRESSING         UAT12070
         CLC   EOF2EOF2(4),=C'EOF2'    IS THIS EOF LABEL?               UAT12080
         BE    FIXEOF2             YES - BRANCH                         UAT12090
         DROP  R7                                                       UAT12100
         USING HDR2D,R7            DATA SET LABEL ADDRESSING            UAT12110
         CLC   HDR2HDR2(4),=C'HDR2'    IS THIS DATA SET LABEL?          UAT12120
         BE    FIXHDR2             YES - BRANCH                         UAT12130
         DROP  R7                                                       UAT12140
         B     FIXLABXT            NONE OF THESE - RETURN TO CALLER     UAT12150
         SPACE 2                                                        UAT12160
*   FIX VOLUME LABEL                                                    UAT12170
         SPACE                                                          UAT12180
FIXVOL1  EQU   *                                                        UAT12190
         USING VOL1D,R7            VOLUME LABEL ADDRESSING              UAT12200
         MVC   VOL1SER(6),VOLSER2  RENAME                               UAT12210
         B     FIXLABXT            RETURN TO CALLER                     UAT12220
         DROP  R7                                                       UAT12230
         SPACE 2                                                        UAT12240
*   FIX DATA SET LABEL 1                                                UAT12250
         SPACE                                                          UAT12260
FIXHDR1  EQU   *                                                        UAT12270
         TM    FLAG2,#INITHDR      IS THIS AN IEHINITT HDR1?            UAT12280
         BO    FIXLABXT            YES - DON'T DO FIXUP                 UAT12290
         USING HDR1D,R7            DATA SET LABEL ADDRESSING            UAT12300
         MVC   HDR1SER(6),VOLSER2  RENAME                               UAT12310
         B     FIXLABXT            RETURN TO CALLER                     UAT12320
         DROP  R7                                                       UAT12330
         SPACE 2                                                        UAT12340
*   FIX END OF FILE LABEL 1                                             UAT12350
         SPACE                                                          UAT12360
FIXEOF1  EQU   *                                                        UAT12370
         USING EOF1D,R7            END OF FILE LABEL ADDRESSING         UAT12380
         MVC   EOF1SER(6),VOLSER2  RENAME                               UAT12390
         B     FIXLABXT            RETURN TO CALLER                     UAT12400
         DROP  R7                                                       UAT12410
         SPACE 2                                                        UAT12420
*   FIX END OF VOLUME LABEL 1                                           UAT12430
         SPACE                                                          UAT12440
FIXEOV1  EQU   *                                                        UAT12450
         USING EOV1D,R7            END OF VOLUME LAB ADDRESSING         UAT12460
         MVC   EOV1SER(6),VOLSER2  RENAME                               UAT12470
         B     FIXLABXT            RETURN TO CALLER                     UAT12480
         DROP  R7                                                       UAT12490
         SPACE 2                                                        UAT12500
*  FIX DATA SET LABEL 2                                                 UAT12510
         SPACE                                                          UAT12520
FIXHDR2  EQU   *                                                        UAT12530
         USING HDR2D,R7            DATA SET LABEL ADDRESSING            UAT12540
         MVC   HDR2DEN(1),TAPEDEN  MOVE IN OUTPUT DENSITY               UAT12550
         B     FIXLABXT            RETURN TO CALLER                     UAT12560
         DROP  R7                                                       UAT12570
         SPACE 2                                                        UAT12580
*   FIX END OF FILE LABEL 2                                             UAT12590
         SPACE                                                          UAT12600
FIXEOF2  EQU   *                                                        UAT12610
         USING EOF2D,R7            DATA SET LABEL ADDRESSING            UAT12620
         MVC   EOF2DEN(1),TAPEDEN  MOVE IN OUTPUT DENSITY               UAT12630
         B     FIXLABXT            RETURN TO CALLER                     UAT12640
         DROP  R7                                                       UAT12650
         SPACE 2                                                        UAT12660
*   FIX END OF VOLUME LABEL 2                                           UAT12670
         SPACE                                                          UAT12680
FIXEOV2  EQU   *                                                        UAT12690
         USING EOV2D,R7            DATA SET LABEL ADDRESSING            UAT12700
         MVC   EOV2DEN(1),TAPEDEN  MOVE IN OUTPUT DENSITY               UAT12710
         SPACE 2                                                        UAT12720
FIXLABXT EQU   *                                                        UAT12730
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT12740
         BR    R9                  RETURN TO CALLER                     UAT12750
         DROP  R7                                                       UAT12760
         EJECT                                                          UAT12770
*********************************************************************** UAT12780
*                                                                     * UAT12790
*    DUMPBLK                                                          * UAT12800
*                                                                     * UAT12810
*          THIS ROUTINE PRINTS A DATA BLOCK IN HEXADECIMAL FORMAT     * UAT12820
*                                                                     * UAT12830
*********************************************************************** UAT12840
         SPACE                                                          UAT12850
DUMPBLK  EQU   *                                                        UAT12860
         TM    FLAG,#TAPEMRK       TAPE MARK HERE?                      UAT12870
         BOR   R9                  YES - RETURN TO CALLER               UAT12880
         TM    OPTIONS1,#DUMP+#DUMPALL  DUMP OPTIONS SET?               UAT12890
         BZR   R9                  BRANCH IF NO DUMP OPTIONS            UAT12900
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT12910
         TM    OPTIONS2,#DMAX      WAS DUMPMAX OPTION SPECIFIED?        UAT12920
         BNO   NODMAX1             NO - SKIP CHECK                      UAT12930
         L     R15,DBLKCT          LOAD BLOCK COUNTER                   UAT12940
         SH    R15,=H'1'           DECREMENT THE COUNTER                UAT12950
         ST    R15,DBLKCT          SAVE NEW COUNTER VALUE               UAT12960
         BNM   NODMAX1             CONTINUE WITH DUMP IF NOT NEGATIVE   UAT12970
         AH    R15,=H'1'           IS IT -1?                            UAT12980
         BNZ   DUMPITXT            NO - RETURN TO CALLER                UAT12990
         MOVEMSG MSG50             DUMP SUSPENDED MSG                   UAT13000
         OI    FLAG2,#NOSHIFT      INDICATE NO SHIFT                    UAT13010
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT13020
         B     DUMPITXT            RETURN TO CALLER                     UAT13030
NODMAX1  EQU   *                                                        UAT13040
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT13050
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT13060
         MOVEMSG MSG24             FILE XX BLOCK YY LENGTH ZZ           UAT13070
         UNPK  LINE+MSG24F(4),DOUBLE(8)   FILE COUNTER                  UAT13080
         OI    LINE+MSG24F+3,X'F0' INSURE LAST DIGIT PRINTABLE          UAT13090
         L     R15,BLOCKCNT        LOAD BLOCK COUNTER                   UAT13100
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT13110
         UNPK  LINE+MSG24B(6),DOUBLE(8)   BLOCK COUNTER                 UAT13120
         OI    LINE+MSG24B+5,X'F0' INSURE LAST DIGIT PRINTABLE          UAT13130
         L     R15,RECLENF         LOAD RECORD LENGTH                   UAT13140
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT13150
         UNPK  LINE+MSG24L(5),DOUBLE(8)   BLOCK LENGTH                  UAT13160
         OI    LINE+MSG24L+4,X'F0' INSURE LAST DIGIT PRINTABLE          UAT13170
         BAL   R9,PRINTIT          GO PRINT THE LINE                    UAT13180
         B     DUMPIT              GO DUMP THE BLOCK                    UAT13190
         EJECT                                                          UAT13200
*********************************************************************** UAT13210
*                                                                     * UAT13220
*    DUMPLAB                                                          * UAT13230
*                                                                     * UAT13240
*          THIS ROUTINE PRINTS A TAPE LABEL IN HEXADECIMAL FORMAT     * UAT13250
*                                                                     * UAT13260
*********************************************************************** UAT13270
         SPACE                                                          UAT13280
DUMPLAB  EQU   *                                                        UAT13290
         TM    FLAG,#TAPEMRK       TAPE MARK HERE?                      UAT13300
         BOR   R9                  YES - RETURN TO CALLER               UAT13310
         TM    OPTIONS1,#DUMPLAB+#DUMPALL EITHER DUMPLAB OR DUMPALL OPT UAT13320
         BZR   R9                  NO - RETURN TO CALLER                UAT13330
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT13340
         TM    OPTIONS2,#DMAX      WAS DUMPMAX OPTION SPECIFIED?        UAT13350
         BNO   DUMPIT              NO - SKIP CHECK                      UAT13360
         L     R15,DBLKCT          LOAD BLOCK COUNTER                   UAT13370
         SH    R15,=H'1'           DECREMENT THE COUNTER                UAT13380
         ST    R15,DBLKCT          SAVE NEW COUNTER VALUE               UAT13390
         BM    DUMPITXT            IT'S NOT POSITIVE, RETURN            UAT13400
         EJECT                                                          UAT13410
*     GENERALIZED DUMP ROUTINE                                          UAT13420
*     (NOTE:  RETURN ADDRESS MUST BE ON STACK UPON ENTRY TO DUMPIT)     UAT13430
         SPACE                                                          UAT13440
DUMPIT   EQU   *                                                        UAT13450
         L     R2,RECLENF          LOAD BLOCK'S LENGTH                  UAT13460
         SR    R3,R3               THIS IS BLOCK OFFSET                 UAT13470
         LA    R4,9                BXLE INCREMENT                       UAT13480
         LA    R5,LINE+79          END OF BXLE RUN                      UAT13490
         LR    R6,R7               COPY DATA ADDRESS                    UAT13500
         MVI   LINE,C'0'           MAKE NEXT LINE DOUBLE SPACE          UAT13510
         SPACE                                                          UAT13520
NEWLINE  EQU   *                                                        UAT13530
         L     R8,VTABLES          GET TRANSLATE TABLES CSECT ADDR      UAT13540
         USING TABLES,R8           MAKE THEM ADDRESSABLE                UAT13550
         STH   R3,DOUBLE           STORE OFFSET IN WORKAREA             UAT13560
         UNPK  WORKAREA(5),DOUBLE(3)   CONVERT LENGTH TO                UAT13570
         TR    WORKAREA(4),HEXTABLE       PRINTABLE HEX FORMAT          UAT13580
         MVC   LINE+1(4),WORKAREA  MOVE TO PRINT LINE                   UAT13590
         MVI   LINE+5,C'('         STARTING PARENS                      UAT13600
         MVI   LINE+11,C')'        ENDING PARENS                        UAT13610
         CVD   R3,DOUBLE           CONVERT OFFSET TO DECIMAL            UAT13620
         UNPK  LINE+6(5),DOUBLE(8)     CONVERT LENGTH TO                UAT13630
         OI    LINE+10,X'F0'              PRINTABLE DECIMAL             UAT13640
         LA    R15,32              MAX NO. BYTES PER LINE               UAT13650
         CR    R15,R2              ARE THERE MORE THAN 32 LEFT?         UAT13660
         BNH   FULL1               NO - SKIP                            UAT13670
         LR    R15,R2              YES- USE ONLY 32                     UAT13680
FULL1    EQU   *                                                        UAT13690
         BCTR  R15,0               GET EXECUTABLE LENGTH                UAT13700
         MVC   LINE+89(34),=34C'*' ASTERISKS AT END                     UAT13710
         EX    R15,MOVEIT3         MOVE STRING TO LINE                  UAT13720
         TR    LINE+90(32),PRTTABLE  MAKE UNPRINTABLES PRINTABLE        UAT13730
         LA    R14,LINE+14         POINT TO START OF THE LINE           UAT13740
         LA    R15,4               NO. OF 4-BYTE SECTIONS 'TILL BREAK   UAT13750
LINE1    EQU   *                                                        UAT13760
         UNPK  WORKAREA(9),0(5,R6) DO NEXT FOUR BYTES                   UAT13770
         TR    WORKAREA(9),HEXTABLE  MAKE IT PRINTABLE                  UAT13780
         LA    R1,4                FOUR BYTES PER SECTION               UAT13790
         CR    R1,R2               IS THERE FOUR BYTES LEFT?            UAT13800
         BNH   FULL2               YES - SKIP                           UAT13810
         LR    R1,R2               NO  - USE WHAT'S LEFT                UAT13820
FULL2    EQU   *                                                        UAT13830
         SLL   R1,1                MULTIPLY BY TWO                      UAT13840
         BCTR  R1,0                GET EXECUTABLE LENGTH                UAT13850
         EX    R1,MOVEIT4          MOVE SECTION TO PRINT LINE           UAT13860
         BCT   R15,LINE2           DECREMENT SECTION COUNTER            UAT13870
         LA    R14,2(,R14)         BUMP LINE POINTER                    UAT13880
LINE2    EQU   *                                                        UAT13890
         S     R2,=F'4'            DECREMENT LENGTH BY FOUR             UAT13900
         BNP   OUT                 IF THAT'S ALL, QUIT                  UAT13910
         LA    R3,4(,R3)           INCREMENT OFFSET COUNT               UAT13920
         LA    R6,4(,R6)           NEXT WORD                            UAT13930
         BXLE  R14,R4,LINE1        LOOP BACK                            UAT13940
         OI    FLAG2,#NOSHIFT      SET NO SHIFT OPTION                  UAT13950
         BAL   R9,PRINTIT          GO PRINT THIS LINE                   UAT13960
         B     NEWLINE             BEGIN WITH NEW LINE                  UAT13970
OUT      EQU   *                                                        UAT13980
         OI    FLAG2,#NOSHIFT      SET NO SHIFT OPTION                  UAT13990
         BAL   R9,PRINTIT          GO PRINT REMAINING LINE              UAT14000
         SPACE                                                          UAT14010
DUMPITXT EQU   *                                                        UAT14020
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT14030
         BR    R9                  RETURN TO CALLER                     UAT14040
         DROP  R8                  DON'T NEED THIS ANY MORE             UAT14050
         SPACE 2                                                        UAT14060
MOVEIT3  MVC   LINE+90(*-*),0(R6)    *** EXECUTED INSTRUCTION ***       UAT14070
MOVEIT4  MVC   0(*-*,R14),WORKAREA   *** EXECUTED INSTRUCTION ***       UAT14080
         EJECT                                                          UAT14090
*********************************************************************** UAT14100
*                                                                     * UAT14110
*      PRINTBLK                                                       * UAT14120
*                                                                     * UAT14130
*           THIS ROUTINE PRINTS A DATA BLOCK FROM THE TAPE.  AN       * UAT14140
*           ATTEMPT IS MADE TO PRINT LOGICAL RECORDS FOUND IN THE     * UAT14150
*           DATA BLOCK.  IF THE TAPE HAS STANDARD LABELS, THEN THE    * UAT14160
*           LRECL FIELD OF THE HDR2 LABEL IS USED TO DETERMINE THE    * UAT14170
*           RECORD LENGTH.  IF THE LRECL IS LESS THAN 133, THEN       * UAT14180
*           EACH RECORD IS PRINTED ON A SEPARATE LINE.  IF THE        * UAT14190
*           LRECL IS 133 OR GREATER, THEN A DEFAULT OF 80 IS USED.    * UAT14200
*                                                                     * UAT14210
*           NOTE:  CURRENTLY, HDR2 LABEL LRECLS ARE USED FOR          * UAT14220
*                  RECFM=F FILES ONLY.  FOR RECFM=V OR U FILES,       * UAT14230
*                  LRECL=80 IS USED.                                  * UAT14240
*                                                                     * UAT14250
*********************************************************************** UAT14260
         SPACE                                                          UAT14270
PRINTBLK EQU   *                                                        UAT14280
         TM    OPTIONS2,#PRINT     WAS PRINT OPTION SPECIFIED?          UAT14290
         BZR   R9                  NO - RETURN TO CALLER                UAT14300
         TM    FLAG,#TAPEMRK       TAPE MARK HERE?                      UAT14310
         BOR   R9                  YES - RETURN TO CALLER               UAT14320
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT14330
         TM    OPTIONS2,#PMAX      WAS PRINTMAX OPTION SPECIFIED?       UAT14340
         BNO   NOPMAX1             NO - SKIP CHECK                      UAT14350
         L     R15,PBLKCT          LOAD BLOCK COUNTER                   UAT14360
         SH    R15,=H'1'           DECREMENT THE COUNTER                UAT14370
         ST    R15,PBLKCT          SAVE NEW COUNTER VALUE               UAT14380
         BNM   NOPMAX1             CONTINUE WITH PRINT IF NOT NEGATIVE  UAT14390
         AH    R15,=H'1'           IS COUNT -1?                         UAT14400
         BNZ   PRINTBXT            NO - RETURN TO CALLER                UAT14410
         MOVEMSG MSG53             PRINT SUSPENDED MSG                  UAT14420
         OI    FLAG2,#NOSHIFT      INDICATE NO SHIFT                    UAT14430
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT14440
         B     PRINTBXT            RETURN TO CALLER                     UAT14450
NOPMAX1  EQU   *                                                        UAT14460
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT14470
         CVD   R15,DOUBLE          CONVERT TO PACKED DECIMAL            UAT14480
         MOVEMSG MSG24             FILE XX BLOCK YY LENGTH ZZ           UAT14490
         UNPK  LINE+MSG24F(4),DOUBLE(8)   FILE NUMBER TO CHARACTER      UAT14500
         OI    LINE+MSG24F+3,X'F0' INSURE SIGN NIBBLE                   UAT14510
         L     R15,BLOCKCNT        LOAD BLOCK COUNTER                   UAT14520
         CVD   R15,DOUBLE          CONVERT TO PACKED DECIMAL            UAT14530
         UNPK  LINE+MSG24B(6),DOUBLE(8)   BLOCK NUMBER TO CHARACTER     UAT14540
         OI    LINE+MSG24B+5,X'F0' INSURE SIGN NIBBLE                   UAT14550
         L     R15,RECLENF         LOAD BLOCK LENGTH                    UAT14560
         CVD   R15,DOUBLE          CONVERT TO PACKED DECIMAL            UAT14570
         UNPK  LINE+MSG24L(5),DOUBLE(8)   BLOCK LENGTH TO CHARACTER     UAT14580
         OI    LINE+MSG24L+4,X'F0' INSURE SIGN NIBBLE                   UAT14590
         OI    FLAG2,#NOSHIFT      DON'T SHIFT LINE                     UAT14600
         BAL   R9,PRINTIT          GO PRINT THE LINE                    UAT14610
         L     R2,RECLENF          LOAD THIS BLOCK'S LENGTH             UAT14620
         SRDA  R2,32               PREPARE FOR DIVIDE                   UAT14630
         LA    R5,80               DEFAULT LINE LENGTH OF 80            UAT14640
         TM    FLAG,#SL            STD LABEL TAPE?                      UAT14650
         BNO   PRTDFLT             NO - USE DEFAULT                     UAT14660
         CLI   CURRECFM,C'F'       FIXED-LENGTH FILE?                   UAT14670
         BNE   PRTDFLT             NO - DON'T SUPPORT OTHERS YET        UAT14680
         L     R5,CURLRECL         GET CURRENT FILE'S LRECL             UAT14690
         CH    R5,SYSPRINT+(DCBLRECL-IHADCB)  LESS THAN SYSPRINT LRECL? UAT14700
         BL    PRTDFLT             YES - USE FILE'S LRECL               UAT14710
         LA    R5,80               NO - MUST USE DEFAULT OF 80          UAT14720
         SPACE                                                          UAT14730
PRTDFLT  EQU   *                                                        UAT14740
         DR    R2,R5               DIVIDE BY LINE LENGTH                UAT14750
         LR    R4,R7               DATA BLOCK ADDRESS IN R4             UAT14760
         LTR   R3,R3               DO WE HAVE A FULL LINE?              UAT14770
         BZ    LASTLINE            NO - SKIP TO DO LAST LINE            UAT14780
         SPACE                                                          UAT14790
FULLLINE EQU   *                                                        UAT14800
         LR    R15,R5              GET LINE LENGTH                      UAT14810
         BCTR  R15,0               CALC EXECUTE LENGTH                  UAT14820
         EX    R15,MOVEIT5         MOVE IN DATA                         UAT14830
         OI    FLAG2,#NOSHIFT      DON'T SHIFT LINE                     UAT14840
         BAL   R9,PRINTIT          GO PRINT THE LINE                    UAT14850
         AR    R4,R5               POINT TO NEXT LINE OF DATA           UAT14860
         BCT   R3,FULLLINE         GO BACK TO DO NEXT LINE              UAT14870
         LTR   R2,R2               IS THERE ANY DATA LEFT               UAT14880
         BNP   PRINTBXT            NO - RETURN TO CALLER                UAT14890
         SPACE                                                          UAT14900
LASTLINE EQU   *                                                        UAT14910
         BCTR  R2,0                GET EXECUTABLE LENGTH                UAT14920
         EX    R2,MOVEIT5          MOVE REMAINING DATA TO LINE          UAT14930
         OI    FLAG2,#NOSHIFT      DON'T SHIFT LINE                     UAT14940
         BAL   R9,PRINTIT                                               UAT14950
         SPACE                                                          UAT14960
PRINTBXT EQU   *                                                        UAT14970
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT14980
         BR    R9                  RETURN TO CALLER                     UAT14990
         SPACE                                                          UAT15000
MOVEIT5  MVC   LINE+1(*-*),0(R4)   *** EXECUTED INSTRUCTION ***         UAT15010
         EJECT                                                          UAT15020
*********************************************************************** UAT15030
*                                                                     * UAT15040
*    TRANSLTE  AND  TRANSBCK                                          * UAT15050
*                                                                     * UAT15060
*       THESE ROUTINES PERFORM THE "EBCDIC TO ASCII" OR "ASCII TO     * UAT15070
*       EBCDIC" TRANSLATION REQUESTED BY THE USER.                    * UAT15080
*                                                                     * UAT15090
*********************************************************************** UAT15100
TRANSLTE EQU   *                                                        UAT15110
         TM    FLAG,#TAPEMRK       IS THIS BLOCK A TAPE MARK?           UAT15120
         BOR   R9                  YES - RETURN TO CALLER               UAT15130
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT15140
         L     R15,VTABLES         GET TRANSLATE TABLES CSECT ADDR      UAT15150
         USING TABLES,R15          MAKE THEM ADDRESSABLE                UAT15160
         TM    OPTIONS2,#ETOA      WAS "ETOA" OPTION SPECIFIED?         UAT15170
         BNO   NOETOA              NO EBCDIC TO ASCII TRANSLATE         UAT15180
         LA    R2,IECTSASA         POINT TO EBCDIC->ASCII TABLE         UAT15190
         B     TRANS               GO TRANSLATE BUFFER                  UAT15200
NOETOA   EQU   *                                                        UAT15210
         TM    OPTIONS2,#ATOE      WAS "ATOE" OPTION SPECIFIED?         UAT15220
         BNO   TRANSXT             NO ASCII TO EBCDIC TRANSLATE         UAT15230
         LA    R2,IECTRASA         POINT TO ASCII->EBCDIC TABLE         UAT15240
         B     TRANS               GO TRANSLATE BUFFER                  UAT15250
         SPACE 2                                                        UAT15260
TRANSLAB EQU   *                                                        UAT15270
         TM    FLAG,#TAPEMRK       IS THIS BLOCK A TAPE MARK?           UAT15280
         BOR   R9                  YES - RETURN TO CALLER               UAT15290
         TM    FLAG2,#AL+#LABREC   ARE WE PROCESSING ASCII LABEL?       UAT15300
         BNOR  R9                  NO ASCII TO EBCDIC TRANSLATE         UAT15310
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT15320
         L     R15,VTABLES         GET TRANSLATE TABLES CSECT ADDR      UAT15330
         LA    R2,IECTRASA         POINT TO ASCII->EBCDIC TABLE         UAT15340
         B     TRANS               GO TRANSLATE BUFFER                  UAT15350
         SPACE 2                                                        UAT15360
*   THIS ROUTINE TRANSLATES A PREVIOUSLY TRANSLATED ASCII LABEL         UAT15370
*   FROM EBCDIC BACK INTO ASCII                                         UAT15380
TRANSBCK EQU   *                                                        UAT15390
         TM    FLAG,#TAPEMRK       IS THIS BLOCK A TAPE MARK?           UAT15400
         BOR   R9                  YES - RETURN TO CALLER               UAT15410
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT15420
         TM    FLAG2,#AL+#LABREC   ARE WE PROCESSING ASCII LABEL?       UAT15430
         BNO   TRANSQ1             NO EBCDIC TO ASCII TRANSLATE         UAT15440
         TM    OPTIONS2,#ATOE      WAS "ATOE" OPTION SPECIFIED?         UAT15450
         BO    TRANSXT             YES - DON'T TRANSLATE                UAT15460
         L     R15,VTABLES         GET TRANSLATE TABLES CSECT ADDR      UAT15470
         LA    R2,IECTSASA         POINT TO EBCDIC->ASCII TABLE         UAT15480
         B     TRANS               GO TRANSLATE THE BLOCK               UAT15490
TRANSQ1  EQU   *                                                        UAT15500
         TM    OPTIONS2,#ETOA      WAS "ETOA" OPTION SPECIFIED?         UAT15510
         BNO   TRANSXT             NO - RETURN                          UAT15520
         L     R15,VTABLES         GET TRANSLATE TABLES CSECT ADDR      UAT15530
         LA    R2,IECTSASA         POINT TO EBCDIC->ASCII TABLE         UAT15540
TRANS    EQU   *                                                        UAT15550
         L     R3,RECLENF          LOAD RECORD LENGTH                   UAT15560
         LA    R4,256              MAXIMUM LENGTH PER TR INSTRUCION     UAT15570
         LR    R5,R7               DATA ADDRESS                         UAT15580
TRLOOPB  EQU   *                                                        UAT15590
         CR    R3,R4               MORE THAN 256 BYTES LEFT?            UAT15600
         BL    TRLOOPE             NO - BRANCH                          UAT15610
         TR    0(256,R5),0(R2)     TRANSLATE 256 BYTES OF BUFFER        UAT15620
         AR    R5,R4               NEXT 256 BYTES                       UAT15630
         SR    R3,R4               LESS 256 BYTES                       UAT15640
         BP    TRLOOPB             GO DO IT (IF ANY LEFT)               UAT15650
TRLOOPE  EQU   *                                                        UAT15660
         BZ    TRANSXT             RETURN IF NO DATA LEFT               UAT15670
         BCTR  R3,0                GET EXECUTABLE LENGTH                UAT15680
         EX    R3,EXTRANS          TRANSLATE REMAINING BUFFER           UAT15690
         SPACE                                                          UAT15700
TRANSXT  EQU   *                                                        UAT15710
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT15720
         BR    R9                  RETURN TO CALLER                     UAT15730
         DROP  R15                 WE DON'T NEED THIS ANYMORE           UAT15740
         SPACE                                                          UAT15750
EXTRANS  TR    0(*-*,R5),0(R2)     ***** EXECUTED INSTRUCTION *****     UAT15760
         EJECT                                                          UAT15770
*********************************************************************** UAT15780
*                                                                     * UAT15790
*     BLOCKS                                                          * UAT15800
*                                                                     * UAT15810
*            THE BLOCKS ROUTINE PRINTS THE SIZE OF THE DATA BLOCK     * UAT15820
*            IF THE BLOCKS OPTION IS IN EFFECT AND THE DUMP OPTION    * UAT15830
*            IS NOT IN EFFECT.  PRINTOUT IS CONDENSED WHERE           * UAT15840
*            POSSIBLE.  IF INDICATED BY THE #TAPEMRK FLAG, THIS       * UAT15850
*            ROUTINE SHUTS DOWN THE BLOCKS OPTION FOR THE FILE        * UAT15860
*            AND PRINTS THE SIZE OF THE LAST BLOCK.                   * UAT15870
*                                                                     * UAT15880
*********************************************************************** UAT15890
         SPACE                                                          UAT15900
BLOCKS   EQU   *                                                        UAT15910
         TM    OPTIONS1,#BLOCKS    WAS BLOCKS OPTION SELECTED?          UAT15920
         BNOR  R9                  NO - RETURN TO CALLER                UAT15930
         TM    OPTIONS1,#DUMP+#DUMPALL   WAS EITHER DUMP OR DUMPALL?    UAT15940
         BNZR  R9                  YES - RETURN TO CALLER               UAT15950
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT15960
         TM    FLAG,#TAPEMRK       IS THIS A TAPE MARK?                 UAT15970
         BNO   CHKBLOCK            NO - NOT END OF FILE                 UAT15980
         L     R14,BLOCKCNT        GET BLOCK COUNT                      UAT15990
         LTR   R14,R14             WERE THERE ANY PREV BLOCKS?          UAT16000
         BZ    BLOCKSXT            NO - JUST EXIT                       UAT16010
         B     LSTBLOCK            YES - DUMP LAST ACCUMULATION         UAT16020
CHKBLOCK EQU   *                                                        UAT16030
         CLC   BLOCKCNT(4),=F'1'   IS THIS 1ST BLOCK?                   UAT16040
         BE    NEWBLOCK            YES - BRANCH                         UAT16050
         CLC   RECLENF(4),LASTLEN  BLOCK LENGTH SAME AS LAST TIME?      UAT16060
         BE    BLOCKSXT            YES - RETURN TO CALLER               UAT16070
         L     R14,BLOCKCNT        LOAD CURRENT BLOCK COUNTER           UAT16080
         BCTR  R14,0               DECREMENT BLOCK NUMBER               UAT16090
LSTBLOCK EQU   *                                                        UAT16100
         ST    R14,LASTBLK         SAVE THIS                            UAT16110
         SPACE                                                          UAT16120
         LA    R14,BLOCKSP1        ADDRESS OF PRINT RTN FOR ONE BLOCK   UAT16130
         CLC   STARTBLK,LASTBLK    START AND END THE SAME?              UAT16140
         BE    ONEBLOCK            IF EQUAL, ONLY ONE BLOCK             UAT16150
         LA    R14,BLOCKSP2        ADDRESS OF PRINT RTN FOR MULT BLOCKS UAT16160
ONEBLOCK EQU   *                                                        UAT16170
         BALR  R9,R14              GO PRINT MESSAGE                     UAT16180
NEWBLOCK EQU   *                                                        UAT16190
         MVC   STARTBLK(4),BLOCKCNT   RESET START BLOCK                 UAT16200
         MVC   LASTLEN(4),RECLENF  RESET LAST LENGTH                    UAT16210
BLOCKSXT EQU   *                                                        UAT16220
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT16230
         BR    R9                  RETURN TO CALLER                     UAT16240
         SPACE                                                          UAT16250
*  PRINT "BLOCKS XXXX TO YYYY LENGTH ZZZZ" MESSAGE                      UAT16260
BLOCKSP2 EQU   *                                                        UAT16270
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT16280
         MOVEMSG MSG25             BLOCKS XXXX TO YYYY LENGTH ZZZZ      UAT16290
         L     R14,LASTBLK         GET LAST BLOCK                       UAT16300
         CVD   R14,DOUBLE          CONVERT LAST BLOCK TO DECIMAL        UAT16310
         UNPK  LINE+MSG25T(6),DOUBLE(8)   TO PRINTABLE FORM             UAT16320
         OI    LINE+MSG25T+5,X'F0' INSURE PRINTABLE LAST DIGIT          UAT16330
         L     R14,STARTBLK        LOAD STARTING BLOCK                  UAT16340
         CVD   R14,DOUBLE          CONVERT TO DECIMAL                   UAT16350
         UNPK  LINE+MSG25B(6),DOUBLE(8)   TO PRINTABLE FORM             UAT16360
         OI    LINE+MSG25B+5,X'F0' INSURE PRINTABLE LAST DIGIT          UAT16370
         BCT   R14,SGLSKIP1        IF NOT FIRST BLOCK, DO SINGLE SKIP   UAT16380
         MVI   LINE,C'0'           IF FIRST BLOCK, DO DOUBLE SKIP       UAT16390
SGLSKIP1 EQU   *                                                        UAT16400
         L     R15,LASTLEN         LOAD BLOCK LENGTH                    UAT16410
         CVD   R15,DOUBLE          CONVERT BLK LENGTH TO DECIMAL        UAT16420
         UNPK  LINE+MSG25L(5),DOUBLE(8)   TO PRINTABLE FORM             UAT16430
         OI    LINE+MSG25L+4,X'F0' INSURE PRINTABLE LAST DIGIT          UAT16440
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT16450
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT16460
         BR    R9                  RETURN TO CALLER                     UAT16470
         SPACE                                                          UAT16480
*  PRINT "BLOCK  XXXX         LENGTH ZZZZ" MESSAGE                      UAT16490
BLOCKSP1 EQU   *                                                        UAT16500
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT16510
         MOVEMSG MSG26             BLOCK XXXX LENGTH YYYY               UAT16520
         L     R14,STARTBLK        LOAD STARTING BLOCK                  UAT16530
         CVD   R14,DOUBLE          CONVERT TO DECIMAL                   UAT16540
         UNPK  LINE+MSG26B(6),DOUBLE(8)   TO PRINTABLE FORM             UAT16550
         OI    LINE+MSG26B+5,X'F0' INSURE LAST DIGIT PRINTABLE          UAT16560
         BCT   R14,SGLSKIP2        IF NOT FIRST BLOCK, DO SINGLE SKIP   UAT16570
         MVI   LINE,C'0'           IF FIRST BLOCK, DO DOUBLE SKIP       UAT16580
SGLSKIP2 EQU   *                                                        UAT16590
         L     R15,LASTLEN         LOAD LAST LENGTH                     UAT16600
         CVD   R15,DOUBLE          CONVERT TO DECIMAL                   UAT16610
         UNPK  LINE+MSG26L(5),DOUBLE(8)   TO PRINTABLE FORM             UAT16620
         OI    LINE+MSG26L+4,X'F0' INSURE LAST DIGIT PRINTABLE          UAT16630
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT16640
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT16650
         BR    R9                  RETURN TO CALLER                     UAT16660
         EJECT                                                          UAT16670
*********************************************************************** UAT16680
*                                                                     * UAT16690
*     OPEN1                                                           * UAT16700
*                                                                     * UAT16710
*          THIS ROUTINE OPENS THE SYSPRINT AND SYSUT1 DCB'S           * UAT16720
*          AND ALLOCATES A BUFFER FOR SYSUT1.                         * UAT16730
*                                                                     * UAT16740
*********************************************************************** UAT16750
         SPACE                                                          UAT16760
OPEN1    EQU   *                                                        UAT16770
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT16780
         SPACE 2                                                        UAT16790
*    VERIFY PRESENCE OF SYSPRINT, SYSUT1, AND SYSUT2 DD-STATEMENTS      UAT16800
         SPACE 1                                                        UAT16810
         EXTRACT TIOTADDR,'S',FIELDS=TIOT   GO GET TIOT ADDRESS         UAT16820
         L     R2,TIOTADDR         LOAD TIOT POINTER                    UAT16830
         LA    R2,TIOTDDEN(,R2)    POINT TO FIRST DD ENTRY              UAT16840
         SR    R15,R15             ZERO OUT WORK REGISTER               UAT16850
TIOTLOOP EQU   *                                                        UAT16860
         CLI   TIOTLEN(R2),0       ARE WE AT END OF TIOT?               UAT16870
         BE    TIOTEND             YES - GET OUT OF LOOP                UAT16880
         CLC   TIOTDDNM(8,R2),SYSPRINT+DDNAME    IS THIS SYSPRINT?      UAT16890
         BE    FOUNDP              YES - GO SET FLAG                    UAT16900
         CLC   TIOTDDNM(8,R2),SYSUT1+DDNAME      IS THIS SYSUT1?        UAT16910
         BE    FOUND1              YES - GO SET FLAG                    UAT16920
         CLC   TIOTDDNM(8,R2),SYSUT2+DDNAME      IS THIS SYSUT2?        UAT16930
         BE    FOUND2              YES - GO SET FLAG                    UAT16940
TIOTNEXT EQU   *                                                        UAT16950
         IC    R15,TIOTLEN(,R2)    LOAD DD ENTRY LENGTH                 UAT16960
         AR    R2,R15              POINT TO NEXT DD ENTRY               UAT16970
         B     TIOTLOOP            LOOP BACK FOR IT                     UAT16980
         SPACE                                                          UAT16990
FOUNDP   EQU   *                                                        UAT17000
         OI    FLAG,#SYSPRNT       SET FLAG FOR SYSPRINT                UAT17010
         B     TIOTNEXT            CONTINUE LOOPING THROUGH TIOT        UAT17020
         SPACE                                                          UAT17030
FOUND1   EQU   *                                                        UAT17040
         OI    FLAG,#SYSUT1        SET FLAG FOR SYSUT1                  UAT17050
         MVC   UCB1(4),TIOTFSRT-1(R2)  SAVE SYSUT1 UCB ADDRESS          UAT17060
         B     TIOTNEXT            CONTINUE LOOPING THROUGH TIOT        UAT17070
         SPACE                                                          UAT17080
FOUND2   EQU   *                                                        UAT17090
         OI    FLAG,#SYSUT2        SET FLAG FOR SYSUT2                  UAT17100
         MVC   UCB2(4),TIOTFSRT-1(R2)  SAVE SYSUT2 UCB ADDRESS          UAT17110
         B     TIOTNEXT            CONTINUE LOOPING THROUGH TIOT        UAT17120
         SPACE                                                          UAT17130
TIOTEND  EQU   *                                                        UAT17140
         TM    FLAG,#SYSPRNT       WAS SYSPRINT FOUND?                  UAT17150
         BNO   NOPRINT1            NO - GO TERMINATE PROGRAM            UAT17160
         SPACE 2                                                        UAT17170
*    OPEN THE SYSPRINT DATA SET                                         UAT17180
         SPACE                                                          UAT17190
         OPEN  (SYSPRINT,OUTPUT)   OPEN SYSPRINT                        UAT17200
         TM    SYSPRINT+OFLGS,#BIT3   DID SYSPRINT OPEN OK?             UAT17210
         BNO   NOPRINT2            NO - HAVE TO TERMINATE PROGRAM       UAT17220
         BAL   R9,PRINTIT          GO PRINT HEADING                     UAT17230
         SPACE 2                                                        UAT17240
*    OPEN THE SYSUT1 TAPE DATA SET                                      UAT17250
         SPACE                                                          UAT17260
         TM    FLAG,#SYSUT1        WAS SYSUT1 FOUND?                    UAT17270
         BNO   NOSYS1A             NO - GO TERMINATE PROGRAM            UAT17280
         L     R15,UCB1            LOAD SYSUT1 UCB ADDRESS              UAT17290
         CLI   #UCBTYP+2(R15),X'80' IS THIS DEVICE MAGNETIC TAPE?       UAT17300
         BNE   NOTTAPE1            NO - ISSUE ERROR                     UAT17310
         CLI   #UCBTYP+3(R15),X'80' IS THIS A 3480?                     UAT17320
         BE    ACART               YES - SET FLAG!                      UAT17330
         CLI   #UCBTYP+3(R15),X'81' IS THIS A 3490?                     UAT17320
         BE    ACART               YES - SET FLAG!                      UAT17330
         CLI   #UCBTYP+3(R15),X'83' IS THIS A 3590?                     UAT17320
         BNE   NOT3480A            NO - SKIP                            UAT17330
ACART    EQU   *                                                        UAT17350
         OI    FLAG2,#CART1        SET CART FLAG                        UAT17340
NOT3480A EQU   *                                                        UAT17350
         RDJFCB SYSUT1             READ JOB FILE CONTROL BLOCK          UAT17360
         LA    R2,JFCB             LOAD JFCB BASE REGISTER              UAT17370
         USING JFCBD,R2            DECLARE BASE ADDRESSING              UAT17380
         MVI   JFCBNVOL,1          FORCE NUMBER OF VOLUMES TO 1         UAT17390
         MVI   JFCBLTYP,#BIT3      FORCE LABEL TYPE BLP                 UAT17400
         NI    JFCBTSDM,X'10'      REMOVE JOB MANAGEMENT FLAGS          UAT17410
         OI    JFCBTSDM,#BIT1      SHOW VOL SER LIST WAS CHANGED        UAT17420
         OI    JFCBIND2,#BIT7      FORCE THIS TO BE TEMPORARY DATA SET  UAT17430
         MVC   VOLSER1(6),JFCBVOLS SAVE JCL'S VOLUME SERIAL             UAT17440
         DROP  R2                  DON'T NEED THIS NOW                  UAT17450
         OPEN  (SYSUT1,INPUT),TYPE=J  OPEN SYSUT1 WITH MODIFIED JFCB    UAT17460
         TM    SYSUT1+OFLGS,#BIT3  DID SYSUT1 OPEN OK?                  UAT17470
         BNO   NOSYS1B             NO - TERMINATE PROGRAM               UAT17480
         SPACE 2                                                        UAT17490
*    GET A 32K I/O BUFFER                                               UAT17500
         SPACE                                                          UAT17510
         GETMAIN EC,LV=66000,A=BUFADDR,SP=0   GO GET I/O BUFFER SPACE   UAT17520
         LTR   R15,R15             DID WE GET THE CORE?                 UAT17530
         BNZ   NOCORE              NOPE - HAVE TO QUIT                  UAT17540
         GETMAIN EC,LV=LSTATBUF,A=ASTATBUF,SP=0   GO GET FILE STAT BUF  UAT17550
         LTR   R15,R15             DID WE GET THE CORE?                 UAT17560
         BNZ   NOCORE              NOPE - HAVE TO QUIT                  UAT17570
         MVC   BSTATBUF(4),ASTATBUF   SAVE CURRENT STAT BUF ADDR        UAT17580
         L     R7,BUFADDR          LOAD I/O BUFFER ADDRESS              UAT17590
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT17600
         BR    R9                  RETURN TO CALLER                     UAT17610
         EJECT                                                          UAT17620
*********************************************************************** UAT17630
*                                                                     * UAT17640
*     OPEN2                                                           * UAT17650
*                                                                     * UAT17660
*          THIS ROUTINE OPENS THE SYSUT2 DCB.                         * UAT17670
*                                                                     * UAT17680
*********************************************************************** UAT17690
         SPACE                                                          UAT17700
OPEN2    EQU   *                                                        UAT17710
         TM    OPTIONS1,#COPY      WAS COPY OPTION SPECIFIED?           UAT17720
         BNOR  R9                  NO - RETURN TO CALLER                UAT17730
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT17740
         SPACE 2                                                        UAT17750
*    OPEN THE SYSUT2 TAPE DATA SET                                      UAT17760
         SPACE                                                          UAT17770
         TM    FLAG,#SYSUT2        WAS SYSUT2 FOUND?                    UAT17780
         BNO   NOSYS2A             NO - GO TERMINATE PROGRAM            UAT17790
         L     R15,UCB2            LOAD SYSUT2 UCB ADDRESS              UAT17800
         CLI   #UCBTYP+2(R15),X'80' IS THIS DEVICE MAGNETIC TAPE?       UAT17810
         BNE   NOTTAPE2            NO - ISSUE ERROR                     UAT17820
         CLI   #UCBTYP+3(R15),X'80' IS THIS A 3480?                     UAT17830
         BNE   NOT3480B            NO - SKIP                            UAT17840
         OI    FLAG2,#CART2        SET 3480 FLAG                        UAT17850
         LA    R14,DEN38K          DEFAULT DENSITY                      UAT17860
         B     DEFDEN2             PROCEED WITH OPEN                    UAT17870
NOT3480B EQU   *                                                        UAT17880
         LA    R14,DEN6250         DEFAULT 6250 BPI                     UAT17890
         TM    #UCBTYP+0(R15),X'02' THIS DEVICE SUPPORT 6250?           UAT17900
         BO    DEFDEN2             YES - LET 6250 BE DEFAULT            UAT17910
         LA    R14,DEN1600         DEFAULT 1600 BPI                     UAT17920
         TM    #UCBTYP+0(R15),X'04' THIS DEVICE SUPPORT 1600?           UAT17930
         BO    DEFDEN2             YES - LET 1600 BE DEFAULT            UAT17940
         LA    R14,DEN800          DEFAULT 800 BPI                      UAT17950
DEFDEN2  EQU   *                                                        UAT17960
         MVC   DEFDEN(L'DENTAB),0(R14)   SAVE DEFAULT DENSITY INFO      UAT17970
         SPACE                                                          UAT17980
         RDJFCB SYSUT2             READ JOB FILE CONTROL BLOCK          UAT17990
         LA    R2,JFCB             LOAD JFCB BASE REGISTER              UAT18000
         USING JFCBD,R2            DECLARE BASE ADDRESSING              UAT18010
         MVI   JFCBNVOL,1          FORCE NUMBER OF VOLUMES TO 1         UAT18020
         MVI   JFCBLTYP,#BIT3      FORCE LABEL TYPE BLP                 UAT18030
         NI    JFCBTSDM,X'10'      REMOVE JOB MANAGEMENT FLAGS          UAT18040
         OI    JFCBTSDM,#BIT1      SHOW VOL SER LIST WAS CHANGED        UAT18050
         OI    JFCBIND2,#BIT7      FORCE THIS TO BE TEMPORARY DATA SET  UAT18060
         MVC   VOLSER2(6),JFCBVOLS SAVE JCL'S VOLUME SERIAL             UAT18070
         OPEN  (SYSUT2,INPUT),TYPE=J    OPEN THE OUTPUT TAPE DCB        UAT18080
         TM    SYSUT2+OFLGS,#BIT3  DID SYSUT2 OPEN OK?                  UAT18090
         BNO   NOSYS2B             NO - LET'S TERMINATE THE PROGRAM     UAT18100
         SPACE 2                                                        UAT18110
*   PREPARE MODESET ON SYSUT2 TAPE TO SET PROPER TAPE DENSITY           UAT18120
         SPACE                                                          UAT18130
         TM    FLAG2,#CART2        WRITING TO 3480 CARTRIDGE?           UAT18140
         BNO   CHKREEL2            NO - SKIP 3480 STUFF                 UAT18150
         MVC   MODECCW(1),DEN38K+DENTABM   MAKE CCW MODESET DUMMY       UAT18160
         MVC   TAPEDEN(1),DEN38K+DENTABJ   SAVE DENSITY CHARACTER       UAT18170
         MVC   DENSITY2(4),DEN38K+DENTABC  FOR OUR MESSAGE              UAT18180
         MVC   OUTIRG(6),DEN38K+DENTABN    IRG SIZE INFO                UAT18190
         ICM   R15,15,DEN38K+DENTABB  800 BYTES PER INCH                UAT18200
         B     DENCOMMN            BRANCH TO COMMON CODE                UAT18210
CHKREEL2 EQU   *                                                        UAT18220
         CLI   JFCDEN,JFCDOMIT     WAS DENSITY OMITTED ON DDCARD?       UAT18230
         BNE   CHK800              NO - BRANCH                          UAT18240
         MOVEMSG MSG42             DEFAULT DENSITY ON SYSUT2            UAT18250
         MVC   LINE+MSG42D(4),DEFDEN+2  PUT DENSITY INTO MSG            UAT18260
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT18270
         BAL   R9,PRINTIT          GO PRINT THIS MESSAGE                UAT18280
         B     SETDEFD             GO SET THE DEFAULT DENSITY           UAT18290
CHK800   EQU   *                                                        UAT18300
         CLI   JFCDEN,JFCD800      800 BPI?                             UAT18310
         BNE   CHK1600             NO - BRANCH                          UAT18320
         MVC   MODECCW(1),DEN800+DENTABM   MAKE CCW MODESET 800         UAT18330
         MVC   TAPEDEN(1),DEN800+DENTABJ   SAVE DENSITY CHARACTER       UAT18340
         MVC   DENSITY2(4),DEN800+DENTABC  FOR OUR MESSAGE              UAT18350
         MVC   OUTIRG(6),DEN800+DENTABN    IRG SIZE INFO                UAT18360
         ICM   R15,15,DEN800+DENTABB  800 BYTES PER INCH                UAT18370
         B     DENCOMMN            BRANCH TO COMMON CODE                UAT18380
CHK1600  EQU   *                                                        UAT18390
         CLI   JFCDEN,JFCD1600     1600 BPI?                            UAT18400
         BNE   CHK6250             NO - BRANCH                          UAT18410
         MVC   MODECCW(1),DEN1600+DENTABM   MAKE CCW MODESET 1600       UAT18420
         MVC   TAPEDEN(1),DEN1600+DENTABJ   SAVE DENSITY CHARACTER      UAT18430
         MVC   DENSITY2(4),DEN1600+DENTABC  FOR OUR MESSAGE             UAT18440
         MVC   OUTIRG(6),DEN1600+DENTABN    IRG SIZE INFO               UAT18450
         ICM   R15,15,DEN1600+DENTABB 1600 BYTES PER INCH               UAT18460
         B     DENCOMMN            BRANCH TO COMMON CODE                UAT18470
CHK6250  EQU   *                                                        UAT18480
         CLI   JFCDEN,JFCD6250     6250 BPI?                            UAT18490
         BNE   INVDEN              NO - UATAPE DOES NOT SUPPORT OTHERS  UAT18500
         MVC   MODECCW(1),DEN6250+DENTABM   MAKE CCW MODESET 6250       UAT18510
         MVC   TAPEDEN(1),DEN6250+DENTABJ   SAVE DENSITY CHARACTER      UAT18520
         MVC   DENSITY2(4),DEN6250+DENTABC  FOR OUR MESSAGE             UAT18530
         MVC   OUTIRG(6),DEN6250+DENTABN    IRG SIZE INFO               UAT18540
         ICM   R15,15,DEN6250+DENTABB 6250 BYTES PER INCH               UAT18550
         B     DENCOMMN            BRANCH TO COMMON CODE                UAT18560
SETDEFD  EQU   *                                                        UAT18570
         MVC   TAPEDEN(1),DEFDEN   DENSITY CHARACTER CODE               UAT18580
         MVC   MODECCW(1),DEFDEN+1 SET MODESET CCW                      UAT18590
         MVC   DENSITY2(4),DEFDEN+2  DENSITY IN ENGLISH                 UAT18600
         ICM   R15,15,DEFDEN+6     BINARY BPI                           UAT18610
DENCOMMN EQU   *                                                        UAT18620
         ST    R15,DENSYS2         SAVE TAPE DENSITY                    UAT18630
         MOVEMSG MSG10                    OUTPUT TAPE DENSITY =         UAT18640
         MVC   LINE+MSG10D(4),DENSITY2    MOVE IN DENSITY               UAT18650
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT18660
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT18670
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT18680
         BR    R9                  RETURN TO CALLER                     UAT18690
         EJECT                                                          UAT18700
*********************************************************************** UAT18710
*                                                                     * UAT18720
*     LABELS                                                          * UAT18730
*                                                                     * UAT18740
*        PERFORM SYSUT1 AND SYSUT2 TAPE VOLUME LABEL PROCESSING       * UAT18750
*                                                                     * UAT18760
*********************************************************************** UAT18770
         SPACE                                                          UAT18780
*      PERFORM SYSUT1 VOLUME LABEL PROCESSING                           UAT18790
         SPACE                                                          UAT18800
LABELS   EQU   *                                                        UAT18810
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT18820
GETVOLLB EQU   *                                                        UAT18830
         BAL   R9,READ1            GO READ 1ST RECORD ON TAPE           UAT18840
         TM    FLAG,#TAPEMRK       DID WE FIND LEADING TAPE MARK?       UAT18850
         BO    CHECKLTM            YES - CHECK 'LTM' OPTION             UAT18860
         LA    R15,75              MINIMUM ACCEPTABLE RECORD LENGTH     UAT18870
         C     R15,RECLENF         IS LABEL RECORD SHORTER THAN 75?     UAT18880
         BNL   NOTSL               YES- DO NOT CONSIDER STANDARD LABEL  UAT18890
         LA    R15,85              MAXIMUM ACCEPTABLE RECORD LENGTH     UAT18900
         C     R15,RECLENF         IS LABEL RECORD LONGER THAN 85?      UAT18910
         BNH   NOTSL               YES- DO NOT CONSIDER STANDARD LABEL  UAT18920
         USING VOL1D,R7            GET VOLUME LABEL ADDRESSING          UAT18930
         CLC   VOL1VOL1(4),=C'VOL1'   IS THIS A VOLUME LABEL?           UAT18940
         BNE   CHKASCII            NO - CHECK FOR ASCII LABELS          UAT18950
         OI    FLAG,#SL            SET FLAG TO SHOW STD. LABEL          UAT18960
         MOVEMSG MSG2              TAPE CONTAINS STANDARD LABELS        UAT18970
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT18980
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT18990
         MVC   VOLSER1(6),VOL1SER  SAVE THE VOLUME SERIAL               UAT19000
         B     OPEN1A              SKIP SOME STUFF                      UAT19010
         SPACE                                                          UAT19020
CHECKLTM EQU   *                                                        UAT19030
         OI    FLAG,#LTMPRES       SAY THAT LTM FOUND                   UAT19040
         TM    OPTIONS2,#LTM       WAS 'LTM' OPTION SPECIFIED?          UAT19050
         BNO   LTMNOTOK            NO - LEADING TAPE MARK IS NOT OK     UAT19060
         MOVEMSG MSG51             LEADING TAPE MARK SKIPPED            UAT19070
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT19080
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT19090
         B     GETVOLLB            GO CHECK FOR A VOLUME LABEL          UAT19100
LTMNOTOK EQU   *                                                        UAT19110
         MOVEMSG MSG52             LEADING TAPE MARK FOUND - NOT SL     UAT19120
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT19130
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT19140
         B     OPEN1A              CONTINUE AS NON STD LABELS           UAT19150
         SPACE                                                          UAT19160
CHKASCII EQU *               'V O L 1'   (IN ASCII)                     UAT19170
         CLC   VOL1VOL1(4),=X'564F4C31'  IS THIS ASCII "VOL1"?          UAT19180
         BNE   NOTSL               NO - CONSIDER IT NONSTANDARD         UAT19190
         MOVEMSG MSG49             TAPE CONTAINS ASCII LABELS           UAT19200
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT19210
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT19220
         OI    FLAG,#SL            SHOWS THAT WE HAVE STD. LABELS       UAT19230
         OI    FLAG2,#AL           SHOW THAT WE HAVE ASCII LABELS       UAT19240
         MVC   VOLSER1(6),VOL1SER  SAVE THE VOLUME SERIAL               UAT19250
         L     R15,VTABLES         GET TRANSLATE TABLES CSECT ADDR      UAT19260
         USING TABLES,R15          MAKE THEM ADDRESSABLE                UAT19270
         TR    VOLSER1(6),IECTRASA TRANSLATE IT TO EBCDIC               UAT19280
         DROP  R15                 WE DON'T NEED THIS ANYMORE           UAT19290
         B     OPEN1A              SKIP SOME STUFF                      UAT19300
         DROP  R7                  DON'T NEED THIS NOW                  UAT19310
NOTSL    EQU   *                                                        UAT19320
         MOVEMSG MSG3              TAPE DOES NOT CONTAIN STANDARD LABEL UAT19330
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT19340
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT19350
         SPACE                                                          UAT19360
OPEN1A   EQU   *                                                        UAT19370
         TM    FLAG2,#CART1        IS THIS A 3480 CARTRIDGE?            UAT19380
         BO    OPEN1B              YES - PROCESS DIFFERENTLY            UAT19390
         MOVEMSG MSG6              WRITE RING IS IN                     UAT19400
         BAL   R9,SENSE1           GO GET SYSUT1 SENSE INFO             UAT19410
         TM    #SENSE1,#BIT6       CHECK WRITE RING BIT                 UAT19420
         BNO   RINGIN              BRANCH IF IT'S IN                    UAT19430
         MVC   LINE+MSG6W(4),=C'OUT.'  SAY WRITE RING IS OUT.           UAT19440
RINGIN   EQU   *                                                        UAT19450
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT19460
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT19470
         BAL   R9,REWIND1          REWIND THE SYSUT1 TAPE               UAT19480
         B     LABELS2             NOW GO PROCESS SYSUT2                UAT19490
         SPACE                                                          UAT19500
OPEN1B   EQU   *                                                        UAT19510
         BAL   R9,SENSE1           GO GET SYSUT1 SENSE INFO             UAT19520
         MOVEMSG MSG61             WRITE PROTECT ENABLED                UAT19530
         TM    #SENSE1,#BIT6       IS IT WRITE PROTECTED?               UAT19540
         BO    WRITEPON            YES - BRANCH                         UAT19550
         MVC   LINE+MSG61A(9),=C'DISABLED.'  SAY WRITE PROTECT OFF      UAT19560
WRITEPON EQU   *                                                        UAT19570
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT19580
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT19590
         BAL   R9,REWIND1          REWIND SYSUT1 TAPE                   UAT19600
         SPACE 2                                                        UAT19610
*  PERFORM LABCHECK OPTION CHECK (DISPLAY VOLSER AND QUIT)              UAT19620
         TM    OPTIONS3,#LABCHK    LABCHECK OPTION IN EFFECT?           UAT19630
         BNO   LABELS2             NO - SKIP                            UAT19640
         ICM   R15,B'0011',=C'NL'  NONSTANDARD LABEL                    UAT19650
         TM    FLAG,#SL            STANDARD LABEL?                      UAT19660
         BNO   LABCHK1             NO - BRANCH                          UAT19670
         ICM   R15,B'0011',=C'AL'  ASCII LABEL?                         UAT19680
         TM    FLAG2,#AL           ASCII LABEL                          UAT19690
         BO    LABCHK1             YES - BRANCH                         UAT19700
         ICM   R15,B'0011',=C'SL'  STANDARD LABEL                       UAT19710
LABCHK1  EQU   *                                                        UAT19720
         STCM  R15,B'0011',WTO1LAB  STORE NL/AL/SL INTO WTO MSG         UAT19730
         MVC   WTO1VOL(6),VOLSER1   STORE VOLSER INTO WTO MSG           UAT19740
         L     R15,UCB1            GET SYSUT1 UCB ADDRESS               UAT19750
         MVC   WTO1UNIT(3),#UCBNAME(R15)  STORE UCB NAME INTO WTO MSG   UAT19760
         MVC   WTO1TYPE(4),=C'CART'                                     UAT19770
         TM    FLAG2,#CART1        IS THIS A CARTRIDGE?                 UAT19780
         BO    LABCHK2             NO - SKIP                            UAT19790
         MVC   WTO1TYPE(4),=C'TAPE'                                     UAT19800
LABCHK2  EQU   *                                                        UAT19810
         WTO   MF=(E,WTO1)         TAPE ON XXX IS SL VOLSER             UAT19820
         B     EPILOG              JUST QUIT                            UAT19830
         SPACE 2                                                        UAT19840
*     PERFORM SYSUT2 VOLUME LABEL PROCESSING                            UAT19850
         SPACE                                                          UAT19860
LABELS2  EQU   *                                                        UAT19870
         TM    OPTIONS1,#COPY      WAS COPY OPTION SPECIFIED?           UAT19880
         BNO   LABELS1             NO - DO NOT CHECK SYSUT2             UAT19890
         TM    OPTIONS2,#BYPASS    WAS BYPASS OPTION SPECIFIED?         UAT19900
         BO    BYPASS2             YES - DO NOT CHECK SYSUT2            UAT19910
         BAL   R9,READ2            GO READ 1ST RECORD ON TAPE           UAT19920
         TM    FLAG,#TAPEMRK       DID WE FIND TAPE MARK?               UAT19930
         BO    INVALID1            YES - CANNOT USE THIS TAPE           UAT19940
         LA    R15,80              LOAD SUPPOSED LABEL RECORD LENGTH    UAT19950
         C     R15,RECLENF         IS THE RECORD REALLY 80?             UAT19960
         BNE   INVALID1            NO - CANNOT USE THIS TAPE            UAT19970
         USING VOL1D,R7            DECLARE VOLUME LABEL ADDRESSABILITY  UAT19980
         CLC   VOL1VOL1(4),=C'VOL1'   IS THIS REALLY VOLUME LABEL?      UAT19990
         BNE   INVALID1            NO - CANNOT USE THIS TAPE            UAT20000
         MVC   VOLSER2X(6),VOL1SER SAVE TAPE'S VOLUME SERIAL            UAT20010
         CLC   VOL1SER(6),VOLSER2  DO VOLUME SERIAL MATCH?              UAT20020
         BNE   INVALID2            NO - CANNOT USE THIS TAPE            UAT20030
         DROP  R7                  DON'T NEED THIS ANY MORE             UAT20040
         MOVEMSG MSG7              ORIGINAL SYSUT2 VOLUME SERIAL        UAT20050
         MVC   LINE+MSG7S(6),VOLSER2X    PUT VOL SER IN MSG             UAT20060
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT20070
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT20080
BYPASS2  EQU   *                                                        UAT20090
         BAL   R9,REWIND2          REWIND THE OUTPUT TAPE               UAT20100
         BAL   R9,MODESET2         GO SET DRIVE DENSITY                 UAT20110
         BAL   R9,SENSE2           GO GET SYSUT2 SENSE INFO.            UAT20120
*** NOTE:  SENSE BYTE 1 BIT 6 IS SET FOR WRITE PROTECT ENABLED ON       UAT20130
***        BOTH 3420 AND 3480 TAPE DRIVES.                              UAT20140
         TM    #SENSE1,#BIT6       CHECK WRITE PROTECT BIT              UAT20150
         BO    FILEPROT            CAN'T USE THIS TAPE                  UAT20160
LABELS1  EQU   *                                                        UAT20170
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT20180
         BR    R9                  RETURN TO CALLER                     UAT20190
         EJECT                                                          UAT20200
*********************************************************************** UAT20210
*                                                                     * UAT20220
*     EOTSTATS                                                        * UAT20230
*                                                                     * UAT20240
*         THIS ROUTINE PRINTS THE VARIOUS STATISTIC FIELDS            * UAT20250
*         FOUND IN THE UCB'S FOR BOTH SYSUT1 AND SYSUT2               * UAT20260
*         TAPES.                                                      * UAT20270
*                                                                     * UAT20280
*********************************************************************** UAT20290
         SPACE                                                          UAT20300
EOTSTATS EQU   *                                                        UAT20310
         STACK R9                       PLACE RETURN ADDRESS ON STACK   UAT20320
         L     R4,UCB1                  LOAD SYSUT1 UCB ADDRESS         UAT20330
         L     R2,#UCBXTN-1(R4)         LOAD SYSUT1 UCB EXTENSION ADDR  UAT20340
         MOVEMSG MSG28                  STATISTICS                      UAT20350
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT20360
         BNO   NC0                      NO - SKIP A FEW                 UAT20370
         MVC   LINE+MSGS2-6(6),=C'SYSUT2'    SAY SYSUT2 TOO             UAT20380
         L     R5,UCB2                  LOAD SYSUT2 UCB ADDRESS         UAT20390
         L     R3,#UCBXTN-1(R5)         LOAD SYSUT2 UCB EXTENSION ADDR  UAT20400
NC0      EQU   *                                                        UAT20410
         BAL   R9,PRINTIT               GO PRINT THE LINE               UAT20420
         SPACE                                                          UAT20430
*   VOLUME SERIAL NUMBER                                                UAT20440
         MOVEMSG MSG29                  VOLUME SERIAL                   UAT20450
         MVC   LINE+MSGS1-6(6),VOLSER1  SYSUT1 VOLUME SERIAL            UAT20460
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT20470
         BNO   NC1                      NO - SKIP A FEW                 UAT20480
         MVC   LINE+MSGS2-6(6),VOLSER2  SYSUT2 VOLUME SERIAL            UAT20490
NC1      EQU   *                                                        UAT20500
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT20510
         SPACE                                                          UAT20520
*   TAPE DRIVE UNIT ADDRESS                                             UAT20530
         MOVEMSG MSG37                  TAPE DRIVE                      UAT20540
         MVC   LINE+MSGS1-3(3),#UCBNAME(R4)  MOVE IN SYSUT1 DEVICE ADDR UAT20550
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT20560
         BNO   NC2                      NO - SKIP A FEW                 UAT20570
         MVC   LINE+MSGS2-3(3),#UCBNAME(R5)  MOVE IN SYSUT2 DEVICE ADDR UAT20580
NC2      EQU   *                                                        UAT20590
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT20600
         SPACE                                                          UAT20610
*   TEMPORARY READ ERRORS                                               UAT20620
         MOVEMSG MSG30                  TEMPORARY READS                 UAT20630
         SR    R4,R4                    CLEAR WORK REGISTER             UAT20640
         IC    R4,#UCBTR(R2)            SYSUT1 TEMP READS               UAT20650
         CVD   R4,DOUBLE                CONVERT TO                      UAT20660
         UNPK  LINE+MSGS1-3(3),DOUBLE(8)   PRINTABLE                    UAT20670
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT20680
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT20690
         BNO   NC3                      NO - SKIP A FEW                 UAT20700
         IC    R4,#UCBTR(R3)            SYSUT2 TEMP READS               UAT20710
         CVD   R4,DOUBLE                CONVERT TO                      UAT20720
         UNPK  LINE+MSGS2-3(3),DOUBLE(8)    PRINTABLE                   UAT20730
         OI    LINE+MSGS2-1,X'F0'              DECIMAL                  UAT20740
NC3      EQU   *                                                        UAT20750
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT20760
         SPACE                                                          UAT20770
*   TEMPORARY WRITE ERRORS                                              UAT20780
         MOVEMSG MSG31                  TEMPORARY WRITES                UAT20790
         IC    R4,#UCBTW(R2)            SYSUT1 TEMP WRITES              UAT20800
         CVD   R4,DOUBLE                CONVERT TO                      UAT20810
         UNPK  LINE+MSGS1-3(3),DOUBLE(8)   PRINTABLE                    UAT20820
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT20830
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT20840
         BNO   NC4                      NO - SKIP A FEW                 UAT20850
         IC    R4,#UCBTW(R3)            SYSUT2 TEMP WRITES              UAT20860
         CVD   R4,DOUBLE                CONVERT TO                      UAT20870
         UNPK  LINE+MSGS2-3(3),DOUBLE(8)   PRINTABLE                    UAT20880
         OI    LINE+MSGS2-1,X'F0'             DECIMAL                   UAT20890
NC4      EQU   *                                                        UAT20900
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT20910
         SPACE                                                          UAT20920
*   PERMANENT READ ERRORS                                               UAT20930
         MOVEMSG MSG32                  PERMANENT READS                 UAT20940
         IC    R4,#UCBPR(R2)            SYSUT1 PERM READS               UAT20950
         CVD   R4,DOUBLE                CONVERT TO                      UAT20960
         UNPK  LINE+MSGS1-3(3),DOUBLE(8)   PRINTABLE                    UAT20970
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT20980
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT20990
         BNO   NC5                      NO - SKIP A FEW                 UAT21000
         IC    R4,#UCBPR(R3)            SYSUT2 PERM READS               UAT21010
         CVD   R4,DOUBLE                CONVERT TO                      UAT21020
         UNPK  LINE+MSGS2-3(3),DOUBLE(8)   PRINTABLE                    UAT21030
         OI    LINE+MSGS2-1,X'F0'             DECIMAL                   UAT21040
NC5      EQU   *                                                        UAT21050
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT21060
         SPACE                                                          UAT21070
*   PERMANENT WRITE ERRORS                                              UAT21080
         MOVEMSG MSG33                  PERMANENT WRITES                UAT21090
         IC    R4,#UCBPW(R2)            SYSUT1 PERM WRITES              UAT21100
         CVD   R4,DOUBLE                CONVERT TO                      UAT21110
         UNPK  LINE+MSGS1-3(3),DOUBLE(8)   PRINTABLE                    UAT21120
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT21130
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT21140
         BNO   NC6                      NO - SKIP A FEW                 UAT21150
         IC    R4,#UCBPW(R3)            SYSUT2 PERM WRITES              UAT21160
         CVD   R4,DOUBLE                CONVERT TO                      UAT21170
         UNPK  LINE+MSGS2-3(3),DOUBLE(8)   PRINTABLE                    UAT21180
         OI    LINE+MSGS2-1,X'F0'             DECIMAL                   UAT21190
NC6      EQU   *                                                        UAT21200
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT21210
         SPACE                                                          UAT21220
*   NOISE BLOCKS                                                        UAT21230
         MOVEMSG MSG38                  NOISE BLOCKS                    UAT21240
         IC    R4,#UCBNB(R2)            SYSUT1 NOISE BLOCKS             UAT21250
         CVD   R4,DOUBLE                CONVERT TO                      UAT21260
         UNPK  LINE+MSGS1-3(3),DOUBLE(8)   PRINTABLE                    UAT21270
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT21280
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT21290
         BNO   NC7                      NO - SKIP A FEW                 UAT21300
         IC    R4,#UCBNB(R3)            SYSUT2 NOISE BLOCKS             UAT21310
         CVD   R4,DOUBLE                CONVERT TO                      UAT21320
         UNPK  LINE+MSGS2-3(3),DOUBLE(8)   PRINTABLE                    UAT21330
         OI    LINE+MSGS2-1,X'F0'             DECIMAL                   UAT21340
NC7      EQU   *                                                        UAT21350
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT21360
         SPACE                                                          UAT21370
*   NUMBER OF ERASE GAPS                                                UAT21380
         MOVEMSG MSG34                  ERASE GAPS                      UAT21390
         LH    R4,#UCBERG(R2)           SYSUT1 ERASE GAPS               UAT21400
         CVD   R4,DOUBLE                CONVERT TO                      UAT21410
         UNPK  LINE+MSGS1-3(3),DOUBLE(8)   PRINTABLE                    UAT21420
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT21430
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT21440
         BNO   NC8                      NO - SKIP A FEW                 UAT21450
         LH    R4,#UCBERG(R3)           SYSUT2 ERASE GAPS               UAT21460
         CVD   R4,DOUBLE                CONVERT TO                      UAT21470
         UNPK  LINE+MSGS2-3(3),DOUBLE(8)   PRINTABLE                    UAT21480
         OI    LINE+MSGS2-1,X'F0'             DECIMAL                   UAT21490
NC8      EQU   *                                                        UAT21500
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT21510
         SPACE                                                          UAT21520
*   CLEANER ACTIONS                                                     UAT21530
         MOVEMSG MSG35                  CLEANER ACTIONS                 UAT21540
         LH    R4,#UCBCLN(R2)           SYSUT1 CLEANER ACTIONS          UAT21550
         CVD   R4,DOUBLE                CONVERT TO                      UAT21560
         UNPK  LINE+MSGS1-3(3),DOUBLE(8)   PRINTABLE                    UAT21570
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT21580
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT21590
         BNO   NC9                      NO - SKIP A FEW                 UAT21600
         LH    R4,#UCBCLN(R3)           SYSUT2 CLEANER ACTIONS          UAT21610
         CVD   R4,DOUBLE                CONVERT TO                      UAT21620
         UNPK  LINE+MSGS2-3(3),DOUBLE(8)   PRINTABLE                    UAT21630
         OI    LINE+MSGS2-1,X'F0'             DECIMAL                   UAT21640
NC9      EQU   *                                                        UAT21650
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT21660
         SPACE                                                          UAT21670
*   START I/O COUNT                                                     UAT21680
         MOVEMSG MSG36                  START I/O                       UAT21690
         LH    R4,#UCBSIO(R2)           SYSUT1 SIO'S                    UAT21700
         CVD   R4,DOUBLE                CONVERT TO                      UAT21710
         UNPK  LINE+MSGS1-6(6),DOUBLE(8)   PRINTABLE                    UAT21720
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT21730
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT21740
         BNO   NC10                     NO - SKIP A FEW                 UAT21750
         LH    R4,#UCBSIO(R3)           SYSUT2 SIO'S                    UAT21760
         CVD   R4,DOUBLE                CONVERT TO                      UAT21770
         UNPK  LINE+MSGS2-6(6),DOUBLE(8)   PRINTABLE                    UAT21780
         OI    LINE+MSGS2-1,X'F0'             DECIMAL                   UAT21790
NC10     EQU   *                                                        UAT21800
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT21810
         SPACE                                                          UAT21820
*    TOTAL DATA BYTES ON TAPE                                           UAT21830
         MOVEMSG MSG391                 DATA LENGTH (FEET)              UAT21840
         L     R4,TBYTECNT              TOTAL BYTES ON TAPE             UAT21850
         CVD   R4,DOUBLE                CONVERT TO                      UAT21860
         MVC   LINE+MSGS1-15(15),=X'4020206B2020206B2020206B202120'     UAT21870
         ED    LINE+MSGS1-15(15),DOUBLE+2  PRINTABLE DECIMAL            UAT21880
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT21890
         BNO   NC11                     NO - SKIP A FEW                 UAT21900
         L     R4,TBYTECNT              TOTAL BYTES ON TAPE             UAT21910
         CVD   R4,DOUBLE                CONVERT TO                      UAT21920
         MVC   LINE+MSGS2-15(15),=X'4020206B2020206B2020206B202120'     UAT21930
         ED    LINE+MSGS2-15(15),DOUBLE+2  PRINTABLE DECIMAL            UAT21940
NC11     EQU   *                                                        UAT21950
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT21960
         SPACE                                                          UAT21970
*    TOTAL DATA LENGTH ON TAPE                                          UAT21980
         MOVEMSG MSG39                  DATA LENGTH (FEET)              UAT21990
         L     R4,TOTFEET               TOTAL NUMBER OF FEET ON TAPE    UAT22000
         CVD   R4,DOUBLE                CONVERT TO                      UAT22010
         UNPK  LINE+MSGS1-5(5),DOUBLE(8)   PRINTABLE                    UAT22020
         OI    LINE+MSGS1-1,X'F0'             DECIMAL                   UAT22030
         TM    OPTIONS1,#COPY           IS COPY OPTION IN EFFECT?       UAT22040
         BNO   NC12                     NO - SKIP A FEW                 UAT22050
         L     R4,TOTFEET2              TOTAL NUMBER OF FEET ON TAPE    UAT22060
         CVD   R4,DOUBLE                CONVERT TO                      UAT22070
         UNPK  LINE+MSGS2-5(5),DOUBLE(8)   PRINTABLE                    UAT22080
         OI    LINE+MSGS2-1,X'F0'             DECIMAL                   UAT22090
NC12     EQU   *                                                        UAT22100
         BAL   R9,PRINTIT               GO PRINT THE MESSAGE            UAT22110
         SPACE                                                          UAT22120
         TM    FLAG,#SL            STANDARD LABELS?                     UAT22130
         BNO   NC13                NO - SKIP                            UAT22140
         MOVEMSG MSG67             (TOTAL BYTES DOES NOT INCLUDE LABEL) UAT22150
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT22160
NC13     EQU   *                                                        UAT22170
         SPACE                                                          UAT22180
*    PRINT TAPE FILES SUMMARY                                           UAT22190
         TM    FLAG,#SL            STANDARD LABEL TAPE?                 UAT22200
         BNO   NOSUMM              NO - NO SUMMARY                      UAT22210
         L     R6,ASTATBUF         LOAD BEGINNING STAT BUF PTR          UAT22220
         LA    R4,WSTATBUF         LOAD LENGTH OF EACH ENTRY            UAT22230
         L     R5,BSTATBUF         LOAD CURRENT POINTER                 UAT22240
         SR    R5,R4               BACK UP TO LAST ENTRY                UAT22250
         CR    R5,R6               ARE THERE ANY ENTRIES?               UAT22260
         BL    NOSUMM              NO - EXIT                            UAT22270
         LA    R3,1                LAST LINE COUNTER                    UAT22280
SUMMHDR  EQU   *                                                        UAT22290
         MOVEMSG MSG47                  SUMMARY HEADING                 UAT22300
         MVC   LINE+MSG471(6),VOLSER1   INPUT VOLUME SERIAL             UAT22310
         TM    OPTIONS1,#COPY           COPY OPTION IN EFFECT?          UAT22320
         BNO   SUMMNCPY                 NO - SKIP VOLSER2               UAT22330
         MVC   LINE+MSG47M(3),=C'AND'   ADD AN "AND"                    UAT22340
         MVC   LINE+MSG472(6),VOLSER2   OUTPUT VOLUME SERIAL            UAT22350
SUMMNCPY EQU   *                                                        UAT22360
         BAL   R9,PRINTIT          GO PRINT HEADING                     UAT22370
         MOVEMSG MSG45             SUMMARY HEADING                      UAT22380
         BAL   R9,PRINTIT          GO PRINT HEADING                     UAT22390
         MOVEMSG MSG46             SUMMARY HEADING UNDERSCORE           UAT22400
         BAL   R9,PRINTIT          GO PRINT HEADING                     UAT22410
SUMMLOOP EQU   *                                                        UAT22420
         TM    OPTIONS2,#CRT       CRT OPTION IN EFFECT?                UAT22430
         BO    SUMMSKIP            YES - SKIP CHECK FOR HEADER          UAT22440
         C     R3,LLINES           LINE COUNTER LOW ENOUGH?             UAT22450
         BNL   SUMMHDR             YES - PRINT HEADER                   UAT22460
SUMMSKIP EQU   *                                                        UAT22470
         MVC   LINE+8(4),STATFILE(R6)    FILE NUMBER                    UAT22480
         MVC   LINE+16(17),STATDSN(R6)   DATA SET NAME                  UAT22490
         MVC   LINE+37(4),STATRECF(R6)   RECORD FORMAT                  UAT22500
         MVC   LINE+45(5),STATLREC(R6)   LOGICAL RECORD LENGTH          UAT22510
         MVC   LINE+54(5),STATBLKS(R6)   BLOCK SIZE                     UAT22520
         MVC   LINE+63(6),STATNBLK(R6)   NUMBER OF BLOCKS               UAT22530
         MVC   LINE+73(4),STATLEN(R6)    LENGTH (FEET)                  UAT22540
         BAL   R9,PRINTIT          GO PRINT THE MESSAGE                 UAT22550
         BXLE  R6,R4,SUMMLOOP      LOOP BACK FOR NEXT ENTRY             UAT22560
NOSUMM   EQU   *                                                        UAT22570
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT22580
         BR    R9                       RETURN TO CALLER                UAT22590
         EJECT                                                          UAT22600
*********************************************************************** UAT22610
*                                                                     * UAT22620
*     PRINTIT                                                         * UAT22630
*                                                                     * UAT22640
*          THIS ROUTINE IS A GENERAL PURPOSE PRINT ROUTINE.  IT       * UAT22650
*          ACCEPTS A SINGLE PRINT LINE AT "LINE" THAT CONTAINS        * UAT22660
*          CARRIAGE CONTROL, AND MAINTAINS A COUNTER SUCH THAT        * UAT22670
*          A MAXIMUM OF 60 LINES APPEAR ON EACH PRINTED PAGE.         * UAT22680
*          SUPPORTED CARRIAGE CONTROL CHARACTERS INCLUDE THE '0'      * UAT22690
*          FOR DOUBLE SPACING AND THE '-' FOR TRIPLE SPACING, AS      * UAT22700
*          WELL AS THE BLANK FOR SINGLE SPACING.                      * UAT22710
*                                                                     * UAT22720
*********************************************************************** UAT22730
         SPACE                                                          UAT22740
PRINTIT  EQU   *                                                        UAT22750
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT22760
         TM    OPTIONS2,#CRT       IS CRT OPTION IN EFFECT?             UAT22770
         BO    NOSHIFT             YES - SKIP HEADING STUFF             UAT22780
         LA    R15,1               ONE LINE SKIPPED                     UAT22790
         CLI   LINE,C'0'           DOUBLE SPACING?                      UAT22800
         BE    PUTLINES            YES - BRANCH                         UAT22810
         LA    R15,2               TWO LINES SKIPPED                    UAT22820
         CLI   LINE,C'-'           TRIPLE SPACING?                      UAT22830
         BE    PUTLINES            YES - BRANCH                         UAT22840
         CLI   LINE,C'1'           PAGE EJECT?                          UAT22850
         BE    PUTEJECT            YES - BRANCH                         UAT22860
         SR    R15,R15             WHATEVER, WE WON'T COUNT IT          UAT22870
         SPACE                                                          UAT22880
PUTLINES EQU   *                                                        UAT22890
         L     R14,LLINES          NO. OF LINES LEFT ON PAGE            UAT22900
         SR    R14,R15             SUBTRACT OFF BLANK LINES             UAT22910
         BP    SKIPTOF             IF SOME STILL LEFT, BRANCH           UAT22920
PUTEJECT EQU   *                                                        UAT22930
         L     R14,PAGENUM         WHAT PAGE IS THIS COMING UP?         UAT22940
         LA    R14,1(,R14)         INCREMENT PAGE NUMBER BY 1           UAT22950
         ST    R14,PAGENUM         SAVE NEW PAGE NUMBER                 UAT22960
         CVD   R14,DOUBLE          CONVERT PAGE NUMBER                  UAT22970
         UNPK  PAGE(4),DOUBLE(8)      TO CHARACTER FORM                 UAT22980
         OI    PAGE+3,X'F0'        INSURE SIGN NIBBLE                   UAT22990
         PUT   SYSPRINT,HEADING1   PRINT ADVERTISEMENT                  UAT23000
         LA    R14,57              57 LINES LEFT ON PAGE                UAT23010
         MVI   LINE,C'-'           NEXT LINE IS TRIPLE SPACED           UAT23020
         SPACE                                                          UAT23030
SKIPTOF  EQU   *                                                        UAT23040
         BCTR  R14,0               DECREMENT LINE COUNTER               UAT23050
         ST    R14,LLINES          SAVE THIS NEW VALUE                  UAT23060
         TM    OPTIONS2,#CRT       CRT OPTION IN EFFECT?                UAT23070
         BO    NOSHIFT             YES - DO NOT SHIFT                   UAT23080
         TM    FLAG2,#NOSHIFT      SHIFT THE LINE OVER?                 UAT23090
         BO    NOSHIFT             NO - DO NOT SHIFT                    UAT23100
         MVC   TEMPLINE(1),LINE    MOVE CARRIAGE CONTROL CHAR           UAT23110
         MVC   TEMPLINE+21(110),LINE+1  SHIFT LINE OVER                 UAT23120
         MVC   LINE(L'LINE),TEMPLINE   REPLACE ORIGINAL LINE            UAT23130
NOSHIFT  EQU   *                                                        UAT23140
         PUT   SYSPRINT,LINE       PRINT THE LINE                       UAT23150
         NI    FLAG2,255-#NOSHIFT  RESET NOSHIFT FLAG                   UAT23160
         MVI   LINE,C' '           BLANK OUT THE                        UAT23170
         MVC   LINE+1(L'LINE-1),LINE     PRINT LINE                     UAT23180
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT23190
         BR    R9                  RETURN TO CALLER                     UAT23200
         EJECT                                                          UAT23210
*********************************************************************** UAT23220
*                                                                     * UAT23230
*     READ1                                                           * UAT23240
*                                                                     * UAT23250
*            THIS ROUTINE READS A SINGLE BLOCK FROM THE SYSUT1        * UAT23260
*            TAPE.  THE LENGTH OF THE BLOCK IS CALCULATED AND         * UAT23270
*            PLACED AT "RECLEN".                                      * UAT23280
*                                                                     * UAT23290
*********************************************************************** UAT23300
         SPACE                                                          UAT23310
READ1    EQU   *                                                        UAT23320
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT23330
         STCM  R7,7,READADDR       SAVE BUFFER ADDR IN CCW              UAT23340
         LA    R2,READCCW          POINT TO THE CHANNEL PROGRAM         UAT23350
         BAL   R9,EXCP1            GO READ THE NEXT BLOCK               UAT23360
*        LH    R15,READLEN         LOAD LENGTH OF ATTEMPTED READ        UAT23370
         MVC   HALFWORK(2),READLEN     MOVE ENTIRE 64K HALFWORD         UAT23370
         L     R15,FULLWORK            LOAD FULLWORD                    UAT23370
*        SH    R15,IOB1RES         SUBTRACT OFF THE RESIDUAL LENGTH     UAT23380
         MVC   HALFWORK(2),IOB1RES     MOVE 64K RESIDUAL LENGTH         UAT23380
         S     R15,FULLWORK            SUBTRACT IN FULLWORD ARITHMETIC  UAT23380
         STH   R15,RECLEN          SAVE RECORD LENGTH                   UAT23390
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT23400
         BR    R9                  RETURN TO CALLER                     UAT23410
         SPACE 3                                                        UAT23420
*********************************************************************** UAT23430
*                                                                     * UAT23440
*     READ2                                                           * UAT23450
*                                                                     * UAT23460
*            THIS ROUTINE READS A SINGLE BLOCK FROM THE SYSUT2        * UAT23470
*            TAPE.  THE LENGTH OF THE BLOCK IS CALCULATED AND         * UAT23480
*            PLACED AT "RECLEN".                                      * UAT23490
*                                                                     * UAT23500
*********************************************************************** UAT23510
         SPACE                                                          UAT23520
READ2    EQU   *                                                        UAT23530
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT23540
         STCM  R7,7,READADDR       SAVE BUFFER ADDR IN CCW              UAT23550
         LA    R2,READCCW          POINT TO THE CHANNEL PROGRAM         UAT23560
         BAL   R9,EXCP2            GO READ THE NEXT BLOCK               UAT23570
*        LH    R15,READLEN         LOAD LENGTH OF ATTEMPTED READ        UAT23580
         MVC   HALFWORK(2),READLEN     MOVE ENTIRE 64K HALFWORD         UAT23580
         L     R15,FULLWORK            LOAD FULLWORD                    UAT23580
*        SH    R15,IOB2RES         SUBTRACT OFF THE RESIDUAL LENGTH     UAT23590
         MVC   HALFWORK(2),IOB2RES     MOVE 64K RESIDUAL LENGTH         UAT23590
         S     R15,FULLWORK            SUBTRACT IN FULLWORD ARITHMETIC  UAT23590
         STH   R15,RECLEN          SAVE RECORD LENGTH                   UAT23600
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT23610
         BR    R9                  RETURN TO CALLER                     UAT23620
         EJECT                                                          UAT23630
*********************************************************************** UAT23640
*                                                                     * UAT23650
*     WRITE2                                                          * UAT23660
*                                                                     * UAT23670
*            THIS ROUTINE WRITES A SINGLE BLOCK OR TAPE MARK ON       * UAT23680
*            THE SYSUT2 TAPE.  THE TAPE INDICATE CONDITION IS         * UAT23690
*            CHECKED BEFORE WRITING TO DETERMINE IF THERE IS STILL    * UAT23700
*            ROOM LEFT ON THE TAPE.                                   * UAT23710
*                                                                     * UAT23720
*********************************************************************** UAT23730
         SPACE                                                          UAT23740
WRITE2   EQU   *                                                        UAT23750
         TM    OPTIONS1,#COPY      IS COPY OPTION IN EFFECT?            UAT23760
         BNOR  R9                  RETURN TO CALLER                     UAT23770
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT23780
         TM    FLAG,#TAPEIND       WAS TAPE INDICATE PREVIOUSLY RAISED? UAT23790
         BO    NOROOM              YES - WE ARE OUT OF TAPE             UAT23800
         LA    R2,WTMCCW           POINT TO WRITE TAPE MARK CCW         UAT23810
         TM    FLAG,#TAPEMRK       ARE WE TO WRITE TAPE MARK?           UAT23820
         BO    WRITETM             YES - LET'S WRITE IT INSTEAD         UAT23830
         STCM  R7,7,WRITEADR       SAVE BUFFER ADDR IN CCW              UAT23840
         MVC   WRITELEN(2),RECLEN  PLACE RECORD LENGTH IN CCW           UAT23850
         LA    R2,WRITECCW         POINT TO THE WRITE CHANNEL PGM       UAT23860
WRITETM  EQU   *                                                        UAT23870
         BAL   R9,EXCP2            GO EXECUTE THE CHANNEL PROGRAM       UAT23880
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT23890
         BR    R9                  RETURN TO CALLER                     UAT23900
         EJECT                                                          UAT23910
*********************************************************************** UAT23920
*                                                                     * UAT23930
*     SENSE1                                                          * UAT23940
*                                                                     * UAT23950
*            THIS ROUTINE READS THE SENSE INFORMATION FOR THE         * UAT23960
*            SYSUT1 TAPE.                                             * UAT23970
*                                                                     * UAT23980
*********************************************************************** UAT23990
         SPACE                                                          UAT24000
SENSE1   EQU   *                                                        UAT24010
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT24020
         LA    R2,SENSECCW         POINT TO SENSE CHANNEL PGM           UAT24030
         BAL   R9,EXCP1            GO GET SENSE INFORMATION             UAT24040
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT24050
         BR    R9                  RETURN TO CALLER                     UAT24060
         SPACE 3                                                        UAT24070
*********************************************************************** UAT24080
*                                                                     * UAT24090
*     SENSE2                                                          * UAT24100
*                                                                     * UAT24110
*            THIS ROUTINE READS THE SENSE INFORMATION FOR THE         * UAT24120
*            SYSUT2 TAPE.                                             * UAT24130
*                                                                     * UAT24140
*********************************************************************** UAT24150
         SPACE                                                          UAT24160
SENSE2   EQU   *                                                        UAT24170
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT24180
         LA    R2,SENSECCW         POINT TO SENSE CHANNEL PROGRAM       UAT24190
         BAL   R9,EXCP2            GO GET SENSE INFORMATION             UAT24200
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT24210
         BR    R9                  RETURN TO CALLER                     UAT24220
         EJECT                                                          UAT24230
*********************************************************************** UAT24240
*                                                                     * UAT24250
*     REWIND1                                                         * UAT24260
*                                                                     * UAT24270
*          THIS ROUTINE REWINDS THE SYSUT1 TAPE TO ITS LOAD POINT.    * UAT24280
*                                                                     * UAT24290
*********************************************************************** UAT24300
         SPACE                                                          UAT24310
REWIND1  EQU   *                                                        UAT24320
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT24330
         LA    R2,REWINDCC         POINT TO REWIND CCW                  UAT24340
         BAL   R9,EXCP1            GO REWIND THE TAPE                   UAT24350
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT24360
         BR    R9                  RETURN TO CALLER                     UAT24370
         SPACE 3                                                        UAT24380
*********************************************************************** UAT24390
*                                                                     * UAT24400
*     REWIND2                                                         * UAT24410
*                                                                     * UAT24420
*          THIS ROUTINE REWINDS THE SYSUT2 TAPE TO ITS LOAD POINT.    * UAT24430
*                                                                     * UAT24440
*********************************************************************** UAT24450
         SPACE                                                          UAT24460
REWIND2  EQU   *                                                        UAT24470
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT24480
         LA    R2,REWINDCC         POINT TO REWIND CCW                  UAT24490
         BAL   R9,EXCP2            GO REWIND THE TAPE                   UAT24500
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT24510
         BR    R9                  RETURN TO CALLER                     UAT24520
         SPACE 3                                                        UAT24530
*********************************************************************** UAT24540
*                                                                     * UAT24550
*     MODESET2                                                        * UAT24560
*                                                                     * UAT24570
*          THIS ROUTINE SETS THE PROPER SYSUT2 TAPE DENSITY           * UAT24580
*                                                                     * UAT24590
*********************************************************************** UAT24600
         SPACE                                                          UAT24610
MODESET2 EQU   *                                                        UAT24620
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT24630
         LA    R2,MODECCW          POINT TO MODESET CCW                 UAT24640
         BAL   R9,EXCP2            GO SET DRIVE DENSITY                 UAT24650
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT24660
         BR    R9                  RETURN TO CALLER                     UAT24670
         SPACE 3                                                        UAT24680
*********************************************************************** UAT24690
*                                                                     * UAT24700
*     DISPLAY1                                                        * UAT24710
*                                                                     * UAT24720
*          THIS ROUTINE WRITES TO THE DISPLAY ON 3480 DRIVE           * UAT24730
*                                                                     * UAT24740
*********************************************************************** UAT24750
         SPACE                                                          UAT24760
DISPLAY1 EQU   *                                                        UAT24770
         TM    FLAG2,#CART1        ARE WE ON 3480?                      UAT24780
         BNOR  R9                  NO - JUST RETURN                     UAT24790
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT24800
         LA    R2,DISPCCW          POINT TO LOAD DISPLAY CCW            UAT24810
         BAL   R9,EXCP1            GO SET DRIVE DENSITY                 UAT24820
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT24830
         BR    R9                  RETURN TO CALLER                     UAT24840
         EJECT                                                          UAT24850
*********************************************************************** UAT24860
*                                                                     * UAT24870
*     EXCP1                                                           * UAT24880
*                                                                     * UAT24890
*            THIS ROUTINE EXECUTES CHANNEL PROGRAMS FOR               * UAT24900
*            THE SYSUT1 DATA SET.  VARIOUS ERROR CHECKING             * UAT24910
*            IS DONE, AND FLAG SETTING IS PERFORMED (SUCH             * UAT24920
*            AS FLAGGING TAPE MARKS, ETC.).  AT ENTRY TO              * UAT24930
*            THIS ROUTINE, REGISTER 2 MUST POINT TO THE               * UAT24940
*            START OF THE CHANNEL PROGRAM TO BE EXECUTED.             * UAT24950
*                                                                     * UAT24960
*********************************************************************** UAT24970
         SPACE                                                          UAT24980
*   ISSUE THE I/O OPERATION FOR SYSUT1 TAPE                             UAT24990
         SPACE                                                          UAT25000
EXCP1    EQU   *                                                        UAT25010
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT25020
         NI    FLAG3,255-#SEN3480  RESET SENSE-TYPE FLAG                UAT25030
         TM    FLAG2,#CART1        ARE WE WRITING TO 3480?              UAT25040
         BNO   EXCP1R              NO - SKIP                            UAT25050
         OI    FLAG3,#SEN3480      YES- SET 3480 SENSE FLAG             UAT25060
EXCP1R   EQU   *                   ENTRY FOR REDRIVING THE I/O          UAT25070
         TM    OPTIONS3,#DEBUG1    DEBUG OUTPUT?                        UAT25080
         BNO   EXCP1S1             NO - SKIP                            UAT25090
         MOVEMSG MSG63             DEBUG SYSUT1 BEFORE                  UAT25100
         UNPK  LINE+MSG63A(9),0(5,R2)                                   UAT25110
         UNPK  LINE+MSG63A+8(9),4(5,R2)                                 UAT25120
         MVI   LINE+MSG63A+16,C' '                                      UAT25130
         TR    LINE+MSG63A(16),HEXTABLE                                 UAT25140
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT25150
         BAL   R9,PRINTIT          PRINT DEBUG INFO                     UAT25160
EXCP1S1  EQU   *                                                        UAT25170
         STCM  R2,7,IOB1CCW        SAVE CHANNEL PGM ADDR IN IOB         UAT25180
         EXCP  IOB1                EXECUTE THE CHANNEL PROGRAM          UAT25190
         WAIT  1,ECB=ECB1          WAIT FOR IT TO COMPLETE              UAT25200
         TM    OPTIONS3,#DEBUG1    DEBUG OUTPUT?                        UAT25210
         BNO   EXCP1S2             NO - SKIP                            UAT25220
         MOVEMSG MSG64             DEBUG SYSUT1 BEFORE                  UAT25230
         UNPK  LINE+MSG64A(5),IOB1CSW+3(3)                              UAT25240
         MVI   LINE+MSG64A+4,C' '                                       UAT25250
         TR    LINE+MSG64A(4),HEXTABLE                                  UAT25260
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT25270
         BAL   R9,PRINTIT          PRINT DEBUG INFO                     UAT25280
EXCP1S2  EQU   *                                                        UAT25290
         MVC   TEMPFLAG(1),FLAG    SAVE FLAG BYTE TEMPORARILY           UAT25300
         NI    FLAG,255-#TAPEMRK   CLEAR FLAG                           UAT25310
*   UNIT EXCEPTION INDICATES TAPE MARK SENSED ON 3420 AND 3480          UAT25320
         TM    IOB1CSW+3,#BIT7     DID WE FIND TAPE MARK?               UAT25330
         BNO   EXCP1A              NO - SKIP SETTING FLAG BIT           UAT25340
         OI    FLAG,#TAPEMRK       INDICATE WHAT WE FOUND               UAT25350
         TM    TEMPFLAG,#TAPEMRK   WAS LAST THING ALSO A TAPE MARK?     UAT25360
         BNO   EXCP1A              NO - SKIP SETTING NEW FLAG           UAT25370
         OI    FLAG,#ENDTAPE       ALSO SET END-OF-TAPE FLAG            UAT25380
         SPACE 2                                                        UAT25390
*   CHECK FOR EXCEPTIONAL CONDITION.  IF SO, ISSUE SENSE AND QUIT       UAT25400
         SPACE                                                          UAT25410
EXCP1A   EQU   *                                                        UAT25420
         TM    IOB1CSW+3,#BIT6     WAS THERE A UNIT CHECK?              UAT25430
         BNO   EXCP1XT             NO - RETURN TO CALLER                UAT25440
         TM    IOB1SNS,#BIT1       CHECK FOR INTERVENTION REQ'D         UAT25450
         BO    EXCP1R              RESTART OPERATION IF SO              UAT25460
         MVC   CSW(7),IOB1CSW      SAVE BAD CSW                         UAT25470
         ICM   R15,7,IOB1CCW       LOAD CCW ADDRESS                     UAT25480
         MVC   CCW(8),0(R15)       SAVE BAD CCW                         UAT25490
         MVC   SENSE(1),IOB1SNS    SAVE 1ST SENSE BYTE                  UAT25500
         LA    R15,SENSECCW        POINT TO SENSE CCW                   UAT25510
         STCM  R15,7,IOB1CCW       PLACE CHANNEL PGM ADDR IN IOB        UAT25520
         EXCP  IOB1                EXECUTE THE SENSE CHANNEL PGM        UAT25530
         WAIT  1,ECB=ECB1          WAIT FOR IT TO COMPLETE              UAT25540
         MOVEMSG ERROR9            PERMANENT I/O ERROR ON SYSUT1        UAT25550
         OI    FLAG2,#NOSHIFT      SET THE NOSHIFT FLAG                 UAT25560
         BAL   R9,PRINTIT          GO PRINT ERROR MESSAGE               UAT25570
         BAL   R9,PRTSENSE         GO PRINT SENSE INFORMATION           UAT25580
         TM    OPTIONS3,#SKIPBAD   ARE WE TO SKIP THIS BLOCK?           UAT25590
         BO    SKIPBAD             YES - SKIP IT                        UAT25600
         MVI   RETCODE,16          SET PROGRAM RETURN CODE 16           UAT25610
         DISCARD                   DISCARD RETURN ADDRESS FROM STACK    UAT25620
         B     EPISTAT             TERMINATE/LET SYSTEM CLEAN UP        UAT25630
         SPACE                                                          UAT25640
*   ROUTINE TO SKIP BAD INPUT BLOCK (WARN USER FIRST)                   UAT25650
         SPACE                                                          UAT25660
SKIPBAD  EQU   *                                                        UAT25670
         LA    R15,FSBCCW          POINT TO FWD-SPACE BLOCK CCW         UAT25680
         STCM  R15,7,IOB1CCW       PLACE CHANNEL PGM ADDR IN IOB        UAT25690
         EXCP  IOB1                EXECUTE THE CHANNEL PGM              UAT25700
         WAIT  1,ECB=ECB1          WAIT FOR IT TO COMPLETE              UAT25710
         OI    FLAG2,#NOSHIFT      SET THE NOSHIFT FLAG                 UAT25720
         MOVEMSG ERROR20           FORWARD SPACING OVER BLOCK           UAT25730
         BAL   R9,PRINTIT          GO PRINT MESSAGE                     UAT25740
         B     EXCP1R              GO TRY NEXT BLOCK                    UAT25750
         SPACE                                                          UAT25760
EXCP1XT  EQU   *                                                        UAT25770
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT25780
         BR    R9                  RETURN TO CALLER                     UAT25790
         EJECT                                                          UAT25800
*********************************************************************** UAT25810
*                                                                     * UAT25820
*     EXCP2                                                           * UAT25830
*                                                                     * UAT25840
*            THIS ROUTINE EXECUTES CHANNEL PROGRAMS FOR               * UAT25850
*            THE SYSUT2 DATA SET.  VARIOUS ERROR CHECKING             * UAT25860
*            IS DONE, AND FLAG SETTING IS PERFORMED (SUCH             * UAT25870
*            AS FLAGGING TAPE INDICATE).  AT ENTRY TO                 * UAT25880
*            THIS ROUTINE, REGISTER 2 MUST POINT TO THE               * UAT25890
*            START OF THE CHANNEL PROGRAM TO BE EXECUTED.             * UAT25900
*                                                                     * UAT25910
*********************************************************************** UAT25920
         SPACE                                                          UAT25930
*   ISSUE THE I/O OPERATION FOR SYSUT2 TAPE                             UAT25940
         SPACE                                                          UAT25950
EXCP2    EQU   *                                                        UAT25960
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT25970
         NI    FLAG3,255-#SEN3480  RESET SENSE-TYPE FLAG                UAT25980
         TM    FLAG2,#CART2        ARE WE WRITING TO 3480?              UAT25990
         BNO   EXCP2R              NO - SKIP                            UAT26000
         OI    FLAG3,#SEN3480      YES- SET 3480 SENSE FLAG             UAT26010
EXCP2R   EQU   *                   ENTRY FOR REDRIVING THE I/O          UAT26020
         TM    OPTIONS3,#DEBUG2    DEBUG OUTPUT?                        UAT26030
         BNO   EXCP2S1             NO - SKIP                            UAT26040
         MOVEMSG MSG65             DEBUG SYSUT2 BEFORE                  UAT26050
         UNPK  LINE+MSG65A(9),0(5,R2)                                   UAT26060
         UNPK  LINE+MSG65A+8(9),4(5,R2)                                 UAT26070
         MVI   LINE+MSG65A+16,C' '                                      UAT26080
         TR    LINE+MSG65A(16),HEXTABLE                                 UAT26090
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT26100
         BAL   R9,PRINTIT          PRINT DEBUG INFO                     UAT26110
EXCP2S1  EQU   *                                                        UAT26120
         STCM  R2,7,IOB2CCW        SAVE CHANNEL PGM ADDR IN IOB         UAT26130
         EXCP  IOB2                EXECUTE THE CHANNEL PROGRAM          UAT26140
         WAIT  1,ECB=ECB2          WAIT FOR IT TO COMPLETE              UAT26150
         TM    OPTIONS3,#DEBUG2    DEBUG OUTPUT?                        UAT26160
         BNO   EXCP2S2             NO - SKIP                            UAT26170
         MOVEMSG MSG66             DEBUG SYSUT2 BEFORE                  UAT26180
         UNPK  LINE+MSG66A(5),IOB2CSW+3(3)                              UAT26190
         MVI   LINE+MSG66A+4,C' '                                       UAT26200
         TR    LINE+MSG66A(4),HEXTABLE                                  UAT26210
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT26220
         BAL   R9,PRINTIT          PRINT DEBUG INFO                     UAT26230
EXCP2S2  EQU   *                                                        UAT26240
*   UNIT EXCEPTION INDICATES LOGICAL END OF TAPE FOR 3420 AND 3480      UAT26250
         TM    IOB2CSW+3,#BIT7     DID WE FIND END-OF-TAPE FOIL?        UAT26260
         BNO   EXCP2A              NO - SKIP SETTING FLAG BIT           UAT26270
         OI    FLAG,#TAPEIND       SHOW THAT WE FOUND TAPE INDICATE     UAT26280
         SPACE 2                                                        UAT26290
*   CHECK FOR EXCEPTIONAL CONDITION.  IF SO, ISSUE SENSE AND QUIT       UAT26300
         SPACE                                                          UAT26310
EXCP2A   EQU   *                                                        UAT26320
         TM    IOB2CSW+3,#BIT6     WAS THERE A UNIT CHECK?              UAT26330
         BNO   EXCP2XT             NO - RETURN TO CALLER                UAT26340
         TM    IOB2SNS,#BIT1       CHECK FOR INTERVENTION REQ'D         UAT26350
         BO    EXCP2R              RESTART OPERATION IF SO              UAT26360
         MVC   CSW(7),IOB2CSW      SAVE BAD CSW                         UAT26370
         ICM   R15,7,IOB2CCW       LOAD BAD CCW ADDRESS                 UAT26380
         MVC   CCW(8),0(R15)       SAVE BAD CCW                         UAT26390
         MVC   SENSE(1),IOB2SNS    SAVE 1ST SENSE BYTE                  UAT26400
         LA    R15,SENSECCW        POINT TO SENSE CCW                   UAT26410
         STCM  R15,7,IOB2CCW       PLACE CHANNEL PGM ADDR IN IOB        UAT26420
         EXCP  IOB2                EXECUTE THE SENSE CHANNEL PGM        UAT26430
         WAIT  1,ECB=ECB2          WAIT FOR IT TO COMPLETE              UAT26440
         MOVEMSG ERROR11           PERMANENT I/O ERROR ON SYSUT2        UAT26450
         OI    FLAG2,#NOSHIFT      SET NOSHIFT FLAG                     UAT26460
         BAL   R9,PRINTIT          GO PRINT ERROR MESSAGE               UAT26470
         BAL   R9,PRTSENSE         GO PRINT SENSE INFORMATION           UAT26480
         MVI   RETCODE,16          SET PROGRAM RETURN CODE 16           UAT26490
         DISCARD                                                        UAT26500
         B     EPISTAT             TERMINATE/LET SYSTEM CLEAN UP        UAT26510
         SPACE                                                          UAT26520
EXCP2XT  EQU   *                                                        UAT26530
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT26540
         BR    R9                  RETURN TO CALLER                     UAT26550
         EJECT                                                          UAT26560
*********************************************************************** UAT26570
*                                                                       UAT26580
*   PRINT THE SENSE INFORMATION RESULTING FROM BAD I/O OPERATION        UAT26590
*                                                                       UAT26600
*********************************************************************** UAT26610
         SPACE                                                          UAT26620
PRTSENSE EQU   *                                                        UAT26630
         STACK R9                  PLACE RETURN ADDRESS ON STACK        UAT26640
         LA    R2,SENSETB2         POINT TO 3420 SENSE INFO TABLE       UAT26650
         SR    R3,R3               CLEAR A WORK REGISTER                UAT26660
         LA    R4,SENSENTM         NUMBER OF TIMES THROUGH LOOP         UAT26670
         TM    FLAG3,#SEN3480      IS THIS 3480 SENSE?                  UAT26680
         BNO   PRTSLOOP            NO - SKIP                            UAT26690
         LA    R2,SENSETB8         POINT TO 3480 SENSE INFO TABLE       UAT26700
PRTSLOOP EQU   *                                                        UAT26710
         IC    R3,0(R2)            LOAD THE SENSE INFO BYTE             UAT26720
         EX    R3,SENSECHK         CHECK SENSE BYTE AGAINST TABLE       UAT26730
         BNO   PRTSLOUT            BRANCH IF BIT NOT ON                 UAT26740
         MVC   LINE(23),=C'0****** SENSE INDICATES'                     UAT26750
         MVC   LINE+24(SENSEMLN),1(R2)   MOVE IN MESSAGE                UAT26760
         OI    FLAG2,#NOSHIFT      SET THE NOSHIFT FLAG                 UAT26770
         BAL   R9,PRINTIT          GO PRINT SENSE MESSAGE               UAT26780
PRTSLOUT EQU   *                                                        UAT26790
         LA    R2,SENSELEN(R2)     NEXT SENSE TABLE FIELD               UAT26800
         BCT   R4,PRTSLOOP         LOOP BACK                            UAT26810
         SPACE                                                          UAT26820
         MOVEMSG ERROR10                 CSW=XXXX CCW=XXXX              UAT26830
         UNPK  LINE+ERR10C(15),CSW(8)    CONVERT THE CSW TO             UAT26840
         TR    LINE+ERR10C(14),HEXTABLE  ...PRINTABLE HEX               UAT26850
         MVI   LINE+ERR10C+14,C' '       BLANK OUT LAST JUNK BYTE       UAT26860
         UNPK  LINE+ERR10W(9),CCW(5)     CONVERT CCW TO                 UAT26870
         UNPK  LINE+ERR10W+8(9),CCW+4(5) ...PRINTABLE HEX               UAT26880
         TR    LINE+ERR10W(16),HEXTABLE  JUNK TO HEX                    UAT26890
         MVI   LINE+ERR10W+16,C' '       BLANK OUT LAST JUNK BYTE       UAT26900
         OI    FLAG2,#NOSHIFT            SET THE NOSHIFT FLAG           UAT26910
         BAL   R9,PRINTIT                GO PRINT THE LINE              UAT26920
         SPACE                                                          UAT26930
         MOVEMSG ERROR17                 SENSE=XXXX                     UAT26940
         MVC   #SENSE(1),SENSE           RESTORE 1ST SENSE BYTE         UAT26950
         LA    R14,6               SIX WORDS OF SENSE INFORMATION       UAT26960
         TM    FLAG3,#SEN3480      IS SENSE FROM A 3480?                UAT26970
         BNO   NOTCART2            NO - SKIP                            UAT26980
         LA    R14,8               EIGHT WORDS FOR 3480                 UAT26990
NOTCART2 EQU   *                                                        UAT27000
         LA    R15,LINE+ERR17B                                          UAT27010
         LA    R1,#SENSE                                                UAT27020
PRTRLOOP EQU   *                                                        UAT27030
         UNPK  0(9,R15),0(5,R1)   CONVERT TO HEX                        UAT27040
         TR    0(8,R15),HEXTABLE   TRANSLATE TO PRINTABLE FORM          UAT27050
         MVI   8(R15),C' '         BLANK OUT EXTRANEOUS BYTE            UAT27060
         LA    R15,9(,R15)         NEXT PRINT POSITION                  UAT27070
         LA    R1,4(,R1)           NEXT SENSE FULLWORD                  UAT27080
         BCT   R14,PRTRLOOP        LOOP BACK                            UAT27090
         OI    FLAG2,#NOSHIFT      SET THE NOSHIFT FLAG                 UAT27100
         BAL   R9,PRINTIT          GO PRINT THE LINE                    UAT27110
         OC    FILECNT,FILECNT     IS FILE COUNTER ZERO?                UAT27120
         BZ    VOLERR              YES - WE WERE DOING VOLUME LABEL     UAT27130
         TM    FLAG2,#LABREC       PROCESSING LABEL RECORD?             UAT27140
         BNO   NOTLABR             NO - SKIP                            UAT27150
         MOVEMSG ERR18              "ERROR OCCURRED DURING LABEL"       UAT27160
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT27170
         CVD   R15,DOUBLE          CONVERT TO                           UAT27180
         UNPK  LINE+ERR18F(4),DOUBLE(8)   PRINTABLE DECIMAL             UAT27190
         OI    LINE+ERR18F+3,X'F0' INSURE SIGN NIBBLE                   UAT27200
         OI    FLAG2,#NOSHIFT      SET NOSHIFT FLAG                     UAT27210
         BAL   R9,PRINTIT          GO PRINT ERROR MESSAGE               UAT27220
         B     SETERR16            BRANCH                               UAT27230
NOTLABR  EQU   *                                                        UAT27240
         MOVEMSG ERR19             PROCESSING BLOCK ### OF FILE ###     UAT27250
         L     R15,BLOCKCNT        LOAD BLOCK COUNTER                   UAT27260
         LA    R15,1(,R15)         BUMP UP ONE                          UAT27270
         CVD   R15,DOUBLE          CONVERT TO                           UAT27280
         UNPK  LINE+ERR19B(6),DOUBLE(8)   PRINTABLE DECIMAL             UAT27290
         OI    LINE+ERR19B+5,X'F0' INSURE SIGN NIBBLE                   UAT27300
         L     R15,FILECNT         LOAD FILE COUNTER                    UAT27310
         CVD   R15,DOUBLE          CONVERT TO                           UAT27320
         UNPK  LINE+ERR19F(4),DOUBLE(8)   PRINTABLE DECIMAL             UAT27330
         OI    LINE+ERR19F+3,X'F0' INSURE SIGN NIBBLE                   UAT27340
         OI    FLAG2,#NOSHIFT      SET NOSHIFT FLAG                     UAT27350
         BAL   R9,PRINTIT          GO PRINT THE ERROR MESSAGE           UAT27360
SETERR16 EQU   *                                                        UAT27370
         UNSTACK R9                RETRIEVE RETURN ADDRESS              UAT27380
         BR    R9                  RETURN TO CALLER                     UAT27390
         SPACE 2                                                        UAT27400
VOLERR   EQU   *                                                        UAT27410
         MOVEMSG ERROR21           ERROR PROCESSING VOLUME LABEL        UAT27420
         OI    FLAG2,#NOSHIFT      SET NOSHIFT FLAG                     UAT27430
         BAL   R9,PRINTIT          GO PRINT THE ERROR MESSAGE           UAT27440
         B     SETERR16            RETURN TO CALLER                     UAT27450
         SPACE 2                                                        UAT27460
SENSECHK TM    SENSE,X'00'         **** EXECUTED INSTRUCTION ****       UAT27470
         EJECT                                                          UAT27480
*********************************************************************** UAT27490
*                                                                     * UAT27500
*      ERRORS                                                         * UAT27510
*                                                                     * UAT27520
*             THIS SECTION OF CODE HANDLES ALL PROGRAM ERRORS         * UAT27530
*                                                                     * UAT27540
*********************************************************************** UAT27550
         SPACE                                                          UAT27560
NOPRINT1 EQU   *                                                        UAT27570
         WTO   'UATAPE -- ERROR:  NO SYSPRINT DD STATEMENT',ROUTCDE=11  UAT27580
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT27590
         B     EPILOG              GO TERMINATE PROGRAM                 UAT27600
         SPACE 2                                                        UAT27610
NOPRINT2 EQU   *                                                        UAT27620
         WTO   'UATAPE -- ERROR:  SYSPRINT WOULD NOT OPEN',ROUTCDE=11   UAT27630
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT27640
         B     EPILOG              GO TERMINATE PROGRAM                 UAT27650
         SPACE 2                                                        UAT27660
NOSYS1A  EQU   *                                                        UAT27670
         MOVEMSG ERROR1                    NO SYSUT1 FOUND              UAT27680
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT27690
         B     PRINTERR            GO PRINT AND TERMINATE               UAT27700
         SPACE 2                                                        UAT27710
NOSYS1B  EQU   *                                                        UAT27720
         MOVEMSG ERROR2                  SYSUT1 WOULD NOT OPEN          UAT27730
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT27740
         B     PRINTERR            GO PRINT AND TERMINATE               UAT27750
         SPACE 2                                                        UAT27760
NOCORE   EQU   *                                                        UAT27770
         MOVEMSG ERROR3                  NOT ENOUGH MEMORY              UAT27780
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT27790
         B     PRINTERR            GO PRINT AND TERMINATE               UAT27800
         SPACE 2                                                        UAT27810
NOSYS2A  EQU   *                                                        UAT27820
         MOVEMSG ERROR4                SYSUT2 DD NOT FOUND              UAT27830
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT27840
         B     PRINTERR            GO PRINT AND TERMINATE               UAT27850
         SPACE 2                                                        UAT27860
NOSYS2B  EQU   *                                                        UAT27870
         MOVEMSG ERROR5                SYSUT2 WOULD NOT OPEN            UAT27880
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT27890
         B     PRINTERR            GO PRINT AND TERMINATE               UAT27900
INVALID1 EQU   *                                                        UAT27910
         MOVEMSG ERROR8                 OUTPUT TAPE DOES NOT HAVE LABEL UAT27920
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT27930
         B     PRINTERR            GO PRINT AND TERMINATE               UAT27940
         SPACE 2                                                        UAT27950
INVALID2 EQU   *                                                        UAT27960
         MOVEMSG ERROR6                 JCL VOLSER DOES NOT MATCH TAPE  UAT27970
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT27980
         BAL   R9,PRINTIT          GO PRINT ERROR MESSAGE               UAT27990
         MOVEMSG ERROR7                 JCL VOLSER=    TAPE=            UAT28000
         MVC   LINE+ERR7J(6),VOLSER2    MOVE IN JCL VOLUME SERIAL       UAT28010
         MVC   LINE+ERR7T(6),VOLSER2X   MOVE IN TAPE'S VOLUME SERIAL    UAT28020
         MVI   RETCODE,12          SET PROGRAM RETURN CODE 12           UAT28030
         B     PRINTERR            GO PRINT AND TERMINATE               UAT28040
         SPACE 2                                                        UAT28050
NOROOM   EQU   *                                                        UAT28060
         MOVEMSG ERROR12                   RAN OUT OF TAPE ON SYSUT2    UAT28070
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT28080
         BAL   R9,PRINTIT          GO PRINT ERROR MESSAGE               UAT28090
         MVI   RETCODE,16          SET PROGRAM RETURN CODE 12           UAT28100
         B     EPISTAT             GO TERMINATE PROGRAM                 UAT28110
         SPACE 2                                                        UAT28120
PARMINV  EQU   *                                                        UAT28130
         L     R2,PARMADDR         LOAD PARM ADDRESS                    UAT28140
         L     R2,0(,R2)           LOAD PARM FIELD ADDRESS              UAT28150
         LH    R15,0(,R2)          LOAD PARM FIELD LENGTH               UAT28160
         LA    R2,2(,R2)           POINT TO PARM FIELD TEXT             UAT28170
         BCTR  R15,0               GET EXECUTABLE LENGTH                UAT28180
         EX    R15,MOVEIT2         MOVE TO PRINT LINE                   UAT28190
         MVI   LINE,C'-'           MAKE TRIPLE SPACE                    UAT28200
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT28210
         BAL   R9,PRINTIT          GO PRINT THE LINE                    UAT28220
         SR    R3,R2               GET OFFSET WHERE ERROR IS            UAT28230
         LA    R15,LINE+1(R3)      POINT TO CORRESPONDING PLACE         UAT28240
         MVI   0(R15),C'?'         PUT QM THERE                         UAT28250
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT28260
         BAL   R9,PRINTIT          GO PRINT THE QM                      UAT28270
         MOVEMSG ERROR13                  INVALID PARM FIELD            UAT28280
         MVI   RETCODE,8           SET PROGRAM RETURN CODE 8            UAT28290
         B     PRINTERR            GO PRINT AND TERMINATE               UAT28300
         SPACE                                                          UAT28310
MOVEIT2  MVC   LINE+1(*-*),0(R2)   ***** EXECUTED INSTRUCTION *****     UAT28320
         SPACE 2                                                        UAT28330
INVDEN   EQU   *                                                        UAT28340
         MOVEMSG ERROR14                 DOES NOT SUPPORT SPEC DENSITY  UAT28350
         MVI   RETCODE,16          SET PROGRAM RETURN CODE 16           UAT28360
         B     PRINTERR            GO PRINT AND TERMINATE               UAT28370
         SPACE 2                                                        UAT28380
FILEPROT EQU   *                                                        UAT28390
         MOVEMSG ERROR15                 SYSUT2 IS FILE PROTECTED       UAT28400
         MVI   RETCODE,16          SET PROGRAM RETURN CODE 16           UAT28410
         B     PRINTERR            GO PRINT AND TERMINATE               UAT28420
         SPACE 2                                                        UAT28430
NOTTAPE1 EQU   *                                                        UAT28440
         MOVEMSG ERROR16                 DEVICE NOT TAPE UNIT           UAT28450
         MVC   LINE+ERR16D(6),=C'SYSUT1'   SAY IT'S SYSUT1              UAT28460
         MVI   RETCODE,16          SET PROGRAM RETURN CODE 16           UAT28470
         B     PRINTERR            GO PRINT AND TERMINATE               UAT28480
         SPACE 2                                                        UAT28490
NOTTAPE2 EQU   *                                                        UAT28500
         MOVEMSG ERROR16                 DEVICE NOT TAPE UNIT           UAT28510
         MVC   LINE+ERR16D(6),=C'SYSUT2'   SAY IT'S SYSUT2              UAT28520
         MVI   RETCODE,16          SET PROGRAM RETURN CODE 16           UAT28530
         B     PRINTERR            GO PRINT AND TERMINATE               UAT28540
         SPACE 2                                                        UAT28550
PRINTERR EQU   *                                                        UAT28560
         OI    FLAG2,#NOSHIFT      DO NOT SHIFT THIS MSG OVER           UAT28570
         BAL   R9,PRINTIT          GO PRINT THE ERROR MSG               UAT28580
         B     EPILOG              GO TERMINATE PROGRAM                 UAT28590
         EJECT                                                          UAT28600
*********************************************************************** UAT28610
*                                                                     * UAT28620
*        PROGRAM DATA CONSTANTS AND WORK AREAS                        * UAT28630
*                                                                     * UAT28640
*********************************************************************** UAT28650
         SPACE                                                          UAT28660
DOUBLE   DS    D                   DOUBLE WORD WORK AREA                UAT28670
SAVE     DC    18A(0)              PROGRAM SAVE AREA                    UAT28680
VTABLES  DC    V(TABLES)           VCON FOR TABLES CSECT                UAT28690
LLINES   DC    F'0'                NUMBER OF LINES LEFT ON PAGE         UAT28700
BLOCKCNT DC    F'0'                NUMBER OF BLOCKS IN DATA SET         UAT28710
BLOCKTOT DC    F'0'                NUMBER OF BLOCKS ON TAPE             UAT28720
BYTECNT  DC    F'0'                NUMBER OF BYTES IN DATA SET          UAT28730
TBYTECNT DC    F'0'                NUMBER OF BYTES ON TAPE              UAT28740
TOTFEET  DC    F'0'                LENGTH OF DATA AREA ON SYSUT1 TAPE   UAT28750
TOTFEET2 DC    F'0'                LENGTH OF DATA AREA ON SYSUT2 TAPE   UAT28760
DENSYS1  DC    F'1'                DENSITY (BPI) FOR SYSUT1 TAPE        UAT28770
DENSYS2  DC    F'1'                DENSITY (BPI) FOR SYSUT2 TAPE        UAT28780
FILECNT  DC    F'0'                FILE COUNTER                         UAT28790
PAGENUM  DC    F'0'                CURRENT PAGE NUMBER                  UAT28800
STARTBLK DC    F'0'                STARTING BLOCK NUMBER                UAT28810
LASTBLK  DC    F'0'                ENDING BLOCK NUMBER                  UAT28820
BLRECL   DC    F'0'                PRINT OPTION LRECL                   UAT28830
MXLABERR DC    F'0'                MAXIMUM ERROR LABEL COUNT            UAT28840
MXLABCNT DC    F'11'               MAXIMUM ERROR MESSAGE COUNT PLUS 1   UAT28850
PARMADDR DS    F                   PARM FIELD ADDRESS SAVE AREA         UAT28860
STACKPTR DC    A(STACK)            ADDRESS OF THE PROGRAM STACK         UAT28870
STACK    DS    20F                 PROGRAM STACK (80 BYTES)             UAT28880
CURLRECL DS    F                   CURRENT FILE'S LRECL                 UAT28890
CURBLKSI DS    F                   CURRENT FILE'S BLKSIZE               UAT28900
TIOTADDR DS    A                   TIOT ADDR AS RETURNED FROM EXTRACT   UAT28910
UCB1     DS    A                   UCB ADDR FOR SYSUT1 TAPE             UAT28920
UCB2     DS    A                   UCB ADDR FOR SYSUT2 TAPE             UAT28930
BUFADDR  DC    A(0)                I/O BUFFER ADDRESS                   UAT28940
ASTATBUF DC    A(0)                FILE STAT BUFFER ADDRESS             UAT28950
BSTATBUF DC    A(0)                CURRENT FILE STAT ENTRY ADDR         UAT28960
NSTATBUF EQU   3000                NUMBER OF STAT BUFFER ENTRIES        UAT28970
STATFILE EQU   0                   OFFSET TO FILE NUMBER                UAT28980
STATDSN  EQU   STATFILE+4          OFFSET TO DATA SET NAME              UAT28990
STATRECF EQU   STATDSN+17          OFFSET TO RECORD FORMAT              UAT29000
STATLREC EQU   STATRECF+4          OFFSET TO LRECL                      UAT29010
STATBLKS EQU   STATLREC+5          OFFSET TO BLKSIZE                    UAT29020
STATNBLK EQU   STATBLKS+5          OFFSET TO NUMBER OF BLOCKS           UAT29030
STATLEN  EQU   STATNBLK+6          OFFSET TO DATA LENGTH                UAT29040
WSTATBUF EQU   STATLEN+4           LENGTH OF EACH ENTRY                 UAT29050
LSTATBUF EQU   NSTATBUF*WSTATBUF   LENGTH OF STAT BUFFER                UAT29060
RECLENF  DS    0F                  INPUT BLOCK LENGTH - FULLWORD        UAT29070
RECLENH  DC    H'0'                INPUT BLOCK LENGTH - HI ORDER        UAT29070
RECLEN   DS    H                   INPUT BLOCK LENGTH                   UAT29070
FULLWORK DS    0F                                                     *  05265
         DC    H'0'                                                   *  05266
HALFWORK DC    H'0'                HALFWORD WORK AREA                 *  05267
MAXBLK   DC    F'0'                MAXIMUM BLOCK LENGTH                 UAT29080
MINBLK   DC    F'1200000'          MINIMUM BLOCK LENGTH                 UAT29090
LASTLEN  DC    F'-1'               LAST BLOCK LENGTH                    UAT29100
DBLKCT   DC    F'5'                #DUMPMAX OPTION BLOCK COUNTER        UAT29110
PBLKCT   DC    F'5'                #PRINTMAX OPTION BLOCK COUNTER       UAT29120
FILENO   DC    CL4' '              CURRENT FILE NUMBER                  UAT29130
CURRECFM DS    CL1                 CURRENT FILE'S RECORD FORMAT         UAT29140
PARM     DS    CL8                 PARM FIELD PROCESSOR WORK AREA       UAT29150
VOLSER1  DS    CL6                 INPUT JCL VOLUME SERIAL              UAT29160
VOLSER2  DS    CL6                 OUTPUT JCL VOLUME SERIAL             UAT29170
VOLSER2X DS    CL6                 OUTPUT TAPE VOLUME SERIAL            UAT29180
WORKAREA DS    CL9                 DUMP ROUTINE WORK AREA               UAT29190
CCW      DS    XL8                 SAVE AREA FOR BAD CCW                UAT29200
CSW      DS    XL7                 SAVE AREA FOR BAD CSW                UAT29210
SENSE    DS    XL1                 SAVE AREA FOR BAD IOB SENSE INFO     UAT29220
         SPACE 2                                                        UAT29230
OPTIONS  DS    0X                  OPTION FLAGS                         UAT29240
OPTIONS1 DC    AL1(#LIST)          OPTION FLAG BYTE 1                   UAT29250
#LIST    EQU   B'10000000'         LIST OPTION FLAG                     UAT29260
#COPY    EQU   B'01000000'         COPY OPTION FLAG                     UAT29270
#DUMP    EQU   B'00100000'         DUMP OPTION FLAG                     UAT29280
#DUMPLAB EQU   B'00010000'         DUMPLAB OPTION FLAG                  UAT29290
#DUMPALL EQU   B'00001000'         DUMPALL OPTION FLAG                  UAT29300
#BLOCKS  EQU   B'00000100'         BLOCKS OPTION FLAG                   UAT29310
#PRINT   EQU   B'00000010'         PRINT OPTION FLAG                    UAT29320
#SKIPLAB EQU   B'00000001'         SKIP COPYING LABELS, IF ANY          UAT29330
         SPACE                                                          UAT29340
OPTIONS2 DC    AL1(0)              OPTIONS FLAG BYTE 2                  UAT29350
#CRT     EQU   B'10000000'         CRT OUTPUT OPTION FLAG               UAT29360
#ATOE    EQU   B'01000000'         ASCII TO EBCDIC TRANSLATION          UAT29370
#ETOA    EQU   B'00100000'         EBCDIC TO ASCII TRANSLATION          UAT29380
#BYPASS  EQU   B'00010000'         BYPASS SYSUT2 LABEL PROCESSING       UAT29390
#NOFIX   EQU   B'00001000'         DO NOT CHANGE SYSUT1 LABEL INFO      UAT29400
#DMAX    EQU   B'00000100'         MAX BLOCKS TO DUMP SPECIFIED         UAT29410
#PMAX    EQU   B'00000010'         MAX RECORDS TO PRINT SPECIFIED       UAT29420
#LTM     EQU   B'00000001'         SKIP LEADING TAPE MARK               UAT29430
         SPACE                                                          UAT29440
OPTIONS3 DC    AL1(0)              OPTIONS FLAG BYTE 3                  UAT29450
#SKIPBAD EQU   B'10000000'         SKIP BAD BLOCKS ON INPUT VOLUME      UAT29460
#MXFILES EQU   B'01000000'         (MAXIMUM) NO. OF FILES TO PROCESS    UAT29470
#DEBUG1  EQU   B'00100000'         DEBUG OUTPUT FOR SYSUT1 I/O          UAT29480
#DEBUG2  EQU   B'00010000'         DEBUG OUTPUT FOR SYSUT2 I/O          UAT29490
#LABCHK  EQU   B'00001000'         READ VOLSER AND WTO DISPLAY ONLY     UAT29500
#35      EQU   B'00000100'         RESERVED                             UAT29510
#36      EQU   B'00000010'         RESERVED                             UAT29520
#37      EQU   B'00000001'         RESERVED                             UAT29530
         SPACE 2                                                        UAT29540
FLAG     DC    X'00'               PROGRAM FLAGS                        UAT29550
#SYSPRNT EQU   B'10000000'         SYSPRINT DD-STATEMENT PRESENT        UAT29560
#SYSUT1  EQU   B'01000000'         SYSUT1 DD-STATEMENT PRESENT          UAT29570
#SYSUT2  EQU   B'00100000'         SYSUT2 DD-STATEMENT PRESENT          UAT29580
#SL      EQU   B'00010000'         INPUT TAPE IS STD. LABEL             UAT29590
#TAPEMRK EQU   B'00001000'         LAST SYSUT1 I/O FOUND TAPEMARK       UAT29600
#ENDTAPE EQU   B'00000100'         END OF TAPE (2 TM'S OR EOV1)         UAT29610
#TAPEIND EQU   B'00000010'         TAPE INDICATE (END OF SYSUT2 TAPE)   UAT29620
#LTMPRES EQU   B'00000001'         LEADING TAPE MARK MAY BE PRESENT     UAT29630
         SPACE                                                          UAT29640
FLAG2    DC    X'00'               PROGRAM FLAGS                        UAT29650
#NOSHIFT EQU   B'10000000'         DO NOT SHIFT PRINT LINE              UAT29660
#LABREC  EQU   B'01000000'         PROCESSING LABEL RECORD              UAT29670
#PRTFLAG EQU   B'00100000'         PRINT "FILE: XXXX" FLAG              UAT29680
#EOV     EQU   B'00010000'         EOV LABEL RECORD FOUND               UAT29690
#AL      EQU   B'00001000'         INPUT TAPE HAS ASCII LABELS          UAT29700
#INITHDR EQU   B'00000100'         IEHINITT HDR1 LABEL FOUND            UAT29710
#CART1   EQU   B'00000010'         SYSUT1 IS CARTRIDGE TAPE             UAT29720
#CART2   EQU   B'00000001'         SYSUT2 IS CARTRIDGE TAPE             UAT29730
         SPACE                                                          UAT29740
FLAG3    DC    X'00'               PROGRAM FLAGS                        UAT29750
#IDRC1   EQU   B'10000000'         SYSUT1 FILE WRITTEN WITH IDRC ON     UAT29760
#SEN3480 EQU   B'01000000'         SENSE INFO IS IN 3480 FORMAT         UAT29770
         SPACE                                                          UAT29780
DEBUG    DC    CL8' '              DEBUG WORK AREA                      UAT29790
TEMPFLAG DC    X'00'               WORK BYTE                            UAT29800
RETCODE  DC    X'00'               PROGRAM RETURN CODE                  UAT29810
TAPEDEN  DC    X'00'               OUTPUT TAPE DENSITY FROM JFCB        UAT29820
DENSITY1 DS    CL4                 DENSITY MESSAGE                      UAT29830
DENSITY2 DS    CL4                 DENSITY MESSAGE                      UAT29840
LINE     DC    CL133' '            PRINT LINE                           UAT29850
TEMPLINE DC    CL133' '            PRINT LINE                           UAT29860
         SPACE 2                                                        UAT29870
         DS    0F,H'0'             WASTE A HALFWORD FOR ALIGNMENT       UAT29880
INIRG    DC    H'0',AL4(1)         INPUT TAPE IRG VALUES                UAT29890
         DS    0F,H'0'             WASTE A HALFWORD FOR ALIGNMENT       UAT29900
OUTIRG   DC    H'0',AL4(1)         OUTPUT TAPE IRG VALUES               UAT29910
*                |      |___DENOMINATOR   (SEE NOTE AFTER               UAT29920
*                |__________NUMERATOR      "DENTAB" TABLE)              UAT29930
         SPACE                                                          UAT29940
DEFDEN   DS    XL16                DEFAULT DENSITY INFORMATION          UAT29950
DENTAB   DS    0XL16               DEFAULT DENSITY INFO TABLE           UAT29960
*                 ___________________________JCL DCB=DEN=? CODE         UAT29970
*                |     ______________________MODESET CCW                UAT29980
*                |    |        ______________CHARACTER DENSITY          UAT29990
*                |    |       |          ____BINARY DENSITY             UAT30000
*                |    |       |         |          ___________SEE       UAT30010
*                |    |       |         |         |       ____NOTE      UAT30020
*                |    |       |         |         |      |    BELOW     UAT30030
DEN6250  DC    C'4',X'D3',CL4'6250',AL4(6250),AL2(3),AL4(10)            UAT30040
DEN1600  DC    C'3',X'C3',CL4'1600',AL4(1600),AL2(6),AL4(10)            UAT30050
DEN800   DC    C'2',X'CB',CL4' 800',AL4(0800),AL2(6),AL4(10)            UAT30060
DEN556   DC    C'1',X'73',CL4' 556',AL4(0556),AL2(6),AL4(10) ???        UAT30070
DEN200   DC    C'0',X'33',CL4' 200',AL4(0200),AL2(6),AL4(10) ???        UAT30080
DEN38K   DC    C'0',X'03',CL4' 38K',AL4(38000),AL2(3),AL4(100)          UAT30090
*                                                                       UAT30100
DENTABJ  EQU   0                   JCL DCB=DEN=? CODE                   UAT30110
DENTABM  EQU   1                   MODESET CCW CODE                     UAT30120
DENTABC  EQU   2                   DENSITY (CHARACTER)                  UAT30130
DENTABB  EQU   6                   DENSITY (BINARY)                     UAT30140
DENTABN  EQU   10                  IRG NUMERATOR                        UAT30150
DENTABD  EQU   12                  IRG DENOMINATOR                      UAT30160
*                                                                       UAT30170
*  NOTE:  DENTABB AND DENTABN IN THE TABLE ABOVE CONTAIN THE            UAT30180
*         NUMERATOR AND DENOMINATOR OF A FRACTION REPRESENTING          UAT30190
*         THE SIZE OF THE INNER RECORD GAP AT EACH DENSITY.  FOR        UAT30200
*         EXAMPLE, "AL2(3),AL4(10)" MEANS THAT THE IRG IS 3/10          UAT30210
*         (OR 0.3) INCHES LONG.                                         UAT30220
*                                                                       UAT30230
*  NOTE:  SINCE 3480 DOES NOT SUPPORT MULTIPLE DENSITIES, THE           UAT30240
*         MODESET CCW FOR DEN38K ABOVE IS SET TO NO-OP.                 UAT30250
*                                                                       UAT30260
         SPACE                                                          UAT30270
HEXTABLE EQU   *-C'0'              BACK UP SOME TO SAVE SPACE           UAT30280
         DC    C'0123456789ABCDEF' PRINT HEX TRANSLATE TABLE            UAT30290
         SPACE                                                          UAT30300
* 3420 SENSE BYTE 0 DESCRIPTIVE INFORMATION                             UAT30310
SENSETB2 DC    X'80',CL21'COMMAND REJECT'                               UAT30320
         DC    X'40',CL21'INTERVENTION REQUIRED'                        UAT30330
         DC    X'20',CL21'BUS OUT CHECK'                                UAT30340
         DC    X'10',CL21'EQUIPMENT CHECK'                              UAT30350
         DC    X'08',CL21'DATA CHECK'                                   UAT30360
         DC    X'04',CL21'OVERRUN'                                      UAT30370
         DC    X'02',CL21'WORD COUNT ZERO'                              UAT30380
         DC    X'01',CL21'DATA CONVERT CHECK'                           UAT30390
* 3428 SENSE BYTE 0 DESCRIPTIVE INFORMATION                             UAT30400
SENSETB8 DC    X'80',CL21'COMMAND REJECT'                               UAT30410
         DC    X'40',CL21'INTERVENTION REQUIRED'                        UAT30420
         DC    X'20',CL21'BUS OUT CHECK'                                UAT30430
         DC    X'10',CL21'EQUIPMENT CHECK'                              UAT30440
         DC    X'08',CL21'DATA CHECK'                                   UAT30450
         DC    X'04',CL21'OVERRUN'                                      UAT30460
         DC    X'02',CL21'DEFERRED UNIT CHECK'                          UAT30470
         DC    X'01',CL21'ASSIGNED ELSEWHERE'                           UAT30480
SENSEMLN EQU   21                  LENGTH OF MSGS IN ABOVE TABLE        UAT30490
SENSELEN EQU   22                  LENGTH OF EACH ENTRY ABOVE           UAT30500
SENSENTM EQU   8                   NUMBER OF ENTRIES IN ABOVE TABLE     UAT30510
         SPACE 2                                                        UAT30520
#SENSE   DS    0XL32               SENSE INFORMATION FIELD              UAT30530
#SENSE0  DC    X'00'                 SENSE BYTE 0                       UAT30540
#SENSE1  DC    X'00'                 SENSE BYTE 1                       UAT30550
#SENSE2  DC    X'00'                 SENSE BYTE 2                       UAT30560
#SENSE3  DC    X'00'                 SENSE BYTE 3                       UAT30570
#SENSE4  DC    X'00'                 SENSE BYTE 4                       UAT30580
#SENSE5  DC    X'00'                 SENSE BYTE 5                       UAT30590
#SENSE6  DC    X'00'                 SENSE BYTE 6                       UAT30600
#SENSE7  DC    X'00'                 SENSE BYTE 7                       UAT30610
#SENSE8  DC    X'00'                 SENSE BYTE 8                       UAT30620
#SENSE9  DC    X'00'                 SENSE BYTE 9                       UAT30630
#SENSE10 DC    X'00'                 SENSE BYTE 10                      UAT30640
         DC    XL21'00'            REMAINING 21 SENSE BYTES             UAT30650
         SPACE                                                          UAT30660
OPTLIST  DS    0F                  UATAPE PROGRAM OPTION LIST           UAT30670
@A  DC  CL8'LIST    ',AL1(0),AL3(OPTIONS1),AL4(0),AL1(0,255)            UAT30680
@B  DC  CL8'DUMP    ',AL1(0),AL3(OPTIONS1),AL4(0),AL1(#DUMP,255)        UAT30690
@C  DC  CL8'DUMPMAX ',AL1(1),AL3(OPTIONS2),AL4(0),AL1(#DMAX,255)        UAT30700
@D  DC  CL8'DUMPLAB ',AL1(0),AL3(OPTIONS1),AL4(0),AL1(#DUMPLAB,255)     UAT30710
@E  DC  CL8'DUMPALL ',AL1(0),AL3(OPTIONS1),AL4(0),AL1(#DUMPALL,255)     UAT30720
@F  DC  CL8'COPY    ',AL1(0),AL3(OPTIONS1),AL4(0),AL1(#COPY,255)        UAT30730
@G  DC  CL8'BLOCKS  ',AL1(0),AL3(OPTIONS1),AL4(0),AL1(#BLOCKS,255)      UAT30740
@H  DC  CL8'PRINT   ',AL1(0),AL3(OPTIONS1),AL4(0),AL1(#PRINT,255)       UAT30750
@I  DC  CL8'SKIPLAB ',AL1(0),AL3(OPTIONS1),AL4(0),AL1(#SKIPLAB,255)     UAT30760
@J  DC  CL8'PRINTMAX',AL1(1),AL3(OPTIONS2),AL4(0),AL1(#PMAX,255)        UAT30770
@K  DC  CL8'CRT     ',AL1(0),AL3(OPTIONS2),AL4(0),AL1(#CRT,255)         UAT30780
@L  DC  CL8'ATOE    ',AL1(0),AL3(OPTIONS2),AL4(0),AL1(#ATOE,255-#ETOA)  UAT30790
@M  DC  CL8'ETOA    ',AL1(0),AL3(OPTIONS2),AL4(0),AL1(#ETOA,255-#ATOE)  UAT30800
@N  DC  CL8'BYPASS  ',AL1(0),AL3(OPTIONS2),AL4(0),AL1(#BYPASS,255)      UAT30810
@O  DC  CL8'VERBATIM',AL1(0),AL3(OPTIONS2),AL4(0),AL1(#NOFIX,255)       UAT30820
@P  DC  CL8'LTM     ',AL1(0),AL3(OPTIONS2),AL4(0),AL1(#LTM,255)         UAT30830
@Q  DC  CL8'MAXFILES',AL1(1),AL3(OPTIONS3),AL4(0),AL1(#MXFILES,255)     UAT30840
@R  DC  CL8'SKIPBAD ',AL1(0),AL3(OPTIONS3),AL4(0),AL1(#SKIPBAD,255)     UAT30850
@S  DC  CL8'DEBUG1  ',AL1(0),AL3(OPTIONS3),AL4(0),AL1(#DEBUG1,255)      UAT30860
@T  DC  CL8'DEBUG2  ',AL1(0),AL3(OPTIONS3),AL4(0),AL1(#DEBUG2,255)      UAT30870
@U  DC  CL8'LABCHECK',AL1(0),AL3(OPTIONS3),AL4(0),AL1(#LABCHK,255)      UAT30880
         SPACE                                                          UAT30890
DUMPMAX  EQU   @C                                                       UAT30900
PRINTMAX EQU   @J                                                       UAT30910
LENOPT   EQU   @B-@A               LIST ENTRY LENGTH                    UAT30920
NUMOPTS  EQU   (*-OPTLIST)/LENOPT                                       UAT30930
         SPACE                                                          UAT30940
*  THE FOLLOWING ARE EQUATES FOR OFFSETS INTO 'OPTLIST' ABOVE:          UAT30950
OPTNAME  EQU   0                   OPTION NAME OFFSET                   UAT30960
OPTTYPE  EQU   8                   OPTION TYPE (0=KEYWORD,1=VARIABLE)   UAT30970
OPTKEYWD EQU     0                 --KEYWORD TYPE OPTION                UAT30980
OPTVAR   EQU     1                 --VARIABLE TYPE OPTION               UAT30990
OPTADDR  EQU   8                   OPTION BYTE ADDRESS                  UAT31000
OPTVALUE EQU   12                  OPTION VALUE                         UAT31010
OPTON    EQU   16                  OPTION BYTE OR-FLAG                  UAT31020
OPTOFF   EQU   17                  OPTION BYTE AND-FLAG                 UAT31030
         SPACE 3                                                        UAT31040
MAXFILES EQU   @Q+OPTVALUE         MAX NUMBER OF FILES                  UAT31050
         SPACE                                                          UAT31060
HEADING1 DC    CL133'1U A T A P E   U T I L I T Y   P R O G R A M      XUAT31070
                   VERSION 1.81'                                        UAT31080
         ORG   HEADING1+72                                              UAT31090
@MONTH   DC    C'XX/'                                                   UAT31100
@DAY     DC    C'XX/'                                                   UAT31110
@YEAR    DC    C'XX'                                                    UAT31120
         ORG   HEADING1+84                                              UAT31130
TIME     DC    X'4021207A20207A2020'  TIME - HH:MM:SS                   UAT31140
         ORG   HEADING1+110                                             UAT31150
         DC    C'PAGE '                                                 UAT31160
PAGE     DC    CL4'0001'           PRINTED PAGE NUMBER                  UAT31170
         ORG                                                            UAT31180
         SPACE                                                          UAT31190
*  DAYS IN MONTH COUNT LIST                                             UAT31200
@JAN     DC    H'31'                                                    UAT31210
@FEB     DC    H'28'                                                    UAT31220
@MAR     DC    H'31'                                                    UAT31230
@APR     DC    H'30'                                                    UAT31240
@MAY     DC    H'31'                                                    UAT31250
@JUN     DC    H'30'                                                    UAT31260
@JUL     DC    H'31'                                                    UAT31270
@AUG     DC    H'31'                                                    UAT31280
@SEP     DC    H'30'                                                    UAT31290
@OCT     DC    H'31'                                                    UAT31300
@NOV     DC    H'30'                                                    UAT31310
@DEC     DC    H'31'                                                    UAT31320
         LTORG ,                                                        UAT31330
         EJECT                                                          UAT31340
*********************************************************************** UAT31350
*                                                                     * UAT31360
*      DATA CONTROL BLOCKS                                            * UAT31370
*                                                                     * UAT31380
*********************************************************************** UAT31390
         SPACE                                                          UAT31400
         PRINT NOGEN                                                    UAT31410
SYSPRINT DCB   LRECL=133,RECFM=FA,BLKSIZE=133,DDNAME=SYSPRINT,         XUAT31420
               MACRF=PM,DSORG=PS                                        UAT31430
         SPACE 2                                                        UAT31440
SYSUT1   DCB   DSORG=PS,DEVD=TA,DDNAME=SYSUT1,MACRF=EXCP,EXLST=EXLST    UAT31450
         SPACE 2                                                        UAT31460
SYSUT2   DCB   DSORG=PS,DEVD=TA,DDNAME=SYSUT2,MACRF=EXCP,EXLST=EXLST    UAT31470
         SPACE 3                                                        UAT31480
*        REGEQU                    REGISTER EQUATES                     UAT31490
R0       EQU   0                                                        UAT31500
R1       EQU   1                                                        UAT31510
R2       EQU   2                                                        UAT31520
R3       EQU   3                                                        UAT31530
R4       EQU   4                                                        UAT31540
R5       EQU   5                                                        UAT31550
R6       EQU   6                                                        UAT31560
R7       EQU   7                                                        UAT31570
R8       EQU   8                                                        UAT31580
R9       EQU   9                                                        UAT31590
R10      EQU   10                                                       UAT31600
R11      EQU   11                                                       UAT31610
R12      EQU   12                                                       UAT31620
R13      EQU   13                                                       UAT31630
R14      EQU   14                                                       UAT31640
R15      EQU   15                                                       UAT31650
         SPACE 3                                                        UAT31660
*  WRITE TO OPERATOR CONTROL PARAMETER LIST                             UAT31670
WTO1     WTO   'TTTT ON UUU IS LL VVVVVV',ROUTCDE=(3,5),MF=L            UAT31680
WTO1TYPE EQU   WTO1+4              TAPE OR CART                         UAT31690
WTO1UNIT EQU   WTO1+4+8            UNIT NAME/ADDRESS                    UAT31700
WTO1LAB  EQU   WTO1+4+15           NL OR SL OR AL                       UAT31710
WTO1VOL  EQU   WTO1+4+18           VOLUME SERIAL                        UAT31720
         TITLE 'INPUT/OUTPUT BLOCKS'                                    UAT31730
*********************************************************************** UAT31740
*                                                                     * UAT31750
*     IOB1                INPUT/OUTPUT BLOCK FOR SYSUT1               * UAT31760
*                                                                     * UAT31770
*********************************************************************** UAT31780
         SPACE                                                          UAT31790
IOB1     DS    0F                                                       UAT31800
         DC    X'0200'             IOBFLAG1 AND IOBFLAG2                UAT31810
IOB1SNS  DC    X'0000'             IOBSENS1 AND IOBSENS2                UAT31820
         DC    A(ECB1)             IOBECBCC AND IOBECBPT (ECB STUFF)    UAT31830
         DC    X'00'               IOBFLAG3                             UAT31840
         DC    0XL7'00'            IOBCSW                               UAT31850
IOB1CSW  DC    XL5'00'             FIRST PART OF CSW                    UAT31860
IOB1RES  DC    X'0000'             RESIDUAL IN CSW                      UAT31870
         DC    X'00'               IOBSIOCC                             UAT31880
IOB1CCW  DS    XL3                 IOBSTART (CHANNEL PGM ADDR)          UAT31890
         DC    X'00'               RESERVED                             UAT31900
         DC    AL3(SYSUT1)         IOBDCBPT                             UAT31910
         DC    XL4'00'             IOBRESTR                             UAT31920
         DC    X'0000'             IOBINCAM                             UAT31930
         DC    X'0000'             IOBERRCT                             UAT31940
         DC    2F'0'               ??????????                           UAT31950
         SPACE 2                                                        UAT31960
ECB1     DC    F'0'                SYSUT1 EVENT CONTROL BLOCK           UAT31970
         SPACE 2                                                        UAT31980
*********************************************************************** UAT31990
*                                                                     * UAT32000
*      IOB2                  INPUT/OUTPUT BLOCK FOR SYSUT2            * UAT32010
*                                                                     * UAT32020
*********************************************************************** UAT32030
         SPACE                                                          UAT32040
IOB2     DS    0F                                                       UAT32050
         DC    X'0200'             IOBFLAG1 AND IOBFLAG2                UAT32060
IOB2SNS  DC    X'0000'             IOBSENS1 AND IOBSENS2                UAT32070
         DC    A(ECB2)             IOBECBCC AND IOBECBPT (ECB STUFF)    UAT32080
         DC    X'00'               IOBFLAG3                             UAT32090
         DC    0XL7'00'            IOBCSW                               UAT32100
IOB2CSW  DC    XL5'00'             FIRST PART OF CSW                    UAT32110
IOB2RES  DC    X'0000'             RESIDUAL IN CSW                      UAT32120
         DC    X'00'               IOBSIOCC                             UAT32130
IOB2CCW  DS    XL3                 IOBSTART (CHANNEL PGM ADDR)          UAT32140
         DC    X'00'               RESERVED                             UAT32150
         DC    AL3(SYSUT2)         IOBDCBPT                             UAT32160
         DC    XL4'00'             IOBRESTR                             UAT32170
         DC    X'0000'             IOBINCAM                             UAT32180
         DC    X'0000'             IOBERRCT                             UAT32190
         DC    2F'0'               ??????????                           UAT32200
         SPACE 2                                                        UAT32210
ECB2     DC    F'0'                SYSUT2 EVENT CONTROL BLOCK           UAT32220
         TITLE 'UATAPE CHANNEL PROGRAMS'                                UAT32230
*********************************************************************** UAT32240
*                                                                     * UAT32250
*     CHANNEL PROGRAM AREA                                            * UAT32260
*                                                                     * UAT32270
*********************************************************************** UAT32280
         SPACE                                                          UAT32290
*  SENSE CCW -- UP TO 32 BYTES OF DATA RETURNED IN "#SENSE"             UAT32300
         SPACE                                                          UAT32310
SENSECCW CCW   4,#SENSE,#SILI,32        READ BASIC SENSE                UAT32320
         SPACE 2                                                        UAT32330
*  READ CCW -- UP TO 65536 BYTES OF DATA RETURNED                       UAT32340
         SPACE                                                          UAT32350
READCCW  CCW   2,0,#SILI,X'FFFF'        READ DATA BLOCK                 UAT32360
READADDR EQU   READCCW+1                  INPUT BUFFER ADDRESS          UAT32370
READLEN  EQU   READCCW+6                  LENGTH OF READ OPERATION      UAT32380
         SPACE 2                                                        UAT32390
*  WRITE CCW -- SINGLE DATA BLOCK WRITTEN                               UAT32400
         SPACE                                                          UAT32410
WRITECCW CCW   1,0,#CC+#SILI,0          WRITE DATA BLOCK                UAT32420
         CCW   3,0,#SILI,1              NO OPERATION (NO-OP)            UAT32430
WRITEADR EQU   WRITECCW+1                 OUTPUT BUFFER ADDRESS         UAT32440
WRITELEN EQU   WRITECCW+6                 OUTPUT BLOCK LENGTH           UAT32450
         SPACE 2                                                        UAT32460
*  REWIND CCW -- REWINDS TAPE TO LOAD POINT                             UAT32470
         SPACE                                                          UAT32480
REWINDCC CCW   7,0,#SILI,1              REWIND                          UAT32490
         SPACE 2                                                        UAT32500
*  WRITE TAPE MARK CCW -- WRITES SINGLE TAPE MARK                       UAT32510
         SPACE                                                          UAT32520
WTMCCW   CCW   31,0,#SILI,1             WRITE TAPE MARK                 UAT32530
         SPACE 2                                                        UAT32540
*  MODE SET CCW -- SETS TAPE DRIVE DENSITY                              UAT32550
         SPACE                                                          UAT32560
MODECCW  CCW   0,0,#SILI,1              MODESET                         UAT32570
         SPACE 2                                                        UAT32580
*  FORWARD-SPACE-BLOCK CCW -- SKIPS OVER BAD BLOCKS                     UAT32590
         SPACE                                                          UAT32600
FSBCCW   CCW   X'37',0,#CC+#SILI,1      FOWARD SPACE BLOCK              UAT32610
         SPACE                                                          UAT32620
*  LOAD DISPLAY CCW'S FOR 3480 TAPE DRIVES                              UAT32630
DISPCCW  CCW   X'9F',MSG58,#SILI,17                                     UAT32640
         SPACE 2                                                        UAT32650
*  JOBFILE CONTROL BLOCK                                                UAT32660
         SPACE                                                          UAT32670
EXLST    DC    X'87',AL3(JFCB)     EXIT LIST FOR SYSUT1 AND SYSUT2      UAT32680
         SPACE                                                          UAT32690
JFCB     DS    CL176               JOB FILE CONTROL BLOCK               UAT32700
         TITLE 'PROGRAM MESSAGES'                                       UAT32710
*********************************************************************** UAT32720
*                                                                     * UAT32730
*     PROGRAM MESSAGES                                                * UAT32740
*                                                                     * UAT32750
*********************************************************************** UAT32760
         SPACE                                                          UAT32770
MSG1     DC    C'-       NORMAL END-OF-TAPE FOUND -- UATAPE TERMINATED XUAT32780
               NORMALLY.'                                               UAT32790
MSG2     DC    C'-       SYSUT1 TAPE CONTAINS STANDARD LABELS.'         UAT32800
MSG3     DC    C'-       SYSUT1 TAPE DOES NOT CONTAIN STANDARD LABELS.' UAT32810
MSG4     DC    C'-VOL1:  INPUT VOLUME SERIAL:   XXXXXX       OWNER:'    UAT32820
MSG4V    EQU   31                  OFFSET TO "XXXXXX" IN MSG4           UAT32830
MSG4O    EQU   62                  OFFSET TO OWNR IN MSG4               UAT32840
MSG5     DC    C'        OUTPUT VOLUME SERIAL:  XXXXXX'                 UAT32850
MSG5V    EQU   31                  OFFSET TO "XXXXXX" IN MSG5           UAT32860
MSG6     DC    C'        SYSUT1 WRITE RING IS IN.'                      UAT32870
MSG6W    EQU   29                  OFFSET TO "IN" IN MSG6               UAT32880
MSG7     DC    C'        ORIGINAL SYSUT2 VOLUME SERIAL:  XXXXXX'        UAT32890
MSG7S    EQU   40                  OFFSET TO "XXXXXX" IN MSG7           UAT32900
MSG8     DC    C'0------ TAPE MARK ------------------------------------XUAT32910
               --------------------------'                              UAT32920
MSG9     DC    C'0       UATAPE OPTIONS IN EFFECT:'                     UAT32930
MSG9O    EQU   *-MSG9+2            OFFSET TO MSG LIST                   UAT32940
MSG10    DC    C'        OUTPUT TAPE DENSITY:   XXXX BPI'               UAT32950
MSG10D   EQU   31                  OFFSET TO "XXXX" IN MSG10            UAT32960
MSG11    DC    C'0HDR1:  DATA SET NAME:  12345678901234567   VOLUME SERXUAT32970
               IAL:'                                                    UAT32980
MSG11D   EQU   24                  OFFSET TO DSN IN MSG11               UAT32990
MSG11V   EQU   62                  OFFSET TO VOLSER IN MSG11            UAT33000
MSG12    DC    C'        FILE NUMBER:    XXXX                VOLUME SEQXUAT33010
               UENCE:'                                                  UAT33020
MSG12F   EQU   24                  OFFSET TO FILSEQ IN MSG12            UAT33030
MSG12S   EQU   62                  OFFSET TO VOLSEQ IN MSG12            UAT33040
MSG12#   DC    C'        GENERATION:     XXXX                VERSION:'  UAT33050
MSG12G   EQU   24                  OFFSET TO GENERA IN MSG12#           UAT33060
MSG12V   EQU   62                  OFFSET TO VERS IN MSG12#             UAT33070
MSG13    DC    C'        CREATION DATE:  YY.DDD              EXPIRATIONXUAT33080
                DATE:  YY.DDD'                                          UAT33090
MSG13C   EQU   24                  OFFSET TO CRDT IN MSG13              UAT33100
MSG13E   EQU   62                  OFFSET TO EXDT IN MSG13              UAT33110
MSG13#   DC    C'        SYSTEM CODE:'                                  UAT33120
MSG13S   EQU   24                  OFFSET TO SYSTEM CODE IN MSG13#      UAT33130
MSG15    DC    C'0HDR2:  LRECL:          XXXXX               BLKSIZE:'  UAT33140
MSG15L   EQU   24                  OFFSET TO LRECL IN MSG15             UAT33150
MSG15B   EQU   62                  OFFSET TO BLKSIZE IN MSG15           UAT33160
MSG15#   DC    C'        RECFM:          X                   DENSITY:  XUAT33170
                       X (XXXX BPI)'                                    UAT33180
MSG15R   EQU   24                  OFFSET TO "X" IN MSG15#              UAT33190
MSG15D1  EQU   62                  OFFSET TO "U" IN MSG15#              UAT33200
MSG15D2  EQU   65                  OFFSET TO "NNNN" IN MSG15#           UAT33210
MSG16    DC    C'        CREATING JOB:   XXXXXXXX/XXXXXXXX   RECORDING XUAT33220
               TECH:'                                                   UAT33230
MSG16J   EQU   24                  OFFSET TO JB/SP IN MSG16             UAT33240
MSG16R   EQU   62                  OFFSET TO TECH IN MSG16              UAT33250
MSG18    DC    C'        FILE XXXX CONTAINS YYYYYY BLOCKS.   MAXIMUM=ZZXUAT33260
               ZZZ.  MINIMUM=UUUUU.'                                    UAT33270
MSG18F   EQU   13                  OFFSET TO "XXXX" IN MSG18            UAT33280
MSG18D   EQU   27                  OFFSET TO "YYYYY" IN MSG18           UAT33290
MSG18X   EQU   52                  OFFSET TO "ZZZZZ" IN MSG18           UAT33300
MSG18N   EQU   68                  OFFSET TO "UUUUU" IN MSG18           UAT33310
MSG19    DC    C'0EOF1:  NUMBER OF BLOCKS:'                             UAT33320
MSG19N   EQU   26                  OFFSET TO BLKCT IN MSG19             UAT33330
MSG24    DC    C'-FILE XXXX   BLOCK YYYYY   LENGTH ZZZZZ'               UAT33340
MSG24F   EQU   6                   OFFSET TO "XXXX" IN MSG24            UAT33350
MSG24B   EQU   19                  OFFSET TO "YYYYY" IN MSG24           UAT33360
MSG24L   EQU   34                  OFFSET TO "ZZZZZ" IN MSG24           UAT33370
MSG25    DC    C'        BLOCKS XXXXXX TO YYYYYY LENGTH ZZZZZ'          UAT33380
MSG25B   EQU   15                  OFFSET TO "XXXXXX" IN MSG25          UAT33390
MSG25T   EQU   25                  OFFSET TO "YYYYYY" IN MSG25          UAT33400
MSG25L   EQU   39                  OFFSET TO "ZZZZZ" IN MSG25           UAT33410
MSG26    DC    C'        BLOCK  XXXXXX           LENGTH ZZZZZ'          UAT33420
MSG26B   EQU   15                  OFFSET TO "XXXXXX" IN MSG26          UAT33430
MSG26L   EQU   39                  OFFSET TO "ZZZZZ" IN MSG26           UAT33440
MSG27    DC    C'0       SYSUT1 DENSITY = XXXX BPI.          DATA LENGTXUAT33450
               H = XXXX FEET.'                                          UAT33460
MSG27D   EQU   25                  OFFSET TO "XXXX" IN MSG27            UAT33470
MSG27B   EQU   58                  OFFSET TO LENGTH IN MSG27            UAT33480
MSG28    DC    C'0       --UATAPE STATISTICS--        SYSUT1'           UAT33490
MSGS1    EQU   43                                                       UAT33500
MSGS2    EQU   65                                                       UAT33510
MSG29    DC    C'0       VOLUME SERIAL:'                                UAT33520
MSG30    DC    C'        TEMPORARY READ ERRORS:'                        UAT33530
MSG31    DC    C'        TEMPORARY WRITE ERRORS:'                       UAT33540
MSG32    DC    C'        PERMANENT READ ERRORS:'                        UAT33550
MSG33    DC    C'        PERMANENT WRITE ERRORS:'                       UAT33560
MSG34    DC    C'        NUMBER OF ERASE GAPS:'                         UAT33570
MSG35    DC    C'        CLEANER ACTIONS:'                              UAT33580
MSG36    DC    C'        START I/O COUNT:'                              UAT33590
MSG37    DC    C'        TAPE DRIVE:'                                   UAT33600
MSG38    DC    C'        NUMBER OF NOISE BLOCKS:'                       UAT33610
MSG39    DC    C'        APPROX. LENGTH (FEET):'                        UAT33620
MSG391   DC    C'        TOTAL DATA BYTES:'                             UAT33630
MSG40    DC    C'        SYSUT2 DENSITY = XXXX BPI.          DATA LENGTXUAT33640
               H = XXXX FEET.'                                          UAT33650
MSG40D   EQU   25                  OFFSET TO "XXXX" IN MSG40            UAT33660
MSG40B   EQU   58                  OFFSET TO LENGTH IN MSG40            UAT33670
MSG41    DC    C'-FILE:  XXXX =========================================XUAT33680
               ========================================================XUAT33690
               ======================='                                 UAT33700
MSG41F   EQU   8                   OFFSET TO FILENUMBER IN MSG41        UAT33710
MSG42    DC    C'0****** DENSITY OMITTED ON SYSUT2 DD-STATEMENT.  DEFAUXUAT33720
               LT OF XXXX BPI ASSUMED.'                                 UAT33730
MSG42D   EQU   60                  OFFSET TO BPI                        UAT33740
MSG43    DC    C'0****** NULL DATA FILE -- NO DATA FOUND -- FILE:  '    UAT33750
MSG43F   EQU   *-MSG43             OFFSET TO FILENUMBER IN MSG43        UAT33760
MSG44    DC    C'0****** UNIDENTIFIABLE LABEL RECORD.  FIRST 80 BYTES PXUAT33770
               RINTED ON NEXT LINE.'                                    UAT33780
MSG45    DC    C'0       FILE    DATA SET NAME        RECFM   LRECL   BXUAT33790
               LKSIZE   BLOCKS   LENGTH'                                UAT33800
MSG46    DC    C'        ----    -------------        -----   -----   -XUAT33810
               ------   ------   ------'                                UAT33820
MSG47    DC    C'1                          UATAPE FILE SUMMARY FOR'    UAT33830
MSG471   EQU   *-MSG47+1           OFFSET TO FIRST VOLSER               UAT33840
MSG47M   EQU   MSG471+7            OFFSET TO "AND"                      UAT33850
MSG472   EQU   MSG47M+4            OFFSET TO SECOND VOLSER              UAT33860
MSG48    DC    C'0****** UNIDENTIFIABLE LABEL RECORD.  MESSAGES SUPPRESXUAT33870
               SED FOR THIS FILE.'                                      UAT33880
MSG49    DC    C'-       SYSUT1 TAPE CONTAINS STANDARD ASCII LABELS'    UAT33890
MSG50    DC    C'0 ***** DUMP OUTPUT SUSPENDED UNTIL END-OF-FILE *****' UAT33900
MSG51    DC    C'        LEADING TAPE MARK ON SYSUT1 TAPE SKIPPED'      UAT33910
MSG52    DC    C'        LEADING TAPE MARK ON SYSUT1 TAPE -- NON-STANDAXUAT33920
               RD OR NO LABELS ASSUMED'                                 UAT33930
MSG53    DC    C'0****** PRINT SUSPENDED UNTIL END-OF-FILE ******'      UAT33940
MSG54    DC    C'        ALL TAPE LABELS WILL BE OMITTED ON THE OUTPUT XUAT33950
               TAPE.'                                                   UAT33960
MSG55    DC    C'-****** UATAPE TERMINATING PROCESSING OF THIS TAPE:  XXUAT33970
               XXXX FILES PROCESSED'                                    UAT33980
MSG55C   EQU   53                  OFFSET TO FILE COUNTER IN MSG55      UAT33990
MSG56    DC    C'0****** THE HDR1 LABEL INDICATES THAT THIS TAPE HAS BEXUAT34000
               EN LABELED WITH IEHINITT, BUT HAS NOT YET BEEN USED.'    UAT34010
MSG57    DC    C'0****** WARNING:  THE BLOCK COUNT FROM THE EOF1 LABEL XUAT34020
               DOES NOT MATCH THE ACTUAL BLOCK COUNT ON THE TAPE.'      UAT34030
MSG58    DC    B'01010000'                                              UAT34040
MSG58A   DC    CL8'-UATAPE-'                                            UAT34050
MSG58B   DC    CL8' VOLSER '                                            UAT34060
MSG59    DC    C'0       (IDRC COMPRESSION IS ON, DATA LENGTH VALUE MAYXUAT34070
               BE UNRELIABLE)'                                          UAT34080
MSG60    DC    C'0       SYSUT1 IDRC DATA COMPRESSION IS OFF.'          UAT34090
MSG60A   EQU   40                  OFFSET TO WORD "OFF"                 UAT34100
MSG61    DC    C'        SYSUT1 WRITE PROTECTION IS ENABLED.'           UAT34110
MSG61A   EQU   35                  OFFSET TO WORD "ENABLED"             UAT34120
MSG62    DC    C'        FILE XXXX CONTAINS YYY,YYY,YYY,YYY BYTES OF DAXUAT34130
               TA.'                                                     UAT34140
MSG62F   EQU   13                  OFFSET TO "XXXX" IN MSG62            UAT34150
MSG62D   EQU   27                  OFFSET TO "YYYYY" IN MSG62           UAT34160
MSG63    DC    C' SYSUT1 DEBUG BEFORE CCW XXXXXXXXXXXXXXXX'             UAT34170
MSG63A   EQU   25                  OFFSET TO XXXX                       UAT34180
MSG64    DC    C' SYSUT1 DEBUG AFTER  CSW XXXX'                         UAT34190
MSG64A   EQU   25                  OFFSET TO XXXX                       UAT34200
MSG65    DC    C' SYSUT2 DEBUG BEFORE CCW XXXXXXXXXXXXXXXX'             UAT34210
MSG65A   EQU   25                  OFFSET TO XXXX                       UAT34220
MSG66    DC    C' SYSUT2 DEBUG AFTER  CSW XXXX'                         UAT34230
MSG66A   EQU   25                  OFFSET TO XXXX                       UAT34240
MSG67    DC    C'0       (NOTE: TOTAL DATA BYTES VALUE DOES NOT INCLUDEXUAT34250
                TAPE LABEL RECORDS)'                                    UAT34260
MSG68    DC    C'0****** UATAPE - NORMAL END OF EXECUTION'              UAT34270
         TITLE 'PROGRAM ERROR MESSAGES'                                 UAT34280
*********************************************************************** UAT34290
*                                                                     * UAT34300
*   ERROR MESSAGES                                                    * UAT34310
*                                                                     * UAT34320
*********************************************************************** UAT34330
         SPACE                                                          UAT34340
ERROR1   DC    C'-****** ERROR 1:  NO SYSUT1 DD-STATEMENT WAS FOUND.'   UAT34350
ERROR2   DC    C'-****** ERROR 2:  SYSUT1 DATA SET WOULD NOT OPEN.'     UAT34360
ERROR3   DC    C'-****** ERROR 3:  NOT ENOUGH MEMORY AVAILABLE TO RUN UXUAT34370
               ATAPE.  PLEASE INCREASE REGION SIZE AND RESUBMIT.'       UAT34380
ERROR4   DC    C'-****** ERROR 4:  NO SYSUT2 DD-STATEMENT WAS FOUND.'   UAT34390
ERROR5   DC    C'-****** ERROR 5:  SYSUT2 DATA SET WOULD NOT OPEN.'     UAT34400
ERROR6   DC    C'-****** ERROR 6:  VOLUME SERIAL ON SYSUT2 TAPE DOES NOXUAT34410
               T MATCH VOLUME SERIAL PARAMETER IN JCL:'                 UAT34420
ERROR7   DC    C'0                 TAPE=XXXXXX            JCL=YYYYYY'   UAT34430
ERR7T    EQU   23                  OFFSET TO "XXXXXX" IN ERROR7         UAT34440
ERR7J    EQU   45                  OFFSET TO "YYYYYY" IN ERROR7         UAT34450
ERROR8   DC    C'-****** ERROR 8:  SYSUT2 TAPE DOES NOT HAVE A STANDARDXUAT34460
                LABEL.  LABEL THE TAPE AND RERUN.'                      UAT34470
ERROR9   DC    C'-****** ERROR 9:  PERMANENT I/O ERROR ON SYSUT1'       UAT34480
ERROR10  DC    C'0****** CSW=XXXXXXXXXXXXXX   CCW=ZZZZZZZZZZZZZZZZ'     UAT34490
ERR10C   EQU   12                  OFFSET TO "XX" IN ERROR10            UAT34500
ERR10W   EQU   33                  OFFSET TO "ZZZZ" IN ERROR10          UAT34510
ERROR11  DC    C'-****** ERROR 11:  PERMANENT I/O ERROR ON SYSUT2'      UAT34520
ERROR12  DC    C'-****** ERROR 12: RAN OUT OF TAPE ON SYSUT2 DURING COPXUAT34530
               Y OPERATION.  RESUBMIT WITH LONGER TAPE.'                UAT34540
ERROR13  DC    C' ****** ERROR 13: INVALID PARM FIELD PARAMETER.  QUESTXUAT34550
               ION MARK INDICATES POSITION ABOVE.'                      UAT34560
ERROR14  DC    C'-****** ERROR 14: UATAPE DOES NOT SUPPORT SPECIFIED OUXUAT34570
               TPUT TAPE DENSITY.'                                      UAT34580
ERROR15  DC    C'-****** ERROR 15: SYSUT2 TAPE IS FILE PROTECTED.  INSEXUAT34590
               RT A WRITE RING AND RESUBMIT.'                           UAT34600
ERROR16  DC    C'-****** ERROR 16: XXXXXX DOES NOT DEFINE A MAGNETIC TAXUAT34610
               PE DEVICE.'                                              UAT34620
ERR16D   EQU   18                  OFFSET TO "XXXXXX" IN ERROR16        UAT34630
         SPACE 2                                                        UAT34640
ERROR17  DC    C' ****** SENSE='                                        UAT34650
ERR17B   EQU   14                  OFFSET TO SENSE INFO                 UAT34660
ERR18    DC    C' ****** ERROR OCCURRED WHILE PROCESSING LABEL RECORD FXUAT34670
               OR FILE NUMBER '                                         UAT34680
ERR18F   EQU   *-ERR18             OFFSET TO FILE NUMBER IN ERR18       UAT34690
ERR19    DC    C' ****** ERROR OCCURRED WHILE PROCESSING RECORD ###### XUAT34700
               OF FILE '                                                UAT34710
ERR19B   EQU   47                  OFFSET TO BLOCK # IN ERR19           UAT34720
ERR19F   EQU   *-ERR19             OFFSET TO FILE # IN ERR19            UAT34730
ERROR20  DC    C' ****** FORWARD SPACING OVER BAD RECORD ....'          UAT34740
ERROR21  DC    C' ****** ERROR OCCURRED WHILE PROCESSING VOLUME LABEL RXUAT34750
               ECORD (OR FIRST RECORD ON TAPE)'                         UAT34760
         TITLE 'SYSTEM CONTROL BLOCK EQUATES'                           UAT34770
*********************************************************************** UAT34780
*                                                                     * UAT34790
*      TIOT                  TASK INPUT/OUTPUT TABLE                  * UAT34800
*                                                                     * UAT34810
*********************************************************************** UAT34820
         SPACE                                                          UAT34830
TIOTJOBN EQU   0                   JOB NAME FIELD                       UAT34840
TIOTJOBS EQU   8                   JOB STEP FIELD                       UAT34850
TIOTPROC EQU   16                  CATALOGUED PROCEDURE STEP FIELD      UAT34860
TIOTDDEN EQU   24                  OFFSET TO 1ST DD-ENTRY               UAT34870
TIOTLEN  EQU   0                   DD-ENTRY LENGTH OFFSET               UAT34880
TIOTDDNM EQU   4                   DDNAME OFFSET IN DD-ENTRY            UAT34890
TIOTFSRT EQU   17                  UCB ADDR OFFSET IN DD-ENTRY          UAT34900
         SPACE 2                                                        UAT34910
*********************************************************************** UAT34920
*                                                                     * UAT34930
*       BIT DEFINITION SYMBOLS                                        * UAT34940
*                                                                     * UAT34950
*********************************************************************** UAT34960
         SPACE                                                          UAT34970
#BIT0    EQU   B'10000000'                                              UAT34980
#BIT1    EQU   B'01000000'                                              UAT34990
#BIT2    EQU   B'00100000'                                              UAT35000
#BIT3    EQU   B'00010000'                                              UAT35010
#BIT4    EQU   B'00001000'                                              UAT35020
#BIT5    EQU   B'00000100'                                              UAT35030
#BIT6    EQU   B'00000010'                                              UAT35040
#BIT7    EQU   B'00000001'                                              UAT35050
         SPACE 2                                                        UAT35060
*  CCW FLAG BITS                                                        UAT35070
#CD      EQU   #BIT0               DATA CHAINING                        UAT35080
#CC      EQU   #BIT1               COMMAND CHAINING                     UAT35090
#SILI    EQU   #BIT2               SUPPRESS INCORRECT LENGTH INDICATION UAT35100
#SKIP    EQU   #BIT3               SKIP DATA TRANSFER                   UAT35110
#PCI     EQU   #BIT4               CHANNEL PROGRAM CONTROLLED INTERRUPT UAT35120
#IDA     EQU   #BIT5               CCW SPECIFIES FIRST IDAW             UAT35130
#SUSPEND EQU   #BIT6               SUSPEND CCW                          UAT35140
         TITLE 'UATAPE TABLES CSECT'                                    UAT35150
*********************************************************************** UAT35160
*                                                                     * UAT35170
*    SPECIAL CSECT TO CONTAIN VARIOUS TABLES                          * UAT35180
*                                                                     * UAT35190
*        PRTTABLE  --  TRANSLATE TABLE FOR DUMP ROUTINE               * UAT35200
*        IECTSASA  --  TRANSLATE TABLE FOR EBCDIC TO ASCII            * UAT35210
*        IECTRASA  --  TRANSLATE TABLE FOR ASCII  TO EBCDIC           * UAT35220
*                                                                     * UAT35230
*********************************************************************** UAT35240
TABLES   CSECT                                                          UAT35250
PRTTABLE DC    256C'.'             PRINTABLE CHARACTER TABLE            UAT35260
         ORG   PRTTABLE+C' '       BLANK                                UAT35270
         DC    C' '                                                     UAT35280
         ORG   PRTTABLE+C'.'                                            UAT35290
         DC    C'.<(+|&&'                                               UAT35300
         ORG   PRTTABLE+C'!'                                            UAT35310
         DC    C'!$*);¬-/'                                              UAT35320
         ORG   PRTTABLE+C','                                            UAT35330
         DC    C',%_>?'                                                 UAT35340
         ORG   PRTTABLE+C':'                                            UAT35350
         DC    C':#@''="'                                               UAT35360
         ORG   PRTTABLE+C'a'       WARNING:  THIS TABLE CONTAINS        UAT35370
         DC    C'abcdefghi'        LOWER CASE CHARACTERS                UAT35380
         ORG   PRTTABLE+C'j'                                            UAT35390
         DC    C'jklmnopqr'                                             UAT35400
         ORG   PRTTABLE+C's'                                            UAT35410
         DC    C'stuvwxyz'                                              UAT35420
         ORG   PRTTABLE+C'A'                                            UAT35430
         DC    C'ABCDEFGHI'                                             UAT35440
         ORG   PRTTABLE+C'J'                                            UAT35450
         DC    C'JKLMNOPQR'                                             UAT35460
         ORG   PRTTABLE+C'S'                                            UAT35470
         DC    C'STUVWXYZ'                                              UAT35480
         ORG   PRTTABLE+C'0'                                            UAT35490
         DC    C'0123456789'                                            UAT35500
         ORG   ,                                                        UAT35510
         EJECT                                                          UAT35520
*********************************************************************** UAT35530
*                                                                     * UAT35540
*    TRANSLATE TABLES FOR:                                            * UAT35550
*                                                                     * UAT35560
*        EBCDIC TO ASCII    --  IECTSASA                              * UAT35570
*        ASCII  TO EBCDIC   --  IECTRASA                              * UAT35580
*                                                                     * UAT35590
*********************************************************************** UAT35600
         SPACE                                                          UAT35610
IECTSASA DS    0XL256              EBCDIC TO ASCII TRANSLATE TABLE      UAT35620
         SPACE                                                          UAT35630
*                 0 1 2 3 4 5 6 7 8 9 A B C D E F                       UAT35640
         DC    X'000102031A091A7F1A1A1A0B0C0D0E0F' 0                    UAT35650
         DC    X'101112131A0A080018191A1A1C1D1E1F' 1                    UAT35660
         DC    X'1A1A1A1A1A0A171B1A1A1A1A1A050607' 2                    UAT35670
         DC    X'1A1A161A1A1A1A041A1A1A1A14151A1A' 3                    UAT35680
         DC    X'201A1A1A1A1A1A1A1A5D1A2E3C282B7C' 4                    UAT35690
         DC    X'261A1A1A1A1A1A1A1A1A21242A293B7E' 5                    UAT35700
         DC    X'2D2F1A1A1A1A1A1A1A1A1A2C255F3E3F' 6                    UAT35710
         DC    X'1A1A1A1A1A1A1A1A1A5B3A2340273D22' 7                    UAT35720
         DC    X'1A6162636465666768691A7B1A1A1A1A' 8                    UAT35730
         DC    X'1A6A6B6C6D6E6F7071721A7D1A1A1A1A' 9                    UAT35740
         DC    X'1A1A737475767778797A1A1A1A1A1A1A' A                    UAT35750
         DC    X'5E1A1A1A1A1A1A1A1A1A1A1A1A1A1A60' B                    UAT35760
         DC    X'1A4142434445464748491A1A1A1A1A5C' C                    UAT35770
         DC    X'1A4A4B4C4D4E4F5051521A1A1A1A1A1A' D                    UAT35780
         DC    X'1A1A535455565758595A1A1A1A1A1A1A' E                    UAT35790
         DC    X'303132333435363738391A1A1A1A1A1A' F                    UAT35800
         SPACE                                                          UAT35810
*                                                                       UAT35820
IECTRASA DS    0XL256              ASCII TO EBCDIC TRANSLATE TABLE      UAT35830
         SPACE                                                          UAT35840
*                 0 1 2 3 4 5 6 7 8 9 A B C D E F                       UAT35850
         DC    X'00010203372D2E2F1605250B0C0D0E0F' 0                    UAT35860
         DC    X'101112133C3D322618193F271C1D1E1F' 1                    UAT35870
         DC    X'405A7F7B5B6C507D4D5D5C4E6B604B61' 2                    UAT35880
         DC    X'F0F1F2F3F4F5F6F7F8F97A5E4C7E6E6F' 3                    UAT35890
         DC    X'7CC1C2C3C4C5C6C7C8C9D1D2D3D4D5D6' 4                    UAT35900
         DC    X'D7D8D9E2E3E4E5E6E7E8E979CF49B06D' 5                    UAT35910
         DC    X'BF818283848586878889919293949596' 6                    UAT35920
         DC    X'979899A2A3A4A5A6A7A8A98B4F9B5F07' 7                    UAT35930
         DC    X'00010203372D2E2F1605250B0C0D0E0F' 8                    UAT35940
         DC    X'101112133C3D322618193F271C1D1E1F' 9                    UAT35950
         DC    X'405A7F7B5B6C507D4D5D5C4E6B604B61' A                    UAT35960
         DC    X'F0F1F2F3F4F5F6F7F8F97A5E4C7E6E6F' B                    UAT35970
         DC    X'7CC1C2C3C4C5C6C7C8C9D1D2D3D4D5D6' C                    UAT35980
         DC    X'D7D8D9E2E3E4E5E6E7E8E979CF49B06D' D                    UAT35990
         DC    X'BF818283848586878889919293949596' E                    UAT36000
         DC    X'979899A2A3A4A5A6A7A8A98B4F9B5F07' F                    UAT36010
         TITLE 'UATAPE PROGRAM CONTROL BLOCK DSECTS'                    UAT36020
*********************************************************************** UAT36030
*                                                                     * UAT36040
*     VOL1       VOLUME LABEL RECORD DSECT                            * UAT36050
*                                                                     * UAT36060
*********************************************************************** UAT36070
         SPACE                                                          UAT36080
VOL1D    DSECT                                                          UAT36090
VOL1VOL1 DC    CL4'VOL1'           VOL1 IDENTIFIER                      UAT36100
VOL1SER  DS    CL6                 VOLUME SERIAL NUMBER                 UAT36110
         DS    CL1                 RESERVED                             UAT36120
VOL1VTOC DS    CL10                VTOC POINTER (DIRECT ACCESS ONLY)    UAT36130
         DS    CL10                RESERVED                             UAT36140
         DS    CL10                RESERVED                             UAT36150
VOL1OWNR DS    CL10                OWNER NAME AND ADDRESS CODE          UAT36160
         DS    CL29                RESERVED                             UAT36170
         SPACE 3                                                        UAT36180
*********************************************************************** UAT36190
*                                                                     * UAT36200
*     HDR1                 DATA SET LABEL 1                           * UAT36210
*                                                                     * UAT36220
*********************************************************************** UAT36230
         SPACE                                                          UAT36240
HDR1D    DSECT                                                          UAT36250
HDR1HDR1 DC    CL4'HDR1'           HDR1 IDENTIFIER                      UAT36260
HDR1DSN  DS    CL17                DATA SET NAME                        UAT36270
HDR1SER  DS    CL6                 DATA SET SERIAL NUMBER               UAT36280
HDR1VSEQ DS    CL4                 VOLUME SEQUENCE NUMBER               UAT36290
HDR1DSEQ DS    CL4                 DATA SET SEQUENCE NUMBER             UAT36300
HDR1GEN  DS    CL4                 GENERATION NUMBER                    UAT36310
HDR1VER  DS    CL2                 VERSION NUMBER                       UAT36320
HDR1CRDT DS    CL6                 CREATION DATE                        UAT36330
HDR1EXDT DS    CL6                 EXPIRATION DATE                      UAT36340
HDR1SEC  DS    CL1                 SECURITY BYTE                        UAT36350
HDR1BLKC DS    CL6                 DATA SET BLOCK COUNT                 UAT36360
HDR1SYS  DS    CL13                SYSTEM CODE                          UAT36370
         DS    CL7                 RESERVED                             UAT36380
         SPACE 3                                                        UAT36390
*********************************************************************** UAT36400
*                                                                     * UAT36410
*     EOV1                 END OF VOLUME LABEL 1                      * UAT36420
*                                                                     * UAT36430
*********************************************************************** UAT36440
         SPACE                                                          UAT36450
EOV1D    DSECT                                                          UAT36460
EOV1EOV1 DC    CL4'EOV1'           EOV1 IDENTIFIER                      UAT36470
EOV1DSN  DS    CL17                DATA SET NAME                        UAT36480
EOV1SER  DS    CL6                 DATA SET SERIAL NUMBER               UAT36490
EOV1VSEQ DS    CL4                 VOLUME SEQUENCE NUMBER               UAT36500
EOV1DSEQ DS    CL4                 DATA SET SEQUENCE NUMBER             UAT36510
EOV1GEN  DS    CL4                 GENERATION NUMBER                    UAT36520
EOV1VER  DS    CL2                 VERSION NUMBER                       UAT36530
EOV1CRDT DS    CL6                 CREATION DATE                        UAT36540
EOV1EXDT DS    CL6                 EXPIRATION DATE                      UAT36550
EOV1SEC  DS    CL1                 SECURITY BYTE                        UAT36560
EOV1BLKC DS    CL6                 DATA SET BLOCK COUNT                 UAT36570
EOV1SYS  DS    CL13                SYSTEM CODE                          UAT36580
         DS    CL7                 RESERVED                             UAT36590
         SPACE 3                                                        UAT36600
*********************************************************************** UAT36610
*                                                                     * UAT36620
*     EOF1                 END OF FILE LABEL 1                        * UAT36630
*                                                                     * UAT36640
*********************************************************************** UAT36650
         SPACE                                                          UAT36660
EOF1D    DSECT                                                          UAT36670
EOF1EOF1 DC    CL4'EOF1'           EOF1 IDENTIFIER                      UAT36680
EOF1DSN  DS    CL17                DATA SET NAME                        UAT36690
EOF1SER  DS    CL6                 DATA SET SERIAL NUMBER               UAT36700
EOF1VSEQ DS    CL4                 VOLUME SEQUENCE NUMBER               UAT36710
EOF1DSEQ DS    CL4                 DATA SET SEQUENCE NUMBER             UAT36720
EOF1GEN  DS    CL4                 GENERATION NUMBER                    UAT36730
EOF1VER  DS    CL2                 VERSION NUMBER                       UAT36740
EOF1CRDT DS    CL6                 CREATION DATE                        UAT36750
EOF1EXDT DS    CL6                 EXPIRATION DATE                      UAT36760
EOF1SEC  DS    CL1                 SECURITY BYTE                        UAT36770
EOF1BLKC DS    CL6                 DATA SET BLOCK COUNT                 UAT36780
EOF1SYS  DS    CL13                SYSTEM CODE                          UAT36790
         DS    CL7                 RESERVED                             UAT36800
         SPACE 3                                                        UAT36810
*********************************************************************** UAT36820
*                                                                     * UAT36830
*      HDR2                DATA SET LABEL 2                           * UAT36840
*                                                                     * UAT36850
*********************************************************************** UAT36860
         SPACE                                                          UAT36870
HDR2D    DSECT                                                          UAT36880
HDR2HDR2 DC    CL4'HDR2'           HDR2 IDENTIFIER                      UAT36890
HDR2RECF DS    CL1                 RECORD FORMAT                        UAT36900
HDR2BLKL DS    CL5                 BLOCK LENGTH                         UAT36910
HDR2LREC DS    CL5                 RECORD LENGTH                        UAT36920
HDR2DEN  DS    CL1                 TAPE DENSITY                         UAT36930
HDR2DSP  DS    CL1                 DATA SET POSITION                    UAT36940
HDR2JOBI DS    CL17                JOB/JOBSTEP IDENTIFICATION           UAT36950
HDR2TTRC DS    CL2                 TAPE RECORDING TECHNIQUE             UAT36960
HDR2CONC DS    CL1                 CONTROL CHARACTERS                   UAT36970
         DS    CL1                 RESERVED                             UAT36980
HDR2BLKF DS    CL1                 RECORD FORMAT BLOCK ATTRIBUTE        UAT36990
         DS    CL41                RESERVED                             UAT37000
         SPACE 3                                                        UAT37010
*********************************************************************** UAT37020
*                                                                     * UAT37030
*      EOV2                END OF VOLUME LABEL 2                      * UAT37040
*                                                                     * UAT37050
*********************************************************************** UAT37060
         SPACE                                                          UAT37070
EOV2D    DSECT                                                          UAT37080
EOV2EOV2 DC    CL4'EOV2'           EOV2 IDENTIFIER                      UAT37090
EOV2RECF DS    CL1                 RECORD FORMAT                        UAT37100
EOV2BLKL DS    CL5                 BLOCK LENGTH                         UAT37110
EOV2LREC DS    CL5                 RECORD LENGTH                        UAT37120
EOV2DEN  DS    CL1                 TAPE DENSITY                         UAT37130
EOV2DSP  DS    CL1                 DATA SET POSITION                    UAT37140
EOV2JOBI DS    CL17                JOB/JOBSTEP IDENTIFICATION           UAT37150
EOV2TTRC DS    CL2                 TAPE RECORDING TECHNIQUE             UAT37160
EOV2CC   DS    CL1                 CONTROL CHARACTERS                   UAT37170
         DS    CL1                 RESERVED                             UAT37180
EOV2BLKF DS    CL1                 RECORD FORMAT BLOCK ATTRIBUTE        UAT37190
         DS    CL41                RESERVED                             UAT37200
         SPACE 3                                                        UAT37210
*********************************************************************** UAT37220
*                                                                     * UAT37230
*      EOF2                END OF FILE LABEL 2                        * UAT37240
*                                                                     * UAT37250
*********************************************************************** UAT37260
         SPACE                                                          UAT37270
EOF2D    DSECT                                                          UAT37280
EOF2EOF2 DC    CL4'EOF2'           EOF2 IDENTIFIER                      UAT37290
EOF2RECF DS    CL1                 RECORD FORMAT                        UAT37300
EOF2BLKL DS    CL5                 BLOCK LENGTH                         UAT37310
EOF2LREC DS    CL5                 RECORD LENGTH                        UAT37320
EOF2DEN  DS    CL1                 TAPE DENSITY                         UAT37330
EOF2DSP  DS    CL1                 DATA SET POSITION                    UAT37340
EOF2JOBI DS    CL17                JOB/JOBSTEP IDENTIFICATION           UAT37350
EOF2TTRC DS    CL2                 TAPE RECORDING TECHNIQUE             UAT37360
EOF2CC   DS    CL1                 CONTROL CHARACTERS                   UAT37370
         DS    CL1                 RESERVED                             UAT37380
EOF2BLKF DS    CL1                 RECORD FORMAT BLOCK ATTRIBUTE        UAT37390
         DS    CL41                RESERVED                             UAT37400
         SPACE 3                                                        UAT37410
*********************************************************************** UAT37420
*                                                                     * UAT37430
*       DCB               DATA CONTROL BLOCK DSECT                    * UAT37440
*                                                                     * UAT37450
*********************************************************************** UAT37460
         SPACE                                                          UAT37470
         PRINT NOGEN                                                    UAT37480
         DCBD  DEVD=TA,DSORG=PS                                         UAT37490
LRECL    EQU   DCBLRECL-IHADCB     LOGICAL RECORD LENGTH                UAT37500
BLKSIZE  EQU   DCBBLKSI-IHADCB     BLOCK SIZE                           UAT37510
RECFM    EQU   DCBRECFM-IHADCB     RECORD FORMAT                        UAT37520
DDNAME   EQU   DCBDDNAM-IHADCB     DD NAME                              UAT37530
OFLGS    EQU   DCBOFLGS-IHADCB     DCB OPEN FLAGS                       UAT37540
         SPACE 3                                                        UAT37550
*********************************************************************** UAT37560
*                                                                     * UAT37570
*      JFCB                  JOB FILE CONTROL BLOCK DSECT             * UAT37580
*                                                                     * UAT37590
*********************************************************************** UAT37600
         SPACE                                                          UAT37610
JFCBD    DSECT                                                          UAT37620
JFCBDSNM DS    CL44                DATA SET NAME                        UAT37630
JFCBELNM DS    CL8                 ELEMENT NAME OR RELATIVE GENERATION  UAT37640
JFCBTSDM DS    XL1                 JOB MANAGEMENT/DATA MGT I/F          UAT37650
JFCBDSCB DS    XL3                 TTR OF FORMAT 1 DSCB                 UAT37660
JFCFCBID DS    XL4                 FCB IMAGE IDENTIFICATION             UAT37670
         DS    XL6                 RESERVED                             UAT37680
JFCBLTYP DS    XL1                 LABEL TYPE                           UAT37690
*              .1.. ....           AL                                   UAT37700
*              X... ....           RESERVED BIT                         UAT37710
*              ...1 ....           BLP                                  UAT37720
*              .... 1.1.           SUL                                  UAT37730
*              .1.. 1...           AUL                                  UAT37740
*              .... .1..           NSL                                  UAT37750
*              .... ..1.           SL                                   UAT37760
*              .... ...1           NL                                   UAT37770
*              ..1. ...1           LTM                                  UAT37780
JFCBOTTR DS    XL3                 DASD, MOD DATA SET                   UAT37790
         ORG   JFCBOTTR                                                 UAT37800
JFCBUFOF DS    XL1                 TAPE DATA SET BUFFER OFFSET          UAT37810
JFCBFLSQ DS    XL2                 MAGNETIC TAPE, FILE SEQUENCE NO.     UAT37820
         ORG   JFCBFLSQ                                                 UAT37830
JFCFUNC  DS    XL1                 FUNC PARAMETER FOR 3505/3525         UAT37840
         ORG                                                            UAT37850
JFCBVLSQ DS    XL2                 VOLUME SEQUENCE NUMBER               UAT37860
JFCBMASK DS    XL8                 DATA MANAGEMENT MASK                 UAT37870
JFCBCRDT DS    XL3                 CREATION DATE                        UAT37880
JFCBXPDT DS    XL3                 EXPIRATION DATE                      UAT37890
JFCBIND1 DS    XL1                 INDICATOR BYTE 1                     UAT37900
*              11.. ....           RELEASE EXTERNAL STORAGE             UAT37910
*              ..11 ....           DATA SET HAS BEEN LOCATED            UAT37920
*              .... 11..           NEW VOLUME ADDED TO DATA SET         UAT37930
*              .... ..1.           DATA SET IS MEMBER OF GENER. DATA GR UAT37940
*              .... ...1           DATA SET IS MEMBER OF PDS            UAT37950
JFCBIND2 DS    XL1                 INDICATOR BYTE 2                     UAT37960
*              01.. ....           OLD DATA SET                         UAT37970
*              10.. ....           MOD DATA SET                         UAT37980
*              11.. ....           NEW DATA SET                         UAT37990
*              ..XX ....           DATA SET SECURITY                    UAT38000
*              ..01 ....           PASSWORD IS REQUIRED TO READ/WRITE   UAT38010
*              ..11 ....           PASSWORD IS REQUIRED TO WRITE        UAT38020
*              .... 1...           SHARED                               UAT38030
*              .... .1..           DELETE JFCB BEFORE ALLOC GEN. DATA   UAT38040
*              .... ..1.           STORAGE VOLUME REQUESTED             UAT38050
*              .... ...1           TEMPORARY DATA SET                   UAT38060
JFCBUFNO DS    XL1                 NUMBER OF BUFFERS                    UAT38070
JFCBFTEK DS    XL1                 BUFFERING TECHNIQUE                  UAT38080
JFCBHIAR EQU   JFCBFTEK                                                 UAT38090
JFCBFLAN EQU   JFCBFTEK                                                 UAT38100
JFCBUFL  DS    XL2                 BUFFER LENGTH                        UAT38110
JFCEROPT DS    XL1                 ERROR OPTION                         UAT38120
JFCTRTCH DS    XL1                 TAPE RECORDING TECHNIQUE (7-TRK)     UAT38130
*              0010 0011           E   EVEN PARITY                      UAT38140
*              0011 1011           T   EOD/EBCDIC TRANSLATION           UAT38150
*              0001 0011           C   DATA CONVERSION                  UAT38160
*              0010 1011           ET  EVEN PARITY AND TRANSLATION      UAT38170
JFCKENLE EQU   JFCTRTCH            DIRECT ACCESS KEY LENGTH             UAT38180
JFCMODE  EQU   JFCTRTCH            UNIT RECORD MODE OF OPERATION        UAT38190
JFCSTACK EQU   JFCMODE             UNIT RECORD STACKER SELECTION        UAT38200
JFCPRTSP EQU   JFCTRTCH            PRINT SPACING                        UAT38210
JFCCODE  EQU   JFCTRTCH            PAPER TAPE CONVERSION CODE           UAT38220
JFCDEN   DS    XL1                 TAPE DENSITY                         UAT38230
*                                  CODE  7-TRACK 9-TRACK                UAT38240
*                                  ----  ------- -------                UAT38250
*              0000 0000           DENSITY OMITTED ON DDCARD            UAT38260
*              0000 0011             0   200 BPI    -                   UAT38270
*              0100 0011             1   556 BPI    -                   UAT38280
*              1000 0011             2   800 BPI  800 BPI               UAT38290
*              1100 0011             3     -     1600 BPI               UAT38300
*              1101 0011             4     -     6250 BPI               UAT38310
JFCDOMIT EQU   B'00000000'                                              UAT38320
JFCD800  EQU   B'10000011'                                              UAT38330
JFCD1600 EQU   B'11000011'                                              UAT38340
JFCD6250 EQU   B'11010011'                                              UAT38350
JFCLIMCT DS    XL3                 BDAM:  SEARCH LIMIT                  UAT38360
JFCDSORG DS    XL2                 DATA SET ORGANIZATION                UAT38370
*        BYTE 1                                                         UAT38380
*              1... ....           IS   INDEXED SEQUENTIAL              UAT38390
*              .1.. ....           PS   PHYSICAL SEQUENTIAL             UAT38400
*              ..1. ....           DA   DIRECT ACCESS                   UAT38410
*              ...X XX..                RESERVED                        UAT38420
*              .... ..1.           PO   PARTITIONED                     UAT38430
*              .... ...1            U   UNMOVABLE                       UAT38440
*        BYTE 2                                                         UAT38450
*              1... ....           GS   GRAPHICS                        UAT38460
*              .XXX XXXX                RESERVED                        UAT38470
JFCRECFM DS    XL1                 RECORD FORMAT                        UAT38480
*              10.. ....           F   FIXED                            UAT38490
*              01.. ....           V   VARIABLE                         UAT38500
*              11.. ....           U   UNDEFINED                        UAT38510
*              001. ....           D   VARIABLE (ASCII)                 UAT38520
*              ..1. ....           T   TRACK OVERFLOW                   UAT38530
*              ...1 ....           B   BLOCKED                          UAT38540
*              .... 1...           S   FIXED - STANDARD OR VARIABLE SPA UAT38550
*              .... .10.           A   ANSI CONTROL CHARACTERS          UAT38560
*              .... .01.           M   MACHINE CODE CONTROL CHARACTERS  UAT38570
*              .... .00.               NO CONTROL CHARACTERS            UAT38580
*              .... ...0               ALWAYS ZERO                      UAT38590
JFCOPTCD DS    XL1                 OPTION CODES                         UAT38600
JFCBLKSI DS    XL2                 MAXIMUM BLOCK SIZE                   UAT38610
JFCLRECL DS    XL2                 LOGICAL RECORD LENGTH                UAT38620
JFCNCP   DS    XL1                 NUMBER OF CHANNEL PROGRAMS           UAT38630
JFCNTM   DS    XL1                 NUMBER OF TRACKS MASTER INDEX        UAT38640
JFCRKP   DS    XL2                 RELATIVE KEY POSITION                UAT38650
JFCCYLOF DS    XL1                 CYLINDER OVERFLOW TRACKS             UAT38660
JFCDBUFN DS    XL1                 RESERVED                             UAT38670
JFCINTVL DS    XL1                 QTAM: INTENTIONAL DELAY              UAT38680
JFCCPRI  DS    XL1                 QTAM: PRIORITY                       UAT38690
JFCSOWA  DS    XL2                 QTAM: LENGTH OF USER WORK AREA       UAT38700
         ORG   JFCCPRI                                                  UAT38710
JFCOUTLI DS    XL3                 SMF - SYSOUT LIMIT                   UAT38720
         ORG                                                            UAT38730
         DS    XL1                 RESERVED                             UAT38740
JFCBNVOL DS    XL1                 NUMBER OF VOLUME SERIAL NUMBERS      UAT38750
JFCBVOLS DS    XL30                VOLUME SERIAL NUMBERS                UAT38760
JFCBEXTL DS    XL1                 RESERVED                             UAT38770
JFCBEXAD DS    XL3                 TTR OF FIRST JFCB EXTENSION BLK      UAT38780
JFCBPQTY DS    XL3                 PRIMARY QUANTITY OF DASD REQUIRED    UAT38790
JFCBCTRI DS    XL1                 SPACE PARAMETERS                     UAT38800
JFCBSQTY DS    XL3                 SECONDARY QUANTITY OF DASD REQUIRED  UAT38810
JFCFLGS1 DS    XL1                 FLAG BYTE                            UAT38820
JFCBDQTY DS    XL3                 QUANTITY OF DASD REQUIRED FOR DIRECT UAT38830
JFCBSPNM DS    XL3                 ADDR WHERE JFCB CYLINDERS SPLIT      UAT38840
JFCBABST DS    XL2                 TTR OF 1ST TRK TO BE ALLOCATED       UAT38850
JFCBSBNM DS    XL3                 ADDR OF JFCB WHERE SPACE ALLOC       UAT38860
JFCBDRLH DS    XL3                 AVERAGE DATA BLOCK LENGTH            UAT38870
JFCBVLCT DS    XL1                 VOLUME COUNT                         UAT38880
JFCBSPTN DS    XL1                 NO. TRKS/CYL SPLIT CYLINDER          UAT38890
         SPACE 2                                                        UAT38900
*********************************************************************** UAT38910
*                                                                     * UAT38920
*      UCB                   UNIT CONTROL BLOCK                       * UAT38930
*                                                                     * UAT38940
*********************************************************************** UAT38950
         SPACE                                                          UAT38960
UCB      DSECT                                                          UAT38970
         IEFUCBOB                                                       UAT38980
#UCBNAME EQU   UCBNAME-UCB         DEVICE NAME (ADDRESS)                UAT38990
#UCBTYP  EQU   UCBTYP-UCB          DEVICE TYPE                          UAT39000
#UCBXTN  EQU   UCBXTNB-UCB         UCB EXTENSION ADDRESS                UAT39010
#UCBTR   EQU   UCBTR-UCBMT         NUMBER OF TEMP READ ERRORS           UAT39020
#UCBTW   EQU   UCBTW-UCBMT         NUMBER OF TEMP WRITE ERRORS          UAT39030
#UCBSIO  EQU   UCBSIO-UCBMT        NUMBER OF SIO OPERATIONS             UAT39040
#UCBPR   EQU   UCBPR-UCBMT         NUMBER OF PERM READ ERRORS           UAT39050
#UCBPW   EQU   UCBPW-UCBMT         NUMBER OF PERM WRITE ERRORS          UAT39060
#UCBNB   EQU   UCBNB-UCBMT         NUMBER OF NOISE BLOCKS               UAT39070
#UCBERG  EQU   UCBERG-UCBMT        NUMBER OF ERASE GAPS                 UAT39080
#UCBCLN  EQU   UCBCLN-UCBMT        NUMBER OF CLEANER ACTIONS            UAT39090
         END                                                            UAT39100
