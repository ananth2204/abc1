         MACRO
&LAB     ENDEVAL
.*
.* THIS MACRO IS ONE OF A RELATED SET OF MACROS WHICH ENGINEER THE
.* SELECTED EXECUTION OF CODE DEPENDING ON THE CONTENTS OF A FIELD.
.*
.* THE GENERAL STRUCTURE IS AS FOLLOWS -
.*    EVALUATE OPCODE,OP1(,OP2.REP.TYPE.LTH)
.*      WHEN   OP2REST,OP2REST
.*      WHEN   OP2REST-OP2REST,OP2REST
.*      OTHERWSE
.*    ENDEVAL
.*
.* CURRENT LABEL GENERATION NUMBER FOR EACH POSSIBLE DEPTH
         GBLA  &ON(16)
.* CURRENT END LABEL NUMBER FOR EACH POSSIBLE DEPTH
         GBLA  &OE(16)
.* CURRENT DEPTH OF OPTION NESTING (1 TO 16)
         GBLA  &OD
.* OPTELSE INDICATOR FOR EACH POSSIBLE DEPTH
         GBLB  &OELSE(16)
.* OPTION INDICATOR FOR EACH POSSIBLE DEPTH
         GBLB  &OPTN(16)
.* OPT INDICATOR FOR EACH POSSIBLE DEPTH
         GBLB  &OPTI(16)
.*
.IF0     AIF   (T'&LAB EQ 'O').END0
&LAB     EQU   *
.END0    ANOP
.IF0A    AIF   (&OD NE 0).END0A
         MNOTE 16,'UNMATCHED ENDOPT'
         MEXIT
.END0A   ANOP
.IF1     AIF   (&OD LE 16).END1
         MNOTE 16,'MAX OPTION NESTING OF 16 EXCEEDED'
         AGO   .REDUCE
.END1    ANOP
.* SET OPTION INDICATOR OFF
&OPTN(&OD) SETB (0)
.IF3     AIF   ((&OELSE(&OD)) EQ (1)).END3
.* WHEN NO OPTELSE CLAUSE NEED CURRENT GENERATION NUMBER LABEL
@D&OD.N&ON(&OD) EQU   *
.END3    ANOP
&OELSE(&OD) SETB (0)
&OPTI(&OD) SETB (0)
.* SET LABEL FOR STRAIGHT END EXIT
@D&OD.E&OE(&OD) EQU   *
.REDUCE  ANOP
.* REDUCE DEPTH COUNT
&OD      SETA  &OD-1
         MEND
