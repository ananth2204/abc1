/* REXX ------------------------------------------------------------ */
/*                                                                   */
/* ----------------------------------------------------------------- */

ARG PARMS

  /* TRACE R */

PARSE VAR  PARMS "=" X1 X2

ADDRESS TSO ISPEXEC VGET ZDLVOL
ADDRESS TSO ISPEXEC VGET ZDLCAT

IF ZDLCAT = 0 THEN
   VOLPARM = ""
ELSE
   VOLPARM = "VOLSER="ZDLVOL

IF X1 <>  "" THEN DO
  ADDRESS TSO ISPEXEC "CONTROL ERRORS RETURN"
  ADDRESS TSO ISPEXEC "SELECT  CMD(OS2" PARMS ") NEWAPPL(OS)"
  EXIT (0)
END

NBR_PARMS = WORDS(PARMS)

IF NBR_PARMS = 1 THEN DO
  X_DSN = "DSN=" || WORD(PARMS,1)
  ADDRESS TSO ISPEXEC "CONTROL ERRORS RETURN"
  ADDRESS TSO ISPEXEC "SELECT  CMD(OS2" X_DSN ") NEWAPPL(OS)"
  EXIT (0)
END

IF NBR_PARMS = 2 THEN DO
  X_DSN = "DSN=" || WORD(PARMS,1)
  X_MEM = "MEM=" || WORD(PARMS,2)
  ADDRESS TSO ISPEXEC "CONTROL ERRORS RETURN"
  ADDRESS TSO ISPEXEC "SELECT  CMD(OS2" X_DSN X_MEM ") NEWAPPL(OS)"
  EXIT (0)
END

ADDRESS TSO ISPEXEC "CONTROL ERRORS RETURN"

ADDRESS TSO ISPEXEC "SELECT  CMD(OS2" PARMS ") NEWAPPL(OS)"

RETURN 4
