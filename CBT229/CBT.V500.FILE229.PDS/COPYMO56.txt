*          DATA SET CBT990     AT LEVEL 056 AS OF 06/23/03               00001
   TITLE 'COPYMODS -- TAPE COPY PROGRAM'                                 00002
**************************************************************           00003
**************************************************************           00004
**                                                          **           00005
**                                                          **           00006
**  MODULE: COPYMODS.   WRITTEN BY PAUL TOKHEIM, AFAFC.     **           00007
**                                                          **           00008
**                                                          **           00009
**  PURPOSE: COPY ALL FILES OF AN INPUT TAPE TO ONE TO 16   **           00010
**     OUTPUT TAPES.  THE ORIGINAL PURPOSE OF THIS PROGRAM  **           00011
**     IS FOR COPYING THE SHARE MVS MODS TAPE.              **           00012
**                                                          **           00013
**                                                          **           00014
**  METHOD: COPYMODS FIRST DETERMINES WHICH OUTPUT DD'S ARE **           00015
**    PRESENT. THE INPUT TAPE IS READ USING EXCP AND THE    **           00016
**    APPROPRIATE OUTPUT TAPES ARE WRITTEN USING EXCP.      **           00017
**    ANY LABELS ON THE INPUT WILL BE COPIED. ANY LABELS ON **           00018
**    THE OUTPUT TAPES WILL BE DESTROYED.  IF AN ERROR      **           00019
**    OCCURS ON THE INPUT TAPE, THE PROGRAM WILL ABEND WITH **           00020
**    A USER 69 ABEND.  IF AN ERROR OCCURS ON AN OUTPUT     **           00021
**    TAPE, THE PROGRAM WILL QUIT WRITING TO THE TAPE       **           00022
**    WHICH ENCOUNTERED THE ERROR.                          **           00023
**                                                          **           00024
**                                                          **           00025
**************************************************************           00026
**  NEW FEATURES ADDED BY SAM GOLOB:                        **           00027
**                                                          **           00028
**                                                          **           00029
**   1.  64K BLOCKS ON A TAPE CAN BE COPIED.                **           00030
**                                                          **           00031
**   2.  UP TO 16 OUTPUT DDNAMES ALLOWED.                   **           00032
**                                                          **           00033
**   3.  INITTED TAPES, AND SL MULTIVOLUME TAPES CAN        **           00034
**       BE CORRECTLY COPIED.                               **           00035
**                                                          **           00036
**   4.  ALL STANDARD LABEL INFORMATION, OR ANY             **           00037
**       PARTICULAR LABEL TYPES, CAN BE PRINTED, IF         **           00038
**       FOUND ON THE INPUT TAPE.                           **           00039
**                                                          **           00040
**   5.  A FLEXIBLE TABLE-DRIVEN PARM KEYWORD SCANNER       **           00041
**       WAS ADDED.  THIS ALLOWS FOR EASY SETTING OF        **           00042
**       PROGRAM DEFAULTS, AND KEYWORD SYNONYMS.  SEE       **           00043
**       LABEL PARMTABL.                                    **           00044
**                                                          **           00045
**   6.  OPTIONALLY, THE VOLSER OF THE OUTPUT TAPES         **           00046
**       CAN BE SET TO THE JCL VOLSER, INSTEAD OF THE       **           00047
**       INPUT TAPE'S VOLSER.  USE THE CHGVOL PARM TO       **           00048
**       INVOKE THIS ACTION.                                **           00049
**                                                          **           00050
**   7.  TAPES WITH LEADING TAPE MARKS CAN BE COPIED        **           00051
**       EITHER AS-IS, OR WITH THE LEADING TAPE MARKS       **           00052
**       LEFT OFF.                                          **           00053
**                                                          **           00054
**   8.  EOV LABELS IN THE MIDDLE OF A TAPE, CAN NOW BE     **           00055
**       CHANGED TO EOF LABELS, IF THE TAPE WAS CREATED     **           00056
**       AS A COMPOSITE, BY THE COPYFILE PROGRAM.  THE      **           00057
**       PARM IS EOV2EOF (SEE PARMTABL FOR ALL ACCURATE     **           00058
**       AND CURRENT PARM KEYWORD SETTINGS).  THIS ALSO     **           00059
**       WORKS WHEN ADDING EXTERNAL LABELS TO AN NL TAPE.   **           00060
**                                                          **           00061
**   9.  COPYMODS CAN NOW BE RUN READ-ONLY FOR THE INPUT    **           00062
**       TAPE, USING PARMS OF READ, READONLY, OR NOWRITE.   **           00063
**                                                          **           00064
**  10.  COPYMODS CAN READ A TAPE (EITHER WHILE COPYING     **           00065
**       IT, OR IN READ-ONLY MODE), AND DUMP ALL THE TAPE   **           00066
**       LABELS TO AN FB-80 OUTPUT FILE WITH A DDNAME OF    **           00067
**       LABLDUMP.  USE A PARM OF LABLDUMP TO INVOKE THIS   **           00068
**       SERVICE.                                           **           00069
**                                                          **           00070
**  11.  COPYMODS CAN READ AN SL TAPE AND DUMP THE LABELS   **           00071
**       OFF INTO AN OUTPUT FILE.  THESE LABEL IMAGES HAVE  **           00072
**       EXTRA CONTROL CARDS ADDED.  THESE LABELS CAN BE    **           00073
**       MERGED WITH THE FILES IN AN NL VERSION OF THE      **           00074
**       SAME TAPE, AND A NEW SL TAPE CREATED.  BY DEFAULT, **           00075
**       BLOCK COUNTS IN THE EOF1 AND EOV1 OF THE OUTPUT    **           00076
**       TAPE ARE CORRECTED TO SHOW THE ACTUAL BLOCK        **           00077
**       COUNTS ON THE TAPE, BUT THIS ACTION CAN BE         **           00078
**       MANUALLY TURNED OFF WITH A PARM SETTING.           **           00079
**                                                          **           00080
**       IF YOU CODE A PARM OF SYSIN IN THE PARM FIELD OF   **           00081
**       THE EXEC CARD, THEN COPYMODS NOW TAKES PARM INPUT  **           00082
**       FROM SYSIN, AND THESE CAN OVERRIDE THE OTHER PARMS **           00083
**       IN THE EXEC CARD, BECAUSE SYSIN IS SEARCHED LATER. **           00084
**                                                          **           00085
**       (NOW YOU DON'T HAVE TO CODE PARM=SYSIN IN THE PARM **           00086
**       FIELD OF THE EXEC CARD.  IF THE SYSIN DDNAME IS    **           00087
**       PRESENT IN THE JCL, COPYMODS WILL OPEN IT, AND     **           00088
**       WILL USE IT TO SCAN FOR PARMS.  SG - 05/02).       **           00089
**                                                          **           00090
**       OUTVOLALL=VOLSER , STARTING IN COLUMN1 OF A SYSIN  **           00091
**       CARD, WILL CAUSE ALL OUTPUT VOL1 LABELS TO BE      **           00092
**       OVERWRITTEN WITH THE CODED VOLSER.  THE REST OF    **           00093
**       THAT CARD IS NOT SEARCHED FOR PARMS.               **           00094
**                                                          **           00095
**  12.  OVERLAYING OF THE VOLSER (IN THE VOL1 LABEL)       **           00096
**       CAN ALSO BE DONE IF YOU ARE ADDING EXTERNAL        **           00097
**       LABELS TO AN NL TAPE.  THE OUTPUT TAPES CAN        **           00098
**       HAVE DIFFERENT VOLSER'S FROM THE VOL1 LABEL        **           00099
**       IN THE EXTERNAL LABEL DATASET.                     **           00100
**                                                          **           00101
**  13.  LABLDUMP AND LABADDIN NOW TAKE IBM STANDARD USER   **           00102
**       LABELS INTO ACCOUNT.  THEREFORE, YOU CAN MAKE A    **           00103
**       TAPE WITH ANY USER LABELS YOU WANT, EVEN THOUGH    **           00104
**       YOUR SYSTEM CAN'T CREATE SUCH A TAPE BY ITSELF.    **           00105
**       LABLDUMP DUMPS ALL THE LABEL RECORDS FROM AN SL    **           00106
**       TAPE TO AN EXTERNAL FILE (WITH SPECIAL CONTROL     **           00107
**       CARDS), AND LABADDIN CAN ADD THESE LABELS TO AN    **           00108
**       NL TAPE TO MAKE AN SL TAPE.  (OF COURSE, YOU CAN   **           00109
**       EDIT THE LABEL FILE ON DISK BEFORE USING IT TO     **           00110
**       CREATE A NEW SL TAPE FROM AN NL TAPE.)             **           00111
**                                                          **           00112
**  14.  DEFAULT ACTION OF COPYMODS WITH LABADDIN IS THAT   **           00113
**       IT IS "LABEL DRIVEN".  THAT IS, IF THERE ARE MORE  **           00114
**       NL TAPE FILES THAN EXTERNAL LABELS, THE PROGRAM    **           00115
**       STOPS WHEN IT RUNS OUT OF LABELS.  IF THERE ARE    **           00116
**       MORE LABEL SETS THAN FILES, THE OUTPUT TAPE IS     **           00117
**       WRITTEN WITH NULL STANDARD LABEL FILES UNTIL THE   **           00118
**       LABEL DATASET IS EXHAUSTED, EVEN AFTER THE LAST    **           00119
**       DATA FILE HAS BEEN WRITTEN.                        **           00120
**                                                          **           00121
**       A NEW OPTION CALLED NOEXNULL ALLOWS COPYMODS TO    **           00122
**       STOP AS SOON AS THE NL TAPE FILES ARE EXHAUSTED,   **           00123
**       EVEN IF THERE ARE ADDITIONAL LABEL SETS IN THE     **           00124
**       EXTERNAL LABEL DATASET.                            **           00125
**                                                          **           00126
**  15.  WHEN DOING LABADDIN PROCESSING, IF THE LAST LABEL  **           00127
**       SET IN THE EXTERNAL LABEL FILE HAS A HDR1 AND A    **           00128
**       HDR2 LABEL, BUT NO ENDOFLABELHEADER AND NO EOF1    **           00129
**       AND NO EOF2, THE LBLFIX PARAMETER ALLOWS THE       **           00130
**       PROGRAM TO ACT AS IF THESE CONTROL CARDS WERE      **           00131
**       THERE.  THE EOF1 IS BUILT FROM THE HDR1 AND THE    **           00132
**       MEASURED BLOCK COUNT, AND THE EOF2 IS BUILT FROM   **           00133
**       THE HDR2.                                          **           00134
**                                                          **           00135
**  16.  COPYMODS CAN NOW INIT TAPES WITHOUT COPYING AN     **           00136
**       INPUT TAPE.  USE A PARM OF INITVOLS.               **           00137
**                                                          **           00138
**  17.  COPYMODS CAN NOW CHANGE THE OWNER INFORMATION      **           00139
**       IN THE VOL1 LABEL.  USE THE TAPEOWNER= KEYWORD     **           00140
**       IN A SYSIN CARD.                                   **           00141
**                                                          **           00142
**  18.  COPYMODS CAN LIMIT ITSELF IN THE NUMBER OF FILES   **           00143
**       COPIED, IF THE FILELIMIT=NN KEYWORD IS CODED IN    **           00144
**       SYSIN.  IF THE INPUT IS SL, THEN THE FILELIMIT     **           00145
**       IS INTERPRETED AS SL FILES.  IF NOT, THEN IT IS    **           00146
**       INTERPRETED AS NL.                                 **           00147
**                                                          **           00148
**  19.  USING THE "BYTES" PARAMETER, COPYMODS WILL REPORT  **           00149
**       BYTE COUNTS FOR ALL FILES IN THE INPUT TAPE, AND   **           00150
**       TOTAL BYTES FOR THE ENTIRE TAPE.  THE "CUMTOT"     **           00151
**       PARAMETER REPORTS CUMULATIVE BYTE TOTALS OVER      **           00152
**       MANY FILES, AND IMPLIES THAT THE "BYTES" PARM      **           00153
**       IS ALSO IN EFFECT.  A VARIANT OF THE "CUMTOT"      **           00154
**       PARAMETER IS THE "CUMSEP" PARAMETER, WHICH REPORTS **           00155
**       CUMULATIVE BYTE TOTALS, FILE BY FILE, BUT CUMSEP   **           00156
**       SEPARATES BYTE TOTALS COMING FROM LABELS, FROM THE **           00157
**       BYTE TOTALS COMING FROM DATA FILES.                **           00158
**                                                          **           00159
**  20.  COPYMODS NOW PRINTS "OPTIONS IN EFFECT" WITH THE   **           00160
**       "OPTION" PARAMETER.  (DEFAULT AS DISTRIBUTED, IS   **           00161
**       TO PRINT THEM.)                                    **           00162
**                                                          **           00163
**  21.  BLOCK CORRECTION FOR EOF1 AND EOV1 LABELS NOW      **           00164
**       TAKES THE HIGH ORDER 4 BYTES OF THE BLOCK COUNT    **           00165
**       INTO ACCOUNT.  THIS IS A DIFFERENT FIELD IN THE    **           00166
**       EOF1 OR EOV1 LABEL (LAST 4 BYTES).                 **           00167
**                                                          **           00168
**  22.  COPYMODS CAN NOW DO A QUICK DUMP OF TAPE LABELS,   **           00169
**       WITHOUT READING THE TAPE DATA.  USE THE PARM OF    **           00170
**       LBDQUICK (WHICH IMPLIES READONLY), JUST TO DO      **           00171
**       A LABLDUMP AND "FORWARD SPACE FILE" OVER THE       **           00172
**       DATA BLOCKS ON THE TAPE.                           **           00173
**                                                          **           00174
**  23.  USING PARM=STRIP, COPYMODS CAN STRIP ALL LABELS    **           00174
**       FROM SL TAPES TO MAKE NL OUTPUT TAPES.  IF         **           00174
**       FILE LIMITING IS NOT IN EFFECT (NO FILELIMIT=nnn   **           00174
**       CARD IN SYSIN), THEN THE LABELS AND THE TAPE MARK  **           00174
**       THAT FOLLOWS EACH ONE, WILL NOT BE WRITTEN TO THE  **           00174
**       OUTPUT TAPE(S).  IT DOES NOT MATTER WHERE THE      **           00174
**       LABELS ARE, ON THE TAPE, SO IF YOU HAVE SOME KIND  **           00174
**       OF MESSED-UP TAPE WITH LABELS IN THE WRONG PLACE,  **           00174
**       THESE WILL STILL BE STRIPPED OFF.  IF FILE         **           00174
**       LIMITING IS IN EFFECT, THEN THE INPUT TAPE IS      **           00174
**       ASSUMED TO BE SL, AND THE NUMBER CODED IN THE      **           00174
**       FILELIMIT=nnn SYSIN CARD IS MULTIPLIED BY 3, AND   **           00174
**       THE COPYING IS STOPPED AFTER THAT POINT OF THE     **           00174
**       INPUT TAPE.                                        **           00174
**                                                          **           00174
**  24.  IF YOU HAVE SPECIFIED FILELIMIT=nnn IN A SYSIN     **           00174
**       CARD AND HAVE THEREFORE INVOKED FILE LIMITING,     **           00174
**       YOU CAN FORCE THE nnn TO BE INTERPRETED AS NL,     **           00174
**       USING THE NLLIM PARM, AND YOU CAN FORCE THE nnn    **           00174
**       TO BE INTERPRETED AS SL (AND THEREFORE BE          **           00174
**       MULTIPLIED BY 3), BY USING THE SLLIM PARM.         **           00174
**                                                          **           00174
**  25.  USING PARM=IDRCOFF, YOU CAN INDICATE THAT THE      **           00174
**       TAPE IS NON-COMPRESSED.  THIS IS USEFUL FOR AWS    **           00174
**       FORMAT TAPES WHICH REALLY AREN'T RUNNING ON THE    **           00174
**       3490 HARDWARE AND ABOVE.  SO YOU JUST INDICATE     **           00174
**       THEM AS UNCOMPRESSED, AND THE VIRTUAL TAPE LABELS  **           00174
**       DO NOT INDICATE TO MVS THAT IDRC IS ON.  THIS      **           00174
**       ALLOWS A 3420 OR 3480 VIRTUAL DEVICE TO READ THE   **           00174
**       TAPE, WITHOUT INCURRING AN S413-40 ABEND.          **           00174
**                                                          **           00174
**  26.  USING PARM=HEXPRT, THE FIRST 132 BYTES OF THE      **           00174
**       FIRST n RECORDS IN EACH FILE ARE PRINTED IN HEX    **           00174
**       AND EBCDIC.  DEFAULT FOR n IS 4.  THIS CAN BE      **           00174
**       OVERRIDDEN BY CODING PRINTRCDS=nnn IN THE SYSIN    **           00174
**       CARD, STARTING IN COLUMN 1.                        **           00174
**                                                          **           00174
**************************************************************           00175
         EJECT                                                           00176
**************************************************************           00177
**  CHANGE LOG:                                             **           00178
**                                                          **           00179
** LEVEL 003                                                **           00180
**  03/03/00 - ALLOW COPYING OF 64K BLOCKS        SBG 03/00 **           00181
**                                                          **           00182
** LEVEL 004                                                **           00183
**  03/03/00 - CHECK FOR DOUBLE TAPE MARK AFTER   SBG 03/00 **           00184
**             A HEADER LABEL.  THIS MEANS AN SL  SBG 03/00 **           00185
**             FILE WITHOUT ANY DATA IN IT.  AND  SBG 03/00 **           00186
**             IF THIS IS THE CASE, DON'T STOP    SBG 03/00 **           00187
**             COPYING FILES.                     SBG 03/00 **           00188
**                                                          **           00189
** LEVEL 005                                                **           00190
**  03/03/00 - GET AWAY FROM R13 AS BASE, USE     SBG 03/00 **           00191
**             R12,R11.                           SBG 03/00 **           00192
**                                                          **           00193
** LEVEL 006                                                **           00194
**  03/12/00 - ENLARGED THE PROGRAM TO ALLOW UP   SBG 03/00 **           00195
**             TO 16 OUTPUT TAPES FROM OUT1 TO    SBG 03/00 **           00196
**             OUT16.                             SBG 03/00 **           00197
**                                                          **           00198
** LEVEL 007 AND 008                                        **           00199
**  03/14/00 - CLEANED UP SPELLING ON ERROR       SBG 03/00 **           00200
**             MESSAGES AND FIXED DOCUMENTATION.  SBG 03/00 **           00201
**             ADDED EYECATCHERS COSMETICALLY.    SBG 03/00 **           00202
**                                                          **           00203
** LEVEL 009                                                **           00204
**  03/21/00 - STOP AFTER INITTED MVS TAPE        SBG 03/00 **           00205
**                                                          **           00206
** LEVEL 010                                                **           00207
**  03/24/00 - FIXED THE BLOCK SIZE CALCULATIONS  SBG 03/00 **           00208
**             FOR BLOCK SIZES FROM 32K TO 64K.   SBG 03/00 **           00209
**                                                          **           00210
**             I MADE AN ATTEMPT TO COPY DOS/VSE  SBG 03/00 **           00211
**             TAPES THAT HAVE LEADING TAPE       SBG 03/00 **           00212
**             MARKS.  THERE IS A CHOICE TO       SBG 03/00 **           00213
**             EITHER COPY ALL THE LEADING        SBG 03/00 **           00214
**             TAPEMARKS TO AN OUTPUT TAPE, OR TO SBG 03/00 **           00215
**             DISCARD THEM ALL.  YOU USE A PARM  SBG 03/00 **           00216
**             OF LTMSKIP TO DISCARD LEADING      SBG 03/00 **           00217
**             TAPEMARKS, AND ANY OTHER PARM, OR  SBG 03/00 **           00218
**             NO PARM, WILL CAUSE THE PROGRAM TO SBG 03/00 **           00219
**             COPY THEM TO THE OUTPUT TAPES.     SBG 03/00 **           00220
**                                                          **           00221
** LEVEL 011                                                **           00222
**  03/24/00 - PROPERLY ACCOUNT FOR INITTED TAPE  SBG 03/00 **           00223
**             BY ENDING THE JOB NORMALLY AFTER   SBG 03/00 **           00224
**             ONE TAPEMARK.                      SBG 03/00 **           00225
**                                                SBG 03/00 **           00226
**             IF VOL1 LABEL IS DETECTED, THEN    SBG 03/00 **           00227
**             PUT OUT A MESSAGE SAYING SO, AND   SBG 03/00 **           00228
**             INDICATING THE VOLSER THAT WAS     SBG 03/00 **           00229
**             FOUND.  THIS PROGRAM WAS WRITTEN   SBG 03/00 **           00230
**             ORIGINALLY WITH THE INTENT OF      SBG 03/00 **           00231
**             HANDLING NL TAPES, SO THAT THE     SBG 03/00 **           00232
**             CONDITIONS WHICH RESULT FROM       SBG 03/00 **           00233
**             HAVING SL TAPES, HAD TO BE         SBG 03/00 **           00234
**             ACCOUNTED FOR LATER.               SBG 03/00 **           00235
**                                                          **           00236
** LEVEL 012                                                **           00237
**  04/19/00 - ACCOUNT FOR SL EOV1 AND EOV2       SBG 04/00 **           00238
**             HAVING ONLY ONE TAPE MARK AFTER              **           00239
**             THEM.                                        **           00240
**                                                          **           00241
** LEVEL 013                                                **           00242
**  04/30/00 - ORGANIZE THE CHECK FOR STANDARD    SBG 04/00 **           00243
**             LABEL TYPES, AND THE SETTING OF              **           00244
**             FLAGS TO INDICATE EACH TYPE.                 **           00245
**             SEE NEW SUBROUTINE CALLED LABELCHK.          **           00246
**             MOVE NON-LABEL-RELATED FLAGS OUT             **           00247
**             OF THE LBLFLAG FLAG.  PREPARE FOR            **           00248
**             EASY PRINTING OF LABEL CONTENTS,             **           00249
**             BUT NO EXTRA PRINTING IS DONE AT             **           00250
**             THIS LEVEL.                                  **           00251
**                                                          **           00252
** LEVEL 014                                                **           00253
**  05/02/00 - ADDED A FLEXIBLE TABLE-DRIVEN      SBG 05/00 **           00254
**             PARM SCANNER THAT IS EASY TO                 **           00255
**             MODIFY, AND TO SUPPLY SYNONYMS               **           00256
**             FOR THE PARMS.  ADDED SUPPORT,               **           00257
**             VIA THE LBLINFO PARM, TO PRINT               **           00258
**             HDR1, HDR2, EOF1, EOF2, EOV1,                **           00259
**             EOV2 LABEL INFORMATION, IF IT IS             **           00260
**             FOUND ON THE INPUT TAPE.  THAT IS,           **           00261
**             IF THE INPUT TAPE IS SL.                     **           00262
**                                                          **           00263
**             FOR A LIST OF PERMISSIBLE PARMS,             **           00264
**             SEE LABEL PARMTABL.                          **           00265
**                                                          **           00266
** LEVEL 015                                                **           00267
**  05/07/00 - GAVE THE PARM SCANNER THE ABILITY  SBG 05/00 **           00268
**             TO TURN OFF A PARM FLAG AS WELL AS           **           00269
**             THE ABILITY TO TURN IT ON. INCREASED         **           00270
**             THE SIZE OF A PARM TABLE ENTRY BY ONE        **           00271
**             BYTE.                                        **           00272
**                                                          **           00273
** LEVEL 016                                                **           00274
**  05/08/00 - GAVE THE PARM SCANNER THE ABILITY  SBG 05/00 **           00275
**             TO SET ANY PARM SETTING AS A                 **           00276
**             DEFAULT.  A SETTING FOR A DEFAULT            **           00277
**             ENTRY THAT IS LATER IN THE TABLE,            **           00278
**             WILL OVERRIDE A SETTING FOR A                **           00279
**             DEFAULT THAT WAS SET EARLIER IN THE          **           00280
**             TABLE.  SETTING A PARM EXPLICITLY            **           00281
**             IN THE JCL, WILL OVERRIDE ANY                **           00282
**             DEFAULT SETTING FOR THAT PARM.               **           00283
**                                                          **           00284
** LEVEL 017                                                **           00285
**  05/11/00 - USED THE PARM SCANNER TO MAKE A    SBG 05/00 **           00286
**             DIFFERENCE BETWEEN PRINTING VARIOUS          **           00287
**             KINDS OF TAPE LABELS.  IF YOU WANT           **           00288
**             ALL OF THEM, YOU JUST HAVE A PARM            **           00289
**             THAT THROWS ALL OF THE FLAGS.  ALL           **           00290
**             OF THIS IS CODED IN PARMTABL AND             **           00291
**             THE FLAGS ARE USED IN PRTXXX1 AND            **           00292
**             PRTXXX2.                                     **           00293
**                                                          **           00294
** LEVEL 018                                                **           00295
**  05/22/00 - ADDED THE PROVISION TO CHANGE THE  SBG 05/00 **           00296
**             VOLSER OF THE COPIED TAPES, TO               **           00297
**             MATCH THE VOLSER INDICATED IN THE            **           00298
**             OUTXX DD NAMES.  THIS IS DONE WITH           **           00299
**             THE CHGVOL PARM KEYWORD.  THIS               **           00300
**             ACTION ONLY OCCURS IF THE INPUT              **           00301
**             TAPE IS SL, AND SO A VOL1 LABEL IS           **           00302
**             DETECTED.  THE COPIED VOL1 LABEL             **           00303
**             IS ALTERED BEFORE THE WRITE.                 **           00304
**                                                          **           00305
** LEVEL 019                                                **           00306
**  06/06/00 - ADDED THE PROVISION TO FIX EOV1    SBG 06/00 **           00307
**             AND EOV2 LABELS THAT ARE IN THE              **           00308
**             MIDDLE OF A TAPE.  OF COURSE THIS            **           00309
**             ISN'T SUPPOSED TO HAPPEN, BUT IT             **           00310
**             CAN HAPPEN WHEN YOU COPY FILES               **           00311
**             WITH THE COPYFILE PROGRAM, FROM              **           00312
**             THE END OF ONE TAPE, TO THE                  **           00313
**             BEGINNING OR THE MIDDLE OF                   **           00314
**             ANOTHER.  COPYFILE HAS NOT BEEN              **           00315
**             FIXED AS YET NOT TO DO THIS, BUT IT          **           00316
**             COPIES THE EOV LABELS AS IS.  THIS           **           00317
**             NEW OPTION IS CALLED EOVCHG OR               **           00318
**             EOV2EOF; THE EOV LABELS ARE                  **           00319
**             CHANGED (IN THE COPIED TAPES) TO             **           00320
**             EOF, AND A MESSAGE IS WRITTEN THAT           **           00321
**             REPORTS THIS FACT.                           **           00322
**                                                          **           00323
** LEVEL 020                                                **           00324
**  06/29/00 - ADDED THE PARM OF READ OR READONLY SBG 06/00 **           00325
**             TO ALLOW A RUN OF COPYMODS THAT              **           00326
**             JUST READS THE INPUT TAPE, AND DOES          **           00327
**             NOT MAKE COPIES.                             **           00328
**                                                          **           00329
** LEVEL 021                                                **           00330
**  07/06/00 - FIX COPYMODS TO CORRECTLY COPY     SBG 07/00 **           00331
**             IEHINITTED TAPES.                            **           00332
**                                                          **           00333
** LEVEL 022                                                **           00334
**  09/10/00 - COPYMODS CAN DUMP THE IBM STANDARD SBG 09/00 **           00335
**             LABELS FROM A TAPE, TO AN FB-80              **           00336
**             OUTPUT FILE.  PARM IS LABLDUMP.              **           00337
**                                                          **           00338
** LEVEL 023                                      SBG 09/00 **           00339
**  09/11/00 - ALLOWS LIMITED SYSIN INPUT OPTIONALLY.       **           00340
**             ONLY IMPLEMENTATION SO FAR IS TO             **           00341
**             CHANGE ALL OUTPUT VOLSER'S TO THE            **           00342
**             SAME VALUE, BUT NOT NECESSARILY TO           **           00343
**             WHAT IS IN THE OUTX  DD CARD.  IN            **           00344
**             ORDER TO USE THE FACILITY, YOU HAVE          **           00345
**             TO CODE                                      **           00346
**             OUTVOLALL=XXXXXX STARTING IN COL 1           **           00347
**             OF THE SYSIN CARD FILE.  IF THERE            **           00348
**             ARE NO VALID OUTVOLALL= CARDS IN             **           00349
**             SYSIN, THEN THE EFFECT IS THE SAME           **           00350
**             AS CODING CHGVOL.                            **           00351
**                                                          **           00352
**             FIXED LABEL DUMP OPTION SO THAT THE          **           00353
**             DUMPED LABELS HAVE CONTROL CARDS             **           00354
**             AFTER THEM.  THE EXTERNAL ADD LABELS         **           00355
**             FUNCTION IN LEVEL 24 NEEDS THESE             **           00356
**             CONTROL CARDS.                               **           00357
**                                                          **           00358
** LEVEL 024                                      SBG 09/00 **           00359
**  09/14/00 - ADDED CAPABILITY OF CREATING SL              **           00360
**             OUTPUT COPIES FROM NL INPUT AND A            **           00361
**             SET OF LABELS CREATED BY LABLDUMP.           **           00362
**             CHANGED THE DCB NAMES AND DD CARDS           **           00363
**             AND OPTION NAMES FOR LABEL DUMP AND          **           00364
**             RESTORE.                                     **           00365
**                                                          **           00366
**             CHANGED PROGRAM INITIALIZATION TO            **           00367
**             A STANDARD FORM.  GOT RID OF PRIME           **           00368
**             AND TERME MACROS.  HAVE 5 BASE               **           00369
**             REGISTERS TO LEAVE ROOM FOR EXPANSION.       **           00370
**                                                          **           00371
**             CHECK FOR VOL1 RECORD AS FIRST RECORD        **           00372
**             ON THE INPUT TAPE.  WON'T WRITE MORE         **           00373
**             LABELS ON AN SL TAPE, AND WON'T              **           00374
**             DAMAGE THE OUTPUT TAPES, IF THE INPUT        **           00375
**             TAPE IS SL, ACCIDENTALLY.                    **           00376
**                                                          **           00377
** LEVEL 025                                      SBG 09/00 **           00378
**  09/20/00 - COPYMODS CAN NOW TAKE INPUT FROM             **           00379
**             SYSIN AND SEARCH FOR ALL PARMS.              **           00380
**             TO INVOKE THIS, YOU HAVE TO CODE             **           00381
**             A PARM OF 'SYSIN' ON THE EXEC CARD.          **           00382
**             ANY CARD IN SYSIN WHICH IS NOT A             **           00383
**             KEYWORD PARAMETER (THE ONLY ONE              **           00384
**             CURRENTLY SUPPORTED IS OUTVOLALL= )          **           00385
**             IS SEARCHED BY THE PARMLOOP ROUTINE,         **           00386
**             AND ANY PARM THAT IS CODED IN THE            **           00387
**             PARM TABLE, CAN BE CODED IN SYSIN,           **           00388
**             AND IT WILL OVERRIDE THE PARM IN             **           00389
**             THE EXEC CARD (SINCE SYSIN IS                **           00390
**             SCANNED LATER IN THE PROCESSING).            **           00391
**                                                          **           00392
**             INCLUDED A BLOCK COUNT CORRECTION AS         **           00393
**             DEFAULT, WHEN WRITING STANDARD LABELS        **           00394
**             FROM AN EXTERNAL FILE.  THE CORRECTED        **           00395
**             BLOCK COUNTS ARE WRITTEN TO THE EOF1         **           00396
**             AND EOV1 LABELS IN THE OUTPUT TAPES.         **           00397
**                                                          **           00398
**             WHEN WRITING TAPE LABELS FROM AN EXTERNAL    **           00399
**             FILE, INCLUDED AN OPTION TO PRINT THEIR      **           00400
**             CONTENTS, IN THE SAME WAY, AS PRINTING       **           00401
**             THE CONTENTS OF STANDARD LABELS FOUND        **           00402
**             WHEN COPYING AN INPUT TAPE.                  **           00403
**                                                          **           00404
** LEVEL 026                                      SBG 09/00 **           00405
**  09/22/00 - ON LABADDIN, COPYMODS SHOULD                 **           00406
**             RESPECT CHGVOL AND OUTVOLALL= .              **           00407
**                                                          **           00408
** LEVEL 027                                      SBG 09/00 **           00409
**  09/22/00 - ON LABADDIN, COPYMODS SHOULD                 **           00410
**             BE ABLE TO DO EOV2EOF PROCESSING             **           00411
**                                                          **           00412
** LEVEL 028                                      SBG 09/00 **           00413
**  09/25/00 - ON LABADDIN AND LABLDUMP, PUT IN             **           00414
**             STANDARD USER LABEL SUPPORT.                 **           00415
**                                                          **           00416
** LEVEL 029                                      SBG 09/00 **           00417
**  09/25/00 - FIX LABEL PRINTING REPORTS FOR               **           00418
**             STANDARD USER LABELS.                        **           00419
**                                                          **           00420
** LEVEL 030                                      SBG 09/00 **           00421
**  09/27/00 - CORRBLKS PARM ALLOWS FIXING OF               **           00422
**             EOF1 AND EOV1 BLOCK COUNTS IN THE            **           00423
**             OUTPUT TAPES, DURING THE COPY.               **           00424
**             WRITE MESSAGE THAT THIS IS IN EFFECT.        **           00425
**                                                          **           00426
**             FIXED THE EYECATCHERS A BIT.                 **           00427
**                                                          **           00428
**             AGAIN FIXED COPY OF INITTED TAPES.           **           00429
**                                                          **           00430
** LEVEL 031                                      SBG 09/00 **           00431
**  09/28/00 - MADE SURE WITH LABADDIN WHEN YOU             **           00432
**             HAVE EXTRA LABELS AND ADD NULL FILES,        **           00433
**             THAT 2 TM'S ARE WRITTEN AFTER THE            **           00434
**             HDR2 RECORDS, BEFORE THE EOF1'S.             **           00435
**                                                          **           00436
** LEVEL 032                                      SBG 10/00 **           00437
**  10/02/00 - NEW NOEXNULL OPTION CONTROLS                 **           00438
**             LABADDIN PROCESSING WHEN THERE ARE           **           00439
**             MORE LABELS IN THE EXTERNAL LABEL            **           00440
**             DATASET, THAN THERE ARE NL FILES             **           00441
**             IN THE INPUT TAPE.  DEFAULT IS TO            **           00442
**             WRITE EXTRA NULL SL FILES.  NOEXNULL         **           00443
**             SAYS TO STOP AT THE END OF NL FILES          **           00444
**             AND NOT WRITE NULL SL FILES TO               **           00445
**             CORRESPOND TO THE EXTRA EXTERNAL             **           00446
**             LABELS.                                      **           00447
**                                                          **           00448
**             THIS HAS TO BE DONE WITH A TECHNIQUE         **           00449
**             OF WRITING AN EXTRA HEADER LABEL SET,        **           00450
**             AND THEN BACKING OVER IT AND CLOSING.        **           00451
**                                                          **           00452
** LEVEL 033                                      SBG 10/00 **           00453
**  10/05/00 - NEW LBLFIX OPTION FIXES LABADDIN             **           00454
**             PROCESSING WHEN THE LAST LABEL SET           **           00455
**             IN THE EXTERNAL LABEL FILE IS PARTLY         **           00456
**             MISSING.  ALL YOU NEED IS A HDR1 AND         **           00457
**             A HDR2 LABEL IN THE LAST LABEL SET,          **           00458
**             AND COPYMODS (WITH LBLFIX ON) WILL           **           00459
**             ACT AS IF AN ENDOFLABELHEADER CARD           **           00460
**             WERE THERE (SO IT WRITES A TAPEMARK          **           00461
**             AND THE DATA AND A TAPEMARK), AND IT         **           00462
**             CONSTRUCTS THE EOF1 FROM THE HDR1            **           00463
**             PLUS THE MEASURED BLOCK COUNTS FROM          **           00464
**             THE DATA FILE.  AN EOF2 IS COPIED            **           00465
**             FROM THE EXISTING HDR2 AND EOF IS            **           00466
**             PUT IN.  2 TAPEMARKS ARE WRITTEN ON          **           00467
**             THE END.                                     **           00468
**                                                          **           00469
** LEVEL 034                                      SBG 10/00 **           00470
**  10/10/00 - WHEN AN ERROR THAT IS NOT A UNIT             **           00471
**             CHECK IS PRESENT ON AN OUTPUT TAPE           **           00472
**             DRIVE, NO REWIND IS PERFORMED BEFORE         **           00473
**             THE CLOSE.  THIS LETS THE CLOSE DO           **           00474
**             THE REWIND, AND LEAVES THE WRITTEN           **           00475
**             DATA ON THE TAPE.  THIS WAY, A TAPE          **           00476
**             THAT WAS INCOMPLETELY WRITTEN IS             **           00477
**             NOT ERASED.                                  **           00478
**                                                          **           00479
**             END-OF-TAPE (UNIT EXCEPTION ON WRITE)        **           00480
**             CONDITION IS FLAGGED WITH A PROPER           **           00481
**             MESSAGE FOR THE CONTEXT, AND THE WTOR        **           00482
**             FOR THAT DRIVE IS BYPASSED.                  **           00483
**                                                          **           00484
**             THIS PROBLEM HAS EXISTED SINCE THE           **           00485
**             FIRST VERSION OF THIS PROGRAM.               **           00486
**                                                          **           00487
**             CAREFUL TO FLAG ALL THE EXTRA DD             **           00488
**             NAMES AS CLOSED BEFORE CLOSING THEM.         **           00489
**             THESE ARE THE OPENDFLG SETTINGS.             **           00490
**                                                          **           00491
** LEVEL 035                                      SBG 10/00 **           00492
**  10/12/00 - TRY TO FIX COPYING OF INITTED                **           00493
**             TAPES, BY NOT REUSING THE WRITE              **           00494
**             IOB WITHOUT REFRESHING THE PARTS             **           00495
**             THAT ARE USED BY IOS.  THIS IS THE           **           00496
**             CLEARIOB SUBROUTINE. (IT DOESN'T HELP.)      **           00497
**                                                          **           00498
**             LABLDUMP OF AN IEHINITTED TAPE               **           00499
**             PRODUCES AN ENDOFLABELHEADERINIT             **           00500
**             CARD, IN ANTICIPATION OF CREATING            **           00501
**             A TAPE INITIALIZATION ROUTINE FROM           **           00502
**             EXTERNAL LABELS.  (INITVOLS IN THE           **           00503
**             NEXT LEVEL, IS BETTER.)                      **           00504
**                                                          **           00505
**             FIXED BUG OF WRITING 2 EOV2 LABELS.          **           00506
**                                                          **           00507
** LEVEL 036                                      SBG 10/00 **           00508
**  10/17/00 - CAN INIT TAPES FROM PROGRAM-GENERATED        **           00509
**             CARD IMAGES.  ADD TAPEOWNER= KEYWD           **           00510
**             IN SYSIN DD NAME.  THIS KEYWORD CAN          **           00511
**             ALSO CHANGE TAPE OWNER INFORMATION           **           00512
**             IN THE VOL1 LABEL FOR REGULAR COPIES,        **           00513
**             ALTHOUGH IT WAS WRITTEN FOR TAPE INITS.      **           00514
**                                                          **           00515
**             TO INIT TAPES WITH NO INPUT TAPE,            **           00516
**             USE A PARM OF INITVOLS.                      **           00517
**                                                          **           00518
**             TAPEOWNER=  AND  OUTVOLALL=  KEYWORDS        **           00519
**             BOTH TURN ON THE OUTVOL PARM OPTION.         **           00520
**                                                          **           00521
**             CONSOLIDATED CHGVOL CODE INTO A              **           00522
**             SUBROUTINE TO SIMPLIFY THE PROGRAM.          **           00523
**                                                          **           00524
**             CLEANED CHGVOL CODE TO HANDLE LABADDIN       **           00525
**             AS WELL AS TAPE INPUT, WITHOUT THEM          **           00526
**             STEPPING ON EACH OTHER.                      **           00527
**                                                          **           00528
** LEVEL 037                                      SBG 10/00 **           00529
**  10/31/00 - ADDED FILELIMIT= KEYWORD TO SYSIN            **           00530
**             CARDS.  THE PROGRAM FEELS FOR SL OR          **           00531
**             NL TAPES ON THE INPUT TAPE.  IF THE          **           00532
**             INPUT TAPE IS SL, THEN THE FILELIMIT         **           00533
**             IS MULTIPLIED BY 3, AND THE BIGGER           **           00534
**             VALUE IS USED.                               **           00535
**                                                          **           00536
**             COPYMODS WILL ONLY COPY INPUT TAPE           **           00537
**             FILES UP TO THE LIMIT OF THE FILELIMIT       **           00538
**             VALUE, IF THERE IS ONE.                      **           00539
**                                                          **           00540
**             INTERNALLY, THE FILELIMIT= KEYWORD           **           00541
**             SETS THE PARM VALUE OF LIMFILE OR            **           00542
**             FILELIM, AND THAT PARM IS WHAT DRIVES        **           00543
**             THE PROGRAM ACTION.                          **           00544
**                                                          **           00545
**             BYTES PARM KEYWORD ADDED.  IF SO, THE        **           00546
**             PROGRAM COUNTS BYTES READ FROM THE           **           00547
**             INPUT TAPE FILES, AND TOTALS THEM AT         **           00548
**             THE END.  NOBYTES KEYWORD WILL NULLIFY       **           00549
**             THIS ACTION.                                 **           00550
**                                                          **           00551
** LEVEL 038                                      SBG 11/00 **           00552
**  11/01/00 - ADDED CUMTOT KEYWORD WHICH IMPLIES           **           00553
**             THE BYTES KEYWORD.  THIS OPTION KEEPS        **           00554
**             RUNNING BYTE TOTALS AS WELL AS THE           **           00555
**             BYTE COUNTS FOR THE INDIVIDUAL TAPE          **           00556
**             FILES.                                       **           00557
**                                                          **           00558
** LEVEL 039                                      SBG 11/00 **           00559
**  11/01/00 - EXPANDED THE SIZE OF PARMTABL TO             **           00560
**             TAKE 5 BYTES OF PARMS INSTEAD OF 3.          **           00561
**             THEREFORE WE HAVE PARMFLG1 THRU              **           00562
**             PARMFLG5 TO USE AS OPTION BYTES.             **           00563
**                                                          **           00564
** LEVEL 040                                      SBG 11/00 **           00565
**  11/03/00 - SPLIT BYTE TOTALS TO SEPARATE OUT            **           00566
**             THE INPUT TAPE'S BYTE COUNT COMING FROM      **           00567
**             LABELS.  INNOVATION'S FATAR GIVES TAPE       **           00568
**             BYTE COUNTS NOT COUNTING LABEL BYTES,        **           00569
**             AND I WANT TO BE ABLE TO MATCH THEIR         **           00570
**             COUNT, SO A USER WILL BE ABLE TO             **           00571
**             EXPLAIN IT.  ALSO, I WANT TO BE ABLE         **           00572
**             TO GET A NL BYTE COUNT FROM AN SL TAPE.      **           00573
**                                                          **           00574
**             PUT IN PROTECTION FOR "IN" DDNAME, SO        **           00575
**             IF IT ISN'T CODED IN THE JCL, AND YOU'RE     **           00576
**             NOT INITTING TAPES, YOU DON'T GET AN         **           00577
**             S200 ABEND, BUT A MESSAGE TELLING YOU        **           00578
**             WHAT TO DO.                                  **           00579
**                                                          **           00580
** LEVEL 041                                      SBG 11/00 **           00581
**  11/05/00 - LABELIMIT=NNN WILL LIMIT THE NUMBER          **           00582
**             OF LABEL SETS IN THE LABADDIN FILE           **           00583
**             THAT COPYMODS WILL PROCESS.  EVEN            **           00584
**             IF THE LABADDIN FILE CONTAINS MANY           **           00585
**             LABEL SETS, THE NUMBER PROCESSED WILL        **           00586
**             BE NNN ONLY.  LABELIMIT=NNN IS CODED         **           00587
**             AS A SYSIN CARD, LIKE FILELIMIT=NNN.         **           00588
**                                                          **           00589
**             LABELIMIT=NNN COUNTS THE NUMBER OF           **           00590
**             ----ENDOFLABELTRAILER CARDS SEEN IN          **           00591
**             THE LABADDIN FILE, AND CONSIDERS THE         **           00592
**             FILE TO END AFTER NNN OF THEM.               **           00593
**                                                          **           00594
**  11/06/00 - FIXED A BUG THAT I INTRODUCED A WHILE        **           00595
**             BACK AT LABEL WRITE17.  THERE SHOULDN'T      **           00596
**             BE A TEST FOR LBLFLAG,X'80' (EOV2).          **           00597
**             THIS CHOPS PROCESSING OFF TOO SOON           **           00598
**             WHEN EOV LABELS ARE PRESENT.                 **           00599
**                                                          **           00600
** LEVEL 042                                      SBG 11/00 **           00601
**  11/06/00 - TURNED ALL BAL R6 ROUTINES INTO              **           00602
**             BAL R7, AND USED R6 AS SIXTH BASE            **           00603
**             REGISTER.                                    **           00604
**                                                          **           00605
** LEVEL 043                                      SBG 11/00 **           00606
**  11/08/00 - PRINT "OPTIONS IN EFFECT" WITH THE           **           00607
**             "OPTION" PARAMETER.  CALL IS TO A            **           00608
**             SUBPROGRAM THAT WRITES TO SYSPRINT.          **           00609
**             PROGRAM COPYMOPT SHOULD BE BATCH             **           00610
**             ASSEMBLED AND LINKEDITED WITH                **           00611
**             THE COPYMODS PROGRAM.                        **           00612
**                                                          **           00613
**             CHANGED THE WORDING OF SOME OF THE           **           00614
**             PARMS TO "SHUT OFF" OPTIONS, SLIGHTLY,       **           00615
**             TO ACCOMMODATE THE COPYMOPT PROGRAM.         **           00616
**                                                          **           00617
**  12/02/00 - FIXED BUG AFTER INTRODUCING THE OPTIONS      **           00618
**             PARAMETER.  WRLBLFLG,X'01' WAS ON            **           00619
**             UNCONDITIONALLY, INSTEAD OF ONLY WHEN        **           00620
**             LABADDIN WAS IN EFFECT.                      **           00621
**                                                          **           00622
** LEVEL 044                                      SBG 12/00 **           00623
**  12/02/00 - ENHANCED OPTIONS DISPLAY                     **           00624
**                                                          **           00625
** LEVEL 045                                      SBG 12/00 **           00626
**  12/05/00 - OPTION TO SUPPRESS WTO AT GOOD               **           00627
**             COMPLETION OF THE COPY. SUPPWTO.             **           00628
**                                                          **           00629
** LEVEL 046                                      SBG 12/00 **           00630
**  12/07/00 - SAVE FULL 10 DIGITS OF BLOCK COUNT.          **           00631
**             7 DIGITS ARE DISPLAYED IN THE REPORT.        **           00632
**             PUT IN FIX TO MOVE HI ORDER 4 DIGITS         **           00633
**             TO HI ORDER FIELD WHEN DOING BLOCK           **           00634
**             COUNT CORRECTION.                            **           00635
**                                                          **           00636
**             PRINT ROUTINE FOR EOF1, EOV1 FIXED.          **           00637
**                                                          **           00638
** LEVEL 047                                      SBG 12/00 **           00639
**  12/11/00 - LBDQUICK OPTION ALLOWS A QUICK LABEL         **           00640
**             DUMP OF TAPES WHICH CONTAIN LARGE            **           00641
**             NUMBERS OF DATA RECORDS.  IF THE             **           00642
**             ONLY TASK IS TO DUMP THE LABELS, YOU         **           00643
**             CAN NOW FSF PAST THE NON-LABEL DATA.         **           00644
**                                                          **           00645
** LEVEL 048                                      SBG 05/02 **           00646
**  05/19/02 - MAKE SYSIN AN OPTIONAL DDNAME, SO            **           00647
**             YOU DON'T HAVE TO LOOK IN THE PARMS          **           00648
**             TO SEE IF YOU SHOULD OPEN IT.  IF IT         **           00649
**             IS THERE IN THE JCL, THEN OPEN IT.           **           00650
**                                                          **           00651
** LEVEL 049                                      SBG 05/02 **           00652
**  05/20/02 - ADD CUMSEP AND NOCUMSEP OPTIONS,             **           00653
**             TO SEPARATE CUMULATIVE TOTALS BY LABEL       **           00654
**             BYTE COUNTS AND DATA BYTE COUNTS,            **           00655
**             INSTEAD OF TOTAL BYTE COUNTS.                **           00656
**                                                          **           00657
** LEVEL 050 - ADD PARM=STRIP, TO NOT COPY TAPE   SBG 10/02 **           00652
**  10/16/02   LABELS, AND ONE TAPE MARK AFTER              **           00657
**             EACH LABEL.  IT DOES NOT MATTER              **           00657
**             WHERE THE LABELS ARE, IN THE INPUT           **           00657
**             TAPE--THEY WILL BE STRIPPED OFF THE          **           00657
**             OUTPUT TAPE.  FILE LIMITING IS TREATED       **           00657
**             AS IN NORMAL SL TAPES.  THE FILE LIMIT       **           00657
**             NUMBER IS MULTIPLIED BY 3, AND THE           **           00657
**             COPYING IS CUT OFF AFTER 3*nnn,              **           00657
**             TREATED AS BLP, ON THE INPUT TAPE.           **           00657
**                                                          **           00657
** LEVEL 051 - WHEN LIMITING FILES TO BE COPIED, USING      **           00657
**             THE FILELIMIT=nnn SYSIN CARD, NORMALLY       **           00657
**             COPYMODS TRIES TO DETECT WHETHER THE         **           00657
**             INPUT TAPE IS SL, OR NL.  THEN, THE nnn      **           00657
**             NUMBER (IF THE TAPE IS SL) IS MULTIPLIED     **           00657
**             BY 3, AND (IF THE TAPE IS NL) THE nnn        **           00657
**             NUMBER IS USED AS-IS.  IN THIS LEVEL,        **           00657
**             WE CAN NOW FORCE THE nnn TO BE               **           00657
**             INTERPRETED AS NL USING THE NLLIM            **           00657
**             KEYWORD, AND WE CAN FORCE nnn TO BE          **           00657
**             INTERPRETED AS 3*nnn USING THE SLLIM         **           00657
**             KEYWORD.  NONLLIM AND NOSLLIM REVERT         **           00657
**             THE PROGRAM TO THE DEFAULT, UNLESS THE       **           00657
**             OTHER KEYWORD IS ALSO CODED.                 **           00657
**                                                          **           00657
** LEVEL 052 - WHEN WRITING A TAPE MARK USING EXCP,         **           00657
**             YOU HAVE TO ADJUST THE "BYTES MOVED"         **           00657
**             FIELD IN OUTCCW+6(2) TO A SMALL VALUE,       **           00657
**             SUCH AS X'0001'.  SO IN THAT CASE, WE        **           00657
**             SAVE THE "BYTES MOVED" FIELD TO LABEL        **           00657
**             SAVBYTES, AND REPLACE IT WITH X'0001'        **           00657
**             DURING THE WRITE OF THE TAPE MARK.           **           00657
**                                                          **           00657
** LEVEL 053 - OPTION TO TURN OFF 3490E OR IDRC INDICATORS  **           00657
**             IN THE TAPE LABELS.  ALSO ON INPUT ERROR,    **           00657
**             CLOSE ALL THE FILES BEFORE ABEND 069.        **           00657
**                                                          **           00657
** LEVEL 054 - HEX PRINT FIRST 132 BYTES OF FIRST N         **           00657
**             RECORDS OF EACH FILE.  IF KEYWORD HEXPRT     **           00657
**             IS CODED, A DEFAULT OF 4 BLOCKS FROM EACH    **           00657
**             TAPE FILE WILL BE DUMPED (THE WAY TAPESCAN   **           00657
**             DOES IT).  YOU CAN OVERRIDE THIS VALUE BY    **           00657
**             CODING PRINTRCDS=nnn IN SYSIN, STARTING IN   **           00657
**             COLUMN 1.  RECORDS ARE DUMPED INTO THE       **           00657
**             SYSPRINT DATASET.                            **           00657
**                                                          **           00657
** LEVEL 055 - MAKE DEFAULT NUMBER OF RECORDS TO HEX PRINT, **           00657
**             A GLOBAL ASSEMBLER VARIABLE, &HEXDFLA.       **           00657
**             DISTRIBUTION VALUE IS SET TO 4, AS ABOVE.    **           00657
**                                                          **           00657
** LEVEL 056 - TAKE THE TRANSLATE TABLES FOR HEX PRINT OUT  **           00657
**             OF THE MAIN CSECT.                           **           00657
**                                                          **           00657
**************************************************************           00658
**************************************************************           00659
         EJECT                                                           00660
         YREGS                                                           00661
         GBLC  &HEXDFLT,&HEXDFLL,&HEXDFLM
         GBLA  &HEXDFLA
* ------------------------------------------------------------------ *
*    HEXDFLA IS THE DEFAULT FOR THE NUMBER OF RECORDS TO BE          *
*    HEX DUMPED FROM EACH TAPE FILE.  SET TO 4 IN THE DISTRIBUTION.  *
* ------------------------------------------------------------------ *
&HEXDFLA SETA  4
&HEXDFLC SETC  '&HEXDFLA'
COPYMODS CSECT                                                           00662
         USING *,R15                                          SBG 03/00  00663
         B     EYECATCH                                       SBG 03/00  00664
         DC    C'HEX DUMP '
HEXDFLCC DC    C'&HEXDFLC'
         DC    C' RECORDS '
HEXDFLL  EQU   L'HEXDFLCC
&HEXDFLM SETC  (6-HEXDFLL)' '.'&HEXDFLA'
         DC    C'--- '            MAKE EYECATCHER VISIBLE     SBG 03/00  00665
         DC    C'COPYMODS '                                   SBG 03/00  00666
         DC    C'&SYSDATE',C'  ',C'&SYSTIME ',C'--- '         SBG 03/00  00667
         DC    C'PARM INPUT IN SYSIN '                                   00668
SAVEAREA DC    18F'0'                                                    00669
EYECATCH DS    0D             ENSURE ALIGNMENT                SBG 03/00  00670
         SAVE  (14,12)                                                   00671
         LR    R5,R1          SAVE PARM POINTER                          00672
         LA    R1,SAVEAREA          NEW SAVE-AREA ADDR                   00673
         ST    R1,8(,R13)           FORWARD SAVE-AREA CHAIN PTR          00674
         ST    R13,4(,R1)           BACKWARD SAVE-AREA CHAIN PTR         00675
         LR    R13,R1               NEW SAVE AREA ADDRESS                00676
         DROP  R15                                                       00677
* -----                       SET UP SIX BASE REGISTERS                  00678
         USING COPYMODS,R12,R11,R10,R9,R8,R6                             00679
         LR    R12,R15                                                   00680
         LA    R11,4095(,R12)                                            00681
         LA    R11,1(,R11)                                               00682
         LA    R10,4095(,R11)                                            00683
         LA    R10,1(,R10)                                               00684
         LA    R9,4095(,R10)                                             00685
         LA    R9,1(,R9)                                                 00686
         LA    R8,4095(,R9)                                              00687
         LA    R8,1(,R8)                                                 00688
         LA    R6,4095(,R8)                                              00689
         LA    R6,1(,R6)                                                 00690
         LR    R1,R5          RESTORE PARM POINTER                       00691
         L     R0,=V(TRTCSECT)
         ST    R0,SAVTRTCS
* ----------------------------------------------------------------- *    00692
         BAL   R7,PARMCHK       FLAG ALL PARMS CODED,         SBG 04/00  00693
*                          AND CHECK FOR SYSIN ADDITIONALLY.  SBG 09/00  00694
* ----------------------------------------------------------------- *    00695
TIOTSCAN DS    0H             Determine the presence of Optional         00696
* ----->                      DDNAME:  SYSIN, AND FLAG IF IT IS THERE.   00697
* ----------------------------------------------------------------- *    00698
         L     R5,16          R5=CVT                                     00699
         L     R5,0(,R5)      R5=TCB WORDS                               00700
         L     R5,4(,R5)      R5=MY TCB                                  00701
         L     R5,12(,R5)     R5=TIOT                                    00702
         LA    R5,24(,R5)     R5=FIRST DD ENTRY                          00703
TIOTLUPE CLC   0(4,R5),=XL4'00' END OF TIOT?                             00704
         BE    TIOTSND        YES, CHECK FOR OUTPUT VOL OVERRIDES        00705
         CLC   4(8,R5),SYSIN+40     SYSIN DDNAME THERE?                  00706
         BNE   TIOTNXT        NO                                         00707
         OI    PARMFLG2,X'20'       SHOW PRESENCE OF SYSIN DD            00708
         B     TIOTSEND       CONTINUE                                   00709
TIOTNXT  SR    R3,R3                                                     00710
         IC    R3,0(,R5)      R3=LENGTH OF DD ENTRY                      00711
         AR    R5,R3          R5=NEXT DD ENTRY                           00712
         B     TIOTLUPE       GO CHECK IT                                00713
TIOTSND  DS    0H                                                        00714
         NI    PARMFLG2,X'FF'-X'20'    End of TIOT. No SYSIN DD.         00715
TIOTSEND DS    0H                                                        00716
* ----------------------------------------------------------------- *    00717
OPNSYSIN TM    PARMFLG2,X'20'   DO WE NEED SYSIN?                        00718
         BZ    OPNSYSNE         NO. GO FURTHER IN PROCESSING             00719
         OPEN  (SYSIN,INPUT)                                             00720
         TM    SYSIN+48,X'10'        IS THE DD OPEN  ?                   00721
         BZ    NOSYSIN        NO. FLAG THE ERROR & MESSAGE               00722
         OI    OPENDFLG,X'02'     FLAG THAT SYSIN IS OPEN                00723
         B     OPNSYSNE           AND CONTINUE PROCESSING.               00724
NOSYSIN  MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     00725
         MVC   LINE(133),NSYSMSG   DISPLAY MISSING DD MESSAGE            00726
         PUT   SYSPRINT,LINE                                             00727
         OI    ENDITFLG,X'02'   FLAG THAT SYSIN NOT OPEN.                00728
OPNSYSNE DS    0H                                                        00729
* ----------------------------------------------------------------- *    00730
CHEKCARD TM    PARMFLG2,X'20'     TEST IF SYSIN IS NEEDED.               00731
         BZ    CHEKCEND           ISN'T. NO POINT TO READ CARDS.         00732
         TM    OPENDFLG,X'02'     IS SYSIN OPEN ?                        00733
         BZ    CHEKCEND           ISN'T THERE SO CAN'T LOOK AT IT.       00734
         BAL   R7,CARDREAD        CHECK SYSIN FOR PARMS AND OVERRIDES    00735
CHEKCEND DS    0H                                                        00736
* ----------------------------------------------------------------- *    00737
*              SUBMITTED PARMS SHOULD BE FINALIZED BY NOW           *    00738
*       ----   NOW MAKE PARM ADJUSTMENTS TO BE CONSISTENT   ----    *    00739
* ----------------------------------------------------------------- *    00740
         BAL   R7,CLEARSAV      CLEAR SAVE AREAS IF LBLFIX IS ON         00741
         TM    PARMFLG1,X'20'   ARE WE SKIPPING LTM'S?        SBG 04/00  00742
         BZ    COPYLTMS         NO. WE'RE COPYING THEM.       SBG 04/00  00743
*                               YES. WE'RE SKIPPING THEM, SO  SBG 04/00  00744
         MVC   LTMRPTI,SKIPPED  MOVE INDICATOR TO REPORT      SBG 03/00  00745
         B     SKIPLTMS         AND DO OTHER INITIALIZATION   SBG 03/00  00746
COPYLTMS MVC   LTMRPTI,COPIED   MOVE INDICATOR TO REPORT      SBG 03/00  00747
SKIPLTMS DS    0H                                             SBG 06/00  00748
* ----- * ----- * ------                                                 00749
         TM    PARMFLG3,X'C0'   IS NOEXNULL OR LBLFIX ON?                00750
         BZ    NONOEXNL         NO. BYPASS ADJUSTMENT                    00751
         OI    PARMFLG2,X'80'   LABADDIN HAS TO BE ON                    00752
NONOEXNL DS    0H                                                        00753
* ----- * ----- * ------                                                 00754
* ----- * ----- * ------ *------                                         00755
         TM    PARMFLG4,X'01'   IS CUMSEP ON?                            00756
         BZ    NOCUMSEP         NO. BYPASS ADJUSTMENT                    00757
         OI    PARMFLG3,X'08'   CUMSEP IMPLIES CUMTOT IS ON              00758
NOCUMSEP DS    0H                                                        00759
* ----- * ----- * ------ *------                                         00760
* ----- * -----                                                          00761
         TM    PARMFLG3,X'08'   IS CUM TOTALS ON?                        00762
         BZ    NOCUMTOT         NO. BYPASS ADJUSTMENT                    00763
         OI    PARMFLG3,X'04'   CUMTOT IMPLIES BYTES HAS TO BE ON        00764
NOCUMTOT DS    0H                                                        00765
* ----- * -----                                                          00766
*  -------------- CODE TO MAKE SURE LABADDIN DOES NOT OCCUR              00767
*  -------------- TOGETHER WITH LABLDUMP OPTION. ---------------- *      00768
         TM    PARMFLG2,X'80'          ARE WE CREATING LABELS?           00769
         BZ    CANLBDMP                NO. WE CAN DUMP LABELS.           00770
         NI    PARMFLG2,FF-X'10'       YES. TURN OFF LABLDUMP            00771
         NI    PARMFLG2,FF-X'08'       YES. TURN OFF READ ONLY TOO       00772
*                                      BECAUSE WE'RE COPYING TO SL.      00773
         OI    WRLBLFLG,X'01'      INITIALIZE TO READ LABELS             00774
CANLBDMP DS    0H                                                        00775
*** --- ***** ------------------- LBDQUICK PARM ADJUSTMENTS - BELOW *    00776
         TM    PARMFLG4,X'80'   IS LBDQUICK ON?                          00777
         BZ    NOLBDQUI         NO. BYPASS THESE ADJUSTMENTS             00778
         OI    PARMFLG2,X'08'   READ-ONLY HAS TO BE ON                   00779
         OI    PARMFLG2,X'10'   LABLDUMP HAS TO BE ON                    00780
         NI    PARMFLG2,FF-X'80'   LABADDIN HAS TO BE OFF                00781
NOLBDQUI DS    0H                                                        00782
*** --- ***** ------------------- LBDQUICK PARM ADJUSTMENTS - ABOVE *    00783
*** ----> ***** ------------------- STRIP PARM ADJUSTMENTS - BELOW *
         TM    PARMFLG4,X'02'      IS STRIP ON?
         BZ    NOSTRADJ            NO. NO OTHER PARM ADJUSTMENTS
         NI    PARMFLG2,FF-X'80'   LABADDIN HAS TO BE OFF
         NI    PARMFLG2,FF-X'40'   OUTVOL   HAS TO BE OFF
         NI    PARMFLG4,FF-X'80'   LBDQUICK HAS TO BE OFF
         NI    PARMFLG2,FF-X'01'   CHGVOL OFF
         NI    PARMFLG3,FF-X'01'   INITVOL OFF
NOSTRADJ DS    0H                  END of the STRIP adjustments
*** ----> ***** ------------------- STRIP PARM ADJUSTMENTS - ABOVE *
* ----------------------------------------------------------------- *    00784
* --           PARMS HAVE NOW BEEN ADJUSTED                      -- *    00785
* --    ----   NOW REPORT OPTIONS IF WANTED   ----               -- *    00786
* ----------------------------------------------------------------- *    00787
* --                                                             -- *    00788
         TM    PARMFLG4,X'20'      ARE WE REPORTING OPTIONS?             00789
         BZ    NOOPTRPT            NO - BYPASS CALLING SUBPROGRAM        00790
         STM   R14,R12,SAV14T12  SAVE THESE REGISTERS                    00791
         LA    R1,PARMFLGS       POINT TO QUANTITY TO BE PASSED          00792
         L     R15,=V(COPYMOPT)  LOAD V-CON FOR SUBPROGRAM               00793
         LTR   R15,R15           WAS SUBPROGRAM PRESENT?                 00794
         BZ    NOOPTRP1          NO. DON'T CALL IT                       00795
         BALR  R14,R15           CALL SUBPROGRAM                         00796
NOOPTRP1 LM    R14,R12,SAV14T12  RESTORE THESE REGISTERS                 00797
NOOPTRPT DS    0H                                                        00798
*  -------------------------------------------------------------- *      00799
         STM   R14,R3,SAV14T03   GET READY TO SAVE INPUT VOL  SBG 06/00  00800
         RDJFCB IN                                                       00801
         MVC   INVOLJ(6),INJFCB+118    SAVE INPUT VOLUME FROM JCL        00802
         MVC   SUCCESSR+60(6),INJFCB+118   COPY TO READ MESSG SBG 06/00  00803
         MVC   READOMSG+60(6),INJFCB+118   COPY TO READ MESSG SBG 06/00  00804
         LM    R14,R3,SAV14T03   RESTORE REGISTERS                TEST   00805
         XC    FULLWORK,FULLWORK  CLEAR WORK AREA             SBG 03/00  00806
         MVC   FILECNT,=F'1'  INITIALIZE FOR FILE NUMBER                 00807
         MVI   DATFLAG,X'10' INITIALIZE FLAG-NO DATA READ YET SBG 03/00  00808
         SPACE 3                                                         00809
OPENSYSP DS    0H                                                        00810
*                                                                        00811
*  DETERMINE WHICH OUTPUT DD'S ARE PRESENT                               00812
*                                                                        00813
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  00814
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  00815
         BO    OPENS      YES--SKIP ALL THE TIOT FOR OUT DD'S SBG 06/00  00816
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  00817
         L     R2,16          R2=CVT                                     00818
         L     R2,0(,R2)      R2=TCB WORDS                               00819
         L     R2,4(,R2)      R2=MY TCB                                  00820
         L     R2,12(,R2)     R2=TIOT                                    00821
         LA    R2,24(,R2)     R2=FIRST DD ENTRY                          00822
TIOTLOOP CLC   0(4,R2),=XL4'00' END OF TIOT?                             00823
         BE    OVOLOV         YES, CHECK FOR OUTPUT VOL OVERRIDES        00824
         CLC   4(8,R2),OUT1+40  OUTPUT FILE NUMBER 1?                    00825
         BNE   TIOT1          NO                                         00826
         OI    FLAG1,OP1      SHOW IT                                    00827
         STM   R14,R3,SAV14T03                                    TEST   00828
         RDJFCB OUT1                                                     00829
         MVC   VOLUME1(6),OUTJFCB+118    SAVE VOLUME SERIAL              00830
         MVC   VOLDD,DDOUT1                                              00831
         LM    R14,R3,SAV14T03                                    TEST   00832
         B     TIOTNEXT       CONTINUE                                   00833
TIOT1    CLC   4(8,R2),OUT2+40  OUTPUT FILE NUMBER 2?                    00834
         BNE   TIOT2          NO                                         00835
         OI    FLAG1,OP2      SHOW IT                                    00836
         STM   R14,R3,SAV14T03                                    TEST   00837
         RDJFCB OUT2                                                     00838
         MVC   VOLUME2(6),OUTJFCB+118    SAVE VOLUME SERIAL              00839
         MVC   VOLDD,DDOUT2                                              00840
         LM    R14,R3,SAV14T03                                    TEST   00841
         B     TIOTNEXT       CONTINUE                                   00842
TIOT2    CLC   4(8,R2),OUT3+40  OUTPUT FILE NUMBER 3?                    00843
         BNE   TIOT3          NO                                         00844
         OI    FLAG1,OP3      SHOW IT                                    00845
         STM   R14,R3,SAV14T03                                    TEST   00846
         RDJFCB OUT3                                                     00847
         MVC   VOLUME3(6),OUTJFCB+118    SAVE VOLUME SERIAL              00848
         MVC   VOLDD,DDOUT3                                              00849
         LM    R14,R3,SAV14T03                                    TEST   00850
         B     TIOTNEXT       CONTINUE                                   00851
TIOT3    CLC   4(8,R2),OUT4+40  OUTPUT FILE NUMBER 4?                    00852
         BNE   TIOT4          NO                                         00853
         OI    FLAG1,OP4      SHOW IT                                    00854
         STM   R14,R3,SAV14T03                                    TEST   00855
         RDJFCB OUT4                                                     00856
         MVC   VOLUME4(6),OUTJFCB+118    SAVE VOLUME SERIAL              00857
         MVC   VOLDD,DDOUT4                                              00858
         LM    R14,R3,SAV14T03                                    TEST   00859
         B     TIOTNEXT       CONTINUE                                   00860
TIOT4    CLC   4(8,R2),OUT5+40  OUTPUT FILE NUMBER 5?                    00861
         BNE   TIOT5          NO                                         00862
         OI    FLAG1,OP5      SHOW IT                                    00863
         STM   R14,R3,SAV14T03                                    TEST   00864
         RDJFCB OUT5                                                     00865
         MVC   VOLUME5(6),OUTJFCB+118    SAVE VOLUME SERIAL              00866
         MVC   VOLDD,DDOUT5                                              00867
         LM    R14,R3,SAV14T03                                    TEST   00868
         B     TIOTNEXT       CONTINUE                                   00869
TIOT5    CLC   4(8,R2),OUT6+40  OUTPUT FILE NUMBER 6?                    00870
         BNE   TIOT6          NO                                         00871
         OI    FLAG1,OP6      SHOW IT                                    00872
         STM   R14,R3,SAV14T03                                    TEST   00873
         RDJFCB OUT6                                                     00874
         MVC   VOLUME6(6),OUTJFCB+118    SAVE VOLUME SERIAL              00875
         MVC   VOLDD,DDOUT6                                              00876
         LM    R14,R3,SAV14T03                                    TEST   00877
         B     TIOTNEXT       CONTINUE                                   00878
TIOT6    CLC   4(8,R2),OUT7+40  OUTPUT FILE NUMBER 7?                    00879
         BNE   TIOT7          NO                                         00880
         OI    FLAG1,OP7      SHOW IT                                    00881
         STM   R14,R3,SAV14T03                                    TEST   00882
         RDJFCB OUT7                                                     00883
         MVC   VOLUME7(6),OUTJFCB+118    SAVE VOLUME SERIAL              00884
         MVC   VOLDD,DDOUT7                                              00885
         LM    R14,R3,SAV14T03                                    TEST   00886
         B     TIOTNEXT       CONTINUE                                   00887
TIOT7    CLC   4(8,R2),OUT8+40  OUTPUT FILE NUMBER 8?                    00888
         BNE   TIOT8          NO                                         00889
         OI    FLAG1,OP8      SHOW IT                                    00890
         STM   R14,R3,SAV14T03                                    TEST   00891
         RDJFCB OUT8                                                     00892
         MVC   VOLUME8(6),OUTJFCB+118    SAVE VOLUME SERIAL              00893
         MVC   VOLDD,DDOUT8                                              00894
         LM    R14,R3,SAV14T03                                    TEST   00895
         B     TIOTNEXT       CONTINUE                                   00896
TIOT8    CLC   4(8,R2),OUT9+40  OUTPUT FILE NUMBER 9?                    00897
         BNE   TIOT9          NO                                         00898
         OI    FLAG2,OP9      SHOW IT                                    00899
         STM   R14,R3,SAV14T03                                    TEST   00900
         RDJFCB OUT9                                                     00901
         MVC   VOLUME9(6),OUTJFCB+118    SAVE VOLUME SERIAL              00902
         MVC   VOLDD,DDOUT9                                              00903
         LM    R14,R3,SAV14T03                                    TEST   00904
         B     TIOTNEXT       CONTINUE                                   00905
TIOT9    CLC   4(8,R2),OUT10+40  OUTPUT FILE NUMBER 10?                  00906
         BNE   TIOT10         NO                                         00907
         OI    FLAG2,OP10     SHOW IT                                    00908
         STM   R14,R3,SAV14T03                                    TEST   00909
         RDJFCB OUT10                                                    00910
         MVC   VOLUME10(6),OUTJFCB+118    SAVE VOLUME SERIAL             00911
         MVC   VOLDD,DDOUT10                                             00912
         LM    R14,R3,SAV14T03                                    TEST   00913
         B     TIOTNEXT       CONTINUE                                   00914
TIOT10   CLC   4(8,R2),OUT11+40  OUTPUT FILE NUMBER 11?                  00915
         BNE   TIOT11         NO                                         00916
         OI    FLAG2,OP11     SHOW IT                                    00917
         STM   R14,R3,SAV14T03                                    TEST   00918
         RDJFCB OUT11                                                    00919
         MVC   VOLUME11(6),OUTJFCB+118    SAVE VOLUME SERIAL             00920
         MVC   VOLDD,DDOUT11                                             00921
         LM    R14,R3,SAV14T03                                    TEST   00922
         B     TIOTNEXT       CONTINUE                                   00923
TIOT11   CLC   4(8,R2),OUT12+40  OUTPUT FILE NUMBER 12?                  00924
         BNE   TIOT12         NO                                         00925
         OI    FLAG2,OP12     SHOW IT                                    00926
         STM   R14,R3,SAV14T03                                    TEST   00927
         RDJFCB OUT12                                                    00928
         MVC   VOLUME12(6),OUTJFCB+118    SAVE VOLUME SERIAL             00929
         MVC   VOLDD,DDOUT12                                             00930
         LM    R14,R3,SAV14T03                                    TEST   00931
         B     TIOTNEXT       CONTINUE                                   00932
TIOT12   CLC   4(8,R2),OUT13+40  OUTPUT FILE NUMBER 13?                  00933
         BNE   TIOT13         NO                                         00934
         OI    FLAG2,OP13     SHOW IT                                    00935
         STM   R14,R3,SAV14T03                                    TEST   00936
         RDJFCB OUT13                                                    00937
         MVC   VOLUME13(6),OUTJFCB+118    SAVE VOLUME SERIAL             00938
         MVC   VOLDD,DDOUT13                                             00939
         LM    R14,R3,SAV14T03                                    TEST   00940
         B     TIOTNEXT       CONTINUE                                   00941
TIOT13   CLC   4(8,R2),OUT14+40  OUTPUT FILE NUMBER 14?                  00942
         BNE   TIOT14         NO                                         00943
         OI    FLAG2,OP14     SHOW IT                                    00944
         STM   R14,R3,SAV14T03                                    TEST   00945
         RDJFCB OUT14                                                    00946
         MVC   VOLUME14(6),OUTJFCB+118    SAVE VOLUME SERIAL             00947
         MVC   VOLDD,DDOUT14                                             00948
         LM    R14,R3,SAV14T03                                    TEST   00949
         B     TIOTNEXT       CONTINUE                                   00950
TIOT14   CLC   4(8,R2),OUT15+40  OUTPUT FILE NUMBER 15?                  00951
         BNE   TIOT15         NO                                         00952
         OI    FLAG2,OP15     SHOW IT                                    00953
         STM   R14,R3,SAV14T03                                    TEST   00954
         RDJFCB OUT15                                                    00955
         MVC   VOLUME15(6),OUTJFCB+118    SAVE VOLUME SERIAL             00956
         MVC   VOLDD,DDOUT15                                             00957
         LM    R14,R3,SAV14T03                                    TEST   00958
         B     TIOTNEXT       CONTINUE                                   00959
TIOT15   CLC   4(8,R2),OUT16+40  OUTPUT FILE NUMBER 16?                  00960
         BNE   TIOTNEXT       NO                                         00961
         OI    FLAG2,OP16     SHOW IT                                    00962
         STM   R14,R3,SAV14T03                                    TEST   00963
         RDJFCB OUT16                                                    00964
         MVC   VOLUME16(6),OUTJFCB+118    SAVE VOLUME SERIAL             00965
         MVC   VOLDD,DDOUT16                                             00966
         LM    R14,R3,SAV14T03                                    TEST   00967
         B     TIOTNEXT       CONTINUE                                   00968
TIOTNEXT SR    R3,R3                                                     00969
         IC    R3,0(,R2)      R3=LENGTH OF DD ENTRY                      00970
         AR    R2,R3          R2=NEXT DD ENTRY                           00971
         B     TIOTLOOP       GO CHECK IT                                00972
*  ---------------------------------------------------------  SBG 09/00  00973
*  --------  DO WE PROPAGATE OUTPUT VOLSER TO ALL OUTPUTS ? --------*    00974
OVOLOV   TM    PARMFLG2,X'20'    IS SYSIN PRESENT                        00975
         BZ    NOVOLOV           NO. CAN'T OVERRIDE OUTPUT VOLSERS.      00976
         TM    OVERFLAG,X'01'    IS THERE AN OVERRIDE PENDING?           00977
         BZ    NOVOLOV           NOPE.  JUST GET OUT.                    00978
         MVC   VOLALL,VOLSTG     PROPAGATE VOLSER TO ALL OUTPUTS         00979
NOVOLOV  DS    0H                                                        00980
*  ---------------------------------------------------------  SBG 09/00  00981
         SPACE 3                                                         00982
*  -----------------------------------------------------------------  *  00983
*                                                                        00984
*  OPEN ALL FILES   -  EXCEPT SYSIN, WHICH IS FINISHED ALREADY           00985
*                                                                        00986
*  -----------------------------------------------------------------  *  00987
OPENS    DS    0H               START OPENING FILES                      00988
         OPEN  (SYSPRINT,OUTPUT)                                         00989
         TM    PARMFLG3,X'01'    INIT TAPES ONLY?                        00990
         BO    OPENMOVE                                                  00991
*----- TESTS FOR EXTRA DD CARDS REQUIRED - EXTRA FILES TO BE OPENED.     00992
         TM    PARMFLG2,X'10'   DO WE DUMP LABELS?            SBG 09/00  00993
         BZ    OPNLABIN         NO. CHECK IF WE NEED LABADDIN.    09/00  00994
         OPEN  (LABLDUMP,OUTPUT)                              SBG 09/00  00995
         TM    LABLDUMP+48,X'10'     IS THE DD OPEN  ?                   00996
         BZ    NOLBLDD        NO. FLAG ERROR AND CHECK LABADDIN.         00997
         OI    OPENDFLG,X'01'     FLAG THAT LABLDUMP IS OPEN.            00998
         B     OPNLABIN           CHECK FOR LABADDIN DDNAME              00999
NOLBLDD  MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     01000
         MVC   LINE(133),LDMPMSG   DISPLAY MISSING DD MESSAGE            01001
         PUT   SYSPRINT,LINE                                             01002
         OI    ENDITFLG,X'01'   FLAG THAT LABLDUMP NOT OPEN.             01003
OPNLABIN TM    PARMFLG2,X'80'   DO WE NEED LABADDIN?                     01004
         BZ    CHKENDIT         NO. SEE IF ANYTHING ELSE IS BAD          01005
         OPEN  (LABADDIN,INPUT)                                          01006
         TM    LABADDIN+48,X'10'     IS THE DD OPEN  ?                   01007
         BZ    NOLABIN        NO. FLAG THE ERROR & MESSAGE               01008
         OI    OPENDFLG,X'04'     FLAG THAT LABADDIN IS OPEN.            01009
         B     CHKENDIT        GO CHECK IF WE HAVE TO END.               01010
NOLABIN  MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     01011
         MVC   LINE(133),NLABMSG   DISPLAY MISSING DD MESSAGE            01012
         PUT   SYSPRINT,LINE                                             01013
         OI    ENDITFLG,X'04'   FLAG THAT LABADDIN NOT OPEN.             01014
CHKENDIT TM    ENDITFLG,X'07'   CHECK IF WE HAVE TO END                  01015
         BZ    OPENIN           NOTHING WRONG.  GO ON.                   01016
ENDEM    DS    0H            WE GOTTA GET OUT. WHICH DDS STILL OPEN?     01017
         CLOSE (SYSPRINT)                                                01018
         TM    OPENDFLG,X'01'   IS LABLDUMP DD OPEN?                     01019
         BZ    TRYCSYSN         NO.  TRY IF SYSIN IS OPEN.               01020
         NI    OPENDFLG,FF-X'01'   MARK FILE AS CLOSED                   01021
         CLOSE (LABLDUMP)                                                01022
TRYCSYSN TM    OPENDFLG,X'02'   IS SYSIN    DD OPEN?                     01023
         BZ    TRYCLABN         NO.  TRY LABADDIN.                       01024
         NI    OPENDFLG,FF-X'02'   MARK FILE AS CLOSED                   01025
         CLOSE (SYSIN)                                                   01026
TRYCLABN TM    OPENDFLG,X'04'   IS LABADDIN DD OPEN?                     01027
         BZ    REALYEND         NO.  GET OUT.                            01028
         NI    OPENDFLG,FF-X'04'   MARK FILE AS CLOSED                   01029
         CLOSE (LABADDIN)                                                01030
REALYEND B     THEEND1                                                   01031
         EJECT                                                           01032
OPENIN   OPEN  (IN,INPUT)                                                01033
         TM    IN+48,X'10'                                               01034
         BO    INISOPEN                                                  01035
** --- IF IN DDNAME IS NOT OPEN ----- BELOW ------------------ *         01036
         TM    PARMFLG3,X'01'       INITTING TAPES?                      01037
         BO    INISOPEN             OK. SHOULDN'T COME HERE, BUT         01038
*                                   BYPASS MESSAGE.                      01039
         MVC   LINE(133),LINE-1     CLEAR MESSAGE LINE                   01040
         MVC   LINE(133),INNOTOPN   MOVE IN MESSAGE TEXT                 01041
         PUT   SYSPRINT,LINE        PUT OUT MESSAGE                      01042
         B     ENDEM                GO TO CLOSE FILES, AND OUT.          01043
** --- IF IN DDNAME IS NOT OPEN ----- ABOVE ------------------ *         01044
INISOPEN DS    0H                                                        01045
         TM    PARMFLG3,X'02'     LIMIT FILES TO BE COPIED?              01046
         BO    OPENINCK           DO PRELIMINARY OPEN IF SO              01047
* -------------- LABADDIN CHECK FOR SL TAPE ------------------------ *   01048
         TM    PARMFLG2,X'80'     ARE WE DOING LABADDIN ?                01049
         BZ    NOINITOP           NO. DON'T DO PRELIMINARY OPEN          01050
* ----                                                                   01051
OPENINCK DS    0H                                                        01052
         LA    R2,IN              POINT TO IN DCB                        01053
         ST    R2,REWDCBPT        TELL IOB TO REWIND IN                  01054
         MVC   REWECB,=F'0'       INITIALIZE REW'S ECB                   01055
         EXCP  REWIOB                                                    01056
         WAIT  ECB=REWECB                                                01057
         MVC   INECB,=F'0'        INITIALIZE IN'S ECB                    01058
         EXCP  INIOB                                                     01059
         WAIT  ECB=INECB                                                 01060
         CLC   INAREA(4),=C'VOL1' IS THE TAPE IBM SL ?                   01061
         BNE   RESETIN            NO. JUST REWIND TO REPOSITION.         01062
         OI    SLFLAG,X'01'       INDICATE INPUT TAPE IS SL              01063
         TM    PARMFLG2,X'80'     ARE WE HERE FOR LABADDIN?              01064
         BO    OPENINXX           VOL1 IS NOT LEGITIMATE FOR LABADDIN    01065
****** ------ BELOW ------ SL FILE NUMBERS.                              01066
         TM    PARMFLG3,X'02'     ARE WE LIMITING INPUT FILES?           01067
         BZ    OPENINXX           NO, GET OUT OF ROUTINE                 01068
         CLC   LINFILE,=F'0'      IS THERE A POSITIVE LIMIT NUMBER?      01069
         BE    RESETIN            NO. JUST RESET TAPE W/O ERROR MSG      01070
**** ----- >>>>>   Force file limiting by SL   - - -  below
         TM    PARMFLG4,X'08'        PARM to force SL reckoning of lim
         BZ    NOSLFLIM              Not set, bypass code for it
         MVC   LTGFILE(4),LSLFILE    Use coded FILELIMIT number
         MVC   LIMFMSG+68(2),=C'SL'  And mark msg as an SL reckoning
         MVC   LINE(133),LINE-1      Clear message line                  01077
         MVC   LINE(133),FORCESLM    Say you'll force limiting by SL     01078
         PUT   SYSPRINT,LINE         Write msg                           01079
         TM    PARMFLG4,X'0C'        Are both NLLIM and SLLIM coded?
         BNO   SLLIMRES              No. only SLLIM. So go on.
         MVC   LINE(133),LINE-1      Clear message line                  01077
         MVC   LINE(133),TWOFORCE    Say you'll force limiting by SL     01078
         PUT   SYSPRINT,LINE         Write msg                           01079
SLLIMRES DS    0H
         B     RESETIN
NOSLFLIM DS    0H
**** ----- >>>>>   Force file limiting by SL   - - -  above
**** ----- >>>>>   Force file limiting by NL   - - -  below
         TM    PARMFLG4,X'04'        PARM to force NL reckoning of lim
         BZ    NONLFLIM              Not set, bypass code for it
         MVC   LTGFILE(4),LINFILE    Use coded FILELIMIT number
         MVC   LIMFMSG+68(2),=C'NL'  And mark msg as an NL reckoning
         MVC   LINE(133),LINE-1      Clear message line                  01077
         MVC   LINE(133),FORCENLM    Say you'll force limiting by NL     01078
         PUT   SYSPRINT,LINE         Write msg                           01079
         B     RESETIN
NONLFLIM DS    0H
**** ----- >>>>>   Force file limiting by NL   - - -  above
* -- > Strip test
         TM    PARMFLG4,X'02'        Are we stripping labels?
         BZ    OPENINXW              No. Bypass this section.
         TM    PARMFLG3,X'02'        Are we limiting files also?
         BO    OPENINXW              Yes. Use SL number.
         MVC   LTGFILE(4),LINFILE    STRIP no LIMFILE, move NL number.
         MVC   LIMFMSG+68(2),=C'SL'  But indicate that input is SL
         B     RESETIN            REWIND INPUT TAPE WITHOUT ERROR MSG
OPENINXW DS    0H
* -- > Strip test
         MVC   LTGFILE(4),LSLFILE    MOVE IN 3 TIMES SET LIMIT FOR SL    01071
         MVC   LIMFMSG+68(2),=C'SL'  MOVE SL INTO FILE NUMBER MESSAGE    01072
         B     RESETIN            REWIND INPUT TAPE WITHOUT ERROR MSG    01073
OPENINXX DS    0H                                                        01074
****** ------ ABOVE ------ SL FILE NUMBERS.                              01075
* --                         WE HAVE VOL1 LABEL. NASTY MSG AND QUIT.     01076
         MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     01077
         MVC   LINE(133),NOLABSL  DISPLAY NO SL ON SL MSG                01078
         PUT   SYSPRINT,LINE      WRITE MSG                              01079
         TM    OPENDFLG,X'02'   IS SYSIN    DD OPEN?                     01080
         BZ    RESETLAD         NO.  TRY LABADDIN.                       01081
         NI    OPENDFLG,FF-X'02'   MARK FILE AS CLOSED                   01082
         CLOSE (SYSIN)                                                   01083
RESETLAD TM    OPENDFLG,X'04'   IS LABADDIN DD OPEN?                     01084
         BZ    RESETEND         NO.  GET OUT.                            01085
         NI    OPENDFLG,FF-X'04'   MARK FILE AS CLOSED                   01086
         CLOSE (LABADDIN)                                                01087
RESETEND CLOSE (IN)                                                      01088
         B     THEEND1                                                   01089
* --                      NO VOL1 LABEL. ASSUME NL TAPE SO CONTINUE.     01090
RESETIN  DS    0H                                                        01091
         MVC   REWECB,=F'0'                                              01092
         EXCP  REWIOB                                                    01093
         WAIT  ECB=REWECB                                                01094
NOINITOP DS    0H                                                        01095
* -------------- LABADDIN CHECK FOR SL TAPE ------------------------ *   01096
         TM    PARMFLG2,X'10'     TEST IF LABLDUMP IS NEEDED.            01097
         BZ    NOLBLDMP           ISN'T. NO POINT TO RDJFCB.             01098
READJLDM RDJFCB LABLDUMP                MOVE JFCB TO AREA                01099
         LTR   R15,R15                  DDNAME SHOULD BE THERE           01100
         BNZ   NOLBLDD                  IF NOT, FLAG                     01101
         ST    R7,SAVE7REG              SAVE R7                          01102
         LA    R7,LBLJFCB               POINT TO JFCB AREA               01103
         USING JFCBLK,R7                MAP THE AREA                     01104
         MVC   LDMPOUTM+38(44),JFCBDSNM                                  01105
         MVC   LDMPOUTM+89(8),JFCBELNM                                   01106
         MVC   LDMPOUTM+105(6),JFCBVOLS                                  01107
         MVC   LINE(133),LINE-1                                          01108
         MVC   LINE(133),LDMPOUTM                                        01109
         PUT   SYSPRINT,LINE                                             01110
         DROP  R7                                                        01111
         L     R7,SAVE7REG              RESTORE R7                       01112
NOLBLDMP DS    0H               SKIP LABLDUMP RDJFCB.         SBG 09/00  01113
         TM    PARMFLG2,X'80'     TEST IF LABLDUMP IS NEEDED.            01114
         BZ    NOLBLSIN           ISN'T. NO POINT TO RDJFCB.             01115
READJLIN RDJFCB LABADDIN                MOVE JFCB TO AREA                01116
         LTR   R15,R15                  DDNAME SHOULD BE THERE           01117
         BNZ   NOLABIN                  IF NOT, FLAG                     01118
         ST    R7,SAVE7REG              SAVE R7                          01119
         LA    R7,LBNJFCB               POINT TO JFCB AREA               01120
         USING JFCBLK,R7                MAP THE AREA                     01121
         MVC   LDMPINMS+38(44),JFCBDSNM                                  01122
         MVC   LDMPINMS+89(8),JFCBELNM                                   01123
         MVC   LDMPINMS+105(6),JFCBVOLS                                  01124
         MVC   LINE(133),LINE-1                                          01125
         MVC   LINE(133),LDMPINMS                                        01126
         PUT   SYSPRINT,LINE                                             01127
         DROP  R7                                                        01128
         L     R7,SAVE7REG              RESTORE R7                       01129
NOLBLSIN DS    0H               SKIP LABADDIN RDJFCB.         SBG 09/00  01130
* --- READ ONLY CODE ------------------ BELOW --------------- SBG 06/00  01131
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  01132
         BZ    OPENMOVE   NO. CONTINUE WITH ALL THE OPENS.    SBG 06/00  01133
*                         OTHERWISE PUT INITIAL READONLY MSG  SBG 06/00  01134
         MVC   LINE(133),READOMSG    MOVE READ-ONLY MESSAGE   SBG 06/00  01135
         PUT   SYSPRINT,LINE  WRITE INITIAL MESSAGE SHOWING READONLY     01136
* -- FILE LIMIT MESSAGE IF APPLICABLE --- BELOW --- *                    01137
         TM    PARMFLG3,X'02'   IS FILE LIMITATION IN EFFECT?            01138
         BZ    NOLIMFMR         NO, SKIP MESSAGE                         01139
         MVC   LINE,LINE-1      CLEAR MSG LINE                           01140
         MVC   LINE(133),LIMFMSG    MOVE MESSAGE TEXT IN                 01141
         PUT   SYSPRINT,LINE                                             01142
NOLIMFMR DS    0H                                                        01143
* -- FILE LIMIT MESSAGE IF APPLICABLE --- ABOVE --- *                    01144
* -- HEXPRT LIMIT MESSAGE IF APPLICABLE --- BELOW --- *                  01171
         TM    PARMFLG5,X'20'   IS HEXPRT LIMITATION IN EFFECT?          01172
         BZ    N1LIMHEX         NO, SKIP MESSAGE                         01173
         MVC   LINE,LINE-1      CLEAR MSG LINE                           01174
         TM    PRTHEXOV,X'01'   HAS DEFAULT BEEN OVERRIDDEN?
         BO    N1LIMDEF         YES. MOVE APPROPRIATE MESSAGE.
         MVC   LINE(133),LIMHMSG    MOVE MESSAGE TEXT IN                 01175
         B     N1LIMPRT             AND PRINT IT
N1LIMDEF DS    0H                                                        01177
         MVC   LINE(133),LIMPMSG    MOVE MESSAGE TEXT IN                 01175
N1LIMPRT PUT   SYSPRINT,LINE        AND PRINT IT                         01176
N1LIMHEX DS    0H                                                        01177
* -- HEXPRT LIMIT MESSAGE IF APPLICABLE --- ABOVE --- *                  01178
         B     READIN                                         SBG 06/00  01145
* --- READ ONLY CODE ------------------ ABOVE --------------- SBG 06/00  01146
OPENMOVE MVC   FLAG3(2),FLAG1 SAVE INDICATION OF WHICH FILES ARE HERE    01147
*                             THIS ALSO MOVES FLAG2 TO FLAG4  SBG 03/00  01148
*  ---------------------------------------------------------  SBG 03/00  01149
* -- HEXPRT LIMIT MESSAGE IF APPLICABLE --- BELOW --- *                  01171
         TM    PARMFLG5,X'20'   IS HEXPRT LIMITATION IN EFFECT?          01172
         BZ    NOLIMHEX         NO, SKIP MESSAGE                         01173
         MVC   LINE,LINE-1      CLEAR MSG LINE                           01174
         TM    PRTHEXOV,X'01'   HAS DEFAULT BEEN OVERRIDDEN?
         BO    NOLIMDEF         YES. MOVE APPROPRIATE MESSAGE.
         MVC   LINE(133),LIMHMSG    MOVE MESSAGE TEXT IN                 01175
         B     NOLIMPRT             AND PRINT IT
NOLIMDEF DS    0H                                                        01177
         MVC   LINE(133),LIMPMSG    MOVE MESSAGE TEXT IN                 01175
NOLIMPRT PUT   SYSPRINT,LINE                                             01176
NOLIMHEX DS    0H                                                        01177
* -- HEXPRT LIMIT MESSAGE IF APPLICABLE --- ABOVE --- *                  01178
         TM    PARMFLG3,X'01'   INIT TAPES ONLY?                         01150
         BZ    OPENOINT                                                  01151
         MVC   INITCOPD,INITCREA    MOVE APPROPRIATE MESSAGE IN          01152
         B     NOCORPRT                                                  01153
OPENOINT DS    0H                                                        01154
* ---- BLOCK COUNT CORRECTION ON TAPE COPY - PRINT MESSAGE -------- *    01155
         TM    PARMFLG3,X'20'   IS BLOCK COUNT CORRECTION IN EFFECT      01156
         BZ    NOCORPRT         IF NOT, DON'T PRINT MESSAGE              01157
         ST    R7,SAVE7REG                                               01158
         BAL   R7,PRTBLCNT      LET THE USER KNOW OPTION IS ACTIVE       01159
         L     R7,SAVE7REG                                               01160
NOCORPRT DS    0H                                                        01161
* ---- BLOCK COUNT CORRECTION ON TAPE COPY - PRINT MESSAGE -------- *    01162
* -- FILE LIMIT MESSAGE IF APPLICABLE --- BELOW --- *                    01163
         TM    PARMFLG3,X'02'   IS FILE LIMITATION IN EFFECT?            01164
         BZ    NOLIMFMS         NO, SKIP MESSAGE                         01165
         MVC   LINE,LINE-1      CLEAR MSG LINE                           01166
         MVC   LINE(133),LIMFMSG    MOVE MESSAGE TEXT IN                 01167
         PUT   SYSPRINT,LINE                                             01168
NOLIMFMS DS    0H                                                        01169
* -- FILE LIMIT MESSAGE IF APPLICABLE --- ABOVE --- *                    01170
* -- LABEL LIMIT MESSAGE IF APPLICABLE --- BELOW --- *                   01171
         TM    PARMFLG4,X'10'   IS LABEL LIMITATION IN EFFECT?           01172
         BZ    NOLIMLMR         NO, SKIP MESSAGE                         01173
         MVC   LINE,LINE-1      CLEAR MSG LINE                           01174
         MVC   LINE(133),LIMLMSG    MOVE MESSAGE TEXT IN                 01175
         PUT   SYSPRINT,LINE                                             01176
NOLIMLMR DS    0H                                                        01177
* -- LABEL LIMIT MESSAGE IF APPLICABLE --- ABOVE --- *                   01178
**** ---- >>> Message that labels are being stripped <<< ---- below ***
         TM    PARMFLG4,X'02'     Are labels being stripped?
         BZ    NOSTRMSG
         MVC   LINE(133),LINE-1   Clear message line
         MVC   LINE(133),STRPMSG  Show we're stripping labels
         PUT   SYSPRINT,LINE
NOSTRMSG DS    0H
**** ---- >>> Message that labels are being stripped <<< ---- above ***
         TM    FLAG1,OP1      OUTPUT 1 PRESENT?                          01179
         BZ    OPEN1          NO                                         01180
         OPEN  (OUT1,OUTPUT)                                             01181
OPEN1    TM    FLAG1,OP2      OUTPUT 2 PRESENT?                          01182
         BZ    OPEN2          NO                                         01183
         OPEN  (OUT2,OUTPUT)                                             01184
OPEN2    TM    FLAG1,OP3      OUTPUT 3 PRESENT?                          01185
         BZ    OPEN3          NO                                         01186
         OPEN  (OUT3,OUTPUT)                                             01187
OPEN3    TM    FLAG1,OP4      OUTPUT 4 PRESENT?                          01188
         BZ    OPEN4          NO                                         01189
         OPEN  (OUT4,OUTPUT)                                             01190
OPEN4    TM    FLAG1,OP5      OUTPUT 5 PRESENT?                          01191
         BZ    OPEN5          NO                                         01192
         OPEN  (OUT5,OUTPUT)                                             01193
OPEN5    TM    FLAG1,OP6      OUTPUT 6 PRESENT?                          01194
         BZ    OPEN6          NO                                         01195
         OPEN  (OUT6,OUTPUT)                                             01196
OPEN6    TM    FLAG1,OP7      OUTPUT 7 PRESENT?                          01197
         BZ    OPEN7          NO                                         01198
         OPEN  (OUT7,OUTPUT)                                             01199
OPEN7    TM    FLAG1,OP8      OUTPUT 8 PRESENT?                          01200
         BZ    OPEN8          NO                                         01201
         OPEN  (OUT8,OUTPUT)                                             01202
OPEN8    TM    FLAG2,OP9      OUTPUT 9 PRESENT?                          01203
         BZ    OPEN9          NO                                         01204
         OPEN  (OUT9,OUTPUT)                                             01205
OPEN9    TM    FLAG2,OP10     OUTPUT 10 PRESENT?                         01206
         BZ    OPEN10         NO                                         01207
         OPEN  (OUT10,OUTPUT)                                            01208
OPEN10   TM    FLAG2,OP11     OUTPUT 11 PRESENT?                         01209
         BZ    OPEN11         NO                                         01210
         OPEN  (OUT11,OUTPUT)                                            01211
OPEN11   TM    FLAG2,OP12     OUTPUT 12 PRESENT?                         01212
         BZ    OPEN12         NO                                         01213
         OPEN  (OUT12,OUTPUT)                                            01214
OPEN12   TM    FLAG2,OP13     OUTPUT 13 PRESENT?                         01215
         BZ    OPEN13         NO                                         01216
         OPEN  (OUT13,OUTPUT)                                            01217
OPEN13   TM    FLAG2,OP14     OUTPUT 14 PRESENT?                         01218
         BZ    OPEN14         NO                                         01219
         OPEN  (OUT14,OUTPUT)                                            01220
OPEN14   TM    FLAG2,OP15     OUTPUT 15 PRESENT?                         01221
         BZ    OPEN15         NO                                         01222
         OPEN  (OUT15,OUTPUT)                                            01223
OPEN15   TM    FLAG2,OP16     OUTPUT 16 PRESENT?                         01224
         BZ    READIN         NO                                         01225
         OPEN  (OUT16,OUTPUT)                                            01226
         EJECT                                                           01227
* --------------------------------------------------------- *            01228
*                                                           *            01229
*  READ INPUT                                               *            01230
*                                                           *            01231
* --------------------------------------------------------- *            01232
*                                                           *            01233
*    THIS IS WHERE RECORDS ARE READ IN FROM.  IF EXTERNAL   *            01234
*    LABELS ARE BEING MERGED WITH A NL TAPE TO MAKE AN SL   *            01235
*    TAPE, THEN A SET OF LABELS IS READ IN AT INEXTLAB      *            01236
*    AND THE TAPE DATA IS READ IN FROM THE INPUT TAPE, AT   *            01237
*    THIS POINT.  THE DIFFERENCE WHEN WRITING THE OUTPUTS,  *            01238
*    IS CREATED BY POINTING THE OUTIOB EITHER AT THE INAREA *            01239
*    WHEN WRITING TAPE BLOCKS, OR AT THE EXTLABIN AREA,     *            01240
*    WHEN WRITING THE OUTPUT TAPES FROM THE EXTERNAL LABELS.*            01241
*                                                           *            01242
* --------------------------------------------------------- *            01243
READIN   DS    0H                                                        01244
         TM    PARMFLG3,X'01'     INITTING TAPES ONLY?                   01245
         BO    TLITWRIT                                                  01246
         NI    L80FLAG,FF-X'01'   TURN OFF 80-BYTE INDICATOR  SBG 03/00  01247
         NI    LBLFLAG,FF-X'04'   TURN OFF VOL1 FLAG                     01248
         MVI   INECB,X'00'    INITIALIZE ECB                             01249
* ------------------------------------------------------------------ *   01250
*   DO WE GET RECORDS FROM THE "IN" DDNAME, IN OTHER WORDS,          *   01251
*   FROM THE INPUT TAPE?  OR DO WE GET RECORDS FROM THE EXTERNAL     *   01252
*   LABEL FILE?  THIS IS DETERMINED BY THE SETTING OF WRLBLFLG,X'01' *   01253
* ------------------------------------------------------------------ *   01254
         TM    PARMFLG2,X'80' IS LABEL WRITE OPTION ON?                  01255
         BZ    NONLSL0        NO. IGNORE THIS CODE                       01256
         TM    WRLBLFLG,X'01' CHECK FLAG TO WRITE FROM LABADDIN          01257
         BO    INEXTLAB       GO GET LABELS FROM EXTERNAL FILE           01258
NONLSL0  DS    0H                                                        01259
* ----------------------------------------------------------- SBG 09/00  01260
INFROMIN DS    0H             INPUT IS FROM THE INPUT TAPE               01261
***** --------------- LIMITING FILES ------------------ ***** BELOW *    01262
         TM    PARMFLG3,X'02'     LIMITING FILES?                        01263
         BZ    INOLIMIT           NO - BYPASS THIS CODE                  01264
         TM    EOFINFLG,X'01'     AT LOGICAL END OF INPUT?               01265
         BZ    INOLIMIT           NOT YET - JUST GO ON                   01266
         B     READIN1            SIMULATE SECOND TAPE MARK BY FORCE     01267
*                                 AND DON'T DO MORE READS OF INPUT TAPE  01268
INOLIMIT DS    0H                                                        01269
***** --------------- LIMITING FILES ------------------ ***** ABOVE *    01270
*** ----- ***** --------------------------- LBDQUICK STUFF -- BELOW *    01271
         TM    PARMFLG4,X'80'     IS LBDQUICK IN EFFECT                  01272
         BZ    NOLBDADJ           NO. BYPASS INITIAL READS AND FEELS     01273
         OI    LBDQFLG,X'01'      TURN ON LBDQ FLAG TO SHORTEN CHECK     01274
         ST    R7,SAVE7RG3        SAVE R7 FOR SAFETY                     01275
         BAL   R7,LBDQREAD        PERFORM LBDQUICK PRELIMINARY READ      01276
         L     R7,SAVE7RG3        RESTORE R7                             01277
         NI    LBDQFLG,FF-X'01'   TURN OFF LBDQ FLAG                     01278
NOLBDADJ DS    0H                                                        01279
*** ----- ***** --------------------------- LBDQUICK STUFF -- ABOVE *    01280
         EXCP  INIOB          READ                                       01281
         WAIT  ECB=INECB      WAIT FOR READ                              01282
         TM    INCSW+4,X'01'  WAS TM READ?                               01283
         BO    READIN1        YES                                        01284
         CLI   INECB,X'7F'    DID READ COMPLETE NORMALLY?                01285
         BNE   INERR          NO -- ERROR                                01286
         MVI   OUTCCW,X'01'   SET OUTPUT CCW TO WRITE                    01287
*        LH    R2,INCCW+6     R2=READ LENGTH                  SBG 03/00  01288
         XC    FULLWORK,FULLWORK     CLEAR AREA COMPLETELY    SBG 03/00  01289
         MVC   HALFWORK(2),INCCW+6   READ LENGTH              SBG 03/00  01290
         L     R2,FULLWORK    LOAD R2 WITH FULL LOW ORDER     SBG 03/00  01291
*        LH    R3,INCSW+6     R3=RESIDUAL BYTE COUNT          SBG 03/00  01292
         MVC   HALFWORK(2),INCSW+6   RESIDUAL BYTE COUNT      SBG 03/00  01293
         L     R3,FULLWORK    LOAD R3 WITH FULL LOW ORDER     SBG 03/00  01294
         SR    R2,R3          R2=ACTUAL LENGTH READ                      01295
         STH   R2,BYTESCOP    SAVE QUANTITY OF BYTES COPIED              01296
*-*-*-------->>    HEX PRINT   -   BELOW    <<---------*-*-*
         TM    PARMFLG5,X'20'    IS HEX PRINTING ON?
         BZ    NPRTHEX           NO. SKIP THIS CODE.
         ST    R7,R7HXPRT        SAVE R7.
         BAL   R7,HEXPRINT       PRINT CURRENT RECORD IN HEX.
         L     R1,BCTLIMIT       LOAD REGISTER FOR DECREMENT
         BCTR  R1,0              LOWER BY ONE
         ST    R1,BCTLIMIT       PUT IT BACK FOR NEXT PASS
         L     R7,R7HXPRT        RESTORE R7.
NPRTHEX  DS    0H
*-*-*-------->>    HEX PRINT   -   ABOVE    <<---------*-*-*
         NI    ISLBLFLG,FF-X'01'  TURN OFF "IS LABEL" FLAG               01297
**** ----  BYTE COUNTS ---- BELOW                                        01298
         TM    PARMFLG3,X'04' ARE WE COUNTING BYTES?                     01299
         BZ    INNOBYTE       NO, SKIP INCREMENT                         01300
         LA    R3,DBIN        POINT REGISTER TO COUNTER                  01301
         BAL   R7,ADDCOUNT    INCREMENT WITH BYTE COUNT                  01302
INNOBYTE DS    0H                                                        01303
**** ----  BYTE COUNTS ---- ABOVE                                        01304
         NI    DATFLAG,FF-X'10'  SHOW REAL DATA HAS BEEN READ SBG 03/00  01305
*  --- BELOW ---  CODE TO DETECT SL BEFORE 2 TAPE MARKS.      SBG 03/00  01306
         C     R2,=F'80'      DID WE READ 80-BYTE BLOCK LAST? SBG 03/00  01307
         BNE   READGO1        NO. SKIP THIS PROCESSING.       SBG 03/00  01308
         OI    L80FLAG,X'01'  INDICATE 80-BYTE RECORD READ    SBG 03/00  01309
         BAL   R7,LABELCHK    CHECK FOR ALL KINDS OF SL       SBG 04/00  01310
*                             FORMATS, AND SET FLAGS          SBG 04/00  01311
*                             ACCORDINGLY.  OPTIONALLY        SBG 04/00  01312
*                             PRINT LABEL INFO FOUND.         SBG 04/00  01313
******** ------------ COUNT BYTES IN LABELS ONLY ---- BELOW              01314
         TM    PARMFLG3,X'04'     GATHERING LABEL COUNTS?                01315
         BZ    LBLNOCNT                                                  01316
         TM    ISLBLFLG,X'01'     WAS LAST INPUT RECORD A LABEL?         01317
         BZ    LBLNOCNT                                                  01318
         L     R2,BYTESMVD        LOAD FULLWORD OF BYTES MOVED           01319
         LA    R3,LABIN           POINT REGISTER TO LABEL COUNTER        01320
         BAL   R7,ADDCOUNT        COUNT BYTES IN THIS LABEL              01321
LBLNOCNT DS    0H                                                        01322
**---->    TEST IF LABELS ARE TO BE STRIPPED  <----** BELOW
         TM    PARMFLG4,X'02'     ARE WE STRIPPING LABELS?
         BZ    STRNOSKP           NO. SKIP THE STRIPPING FLAGGING
****-->>                below  -  Test of LRECL=80 and not a label
         ST    R2,SAVER2A         Save contents of R2
         L     R2,BYTESMVD        Get size of this record.
         C     R2,=F'80'          80 bytes exactly in record?
         BNE   YSTRPFLG           No. Not an exception.
         TM    ISLBLFLG,X'03'     Was last input record a label?         02508
         BZ    NSTRPFLG           No. Don't turn on STRIPFLG.
YSTRPFLG DS    0H
         OI    STRIPFLG,X'01'     FLAG THAT WE'RE STRIPPING              02517
NSTRPFLG DS    0H                 Jump here to not turn on STRIPFLG.
         L     R2,SAVER2A
****-->>                above  -  Test of LRECL=80 and not a label
         B     READGO1            AND CONTINUE READ PROCESSING
SAVER2A  DC    F'0'
STRNOSKP DS    0H
**---->    TEST IF LABELS ARE TO BE STRIPPED  <----** ABOVE
******** ------------ COUNT BYTES IN LABELS ONLY ---- ABOVE              01323
*  --- ABOVE ---  CODE TO DETECT SL BEFORE 2 TAPE MARKS.      SBG 03/00  01324
*                                                             SBG 04/00  01325
*  --- BELOW ---  DON'T ADD LABELS TO SL TAPE ---------.      SBG 03/00  01326
         TM    PARMFLG2,X'80'     ARE WE ADDING LABELS?                  01327
         BZ    READGO1            NO. WE CAN GO ON.                      01328
         TM    ISLBLFLG,X'01'     DID WE JUST READ A LABEL?              01329
         BZ    READGO1            NO DON'T CHECK FOR SL                  01330
         MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     01331
         MVC   LINE(133),NOLABSL  DISPLAY NO SL ON SL MSG                01332
         PUT   SYSPRINT,LINE      WRITE MSG                              01333
         NI    OPENDFLG,FF-X'04'  MARK FILE AS CLOSED                    01334
         CLOSE (LABADDIN)                                                01335
         TM    OPENDFLG,X'02'     IS SYSIN OPEN?                         01336
         BZ    NOSLSOUT           NO. DON'T HAVE TO CLOSE IT             01337
         NI    OPENDFLG,FF-X'02'  MARK FILE AS CLOSED                    01338
         CLOSE (SYSIN)                                                   01339
NOSLSOUT B     CLOSMALL           CLOSE OTHER FILES AND SCRAM            01340
*  --- ABOVE ---  DON'T ADD LABELS TO SL TAPE ---------.      SBG 03/00  01341
         EJECT                                                           01342
*  ----------------------------------------------------------------  *   01343
*  --- BELOW ---  CODE TO READ IN EXTERNAL LABELS TO THE OUTPUT TAPES.   01344
INEXTLAB DS    0H           WRITE A BLOCK OF LABELS TO OUTPUT TAPE       01345
*                           INPUT IS FROM THE EXTERNAL LABEL FILE        01346
*  ----------------------------------------------------------------  *   01347
         TM    PARMFLG2,X'80'   IS LABEL WRITE OPTION SET?               01348
         BZ    GETBLOKZ         NO. NEVER COME HERE AGAIN.               01349
**** --------- END OF DATA ON TAPE INPUT ----   BELOW   ---- ****        01350
         TM    INEODFLG,X'02'   DID WE RUN OUT OF TAPE DATA?             01351
         BZ    STILTAPE                                                  01352
         TM    WRLBLFLG,X'02'   ARE WE WRITING AN EXTRA TAPEMARK?        01353
         BZ    STILTAPE                                                  01354
         B     WRTTAPMK                                                  01355
STILTAPE DS    0H                                                        01356
**** --------- END OF DATA ON TAPE INPUT ----   ABOVE   ---- ****        01357
         TM    WRLBLFLG,X'08'       COMING HERE FROM EOF ON LABADDIN?    01358
         BZ    DOTHEGET             NO. DO THE FILE GETS.                01359
         TM    PARMFLG3,X'80'       IS LBLFIX IN EFFECT?                 01360
         BO    LBLINEND             GO TO EOFRTN AND FIX MISSING DATA    01361
         B     CLOSMALL             EOD. DON'T TRY TO GET MORE.          01362
DOTHEGET DS    0H                                                        01363
*** ---                                                                  01364
         TM    PARMFLG4,X'10'   ARE WE LIMITING LABEL SETS?              01365
         BZ    DOGETALW         NO. DO THE GET ALWAYS.                   01366
         TM    EOFLBFLG,X'01'   HAVE WE REACHED THE LIMIT?               01367
         BZ    DOGETALW         NO. KEEP GETTING LABELS.                 01368
         B     LBLINEND       LIMIT REACHED. ACT AS IF NO MORE LABELS.   01369
DOGETALW DS    0H                                                        01370
*** ---                                                                  01371
         GET   LABADDIN,EXTLBLIN                                         01372
         CLI   EXTLBLIN,C'*'    IS IT A COMMENT CARD?                    01373
         BE    INEXTLAB         IF IT IS, IGNORE IT.                     01374
         CLC   =C'----ENDOFLABELHEADER ',EXTLBLIN                        01375
         BE    ENDHEADR       YES, WRITE TAPE MARK & REINIT WRITE        01376
         CLC   =C'----ENDOFLABELTRAILER',EXTLBLIN                        01377
         BE    ENDTRAIL             YES. INDICATE DATA FOLLOWS           01378
* ---------------------------------  EOV2EOF  BELOW  ------------- *     01379
         CLC   =C'----ENDOFLABELTRAILEREOV',EXTLBLIN                     01380
*        BE    LBLINEND       EOV2. ONLY ONE TAPEMARK AND OUT            01381
         BNE   NTRALEOV            NOT FOLLOWING AN EOV TRAILER          01382
         OI    LBLLFLAG,X'80'      SAY YOU'VE SEEN THIS CONTROL CARD     01383
         NI    LBLLFLAG,FF-X'40'   SHOW NOT AT ENDOFHEADER               01384
         TM    PARMFLG2,X'04'      EOV TO EOF PROCESSING IN EFFECT?      01385
         BZ    TRAILEOV            NO. ONE TAPE MARK AND OUT             01386
TRAILEOF B     ENDTRAIL            YES. TREAT LIKE A TRAILER             01387
TRAILEOV B     LBLINEND            NO EOV2EOF. SAME AS BEFORE.           01388
NTRALEOV DS    0H                                                        01389
* ---------------------------------  EOV2EOF  ABOVE  ------------- *     01390
         CLC   EXTLBLIN(4),=C'VOL1' IS THE CARD A VOL1?                  01391
         BNE   NLABVOL1             NO. CHECK FOR OTHER CARDS            01392
         OI    LBLLFLAG,X'04'       SHOW VOL1 SEEN IN EXTERNAL LABELS    01393
         B     GOTVOL01             PROCESS THE VOL1                     01394
NLABVOL1 DS    0H                                                        01395
***** ----- *****  CHECK EXTERNAL LABELS FOR TYPE - BELOW                01396
         CLC   EXTLBLIN(4),=C'HDR1'                                      01397
         BNE   NLABHDR1                                                  01398
         OI    LBLLFLAG,X'01'       SHOW HDR1 HAS BEEN SEEN              01399
         NI    LBLLFLAG,FF-X'30'    SHOW NOT TRAILERS                    01400
         MVC   HDR1SAV(80),EXTLBLIN  SAVE HDR1 CARD                      01401
         B     ENDIBMSL                                                  01402
NLABHDR1 DS    0H                                                        01403
         CLC   EXTLBLIN(4),=C'HDR2'                                      01404
         BNE   NLABHDR2                                                  01405
         OI    LBLLFLAG,X'02'       SHOW HDR2 HAS BEEN SEEN              01406
         NI    LBLLFLAG,FF-X'30'    SHOW NOT TRAILERS                    01407
         MVC   HDR2SAV(80),EXTLBLIN  SAVE HDR2 CARD                      01408
         B     ENDIBMSL                                                  01409
NLABHDR2 DS    0H                                                        01410
***** ----- *****                                                        01411
         CLC   EXTLBLIN(4),=C'EOF1'                                      01412
         BNE   NLABEOF1                                                  01413
         OI    LBLLFLAG,X'10'       SHOW EOF1 HAS BEEN SEEN              01414
         NI    LBLLFLAG,FF-X'07'    SHOW NOT HEADERS OR VOL1             01415
         B     ENDIBMSL                                                  01416
NLABEOF1 DS    0H                                                        01417
         CLC   EXTLBLIN(4),=C'EOF2'                                      01418
         BNE   NLABEOF2                                                  01419
         OI    LBLLFLAG,X'20'       SHOW EOF2 HAS BEEN SEEN              01420
         NI    LBLLFLAG,FF-X'07'    SHOW NOT HEADERS OR VOL1             01421
         B     ENDIBMSL                                                  01422
NLABEOF2 DS    0H                                                        01423
***** ----- *****                                                        01424
         CLC   EXTLBLIN(4),=C'EOV1'                                      01425
         BNE   NLABEOV1                                                  01426
         OI    LBLLFLAG,X'10'       AS IF EOF1 HAS BEEN SEEN             01427
         NI    LBLLFLAG,FF-X'07'    SHOW NOT HEADERS OR VOL1             01428
         B     ENDIBMSL                                                  01429
NLABEOV1 DS    0H                                                        01430
         CLC   EXTLBLIN(4),=C'EOV2'                                      01431
         BNE   NLABEOV2                                                  01432
         OI    LBLLFLAG,X'20'       AS IF EOF2 HAS BEEN SEEN             01433
         NI    LBLLFLAG,FF-X'07'    SHOW NOT HEADERS OR VOL1             01434
         B     ENDIBMSL                                                  01435
NLABEOV2 DS    0H                                                        01436
ENDIBMSL DS    0H                                                        01437
***** ----- *****  CHECK EXTERNAL LABELS FOR TYPE - ABOVE                01438
ISITHDR  CLC   EXTLBLIN(3),=C'HDR'  IS THE CARD A HDR?                   01439
         BE    WRTLABEL             ASSUME THAT HDRS FOLLOW              01440
* -------------- EOF2EOV BELOW ----------------- *                       01441
ISITEOV  DS    0H                                                        01442
         CLC   EXTLBLIN(3),=C'EOV'                                       01443
         BNE   NOEOF2V                                                   01444
         TM    PARMFLG2,X'04'       IS EOV2EOF IN EFFECT?                01445
         BZ    NOEOF2V                                                   01446
         MVC   EXTLBLIN(3),=C'EOF'                                       01447
NOEOF2V  DS    0H                                                        01448
* -------------- EOF2EOV ABOVE ----------------- *                       01449
* ----------                                                             01450
         TM    PARMFLG1,X'01'       ARE WE CORRECTING BLOCK COUNTS?      01451
         BZ    BLNOCORR             NO. SKIP THIS.                       01452
ISITEOF1 CLC   EXTLBLIN(4),=C'EOF1'     DO ON EOF1                       01453
         BE    CORBLKCT                                                  01454
         CLC   EXTLBLIN(4),=C'EOV1'     DO ON EOV1                       01455
         BE    CORBLKCT                                                  01456
BLNOCORR B     EOFOREOV                                                  01457
****** ----- LABEL FIX CODE FOR EOF2 OR EOV2 ----- ****** BELOW          01458
ADDEOF2  TM    WRLBLFLG,X'08'       COMING FROM LBLINEND?                01459
         BZ    NOMKEOF2             WE STILL CAN GET A REAL ONE.         01460
         TM    PARMFLG3,X'80'       FIXING LABELS?                       01461
         BZ    NOMKEOF2             NO. DON'T MAKE EOF2 IF MISSING       01462
MAKEEOF2 DS    0H                                                        01463
         MVC   EXTLBLIN(80),HDR2SAV                                      01464
         MVC   EXTLBLIN(3),=C'EOF'                                       01465
NOMKEOF2 DS    0H                                                        01466
****** ----- LABEL FIX CODE FOR EOF2 OR EOV2 ----- ****** ABOVE          01467
* ----------                                                             01468
EOFOREOV CLC   EXTLBLIN(2),=C'EO'   EOF OR EOV ?                         01469
         BE    WRTLABEL             SET UP TO WRITE ANOTHER SET          01470
**** ---- ****                                                           01471
         CLC   EXTLBLIN(3),=C'UHL'  USER HEADER LABEL ?                  01472
         BNE   NOTLUHL                                                   01473
         OI    LBLLFLAG,X'08'       MARK THAT UHL SEEN IN EXT LABELS     01474
         B     WRTLABEL             WRITE USER HEADER LABELS TO OUTPUTS  01475
NOTLUHL  DS    0H                                                        01476
**** ---- ****                                                           01477
         CLC   EXTLBLIN(3),=C'UTL'  USER TRAILER LABEL ?                 01478
         BE    WRTLABEL             LEGIT. WRITE TO OUTPUTS.             01479
         B     INEXTLAB     UNKNOWN, GET ANOTHER LABADDIN RECORD         01480
ENDHEADR DS    0H                                                        01481
         OI    LBLLFLAG,X'40'   FLAG THAT YOU'VE SEEN ENDHDR CNTL CARD   01482
         OI    WRLBLFLG,X'04'   ALWAYS SAY WHEN YOU'RE COMING FROM HERE  01483
         NI    LBLLFLAG,FF-X'80'    SHOW NOT AT ENDOFTRAILER             01484
*** -----                                                                01485
         TM    INEODFLG,X'02'       END OF DATA ON INPUT TAPE            01486
         BZ    NOEODFL1                                                  01487
         OI    WRLBLFLG,X'02'       FLAG TO WRITE AN EXTRA TAPE MARK     01488
         B     ENDTRAIL                                                  01489
NOEODFL1 DS    0H                                                        01490
*** -----                                                                01491
         NI    WRLBLFLG,FF-X'01'    DON'T COME HERE NEXT TIME            01492
WRTMNDAT B     FINLABEL             WTM AND SET UP TO WRITE DATA         01493
ENDTRAIL DS    0H                                                        01494
         L     R0,LABELCNT      INCREMENT COUNTER OF EOLTRAILERS         01495
         A     R0,=F'1'         ADD 1 TO COUNT                           01496
         ST    R0,LABELCNT      STORE INCREMENTED COUNT                  01497
*** ---                                                                  01498
         TM    PARMFLG4,X'10'       LIMITING LABELS?                     01499
         BZ    ENDNOLIM             NO. GET OUT OF ROUTINE.              01500
         CLC   LABELCNT,LINLABEL    NUM OF EOFTRAILERS EQUAL LIMIT?      01501
         BL    ENDNOLIM             NOT YET. GET OUT.                    01502
         OI    EOFLBFLG,X'01'       MARK THAT WE'VE REACHED LIMIT.       01503
ENDNOLIM DS    0H                                                        01504
*** ---                                                                  01505
         OI    WRLBLFLG,X'01'       COME HERE NEXT TIME                  01506
         MVI   LBLLFLAG,X'00'       CLEAR ALL FLAGS THAT LABELS SEEN     01507
         OI    LBLLFLAG,X'80'   FLAG THAT YOU'VE SEEN ENDTRLR CNTL CARD  01508
         BAL   R7,CLEARSAV          CLEAR LBLFIX SAVE AREAS              01509
         B     WRTTAPMK                                                  01510
* -- CORRECT BLOCK COUNT IN EOF1 AND EOV1 WHEN WRITING OUTSIDE LABELS    01511
CORBLKCT DS    0H                                                        01512
         TM    PARMFLG2,X'80'    TEST IF EXTERNAL LABELS BEING ADDED     01513
         BZ    NOCORBLK          NO. BYPASS.                             01514
         TM    PARMFLG1,X'01'    TEST IF BLOCK COUNT CORRECTION WANTED   01515
         BZ    NOCORBLK          NO. BYPASS.                             01516
*** ---  FIXING LABELS  --- ***                                          01517
         TM    PARMFLG3,X'80'    LABEL FIXING TURNED ON?                 01518
         BZ    NOFIXL1           NO. DON'T FIX.                          01519
         TM    LBLLFLAG,X'10'    HAVE WE SEEN A REAL EOF1?               01520
         BO    NOFIXL1           YES. DON'T CREATE ONE.                  01521
CORFEOF1 MVC   EXTLBLIN(80),HDR1SAV   MOVE SAVED HDR1 AS EOF1            01522
         MVC   EXTLBLIN(3),=C'EOF'    MARK AS AN EOF1 LABEL              01523
NOFIXL1  DS    0H                                                        01524
*** ---  FIXING LABELS  --- ***                                          01525
         MVC   EXTLBLIN+54(6),BLKCNTSV+4    MOVE IN SAVED BLK COUNT      01526
         STM   R2,R3,SAVE2TO3                                            01527
         LA    R3,EXTLBLIN+76          POINT TO HI ORDER LABEL FIELD     01528
         LA    R2,BLKCNTSV             LOAD ADDRESS OF HI ORDER COUNT    01529
         ST    R7,SAVE7RG2             SAVE BAL REGISTER                 01530
         BAL   R7,MOVEHICT             MOVE NUMBERS IF NOT ZEROES        01531
         L     R7,SAVE7RG2             RESTORE BAL REGISTER              01532
         LM    R2,R3,SAVE2TO3                                            01533
NOCORBLK B     EOFOREOV                                                  01534
* -- CORRECT BLOCK COUNT IN EOF1 AND EOV1 WHEN WRITING OUTSIDE LABELS    01535
GOTVOL01 DS    0H                                                        01536
         OI    LBLFLAG,X'04'         ACT AS IF WE SAW A VOL1 ON INPUT    01537
         MVC   VOLORIG(6),EXTLBLIN+4   MOVE IN ORIGINAL "VOLSER"         01538
* ----       REPORT OUTVOLALL= VOLUME  ---  BELOW                        01539
         TM    OVERFLAG,X'01'          OUTVOLALL= IS CODED?              01540
         BZ    NOOVLALL                NOPE. DON'T CHANGE REPORT         01541
         MVC   VOLNEW(6),VOLSTG        OVERLAY NEW VOLSER FOR ALL OUTS   01542
NOOVLALL DS    0H                                                        01543
* ----       REPORT OUTVOLALL= VOLUME  ---  ABOVE                        01544
         B     WRTLABEL                                                  01545
WRTLABEL OI    WRLBLFLG,X'01'                                            01546
* --------------- PRINT LABEL TO BE WRITTEN ------------------- *        01547
         TM    PARMFLG3,X'10' DO WE PRINT EXT LABELS TO BE WRITTEN       01548
         BZ    NOPRTEXT       FLAG IS NOT ON. DON'T REPORT THEM          01549
TRYPXXX0 DS    0H                                                        01550
         CLC   EXTLBLIN(4),=C'VOL1'                                      01551
         BNE   TRYPUSER                                                  01552
         MVI   LINE-1,C' '                                    SBG 09/00  01553
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 09/00  01554
         MVC   VOL1SER(6),LINE       CLEAR FIELD TO BLANKS    SBG 09/00  01555
         MVC   VOL1SER(6),EXTLBLIN+4   REPORT VOLUME SERIAL   SBG 09/00  01556
         MVC   VOL1OWNR(10),LINE     CLEAR FIELD TO BLANKS    SBG 09/00  01557
         MVC   VOL1OWNR(10),EXTLBLIN+41   OWNER INFORMATION   SBG 09/00  01558
         MVC   LINE(133),VOL1LBL  INDICATE THAT VOL1 FOUND    SBG 09/00  01559
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER       SBG 09/00  01560
         B     NOPRTEXT                                                  01561
TRYPUSER DS    0H                                                        01562
         CLC   EXTLBLIN(3),=C'UHL'     USER HEADER LABEL?                01563
         BE    PUSERPR                 YES.  PRINT ENTIRE LABEL.         01564
         CLC   EXTLBLIN(3),=C'UTL'     USER TRAILER LABEL?               01565
         BE    PUSERPR                 YES.  PRINT ENTIRE LABEL.         01566
         B     TRYPXXX1                                                  01567
PUSERPR  ST    R3,SAVE3REG                                               01568
         LA    R3,EXTLBLIN                                               01569
         BAL   R7,PRTUSER     PRINT LABEL INFO                           01570
         L     R3,SAVE3REG                                               01571
         B     NOPRTEXT                                                  01572
TRYPXXX1 CLC   EXTLBLIN(4),=C'HDR1'                                      01573
         BE    PXXX1PR                                                   01574
         CLC   EXTLBLIN(4),=C'EOF1'                                      01575
         BE    PXXX1PR                                                   01576
         CLC   EXTLBLIN(4),=C'EOV1'                                      01577
         BE    PXXX1PR                                                   01578
         B     TRYPXXX2                                                  01579
PXXX1PR  ST    R3,SAVE3REG                                               01580
         LA    R3,EXTLBLIN                                               01581
         BAL   R7,PRTXXX1     PRINT LABEL INFO                           01582
         L     R3,SAVE3REG                                               01583
         B     NOPRTEXT                                                  01584
TRYPXXX2 CLC   EXTLBLIN(4),=C'HDR2'                                      01585
         BE    PXXX2PR                                                   01586
         CLC   EXTLBLIN(4),=C'EOF2'                                      01587
         BE    PXXX2PR                                                   01588
         CLC   EXTLBLIN(4),=C'EOV2'                                      01589
         BE    PXXX2PR                                                   01590
         B     NOPRTEXT                                                  01591
PXXX2PR  ST    R3,SAVE3REG                                               01592
         LA    R3,EXTLBLIN                                               01593
         BAL   R7,PRTXXX2     PRINT LABEL INFO                           01594
         L     R3,SAVE3REG                                               01595
NOPRTEXT DS    0H             DON'T PRINT EXTERNAL LABEL ON REPORT       01596
* --------------- PRINT LABEL TO BE WRITTEN ------------------- *        01597
         MVC   OUTCCW+1(3),=AL3(EXTLBLIN)  SET UP LABEL WRITE            01598
         MVC   OUTCCW+6(2),=H'80'          LOAD LENGTH OF WRITE          01599
         MVI   OUTCCW,X'01'   SET UP OUTCCW FOR WRITE                    01600
         B     WRITE1         WRITE LABEL RECORD                         01601
FINLABEL MVC   OUTCCW+1(3),=AL3(INAREA)    SET UP DATA WRITE             01602
WRTTAPMK DS    0H                                                        01603
*** ----------------                                                     01604
         TM    INEODFLG,X'02'                                            01605
         BZ    NOEODNOW                                                  01606
         TM    WRLBLFLG,X'04'                                            01607
         BO    ONEFRHDR             ONLY ONE EXTRA TAPEMARK FROM ENDHDR  01608
         TM    WRLBLFLG,X'02'       DO WE WRITE AN EXTRA TAPEMARK?       01609
         BZ    NOEODNOW             WE'RE WRITING ANYWAY.                01610
         NI    WRLBLFLG,FF-X'02'    TURN OFF FLAG FOR SECOND PASS        01611
ONEFRHDR NI    WRLBLFLG,FF-X'04'    AFTER THIS, NOT COMING FROM ENDHDR   01612
NOEODNOW DS    0H                                                        01613
*** ----------------                                                     01614
         MVI   OUTCCW,X'1F'   TAPE MARK OPCODE                           01615
         B     WRITE1         WRITE TAPE MARK                            01616
* ------------------ SPECIAL ROUTINES ------------------------------- *  01617
GETBLOKZ DS    0H             SHOULD NEVER GET HERE IF NO EXT LAB ADD    01618
         NI    WRLBLFLG,FF-X'01'  SAFETY-NEVER RETURN HERE AGAIN         01619
         B     READIN             AND GO BACK WHERE YOU STARTED          01620
* ------------------ SPECIAL ROUTINES ------------------------------- *  01621
LBLINEND DS    0H             STOP COPYING AFTER YOU RUN OUT OF LABELS   01622
         OI    WRLBLFLG,X'08'    SHOW EOF ON LABADDIN                    01623
** BELOW *** ------------------- *** FIX INCOMPLETE LABEL SET *** -- **  01624
         TM    PARMFLG3,X'80'    IS LBLFIX IN EFFECT?                    01625
         BZ    NOFIXLBL          NO. DON'T TRY IT.                       01626
         BAL   R7,FIXEXTLB       DO FIX EXTERNAL LABEL SET PROCESSING    01627
         TM    WRLBLFLG,X'10'    FINISHED FIXING LABELS                  01628
         BZ    NOFIXLBL          NO. KEEP CYCLING TILL DONE              01629
         B     CLOSMALL          FINISHED, GET OUT.                      01630
NOFIXLBL DS    0H                                                        01631
** ABOVE *** ------------------- *** FIX INCOMPLETE LABEL SET *** -- **  01632
         MVI   OUTCCW,X'1F'   ORDER SECOND TAPE MARK TO BE WRITTEN       01633
         B     READIN2        WRITE OUTPUTS AND FINISH                   01634
* ------------------------------------------------------------------- *  01635
*                                                                        01636
*      WE ASSUME THAT    ----ENDOFLABELTRAILER                           01637
*      WAS THE LAST RECORD IN THE LABEL FILE, AND                        01638
*      IT CAUSED ONE TAPE MARK TO HAVE BEEN WRITTEN                      01639
*      ALREADY.                                                          01640
*                                                                        01641
* ------------------ SPECIAL ROUTINES ------------------------------- *  01642
*  --- ABOVE ---  CODE TO READ IN EXTERNAL LABELS TO THE OUTPUT TAPES.   01643
         EJECT                                                           01644
READGO1  DS    0H                                                        01645
******* ---------  BYTE COUNTS FOR NON-LABELS --------- * BELOW          01646
         TM    PARMFLG3,X'04'  COUNTING BYTES?                           01647
         BZ    READNCNT                                                  01648
         TM    ISLBLFLG,X'01'  LAST READ A LABEL?                        01649
         BO    READNCNT        YES, DON'T COUNT BYTES FOR IT HERE        01650
         L     R2,BYTESMVD        LOAD FULLWORD OF BYTES MOVED           01651
         LA    R3,DBINF           POINT REGISTER TO FILE BYTES ONLY      01652
         BAL   R7,ADDCOUNT        COUNT BYTES IN THIS LABEL              01653
READNCNT DS    0H                                                        01654
******* ---------  BYTE COUNTS FOR NON-LABELS --------- * ABOVE          01655
**---->            LABEL STRIPPING CODE          BELOW
         TM    PARMFLG4,X'02'     ARE WE STRIPPING LABELS?
         BZ    RDNOSTRP           NO. CONTINUE REGULAR PROCESSING
         TM    STRIPFLG,X'01'     CHECK IF LABEL WAS READ JUST NOW
         BZ    RDNOSTRP           NO IT WASN'T
         B     READIN             LABEL WAS JUST READ-SKIP THE WRITES.
RDNOSTRP DS    0H
**---->            LABEL STRIPPING CODE          ABOVE
         STH   R2,OUTCCW+6    STORE FOR WRITE                 SBG 03/00  01656
         STH   R2,OUTBYTL     STORE FOR TALLYING BYTE COUNT LATER        01657
         ST    R7,STOR7REG                                               01658
         L     R7,BLOKCNT                                                01659
         LA    R7,1(,R7)      ADD 1 TO COUNT OF DATA BLOCKS              01660
         ST    R7,BLOKCNT                                                01661
         L     R7,STOR7REG                                               01662
* ------------  WHEN COPYING AN INITTED TAPE ----- BELOW ------  *       01663
         TM    LBLFLAG,X'08'    WAS INITTED HDR1 SEEN?                   01664
         BZ    NOINITT1         DON'T CHANGE PROCESSING IF NOT           01665
         OI    FLAG2A,EOV       YES. WRITE AND GET OUT OF PROGRAM.       01666
NOINITT1 DS    0H                                                        01667
* ------------  WHEN COPYING AN INITTED TAPE ----- ABOVE ------  *       01668
         B     WRITE1         CONTINUE                                   01669
*                                                             SBG 04/00  01670
*  --- BELOW ---  PROCESSING WHEN TAPE MARK WAS ENCOUNTERED   SBG 04/00  01671
READIN1  DS    0H             COME HERE IF TM WAS READ        SBG 04/00  01672
* ------------------------- ADD LABEL TO NL CODE ----------- *           01673
         TM    PARMFLG2,X'80'   ADDING EXTERNAL LABELS ?                 01674
         BZ    NONLSL1          NO.  BYPASS.                             01675
         OI    WRLBLFLG,X'01'   NEXT READ, GO ADD MORE LABELS            01676
*** ---                                                                  01677
         TM    INEODFLG,X'02'   ARE WE PAST END OF DATA ON TAPE?         01678
         BO    WRITE1           GO DIRECTLY TO WRITE. DO NOT PASS GO.    01679
*                               DO NOT COLLECT 200 DOLLARS.              01680
*** ---                                                                  01681
NONLSL1  DS    0H                                                        01682
* ------------------------- ADD LABEL TO NL CODE ----------- *           01683
* -----------------  LABEL DUMP CODE - WHEN TO ADD CONTROL RECORDS -- *  01684
         TM    PARMFLG2,X'10'   DUMPING LABELS TO EXTERNAL FILE?         01685
         BZ    NOCNTLWR         NO.  BYPASS THIS SECTION OF CODE.        01686
         TM    EOLGFLAG,X'01'   DO WE WRITE CONTROL RECD FOR EOH?        01687
         BO    WRCTLHDR         YES. PUT IT OUT.                         01688
         TM    EOLGFLAG,X'02'   DO WE WRITE CONTROL RECD FOR EOF?        01689
         BO    WRCTLEOF         YES. PUT IT OUT.                         01690
         TM    EOLGFLAG,X'04'   DO WE WRITE CONTROL RECD FOR EOV?        01691
         BO    WRCTLEOV         YES. PUT IT OUT.                         01692
         B     NOCNTLWR         NOT READY TO WRITE CNTL RECD. OUT.       01693
WRCTLHDR DS    0H                                                        01694
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01695
         MVC   LLINE(80),LABELITH   MARK END OF LABEL         SBG 09/00  01696
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01697
         B     CTWRDONE         FINISHED WRITING CONTROL RECORD          01698
WRCTLEOF DS    0H                                                        01699
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01700
         MVC   LLINE(80),LABELITR   MARK END OF LABEL         SBG 09/00  01701
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01702
         B     CTWRDONE         FINISHED WRITING CONTROL RECORD          01703
WRCTLEOV DS    0H                                                        01704
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01705
         MVC   LLINE(80),LABELITV   MARK END OF LABEL         SBG 09/00  01706
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01707
         B     CTWRDONE         FINISHED WRITING CONTROL RECORD          01708
CTWRDONE NI    EOLGFLAG,FF-X'07'     TURN OFF FLAGS AFTER WRITE          01709
NOCNTLWR DS    0H                                                        01710
* -----------------  LABEL DUMP CODE - WHEN TO ADD CONTROL RECORDS -- *  01711
         TM    DATFLAG,X'10'  NO DATA READ YET?               SBG 03/00  01712
         BZ    READINGO       DATA WAS READ-PROCESS NORMALLY  SBG 03/00  01713
         CLC   LTMRPTI,SKIPPED   WE SKIP LEADING TAPEMARKS?   SBG 03/00  01714
         BNE   RDNOSKIP                                       SBG 03/00  01715
         MVI   LINE-1,C' '                                    SBG 03/00  01716
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 03/00  01717
         MVC   LINE(133),LTMRPT  INDICATE LEADING TM SKIPPED  SBG 03/00  01718
         PUT   SYSPRINT,LINE  WRITE MESSAGE                   SBG 03/00  01719
         B     READIN         DO ANOTHER READ                 SBG 03/00  01720
RDNOSKIP DS    0H                                             SBG 03/00  01721
         MVI   LINE-1,C' '                                    SBG 03/00  01722
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 03/00  01723
         MVC   LINE(133),LTMRPT  INDICATE LEADING TM COPIED   SBG 03/00  01724
         PUT   SYSPRINT,LINE  WRITE MESSAGE                   SBG 03/00  01725
         B     MARKFILE                                       SBG 03/00  01726
READINGO DS    0H                                             SBG 04/00  01727
*------------------------------------> HEX PRINT LIMIT - BELOW
         TM    PARMFLG5,X'20'          HEX PRINT ON?
         BZ    NOHXPRST                NO. DON'T ADJUST LIMIT
         MVC   BCTLIMIT(4),PRTLIMIT    RESTORE BCTLIMIT AT EOF
NOHXPRST DS    0H
*------------------------------------> HEX PRINT LIMIT - ABOVE
         ST    R7,STOR7REG                                               01728
         L     R7,FILECNT                                                01729
         CVD   R7,DWORD       CONVERT FILE NUMBER TO DECIMAL  SBG 03/00  01730
         OI    DWORD+7,X'0F'  MAKE SIGN READABLE                         01731
         UNPK  FILEDONE+6(5),DWORD+5(3)  UNPACK FILE NUMBER              01732
         ST    R7,FILECNT                                                01733
         L     R7,BLOKCNT                                                01734
         CVD   R7,DWORD       CONVERT BLOCK COUNT TO DECIMAL             01735
         OI    DWORD+7,X'0F'  MAKE SIGN READABLE                         01736
         UNPK  FILEDONE+21(7),DWORD+4(4)  UNPACK BLOCK COUNT             01737
         MVC   BLKCNTSV,BLKCNTSV-1        INITIALIZE TO ZEROS            01738
         UNPK  BLKCNTSV(10),DWORD+2(6)    SAVE 10 DIGITS OF BLK COUNT    01739
**** ---- BYTE COUNTS --------------------------- BELOW ---- ****        01740
         TM    PARMFLG3,X'04'     COUNTING BYTES?                        01741
         BZ    MARKNCNT           NO-SKIP ROUTINE                        01742
         MVC   FILEBYTE,BYTESPAT  MOVE IN EDIT PATTERN                   01743
         MVC   FILECONT,=C'CONTAINING'                                   01744
         L     R4,DBINH           LOAD REG WITH HI ORDER                 01745
         CVD   R4,DWORD           CONVERT HI ORDER TO PACKED             01746
         ZAP   QWORD,DWORD        PUT IT INTO PACKED HOLD AREA           01747
         MP    QWORD,TWO31        MULT BY 2 TO THE 31ST                  01748
         L     R4,DBINL           LOAD REG WITH LOW ORDER                01749
         CVD   R4,DWORD           CONVERT LOW ORDER TO PACKED            01750
         AP    QWORD,DWORD        AND ADD IT IN                          01751
         ED    FILEBYTE,QWORD+6   DISPLAY COUNT IN LINE                  01752
** ----                                                                  01753
         LM    R4,R5,TOTBYTES                                            01754
         A     R5,DBINL            LOW ORDER COUNT                       01755
         BNO   MARKNOVR            B IF NO OVERFLOW                      01756
         N     R5,=X'7FFFFFFF'     GET RID OF SIGN BYTE                  01757
         LA    R4,1(R4)            ADD 1 TO HIGH ORDER                   01758
MARKNOVR DS    0H                                                        01759
         A     R4,DBINH            HIGH ORDER                            01760
         STM   R4,R5,TOTBYTES      AND STORE THE NEW TOTAL               01761
** ----                                                                  01762
         TM    ISLBLFLG,X'01'      CAME FROM READING LABELS?             01763
         BZ    MARKISNL            NO. DON'T ADD TOTALS                  01764
         LM    R4,R5,LABBYTES                                            01765
         A     R5,LABINL           LOW ORDER COUNT                       01766
         BNO   MARKNOVL            B IF NO OVERFLOW                      01767
         N     R5,=X'7FFFFFFF'     GET RID OF SIGN BYTE                  01768
         LA    R4,1(R4)            ADD 1 TO HIGH ORDER                   01769
MARKNOVL DS    0H                                                        01770
         A     R4,LABINH           HIGH ORDER                            01771
         STM   R4,R5,LABBYTES      AND STORE THE NEW TOTAL               01772
* - >                                                                    01773
         TM    PARMFLG4,X'01'     IS CUMSEP ON?                          01774
         BZ    NOSEPLBL                                                  01775
         MVC   FILETBYE,BYTESPAT  MOVE IN EDIT PATTERN                   01776
         MVC   FILECUMT,=C'CUM LABEL:'                                   01777
         LM    R4,R5,LABBYTES    RELOAD CORRECT COUNTS                   01778
         CVD   R4,DWORD          HIGH ORDER WORD OF BYTE COUNT           01779
         ZAP   QWORD,DWORD       DUMP INTO TARGET                        01780
         MP    QWORD,TWO31       MULT BY 2 TO THE 31ST                   01781
         CVD   R5,DWORD          LOW ORDER WORD                          01782
         AP    QWORD,DWORD       AND ADD IT IN                           01783
         ED    FILETBYE,QWORD+6     MAKE NUMBER DISPLAYABLE              01784
         B     MARKNCN1            BYPASS PRINT OF COMPLETE TOTAL        01785
NOSEPLBL DS    0H                                                        01786
* - >                                                                    01787
         B     MARKNOLB                                                  01788
MARKISNL DS    0H                                                        01789
         TM    ISLBLFLG,X'01'      CAME FROM READING LABELS?             01790
         BO    MARKNOLB                                                  01791
         LM    R4,R5,FILBYTES                                            01792
         A     R5,DBINFL           LOW ORDER COUNT                       01793
         BNO   MARKNOVF            B IF NO OVERFLOW                      01794
         N     R5,=X'7FFFFFFF'     GET RID OF SIGN BYTE                  01795
         LA    R4,1(R4)            ADD 1 TO HIGH ORDER                   01796
MARKNOVF DS    0H                                                        01797
         A     R4,DBINFH           HIGH ORDER                            01798
         STM   R4,R5,FILBYTES                                            01799
* - >                                                                    01800
         TM    PARMFLG4,X'01'     IS CUMSEP ON?                          01801
         BZ    NOSEPDAT                                                  01802
         MVC   FILETBYE,BYTESPAT  MOVE IN EDIT PATTERN                   01803
         MVC   FILECUMT,=C'CUM DATA :'                                   01804
         LM    R4,R5,FILBYTES    RELOAD CORRECT COUNTS                   01805
         CVD   R4,DWORD          HIGH ORDER WORD OF BYTE COUNT           01806
         ZAP   QWORD,DWORD       DUMP INTO TARGET                        01807
         MP    QWORD,TWO31       MULT BY 2 TO THE 31ST                   01808
         CVD   R5,DWORD          LOW ORDER WORD                          01809
         AP    QWORD,DWORD       AND ADD IT IN                           01810
         ED    FILETBYE,QWORD+6     MAKE NUMBER DISPLAYABLE              01811
         B     MARKNCN1            BYPASS PRINT OF COMPLETE TOTAL        01812
NOSEPDAT DS    0H                                                        01813
* - >                                                                    01814
MARKNOLB DS    0H                                                        01815
** ----                                                                  01816
         TM    PARMFLG3,X'08'     CUMULATIVE BYTE TOTALS?                01817
         BZ    MARKNCN2           NO-SKIP ROUTINE                        01818
* - >                                                                    01819
         MVC   FILETBYE,BYTESPAT  MOVE IN EDIT PATTERN                   01820
         MVC   FILECUMT,=C'CUM TOTAL:'                                   01821
         LM    R4,R5,TOTBYTES    RELOAD CORRECT COUNTS                   01822
         CVD   R4,DWORD          HIGH ORDER WORD OF BYTE COUNT           01823
         ZAP   QWORD,DWORD       DUMP INTO TARGET                        01824
         MP    QWORD,TWO31       MULT BY 2 TO THE 31ST                   01825
         CVD   R5,DWORD          LOW ORDER WORD                          01826
         AP    QWORD,DWORD       AND ADD IT IN                           01827
         ED    FILETBYE,QWORD+6     MAKE NUMBER DISPLAYABLE              01828
* - >                                                                    01829
MARKNCN1 B     MARKNCNE           AVOID BLANKING OUT LINE                01830
MARKNCNT DS    0H                                                        01831
         MVC   FILEPBYT(44),LINE44   BLANK OUT THIS PART OF MESSAGE      01832
MARKNCN2 MVC   FILETBYT(44),LINE44   BLANK OUT THIS PART OF MESSAGE      01833
MARKNCNE DS    0H                                                        01834
**** ---- BYTE COUNTS --------------------------- ABOVE ---- ****        01835
         PUT   SYSPRINT,FILEDONE  WRITE IT                               01836
**** ---- BYTE COUNTS --------------------------- BELOW ---- ****        01837
         TM    PARMFLG3,X'04'     COUNTING BYTES?                        01838
         BZ    MARKNTOT           NO-SKIP ROUTINE                        01839
         MVC   FILECONT,=C'          '                                   01840
         MVC   FILECUMT,=C'          '                                   01841
         SR    R4,R4          ZERO BLOCK COUNT FOR NEW FILE              01842
         ST    R4,DBINH            ZERO BYTE COUNT                       01843
         ST    R4,DBINL            ZERO BYTE COUNT                       01844
         ST    R4,LABINH           ZERO BYTE COUNT                       01845
         ST    R4,LABINL           ZERO BYTE COUNT                       01846
         ST    R4,DBINFH           ZERO BYTE COUNT                       01847
         ST    R4,DBINFL           ZERO BYTE COUNT                       01848
MARKNTOT DS    0H                                                        01849
**** ---- BYTE COUNTS --------------------------- ABOVE ---- ****        01850
MARKFILE DS    0H                                                        01851
         SR    R7,R7          ZERO BLOCK COUNT FOR NEW FILE              01852
         ST    R7,BLOKCNT                                                01853
         L     R7,FILECNT                                                01854
         LA    R7,1(,R7)      ADD 1 TO FILE NUMBER                       01855
         ST    R7,FILECNT                                                01856
         L     R7,STOR7REG                                               01857
         TM    DATFLAG,X'10'  STILL NO REAL DATA READ?        SBG 03/00  01858
         BO    NOLBL          YES, DON'T TEST FOR 2ND TMK     SBG 03/00  01859
*** ---  FILE LIMITING CODE ---  BELOW ---- ***                          01860
         TM    PARMFLG3,X'02'    ARE WE LIMITING INPUT FILES             01861
         BZ    MARKFILA          NO - SKIP THIS CODE                     01862
         CLC   LTGFILE,FILECNT   IS FILECOUNT + 1 BIGGER THAN LIMIT?     01863
         BNL   MARKFILA          NO - NO RESTRICTIONS                    01864
         OI    EOFINFLG,X'01'    YES - CONSIDER AS END OF INPUT DATA     01865
MARKFILA DS    0H                                                        01866
*** ---  FILE LIMITING CODE ---  ABOVE ---- ***                          01867
         TM    PARMFLG4,X'02'   Stripping labels?
         BZ    MARKSTRX         no - bypass strip-related code
         TM    STRIPFLG,X'01'   DID WE JUST SKIP A LABEL?
         BZ    MARKSTRX         NO. CONTINUE PROCESSING
         NI    STRIPFLG,FF-X'01'   JUST SKIPPING ONE T.M. - NO MORE.
         B     READIN           YES. SKIP WRITING THE T.M. TOO
MARKSTRX DS    0H
*  BREAK IN HERE TO DETECT EOV AND STOP AFTER 1 TAPEMARK      SBG 04/00  01868
         TM    LBLFLAG,X'C0'  DID WE SEE AN EOV1 OR EOV2?     SBG 04/00  01869
         BZ    MARKGO         NO. TEST FOR 2ND TM             SBG 04/00  01870
         B     READIN2        YES. WRITE TO OUTPUTS & END     SBG 04/00  01871
MARKGO   CLI   OUTCCW,X'1F'   2ND TM IN A ROW?                           01872
         BE    TESTEND        YES. TEST IF RIGHT AFTER LABELS SBG 03/00  01873
NOLBL    MVI   OUTCCW,X'1F'   SET OUTPUT CCW TO WRITE TM      SBG 03/00  01874
         B     WRITE1         GO WRITE TM TO OUTPUTS                     01875
*  --- BELOW ---  CODE TO GO ON IF LABEL BEFORE 2 TAPE MARKS. SBG 03/00  01876
TESTEND  TM    LBLFLAG,X'03'  TEST FOR PREV HDR1 OR HDR2      SBG 03/00  01877
         BZ    INEODATA       NOT EITHER. END AS USUAL.       SBG 03/00  01878
TESTGOON MVI   LBLFLAG,X'00'  CLEAR LABEL FLAGS FOR NEXT READ SBG 03/00  01879
         B     NOLBL          GO ON WITHOUT SETTING EOV FLAG  SBG 03/00  01880
*  --- ABOVE ---  CODE TO GO ON IF LABEL BEFORE 2 TAPE MARKS. SBG 03/00  01881
*                                                             SBG 04/00  01882
*  --- ABOVE ---  PROCESSING WHEN TAPE MARK WAS ENCOUNTERED   SBG 04/00  01883
INEODATA DS    0H                                                        01884
         OI    INEODFLG,X'03'   INDICATE END OF DATA ON INPUT TAPE       01885
*                                                                        01886
READIN2  DS    0H                                                        01887
*  --- BELOW ---  ARE WE WRITING EXTERNAL LABELS AND EOF ON INPUT?       01888
         TM    PARMFLG2,X'80'    WRITING NEW LABELS ON OUTPUT TAPE?      01889
         BZ    READ2GO           NO. BYPASS THIS CODE.                   01890
         TM    PARMFLG3,X'40'    NO EXTRA LABELS AFTER END OF TAPE DATA  01891
         BO    READ2STP          YES, CUT OFF EXTRA STD LABELS           01892
         TM    WRLBLFLG,X'04'    COMING HERE FROM ENDHEADR?              01893
         BZ    NOEXTMK           NO                                      01894
         B     WRTTAPMK                                                  01895
NOEXTMK  TM    INEODFLG,X'01'    DID WE GET HERE FROM 2 TMKS ?           01896
         BZ    READ2GO           NO. BYPASS REST OF CODE.                01897
         OI    WRLBLFLG,X'01'    NEXT READ WILL BE FROM LABELS.          01898
         NI    INEODFLG,FF-X'01'  ONLY COME HERE ONCE                    01899
         MVI   LBLFLAG,X'00'     DON'T CONTROL WITH INPUT TAPE LABELS    01900
         B     READIN            DON'T WRITE FINAL TAPE MARK YET         01901
READ2STP DS    0H                                                        01902
         BAL   R7,BACKEXTH       BACKSPACE OVER EXTRA HEADERS            01903
READ2GO  DS    0H                                                        01904
*  --- ABOVE ---  ARE WE WRITING EXTERNAL LABELS AND EOF ON INPUT?       01905
         OI    FLAG2A,EOV     INDICATE EOV ON INPUT                      01906
* --- >>>  ------------------ below -------- Skip writing last T.M.
* -------------------------------------------------------------- *
*            When stripping labels, somehow an extra             *
*            tape mark gets written.  This is a kludge           *
*            to correct that.....                                *
* -------------------------------------------------------------- *
         TM    PARMFLG4,X'02'    Stripping Labels?
         BZ    READ2GNS          No. don't skip writing last t.m.
*        MVC   LINE(133),LINE-1       CLEAR LINE
*        MVC   LINE(133),DIAGMS1      Diagnostic message #1
*        PUT   SYSPRINT,LINE
         B     WRITE17           Do not write the extra tape mark
READ2GNS DS    0H
* --- >>>  ------------------ above -------- Skip writing last T.M.
         B     WRITE1                                                    01907
         SPACE 3                                                         01908
TLITWRIT DS    0H                                                        01909
         TM    PARMFLG3,X'01'                                            01910
         BZ    TLITWRIE                                                  01911
         MVC   OUTCCW+1(3),=AL3(EXTLBLIN)  SET UP LABEL WRITE            01912
         OI    WRLBLFLG,X'01'                                            01913
TLITSKP1 DS    0H                                                        01914
         TM    INIT1FLG,X'01'          NOT FIRST PASS THRU?              01915
         BO    TLITSKP2                GO TO SECOND PASS FOR HDR1        01916
         OI    LBLFLAG,X'04'           SIMULATE VOL1 FROM TAPE INPUT     01917
         NI    LBLFLAG,FF-X'03'        SIMULATE NO HDR1 OR HDR2          01918
         OI    LBLLFLAG,X'04'          SIMULATE VOL1 FROM EXT LABELS     01919
         NI    LBLLFLAG,FF-X'03'       SIMULATE NO HDR1 OR HDR2          01920
         MVC   EXTLBLIN(80),VOL1LABL   STUFF THE INPUT AREA WITH VOL1    01921
         MVC   OUTCCW+6(2),=H'80'      SET OUTPUT SIZE TO 80 BYTES       01922
         OI    INIT1FLG,X'01'          DON'T PASS THRU HERE AGAIN        01923
         B     WRITE1                  WRITE THIS VOL1 TO OUTPUTS        01924
TLITSKP2 DS    0H                                                        01925
         OI    LBLFLAG,X'09'           SIMULATE HDR1 AND INITTED HDR1    01926
         OI    LBLLFLAG,X'01'          SIMULATE HDR1 FROM EXT LABELS     01927
         MVC   EXTLBLIN(80),HDR1INIT   STUFF THE INPUT AREA WITH HDR1    01928
         MVC   OUTCCW+6(2),=H'80'      SET OUTPUT SIZE TO 80 BYTES       01929
         OI    FLAG2A,EOV              INDICATE EOV ON INPUT             01930
         OI    INIT1FLG,X'02'          SHOW WRITE THAT I'VE BEEN HERE    01931
         B     WRITE1                  WRITE INITTED HDR1 TO OUTPUTS     01932
TLITWRIE DS    0H                                                        01933
*                                                                        01934
*  WRITE TO OUTPUT TAPES                                                 01935
*                                                                        01936
WRITE1   DS    0H                                             SBG 06/00  01937
         CLI   OUTCCW,X'1F'     Are we writing a Tape Mark?
         BNE   WRNOTPMK         No. Don't touch bytes to be moved
         MVC   SAVBYTES(2),OUTCCW+6   Yes. Save bytes moved
         MVC   OUTCCW+6(2),=X'0001'   and just put in count of 1.
WRNOTPMK DS    0H
* --- READ ONLY CODE ------------------------------- BELOW -- SBG 06/00  01938
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  01939
         BO    WRITE17    YES--NO WRITES - ONLY READS         SBG 06/00  01940
* --- READ ONLY CODE ------------------------------- ABOVE -- SBG 06/00  01941
         TM    FLAG1,OP1      IS THIS OUTPUT PRESENT?                    01942
         BZ    WRITE2         NO                                         01943
         MVC   VOLCHG(6),VOLUME1     MOVE IN JCL OR OUTVOLALL VOLSER     01944
         MVC   DDOCHG(5),DDOUT1      MOVE IN OUTPUT DD NAME FOR MESSAGE  01945
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       01946
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         01947
         LA    R2,OUT1        R2=ADDRESS OF CURRENT DCB                  01948
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01949
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01950
         EXCP  OUTIOB         WRITE IT                                   01951
         WAIT  ECB=OUTECB     WAIT FOR IT                                01952
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01953
         BNE   OUTERR         NO - ERROR                                 01954
WRITE2   TM    FLAG1,OP2      IS THIS OUTPUT PRESENT?                    01955
         BZ    WRITE3         NO                                         01956
         MVC   VOLCHG(6),VOLUME2     MOVE IN JCL OR OUTVOLALL VOLSER     01957
         MVC   DDOCHG(5),DDOUT2      MOVE IN OUTPUT DD NAME FOR MESSAGE  01958
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       01959
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         01960
         LA    R2,OUT2        R2=ADDRESS OF CURRENT DCB                  01961
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01962
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01963
         EXCP  OUTIOB         WRITE IT                                   01964
         WAIT  ECB=OUTECB     WAIT FOR IT                                01965
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01966
         BNE   OUTERR         NO - ERROR                                 01967
WRITE3   TM    FLAG1,OP3      IS THIS OUTPUT PRESENT?                    01968
         BZ    WRITE4         NO                                         01969
         MVC   VOLCHG(6),VOLUME3     MOVE IN JCL OR OUTVOLALL VOLSER     01970
         MVC   DDOCHG(5),DDOUT3      MOVE IN OUTPUT DD NAME FOR MESSAGE  01971
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       01972
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         01973
         LA    R2,OUT3        R2=ADDRESS OF CURRENT DCB                  01974
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01975
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01976
         EXCP  OUTIOB         WRITE IT                                   01977
         WAIT  ECB=OUTECB     WAIT FOR IT                                01978
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01979
         BNE   OUTERR         NO - ERROR                                 01980
WRITE4   TM    FLAG1,OP4      IS THIS OUTPUT PRESENT?                    01981
         BZ    WRITE5         NO                                         01982
         MVC   VOLCHG(6),VOLUME4     MOVE IN JCL OR OUTVOLALL VOLSER     01983
         MVC   DDOCHG(5),DDOUT4      MOVE IN OUTPUT DD NAME FOR MESSAGE  01984
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       01985
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         01986
         LA    R2,OUT4        R2=ADDRESS OF CURRENT DCB                  01987
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01988
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01989
         EXCP  OUTIOB         WRITE IT                                   01990
         WAIT  ECB=OUTECB     WAIT FOR IT                                01991
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01992
         BNE   OUTERR         NO - ERROR                                 01993
WRITE5   TM    FLAG1,OP5      IS THIS OUTPUT PRESENT?                    01994
         BZ    WRITE6         NO                                         01995
         MVC   VOLCHG(6),VOLUME5     MOVE IN JCL OR OUTVOLALL VOLSER     01996
         MVC   DDOCHG(5),DDOUT5      MOVE IN OUTPUT DD NAME FOR MESSAGE  01997
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       01998
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         01999
         LA    R2,OUT5        R2=ADDRESS OF CURRENT DCB                  02000
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02001
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02002
         EXCP  OUTIOB         WRITE IT                                   02003
         WAIT  ECB=OUTECB     WAIT FOR IT                                02004
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02005
         BNE   OUTERR         NO - ERROR                                 02006
WRITE6   TM    FLAG1,OP6      IS THIS OUTPUT PRESENT?                    02007
         BZ    WRITE7         NO                                         02008
         MVC   VOLCHG(6),VOLUME6     MOVE IN JCL OR OUTVOLALL VOLSER     02009
         MVC   DDOCHG(5),DDOUT6      MOVE IN OUTPUT DD NAME FOR MESSAGE  02010
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02011
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02012
         LA    R2,OUT6        R2=ADDRESS OF CURRENT DCB                  02013
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02014
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02015
         EXCP  OUTIOB         WRITE IT                                   02016
         WAIT  ECB=OUTECB     WAIT FOR IT                                02017
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02018
         BNE   OUTERR         NO - ERROR                                 02019
WRITE7   TM    FLAG1,OP7      IS THIS OUTPUT PRESENT?                    02020
         BZ    WRITE8         NO                                         02021
         MVC   VOLCHG(6),VOLUME7     MOVE IN JCL OR OUTVOLALL VOLSER     02022
         MVC   DDOCHG(5),DDOUT7      MOVE IN OUTPUT DD NAME FOR MESSAGE  02023
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02024
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02025
         LA    R2,OUT7        R2=ADDRESS OF CURRENT DCB                  02026
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02027
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02028
         EXCP  OUTIOB         WRITE IT                                   02029
         WAIT  ECB=OUTECB     WAIT FOR IT                                02030
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02031
         BNE   OUTERR         NO - ERROR                                 02032
WRITE8   TM    FLAG1,OP8      IS THIS OUTPUT PRESENT?                    02033
         BZ    WRITE9         NO                                         02034
         MVC   VOLCHG(6),VOLUME8     MOVE IN JCL OR OUTVOLALL VOLSER     02035
         MVC   DDOCHG(5),DDOUT8      MOVE IN OUTPUT DD NAME FOR MESSAGE  02036
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02037
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02038
         LA    R2,OUT8        R2=ADDRESS OF CURRENT DCB                  02039
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02040
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02041
         EXCP  OUTIOB         WRITE IT                                   02042
         WAIT  ECB=OUTECB     WAIT FOR IT                                02043
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02044
         BNE   OUTERR         NO - ERROR                                 02045
WRITE9   TM    FLAG2,OP9      IS THIS OUTPUT PRESENT?                    02046
         BZ    WRITE10        NO                                         02047
         MVC   VOLCHG(6),VOLUME9     MOVE IN JCL OR OUTVOLALL VOLSER     02048
         MVC   DDOCHG(5),DDOUT9      MOVE IN OUTPUT DD NAME FOR MESSAGE  02049
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02050
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02051
         LA    R2,OUT9        R2=ADDRESS OF CURRENT DCB                  02052
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02053
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02054
         EXCP  OUTIOB         WRITE IT                                   02055
         WAIT  ECB=OUTECB     WAIT FOR IT                                02056
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02057
         BNE   OUTERR         NO - ERROR                                 02058
WRITE10  TM    FLAG2,OP10     IS THIS OUTPUT PRESENT?                    02059
         BZ    WRITE11        NO                                         02060
         MVC   VOLCHG(6),VOLUME10    MOVE IN JCL OR OUTVOLALL VOLSER     02061
         MVC   DDOCHG(5),DDOUT10     MOVE IN OUTPUT DD NAME FOR MESSAGE  02062
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02063
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02064
         LA    R2,OUT10       R2=ADDRESS OF CURRENT DCB                  02065
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02066
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02067
         EXCP  OUTIOB         WRITE IT                                   02068
         WAIT  ECB=OUTECB     WAIT FOR IT                                02069
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02070
         BNE   OUTERR         NO - ERROR                                 02071
WRITE11  TM    FLAG2,OP11     IS THIS OUTPUT PRESENT?                    02072
         BZ    WRITE12        NO                                         02073
         MVC   VOLCHG(6),VOLUME11    MOVE IN JCL OR OUTVOLALL VOLSER     02074
         MVC   DDOCHG(5),DDOUT11     MOVE IN OUTPUT DD NAME FOR MESSAGE  02075
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02076
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02077
         LA    R2,OUT11       R2=ADDRESS OF CURRENT DCB                  02078
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02079
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02080
         EXCP  OUTIOB         WRITE IT                                   02081
         WAIT  ECB=OUTECB     WAIT FOR IT                                02082
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02083
         BNE   OUTERR         NO - ERROR                                 02084
WRITE12  TM    FLAG2,OP12     IS THIS OUTPUT PRESENT?                    02085
         BZ    WRITE13        NO                                         02086
         MVC   VOLCHG(6),VOLUME12    MOVE IN JCL OR OUTVOLALL VOLSER     02087
         MVC   DDOCHG(5),DDOUT12     MOVE IN OUTPUT DD NAME FOR MESSAGE  02088
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02089
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02090
         LA    R2,OUT12       R2=ADDRESS OF CURRENT DCB                  02091
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02092
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02093
         EXCP  OUTIOB         WRITE IT                                   02094
         WAIT  ECB=OUTECB     WAIT FOR IT                                02095
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02096
         BNE   OUTERR         NO - ERROR                                 02097
WRITE13  TM    FLAG2,OP13     IS THIS OUTPUT PRESENT?                    02098
         BZ    WRITE14        NO                                         02099
         MVC   VOLCHG(6),VOLUME13    MOVE IN JCL OR OUTVOLALL VOLSER     02100
         MVC   DDOCHG(5),DDOUT13     MOVE IN OUTPUT DD NAME FOR MESSAGE  02101
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02102
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02103
         LA    R2,OUT13       R2=ADDRESS OF CURRENT DCB                  02104
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02105
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02106
         EXCP  OUTIOB         WRITE IT                                   02107
         WAIT  ECB=OUTECB     WAIT FOR IT                                02108
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02109
         BNE   OUTERR         NO - ERROR                                 02110
WRITE14  TM    FLAG2,OP14     IS THIS OUTPUT PRESENT?                    02111
         BZ    WRITE15        NO                                         02112
         MVC   VOLCHG(6),VOLUME14    MOVE IN JCL OR OUTVOLALL VOLSER     02113
         MVC   DDOCHG(5),DDOUT14     MOVE IN OUTPUT DD NAME FOR MESSAGE  02114
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02115
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02116
         LA    R2,OUT14       R2=ADDRESS OF CURRENT DCB                  02117
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02118
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02119
         EXCP  OUTIOB         WRITE IT                                   02120
         WAIT  ECB=OUTECB     WAIT FOR IT                                02121
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02122
         BNE   OUTERR         NO - ERROR                                 02123
WRITE15  TM    FLAG2,OP15     IS THIS OUTPUT PRESENT?                    02124
         BZ    WRITE16        NO                                         02125
         MVC   VOLCHG(6),VOLUME15    MOVE IN JCL OR OUTVOLALL VOLSER     02126
         MVC   DDOCHG(5),DDOUT15     MOVE IN OUTPUT DD NAME FOR MESSAGE  02127
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02128
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02129
         LA    R2,OUT15       R2=ADDRESS OF CURRENT DCB                  02130
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02131
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02132
         EXCP  OUTIOB         WRITE IT                                   02133
         WAIT  ECB=OUTECB     WAIT FOR IT                                02134
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02135
         BNE   OUTERR         NO - ERROR                                 02136
WRITE16  TM    FLAG2,OP16     IS THIS OUTPUT PRESENT?                    02137
         BZ    WRITE17        NO                                         02138
         MVC   VOLCHG(6),VOLUME16    MOVE IN JCL OR OUTVOLALL VOLSER     02139
         MVC   DDOCHG(5),DDOUT16     MOVE IN OUTPUT DD NAME FOR MESSAGE  02140
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY       02141
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE         02142
         LA    R2,OUT16       R2=ADDRESS OF CURRENT DCB                  02143
         ST    R2,OUTDCBPT    PUT IT IN IOB                              02144
         MVI   OUTECB,X'00'   INITIALIZE ECB                             02145
         EXCP  OUTIOB         WRITE IT                                   02146
         WAIT  ECB=OUTECB     WAIT FOR IT                                02147
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   02148
         BNE   OUTERR         NO - ERROR                                 02149
WRITE17  DS    0H                                                        02150
         CLI   OUTCCW,X'1F'   Have we written a Tape Mark?
         BNE   WR17NTPM       No. Don't correct bytes moved field
         MVC   OUTCCW+6(2),SAVBYTES    Yes. Restore bytes moved field
WR17NTPM DS    0H
         TM    LBLFLAG,X'08'  INITTED HDR1 SEEN?                         02151
         BO    ENDINPUT       YES. CLOSE.                                02152
         TM    FLAG2A,EOV     END OF INPUT?                              02153
         BO    ENDINPUT       YES - QUIT                                 02154
         B     READIN         NO - LOOP                                  02155
         SPACE 3                                                         02156
*                                                                        02157
*  ERROR ON INPUT -- TELL OPERATOR AND ABEND                             02158
*                                                                        02159
INERR    TM    INCSW+4,X'02'  UNIT CHECK?                                02160
         BZ    INERR1         NO - ASSUME DATA CHECK                     02161
         MVC   LINE(133),INEQC  SET ERROR MESSAGE                        02162
         MVC   INERR3+16(25),INEQC+12  MOVE ERROR MESSAGE TO WTOR        02163
         B     INERR2         CONTINUE                                   02164
INERR1   MVC   LINE(133),INDCK  SET ERROR MESSAGE                        02165
         MVC   INERR3+16(20),INDCK+12  MOVE ERROR MESSAGE TO WTOR        02166
INERR2   PUT   SYSPRINT,LINE  WRITE ERROR MESSAGE                        02167
         MVI   INECB,X'00'    RESET ECB                                  02168
INERR3   WTOR  '                          -- ACKNOWLEDGE',REPLY,       X 02169
               6,INECB,ROUTCDE=(3)                                       02170
         WAIT  ECB=INECB      WAIT FOR OPERATOR TO SEE THE MESSAGE       02171
*                             WHO CARES WHAT THE REPLY IS                02172
         OI    ABENDFLG,X'01'    Turn on ABEND Flag
         B     CLOSMALL
*        ABEND 69             QUIT                                       02173
         SPACE 3                                                         02174
*                                                                        02175
*  ERROR ON OUTPUT -- TELL OPERATOR THEN TERMINATE THIS OUTPUT ONLY      02176
*                                                                        02177
OUTERR   NI    UNEXFLAG,FF-X'01'  CLEAR BIT ON UNIT EXCEPTION FLAG       02178
         TM    OUTCSW+4,X'02' UNIT CHECK?                                02179
         BO    OUTERUC        YES. HANDLE IT.                            02180
         TM    OUTCSW+4,X'01' UNIT EXCEPTION ON WRITE?                   02181
         BZ    OUTERR1        NO. ASSUME DATA CHECK.                     02182
         OI    UNEXFLAG,X'01'     FLAG THAT WE HAVE UNIT EXCEPTION       02183
         MVC   LINE(133),OUTUNEX  SET UNIT EXCEPTION ERROR MESSAGE       02184
         B     OUTERR2            GO FILL IN REST OF THE INFO            02185
OUTERUC  MVC   LINE(133),OUTEQC  SET ERROR MESSAGE                       02186
         B     OUTERR2        CONTINUE                                   02187
OUTERR1  MVC   LINE(133),OUTDCK  SET ERROR MESSAGE                       02188
OUTERR2  LH    R4,40(,R2)     R4=TIOT OFFSET                             02189
         L     R5,16          R5=CVT                                     02190
         L     R5,0(,R5)      R5=TCB WORDS                               02191
         L     R5,4(,R5)      R5=MY TCB                                  02192
         L     R5,12(,R5)     R5=TIOT                                    02193
         AR    R4,R5          R4=TIOT ENTRY FOR THIS OUTPUT              02194
         MVC   LINE+35(5),4(R4)  MOVE DDNAME TO MESSAGE                  02195
         L     R4,16(,R4)     R4=UCB FOR THIS OUTPUT                     02196
         MVC   LINE+47(3),13(R4)  MOVE UNIT ADDRESS TO MESSAGE           02197
         MVC   LINE+59(6),36(R4)  MOVE VOLSER TO MESSAGE                 02198
         PUT   SYSPRINT,LINE  WRITE MESSAGE                              02199
         TM    UNEXFLAG,X'01'   WAS THIS A UNIT EXCEPTION ONLY           02200
         BO    OUTERR4A         IF SO, SKIP THE WTOR BECAUSE             02201
*                               THIS IS A SEMI-NORMAL CONDITION          02202
*                               AND WHY INVOLVE THE OPERATOR?            02203
         MVC   OUTERR4+16(53),LINE+12  MOVE ERROR MESSAGE TO WTOR        02204
OUTERR3  MVI   OUTECB,X'00'   RESET ECB                                  02205
OUTERR4  WTOR  '                                                       X 02206
               -- REPLY GO TO CONTINUE',REPLY,2,OUTECB,ROUTCDE=(3)       02207
         WAIT  ECB=OUTECB     WAIT FOR OPERATOR TO REPLY                 02208
         CLC   REPLY(2),=C'GO'  CORRECT REPLY?                           02209
         BNE   OUTERR3        NO - TRY AGAIN                             02210
* ------------------------------------------------------------------- *  02211
*        REWIND BEFORE CLOSE RUINS WHATEVER OUTPUT HAS BEEN WRITTEN   *  02212
*        ALREADY.  DON'T DO IT ON END-OF-TAPE CONDITIONS.             *  02213
* ------------------------------------------------------------------- *  02214
*        ST    R2,REWDCBPT    PUT DCB ADDRESS IN REWIND IOB              02215
*        EXCP  REWIOB         REWIND TAPE WITH THE ERROR                 02216
*                             DON'T BOTHER WAITING FOR REWIND            02217
* ------------------------------------------------------------------- *  02218
OUTERR4A OI    FLAG2A,ERR     INDICATE THAT THERE WAS AN ERROR           02219
         LA    R3,OUT1        R3=DCB FOR OUTPUT 1                        02220
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02221
         BNE   OUTERR5        NO                                         02222
         NI    FLAG1,FF-OP1   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02223
         B     WRITE2         CONTINUE WITH OTHER OUTPUT                 02224
OUTERR5  LA    R3,OUT2        R3=DCB FOR OUTPUT 2                        02225
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02226
         BNE   OUTERR6        NO                                         02227
         NI    FLAG1,FF-OP2   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02228
         B     WRITE3         CONTINUE WITH OTHER OUTPUT                 02229
OUTERR6  LA    R3,OUT3        R3=DCB FOR OUTPUT 3                        02230
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02231
         BNE   OUTERR7        NO                                         02232
         NI    FLAG1,FF-OP3   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02233
         B     WRITE4         CONTINUE WITH OTHER OUTPUT                 02234
OUTERR7  LA    R3,OUT4        R3=DCB FOR OUTPUT 4                        02235
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02236
         BNE   OUTERR8        NO                                         02237
         NI    FLAG1,FF-OP4   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02238
         B     WRITE5         CONTINUE WITH OTHER OUTPUT                 02239
OUTERR8  LA    R3,OUT5        R3=DCB FOR OUTPUT 5                        02240
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02241
         BNE   OUTERR9        NO                                         02242
         NI    FLAG1,FF-OP5   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02243
         B     WRITE6         CONTINUE WITH OTHER OUTPUT                 02244
OUTERR9  LA    R3,OUT6        R3=DCB FOR OUTPUT 6                        02245
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02246
         BNE   OUTERR10       NO                                         02247
         NI    FLAG1,FF-OP6   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02248
         B     WRITE7         CONTINUE WITH OTHER OUTPUT                 02249
OUTERR10 LA    R3,OUT7        R3=DCB FOR OUTPUT 7                        02250
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02251
         BNE   OUTERR11       NO                                         02252
         NI    FLAG1,FF-OP7   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02253
         B     WRITE8         CONTINUE WITH OTHER OUTPUT                 02254
OUTERR11 LA    R3,OUT8        R3=DCB FOR OUTPUT 8                        02255
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02256
         BNE   OUTERR12       NO                                         02257
         NI    FLAG1,FF-OP8   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02258
         B     WRITE9         CONTINUE WITH OTHER OUTPUT                 02259
OUTERR12 LA    R3,OUT9        R3=DCB FOR OUTPUT 9                        02260
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02261
         BNE   OUTERR13       NO                                         02262
         NI    FLAG2,FF-OP9   SHOW THIS OUTPUT NOT PRESENT ANY MORE      02263
         B     WRITE10        CONTINUE WITH OTHER OUTPUT                 02264
OUTERR13 LA    R3,OUT10       R3=DCB FOR OUTPUT 10                       02265
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02266
         BNE   OUTERR14       NO                                         02267
         NI    FLAG2,FF-OP10  SHOW THIS OUTPUT NOT PRESENT ANY MORE      02268
         B     WRITE11        CONTINUE WITH OTHER OUTPUT                 02269
OUTERR14 LA    R3,OUT11       R3=DCB FOR OUTPUT 11                       02270
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02271
         BNE   OUTERR15       NO                                         02272
         NI    FLAG2,FF-OP11  SHOW THIS OUTPUT NOT PRESENT ANY MORE      02273
         B     WRITE12        CONTINUE WITH OTHER OUTPUT                 02274
OUTERR15 LA    R3,OUT12       R3=DCB FOR OUTPUT 12                       02275
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02276
         BNE   OUTERR16       NO                                         02277
         NI    FLAG2,FF-OP12  SHOW THIS OUTPUT NOT PRESENT ANY MORE      02278
         B     WRITE13        CONTINUE WITH OTHER OUTPUT                 02279
OUTERR16 LA    R3,OUT13       R3=DCB FOR OUTPUT 13                       02280
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02281
         BNE   OUTERR17       NO                                         02282
         NI    FLAG2,FF-OP13  SHOW THIS OUTPUT NOT PRESENT ANY MORE      02283
         B     WRITE14        CONTINUE WITH OTHER OUTPUT                 02284
OUTERR17 LA    R3,OUT14       R3=DCB FOR OUTPUT 14                       02285
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02286
         BNE   OUTERR18       NO                                         02287
         NI    FLAG2,FF-OP14  SHOW THIS OUTPUT NOT PRESENT ANY MORE      02288
         B     WRITE15        CONTINUE WITH OTHER OUTPUT                 02289
OUTERR18 LA    R3,OUT15       R3=DCB FOR OUTPUT 15                       02290
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           02291
         BNE   OUTERR19       NO                                         02292
         NI    FLAG2,FF-OP15  SHOW THIS OUTPUT NOT PRESENT ANY MORE      02293
         B     WRITE16        CONTINUE WITH OTHER OUTPUT                 02294
*                             THEN IT MUST BE OUTPUT 16                  02295
OUTERR19 NI    FLAG2,FF-OP16  SHOW THIS OUTPUT NOT PRESENT ANY MORE      02296
         B     WRITE17        CONTINUE WITH OTHER OUTPUT                 02297
         SPACE 3                                                         02298
*                                                                        02299
*  END OF INPUT -- FINISH UP                                             02300
*                                                                        02301
ENDINPUT DS    0H                                                        02302
         SPACE 3                                                         02303
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  02304
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  02305
         BZ    ENDIN0     NO. USE WRITE SUCCESS MESSAGE       SBG 06/00  02306
         MVC   LINE(133),SUCCESSR    MOVE READ-ONLY MESSAGE   SBG 06/00  02307
         B     ENDIN16          WRITE OUT MESSAGE             SBG 06/00  02308
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  02309
ENDIN0   MVC   LINE(133),SUCCESS  MOVE MESSAGE TO LINE                   02310
         TM    FLAG2,OP16     OUTPUT 16 COMPLETED?                       02311
         BO    ENDIN1         YES - CONTINUE                             02312
         MVC   LINE+126(5),LINE+131 NO - DON'T SHOW IT                   02313
ENDIN1   TM    FLAG2,OP15     OUTPUT 15 COMPLETED?                       02314
         BO    ENDIN2         YES - CONTINUE                             02315
         MVC   LINE+119(12),LINE+126  NO - DON'T SHOW IT                 02316
ENDIN2   TM    FLAG2,OP14     OUTPUT 14 COMPLETED?                       02317
         BO    ENDIN3         YES - CONTINUE                             02318
         MVC   LINE+112(19),LINE+119  NO - DON'T SHOW IT                 02319
ENDIN3   TM    FLAG2,OP13     OUTPUT 13 COMPLETED?                       02320
         BO    ENDIN4         YES - CONTINUE                             02321
         MVC   LINE+105(26),LINE+112  NO - DON'T SHOW IT                 02322
ENDIN4   TM    FLAG2,OP12     OUTPUT 12 COMPLETED?                       02323
         BO    ENDIN5         YES - CONTINUE                             02324
         MVC   LINE+98(33),LINE+105  NO - DON'T SHOW IT                  02325
ENDIN5   TM    FLAG2,OP11     OUTPUT 11 COMPLETED?                       02326
         BO    ENDIN6         YES - CONTINUE                             02327
         MVC   LINE+91(40),LINE+98  NO - DON'T SHOW IT                   02328
ENDIN6   TM    FLAG2,OP10     OUTPUT 10 COMPLETED?                       02329
         BO    ENDIN7         YES - CONTINUE                             02330
         MVC   LINE+84(47),LINE+91  NO - DON'T SHOW IT                   02331
ENDIN7   TM    FLAG2,OP9      OUTPUT 9 COMPLETED?                        02332
         BO    ENDIN8         YES - CONTINUE                             02333
         MVC   LINE+78(53),LINE+84  NO - DON'T SHOW IT                   02334
ENDIN8   TM    FLAG1,OP8      OUTPUT 8 COMPLETED?                        02335
         BO    ENDIN9         YES - CONTINUE                             02336
         MVC   LINE+72(59),LINE+78  NO - DON'T SHOW IT                   02337
ENDIN9   TM    FLAG1,OP7      OUTPUT 7 COMPLETED?                        02338
         BO    ENDIN10        YES - CONTINUE                             02339
         MVC   LINE+66(65),LINE+72  NO - DON'T SHOW IT                   02340
ENDIN10  TM    FLAG1,OP6      OUTPUT 6 COMPLETED?                        02341
         BO    ENDIN11        YES - CONTINUE                             02342
         MVC   LINE+60(71),LINE+66  NO - DON'T SHOW IT                   02343
ENDIN11  TM    FLAG1,OP5      OUTPUT 5 COMPLETED?                        02344
         BO    ENDIN12        YES - CONTINUE                             02345
         MVC   LINE+54(77),LINE+60  NO - DON'T SHOW IT                   02346
ENDIN12  TM    FLAG1,OP4      OUTPUT 4 COMPLETED?                        02347
         BO    ENDIN13        YES - CONTINUE                             02348
         MVC   LINE+48(83),LINE+54  NO - DON'T SHOW IT                   02349
ENDIN13  TM    FLAG1,OP3      OUTPUT 3 COMPLETED?                        02350
         BO    ENDIN14        YES - CONTINUE                             02351
         MVC   LINE+42(89),LINE+48  NO - DON'T SHOW IT                   02352
ENDIN14  TM    FLAG1,OP2      OUTPUT 2 COMPLETED?                        02353
         BO    ENDIN15        YES - CONTINUE                             02354
         MVC   LINE+36(95),LINE+42  NO - DON'T SHOW IT                   02355
ENDIN15  TM    FLAG1,OP1      OUTPUT 1 COMPLETED?                        02356
         BO    ENDIN16        YES - CONTINUE                             02357
         MVC   LINE+30(101),LINE+36  NO - DON'T SHOW IT                  02358
ENDIN16  PUT   SYSPRINT,LINE  WRITE IT                                   02359
         SPACE 3                                                         02360
*                                                                        02361
*  CLOSE ALL FILES                                                       02362
*                                                                        02363
CLOSMALL DS    0H                                                        02364
**** ---- BYTE COUNT CODE ---------------- BELOW -------- *              02365
         TM    PARMFLG3,X'04'    COUNTING BYTES?                         02366
         BZ    ENDINTOT          NO - SKIP ROUTINE                       02367
         LM    R4,R5,TOTBYTES    GET TOTAL NUMBER OF BYTES               02368
         CVD   R4,DWORD          HIGH ORDER WORD OF BYTE COUNT           02369
         ZAP   QWORD,DWORD       DUMP INTO TARGET                        02370
         MP    QWORD,TWO31       MULT BY 2 TO THE 31ST                   02371
         CVD   R5,DWORD          LOW ORDER WORD                          02372
         AP    QWORD,DWORD       AND ADD IT IN                           02373
         ED    TOTBPATT,QWORD+6     MAKE NUMBER DISPLAYABLE              02374
         PUT   SYSPRINT,TOTBLINE                                         02375
         MVI   LINE,C' '                                                 02376
         MVC   LINE+1(L'LINE-1),LINE CLEAR LINE                          02377
         LM    R4,R5,LABBYTES    GET TOTAL NUMBER OF BYTES IN LABELS     02378
         CVD   R4,DWORD          HIGH ORDER WORD OF BYTE COUNT           02379
         ZAP   QWORD,DWORD       DUMP INTO TARGET                        02380
         MP    QWORD,TWO31       MULT BY 2 TO THE 31ST                   02381
         CVD   R5,DWORD          LOW ORDER WORD                          02382
         AP    QWORD,DWORD       AND ADD IT IN                           02383
         ED    TOTLPATT,QWORD+6     MAKE NUMBER DISPLAYABLE              02384
         PUT   SYSPRINT,TOTLLINE                                         02385
         MVI   LINE,C' '                                                 02386
         MVC   LINE+1(L'LINE-1),LINE CLEAR LINE                          02387
         LM    R4,R5,FILBYTES    GET TOTAL NUMBER OF BYTES IN FILES      02388
         CVD   R4,DWORD          HIGH ORDER WORD OF BYTE COUNT           02389
         ZAP   QWORD,DWORD       DUMP INTO TARGET                        02390
         MP    QWORD,TWO31       MULT BY 2 TO THE 31ST                   02391
         CVD   R5,DWORD          LOW ORDER WORD                          02392
         AP    QWORD,DWORD       AND ADD IT IN                           02393
         ED    TOTWPATT,QWORD+6     MAKE NUMBER DISPLAYABLE              02394
         PUT   SYSPRINT,TOTWLINE                                         02395
         MVI   LINE,C' '                                                 02396
         MVC   LINE+1(L'LINE-1),LINE CLEAR LINE                          02397
ENDINTOT DS    0H                                                        02398
**** ---- BYTE COUNT CODE ---------------- ABOVE -------- *              02399
* --------------------  REPORT THAT WE COPIED INITTED TAPES - BELOW - *  02400
         TM    LBLFLAG,X'08'  HAVE WE COPIED AN INITTED TAPE?            02401
         BZ    NOINITT3       NOPE. DON'T REPORT IT EITHER.              02402
         MVI   LINE-1,C' '                                               02403
         MVC   LINE,LINE-1    CLEAR PRINT LINE                           02404
         MVC   INITSER(6),INVOLUME  MOVE IN VOLSER FROM VOL1             02405
         MVC   LINE(133),INITMSG MSG-WE'RE DOING INITTED TAPE            02406
         PUT   SYSPRINT,LINE  WRITE MESSAGE                              02407
NOINITT3 DS    0H                                                        02408
* --------------------  REPORT THAT WE COPIED INITTED TAPES - ABOVE - *  02409
         TM    PARMFLG3,X'01'   INIT ONLY?                               02410
         BO    NOCLOSIN                                                  02411
         CLOSE (IN)                                                      02412
NOCLOSIN DS    0H                                                        02413
         CLOSE (SYSPRINT)                                                02414
         TM    PARMFLG2,X'10'   DO WE DUMP LABELS?            SBG 09/00  02415
         BZ    NOLBLCLS         NO. NO FILE TO CLOSE          SBG 09/00  02416
         NI    OPENDFLG,FF-X'01'  MARK FILE AS CLOSED                    02417
         CLOSE (LABLDUMP)                                                02418
NOLBLCLS DS    0H               SKIP CLOSE OF LABEL DUMP FILE            02419
         TM    PARMFLG2,X'80'   DO WE ADD LABELS?                        02420
         BZ    NOLABACL         NO. NO FILE TO CLOSE                     02421
         TM    OPENDFLG,X'04'   IS THE FILE OPEN?                        02422
         BZ    NOLABACL         NO. CANNOT CLOSE IT.                     02423
         NI    OPENDFLG,FF-X'04'  MARK FILE AS CLOSED                    02424
         CLOSE (LABADDIN)                                                02425
NOLABACL DS    0H               SKIP CLOSE OF EXTERNAL LABEL FILE        02426
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  02427
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  02428
         BO    THEEND     YES. ONLY CLOSE INPUT AND SYSPRINT. SBG 06/00  02429
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  02430
         TM    FLAG3,OP1      OUTPUT 1 OPEN?                             02431
         BZ    CLOSE1         NO                                         02432
         CLOSE (OUT1)         CLOSE OUTPUT 1                             02433
CLOSE1   TM    FLAG3,OP2      OUTPUT 2 OPEN?                             02434
         BZ    CLOSE2         NO                                         02435
         CLOSE (OUT2)         CLOSE OUTPUT 2                             02436
CLOSE2   TM    FLAG3,OP3      OUTPUT 3 OPEN?                             02437
         BZ    CLOSE3         NO                                         02438
         CLOSE (OUT3)         CLOSE OUTPUT 3                             02439
CLOSE3   TM    FLAG3,OP4      OUTPUT 4 OPEN?                             02440
         BZ    CLOSE4         NO                                         02441
         CLOSE (OUT4)         CLOSE OUTPUT 4                             02442
CLOSE4   TM    FLAG3,OP5      OUTPUT 5 OPEN?                             02443
         BZ    CLOSE5         NO                                         02444
         CLOSE (OUT5)         CLOSE OUTPUT 5                             02445
CLOSE5   TM    FLAG3,OP6      OUTPUT 6 OPEN?                             02446
         BZ    CLOSE6         NO                                         02447
         CLOSE (OUT6)         CLOSE OUTPUT 6                             02448
CLOSE6   TM    FLAG3,OP7      OUTPUT 7 OPEN?                             02449
         BZ    CLOSE7         NO                                         02450
         CLOSE (OUT7)         CLOSE OUTPUT 7                             02451
CLOSE7   TM    FLAG3,OP8      OUTPUT 8 OPEN?                             02452
         BZ    CLOSE8         NO                                         02453
         CLOSE (OUT8)         CLOSE OUTPUT 8                             02454
CLOSE8   TM    FLAG4,OP9      OUTPUT 9 OPEN?                             02455
         BZ    CLOSE9         NO                                         02456
         CLOSE (OUT9)         CLOSE OUTPUT 9                             02457
CLOSE9   TM    FLAG4,OP10     OUTPUT 10 OPEN?                            02458
         BZ    CLOSE10        NO                                         02459
         CLOSE (OUT10)        CLOSE OUTPUT 10                            02460
CLOSE10  TM    FLAG4,OP11     OUTPUT 11 OPEN?                            02461
         BZ    CLOSE11        NO                                         02462
         CLOSE (OUT11)        CLOSE OUTPUT 11                            02463
CLOSE11  TM    FLAG4,OP12     OUTPUT 12 OPEN?                            02464
         BZ    CLOSE12        NO                                         02465
         CLOSE (OUT12)        CLOSE OUTPUT 12                            02466
CLOSE12  TM    FLAG4,OP13     OUTPUT 13 OPEN?                            02467
         BZ    CLOSE13        NO                                         02468
         CLOSE (OUT13)        CLOSE OUTPUT 13                            02469
CLOSE13  TM    FLAG4,OP14     OUTPUT 14 OPEN?                            02470
         BZ    CLOSE14        NO                                         02471
         CLOSE (OUT14)        CLOSE OUTPUT 14                            02472
CLOSE14  TM    FLAG4,OP15     OUTPUT 15 OPEN?                            02473
         BZ    CLOSE15        NO                                         02474
         CLOSE (OUT15)        CLOSE OUTPUT 15                            02475
CLOSE15  TM    FLAG4,OP16     OUTPUT 16 OPEN?                            02476
         BZ    THEEND         NO                                         02477
         CLOSE (OUT16)        CLOSE OUTPUT 16                            02478
         SPACE 3                                                         02479
*                                                                        02480
*  Test for ABEND 069 first.  Did we come from an Input Error?           02480
*                                                                        02480
         TM    ABENDFLG,X'01'    Is ABEND flag on?                       02480
         BZ    THEEND            No.  End normally.                      02480
         ABEND 69                QUIT
*                                                                        02480
*  THE END                                                               02481
*                                                                        02482
THEEND   EQU   *                                                         02483
         TM    PARMFLG4,X'40'    DO WE SUPPRESS THE WTO?                 02484
         BO    THEEND1           YES WE DO.                              02485
         MVC   WTOCBT+16(41),FILEDONE                                    02486
WTOCBT   WTO   'CBT990                                              '    02487
         SR    R15,R15        ZERO RETURN CODE                           02488
         TM    FLAG2A,ERR     WAS THERE AN ERROR?                        02489
         BZ    THEEND1        NO                                         02490
         LA    R15,16         SET RETURN CODE                            02491
*        TERME RMK=NO                                                    02492
THEEND1  DS    0H                                                        02493
         L     R13,4(,R13)                                               02494
         RETURN (14,12),RC=0                                             02495
         EJECT                                                           02496
* - - - - - - - -   SUBROUTINES   - - - - - - - - - - - - - - SBG 04/00  02497
*    BAL REGISTER IS R7.                                      SBG 04/00  02498
* --------------------------------------------------------- * SBG 04/00  02499
LABELCHK DS    0H         CHECK FOR PRESENCE OF TAPE LABELS   SBG 04/00  02500
*                         AND SET LABEL FLAGS, ACCORDINGLY,   SBG 04/00  02501
*                         IN THE LBLFLAG BYTE.                SBG 04/00  02502
*              X'01'    HDR1 HAS BEEN SEEN                    SBG 03/00  02503
*              X'02'    HDR2 HAS BEEN SEEN                    SBG 03/00  02504
*              X'04'    VOL1 HAS BEEN SEEN                    SBG 03/00  02505
*              X'08'    HDR1 IS FROM AN INITTED TAPE          SBG 03/00  02506
*              X'10'    EOF1 HAS BEEN SEEN                    SBG 04/00  02507
*              X'20'    EOF2 HAS BEEN SEEN                    SBG 04/00  02508
*              X'40'    EOV1 HAS BEEN SEEN                    SBG 04/00  02509
*              X'80'    EOV2 HAS BEEN SEEN                    SBG 04/00  02510
* --------------------------------------------------------- * SBG 04/00  02511
* -  CHANGED LOGIC OF LABEL DUMPING CODE FOR UHL AND UTL. - *            02512
* -                                                       - *            02513
* -   NOW:  IF YOU SEE A HDR2, FLAG IT, BUT ONLY WRITE    - *            02514
* -         THE CONTROL CARD WHEN YOU ENCOUNTER THE TAPE  - *            02515
* -         MARK THAT FOLLOWS IT.  THIS LEAVES ROOM FOR   - *            02516
* -         THE USER HEADER LABELS.  SIMILAR LOGIC WITH   - *            02517
* -         EOF2 AND EOV2.  DON'T WRITE THE CONTROL CARDS - *            02518
* -         IMMEDIATELY, BUT WAIT UNTIL THE NEXT TAPEMARK.- *            02519
* --------------------------------------------------------- *            02520
         NI    ISLBLFLG,FF-X'01'  TURN OFF "IS LABEL" FLAG AT START      02521
         CLC   INAREA(4),=C'VOL1'   IS THIS A VOL1 ?          SBG 04/00  02522
         BE    CVOL1                PROCESS THE VOL1          SBG 04/00  02523
         CLC   INAREA(4),=C'HDR1'   IS THIS A HDR1 ?          SBG 04/00  02524
         BE    CHDR1                PROCESS HDR1              SBG 04/00  02525
         CLC   INAREA(4),=C'HDR2'   THIS A HDR2 ?             SBG 04/00  02526
         BE    CHDR2                PROCESS HDR2              SBG 04/00  02527
         CLC   INAREA(4),=C'EOF1'   THIS AN EOF1 ?            SBG 04/00  02528
         BE    CEOF1                PROCESS EOF1              SBG 04/00  02529
         CLC   INAREA(4),=C'EOF2'   THIS AN EOF2 ?            SBG 04/00  02530
         BE    CEOF2                PROCESS EOF2              SBG 04/00  02531
         CLC   INAREA(4),=C'EOV1'   THIS AN EOV1 ?            SBG 04/00  02532
         BE    CEOV1                PROCESS EOV1              SBG 04/00  02533
         CLC   INAREA(4),=C'EOV2'   THIS AN EOV2 ?            SBG 04/00  02534
         BE    CEOV2                PROCESS EOV2              SBG 04/00  02535
         CLC   INAREA(3),=C'UHL'    THIS A USER HEADER LABEL? SBG 04/00  02536
         BE    CUHL                 PROCESS UHL               SBG 04/00  02537
         CLC   INAREA(3),=C'UTL'    THIS A USER TRAILER LABEL?    04/00  02538
         BE    CUTL                 PROCESS UTL               SBG 04/00  02539
         B     NOTLABEL       80 BYTE RECORD IS NOT IBM SL    SBG 04/00  02540
CVOL1    DS    0H    -------- PROCESS VOL1 LABEL -----------  SBG 05/00  02541
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02542
         BO    CVOL1NPR              YES. JUST TURN ON ISLABEL FLAG      02543
* -->>>>>>            CLEAR IDRC INDICATOR IN VOL1  ----  BELOW
         TM    PARMFLG5,X'10'       ARE WE TURNING OFF IDRC INDICATOR?
         BZ    CLRIDRCV             NO. SKIP ROUTINE.
         MVI   INAREA+35,C' '       BLANK THE INDICATOR IN THE VOL1
CLRIDRCV DS    0H
* -->>>>>>            CLEAR IDRC INDICATOR IN VOL1  ----  ABOVE
         MVC   INVOLUME(6),INAREA+4   SAVE SL VOLSER IF THERE SBG 03/00  02544
         MVC   VOLORIG(6),INAREA+4   SAVE SL VOLSER IF THERE  SBG 03/00  02545
* ---------------- LABEL ADDING CODE ---------------------- * SBG 09/00  02546
         TM    PARMFLG2,X'80'       ARE WE ADDING LABELS?                02547
         BZ    CVOLNPRB             NO. WE CAN GO ON.                    02548
         MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     02549
         MVC   LINE(133),NOLABSL   DISPLAY NO SL ON SL MSG               02550
         PUT   SYSPRINT,LINE        WRITE MSG                            02551
         NI    OPENDFLG,FF-X'04'    MARK FILE AS CLOSED                  02552
         CLOSE (LABADDIN)                                                02553
         TM    OPENDFLG,X'02'       IS SYSIN OPEN?                       02554
         BZ    CVOL1OUT           NO. DON'T HAVE TO CLOSE IT             02555
         NI    OPENDFLG,FF-X'02'    MARK FILE AS CLOSED                  02556
         CLOSE (SYSIN)                                                   02557
CVOL1OUT B     CLOSMALL           CLOSE OTHER FILES AND SCRAM            02558
CVOLNPRB DS    0H                   NOT ADDING SL ONTO SL TAPE.          02559
* ---------------- LABEL ADDING CODE ---------------------- * SBG 09/00  02560
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02561
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  02562
         BZ    CVOL1ND              NO. SKIP PUTTING OUT      SBG 09/00  02563
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  02564
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  02565
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  02566
CVOL1ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  02567
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02568
         OI    LBLFLAG,X'04'  YES. FLAG VOL1 SEEN.            SBG 03/00  02569
         TM    PARMFLG2,X'02'  VOL1-FOUND OPTION OFF?         SBG 05/00  02570
         BZ    CVOL1NPR        YES.  DON'T REPORT VOL1 FOUND  SBG 05/00  02571
         MVI   LINE-1,C' '                                    SBG 03/00  02572
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 03/00  02573
         MVC   VOL1SER(6),LINE       CLEAR FIELD TO BLANKS    SBG 04/00  02574
         MVC   VOL1SER(6),INVOLUME   REPORT VOLUME SERIAL     SBG 03/00  02575
         MVC   VOL1OWNR(10),LINE     CLEAR FIELD TO BLANKS    SBG 04/00  02576
         MVC   VOL1OWNR(10),INAREA+41   OWNER INFORMATION     SBG 04/00  02577
         MVC   LINE(133),VOL1LBL  INDICATE THAT VOL1 FOUND    SBG 04/00  02578
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER       SBG 03/00  02579
CVOL1NPR OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  02580
         B     LABCHEND                                       SBG 04/00  02581
CHDR1    DS    0H                                             SBG 04/00  02582
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02583
         BO    CHDR1Z                YES. JUST TURN ON ISLABEL FLAG      02584
         NI    LBLFLAG,X'0F'  TURN OFF EOV, EOF FLAGS         SBG 07/00  02585
         OI    LBLFLAG,X'01'  YES. FLAG HDR1 SEEN.            SBG 03/00  02586
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02587
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  02588
         BZ    CHDR1ND              NO. SKIP PUTTING OUT      SBG 09/00  02589
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  02590
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  02591
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  02592
CHDR1ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  02593
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02594
         CLC   INAREA+4(23),ZERO23   WAS TAPE JUST INITTED?   SBG 03/00  02595
         BNE   CHDR1A         NO. THIS IS A HDR1 FOR DATASET  SBG 03/00  02596
* ---------------- LABEL DUMPING CODE --------------------- *            02597
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?               02598
         BZ    CHDR1NDM             NO. DON'T PUT ENDOFHDR FOR INIT      02599
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA                    02600
         MVC   LLINE(80),LABELITI   MOVE IN ENDOFHDRINIT                 02601
         PUT   LABLDUMP,LLINE       WRITE OUT ENDOFLABELHEADERINIT       02602
CHDR1NDM DS    0H                                                        02603
* ---------------- LABEL DUMPING CODE --------------------- *            02604
         OI    LBLFLAG,X'08'  YES. ZERO DSN AND VOLSER HERE   SBG 03/00  02605
         NOP   CHDR1Z         DON'T PRINT LABEL INFO          SBG 05/00  02606
CHDR1A   TM    PARMFLG1,X'02' DO WE PRINT LABELS?             SBG 05/00  02607
         BZ    CHDR1Z         NO. DON'T PRINT.                SBG 05/00  02608
         ST    R3,SAVE3REG                                               02609
         LA    R3,INAREA                                                 02610
         ST    R7,SAVE7BAL    STORE PREVIOUS BAL REGISTER                02611
         BAL   R7,PRTXXX1     PRINT LABEL INFO                SBG 05/00  02612
         L     R7,SAVE7BAL    RELOAD PREVIOUS BAL REGISTER               02613
         L     R3,SAVE3REG                                               02614
CHDR1Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  02615
         B     LABCHEND                                       SBG 04/00  02616
CHDR2    DS    0H                                             SBG 04/00  02617
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02618
         BO    CHDR2Z                YES. JUST TURN ON ISLABEL FLAG      02619
* -->>>>>>            CLEAR IDRC INDICATOR IN HDR2  ----  BELOW
         TM    PARMFLG5,X'10'       ARE WE TURNING OFF IDRC INDICATOR?
         BZ    CLRIDRH2             NO. SKIP ROUTINE.
         CLI   INAREA+34,C'P'       IS IDRC INDICATOR THERE?
         BNE   CLRIDRH2
         MVI   INAREA+34,C' '       BLANK THE INDICATOR IN THE VOL1
CLRIDRH2 DS    0H
* -->>>>>>            CLEAR IDRC INDICATOR IN HDR2  ----  ABOVE
         NI    LBLFLAG,X'0F'  TURN OFF EOV, EOF FLAGS IF HDR2 SBG 07/00  02620
         OI    LBLFLAG,X'02'  YES. FLAG HDR2 SEEN.            SBG 03/00  02621
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02622
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  02623
         BZ    CHDR2ND              NO. SKIP PUTTING OUT      SBG 09/00  02624
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  02625
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  02626
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  02627
         OI    EOLGFLAG,X'01'       INDICATE HDR2 SEEN ON TAPE           02628
CHDR2ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  02629
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02630
         TM    PARMFLG1,X'04'   DO WE PRINT LABELS?           SBG 05/00  02631
         BZ    CHDR2Z           NO.                           SBG 05/00  02632
         ST    R3,SAVE3REG                                               02633
         LA    R3,INAREA                                                 02634
         ST    R7,SAVE7BAL    STORE PREVIOUS BAL REGISTER                02635
         BAL   R7,PRTXXX2     PRINT LABEL INFO                           02636
         L     R7,SAVE7BAL    RELOAD PREVIOUS BAL REGISTER               02637
         L     R3,SAVE3REG                                               02638
CHDR2Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  02639
         B     LABCHEND                                       SBG 04/00  02640
CEOF1    DS    0H                                             SBG 04/00  02641
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02642
         BO    CEOF1Z                YES. JUST TURN ON ISLABEL FLAG      02643
         NI    LBLFLAG,X'F8'  TURN OFF HDR FLAGS IF EOF1      SBG 04/00  02644
         OI    LBLFLAG,X'10'  YES. FLAG EOF1 SEEN.            SBG 03/00  02645
* ------- OUTPUT TAPE BLOCK COUNT CORRECTION -------------- *            02646
BCTCEOF1 DS    0H                                                        02647
         TM    PARMFLG3,X'20'       IS BLK COUNT CORRECTION ON?          02648
         BZ    BCTCEOFX             NO. BYPASS ROUTINE.                  02649
         MVC   INAREA+54(6),BLKCNTSV+4   MOVE IN CORRECTED COUNT         02650
         STM   R2,R3,SAVE2TO3                                            02651
         LA    R3,INAREA+76            POINT TO HI ORDER LABEL FIELD     02652
         LA    R2,BLKCNTSV             LOAD ADDRESS OF HI ORDER COUNT    02653
         ST    R7,SAVE7RG2             SAVE BAL REGISTER                 02654
         BAL   R7,MOVEHICT             MOVE NUMBERS IF NOT ZEROES        02655
         L     R7,SAVE7RG2             RESTORE BAL REGISTER              02656
         LM    R2,R3,SAVE2TO3                                            02657
BCTCEOFX DS    0H                                                        02658
* ------- OUTPUT TAPE BLOCK COUNT CORRECTION -------------- *            02659
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02660
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  02661
         BZ    CEOF1ND              NO. SKIP PUTTING OUT      SBG 09/00  02662
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  02663
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  02664
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  02665
CEOF1ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  02666
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02667
         TM    PARMFLG1,X'08'   DO WE PRINT LABELS?           SBG 05/00  02668
         BZ    CEOF1Z           NO.                           SBG 05/00  02669
         ST    R3,SAVE3REG                                               02670
         LA    R3,INAREA                                                 02671
         ST    R7,SAVE7BAL    STORE PREVIOUS BAL REGISTER                02672
         BAL   R7,PRTXXX1     PRINT LABEL INFO                           02673
         L     R7,SAVE7BAL    RELOAD PREVIOUS BAL REGISTER               02674
         L     R3,SAVE3REG                                               02675
CEOF1Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  02676
         B     LABCHEND                                       SBG 04/00  02677
CEOF2    DS    0H                                             SBG 04/00  02678
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02679
         BO    CEOF2Z                YES. JUST TURN ON ISLABEL FLAG      02680
* -->>>>>>            CLEAR IDRC INDICATOR IN EOF2  ----  BELOW
         TM    PARMFLG5,X'10'       ARE WE TURNING OFF IDRC INDICATOR?
         BZ    CLRIDRF2             NO. SKIP ROUTINE.
         CLI   INAREA+34,C'P'       IS IDRC INDICATOR THERE?
         BNE   CLRIDRF2
         MVI   INAREA+34,C' '       BLANK THE INDICATOR IN THE VOL1
CLRIDRF2 DS    0H
* -->>>>>>            CLEAR IDRC INDICATOR IN EOF2  ----  ABOVE
         NI    LBLFLAG,X'F8'  TURN OFF HDR FLAGS IF EOF2      SBG 04/00  02681
         OI    LBLFLAG,X'20'  YES. FLAG EOF2 SEEN.            SBG 03/00  02682
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02683
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  02684
         BZ    CEOF2ND              NO. SKIP PUTTING OUT      SBG 09/00  02685
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  02686
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  02687
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  02688
         OI    EOLGFLAG,X'02'       INDICATE EOF2 SEEN ON TAPE           02689
CEOF2ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  02690
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02691
         TM    PARMFLG1,X'10'   DO WE PRINT LABELS?           SBG 05/00  02692
         BZ    CEOF2Z           NO.                           SBG 05/00  02693
         ST    R3,SAVE3REG                                               02694
         LA    R3,INAREA                                                 02695
         ST    R7,SAVE7BAL    STORE PREVIOUS BAL REGISTER                02696
         BAL   R7,PRTXXX2     PRINT LABEL INFO                           02697
         L     R7,SAVE7BAL    RELOAD PREVIOUS BAL REGISTER               02698
         L     R3,SAVE3REG                                               02699
CEOF2Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  02700
         B     LABCHEND                                       SBG 04/00  02701
CEOV1    DS    0H                                             SBG 04/00  02702
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02703
         BO    CEOV1Z                YES. JUST TURN ON ISLABEL FLAG      02704
         NI    LBLFLAG,X'F8'  TURN OFF HDR FLAGS IF EOV1      SBG 04/00  02705
         TM    PARMFLG2,X'04' CHANGE EOV TO EOF?              SBG 06/00  02706
         BZ    CEOVN1         NO, PROCESS ORDINARILY          SBG 06/00  02707
         OI    LBLFLAG,X'10'  INSTEAD, FLAG EOF1 SEEN         SBG 03/00  02708
         NI    LBLFLAG,FF-X'40'   UNFLAG EOV1                            02709
         MVC   INAREA(3),=C'EOF'  PLUG IN FOR LABEL COPY      SBG 06/00  02710
         MVI   LINE-1,C' '                                    SBG 03/00  02711
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 03/00  02712
         MVC   LINE(133),EOVCHG   MOVE IN MESSAGE             SBG 06/00  02713
         PUT   SYSPRINT,LINE  MESSAGE THAT WE ALTERED EOV.    SBG 06/00  02714
         B     CEOVY1                                         SBG 06/00  02715
CEOVN1   OI    LBLFLAG,X'40'  YES. FLAG EOV1 SEEN.            SBG 03/00  02716
CEOVY1   DS    0H                                             SBG 09/00  02717
* ------- OUTPUT TAPE BLOCK COUNT CORRECTION -------------- *            02718
BCTCEOV1 DS    0H                                                        02719
         TM    PARMFLG3,X'20'       IS BLK COUNT CORRECTION ON?          02720
         BZ    BCTCEOVX             NO. BYPASS ROUTINE.                  02721
         MVC   INAREA+54(6),BLKCNTSV+4   MOVE IN CORRECTED COUNT         02722
         STM   R2,R3,SAVE2TO3                                            02723
         LA    R3,INAREA+76            POINT TO HI ORDER LABEL FIELD     02724
         LA    R2,BLKCNTSV             LOAD ADDRESS OF HI ORDER COUNT    02725
         ST    R7,SAVE7RG2             SAVE BAL REGISTER                 02726
         BAL   R7,MOVEHICT             MOVE NUMBERS IF NOT ZEROES        02727
         L     R7,SAVE7RG2             RESTORE BAL REGISTER              02728
         LM    R2,R3,SAVE2TO3                                            02729
BCTCEOVX DS    0H                                                        02730
* ------- OUTPUT TAPE BLOCK COUNT CORRECTION -------------- *            02731
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02732
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  02733
         BZ    CEOV1ND              NO. SKIP PUTTING OUT      SBG 09/00  02734
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  02735
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  02736
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  02737
CEOV1ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  02738
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02739
         TM    PARMFLG1,X'40'   DO WE PRINT LABELS?           SBG 05/00  02740
         BZ    CEOV1Z           NO.                           SBG 05/00  02741
         ST    R3,SAVE3REG                                               02742
         LA    R3,INAREA                                                 02743
         ST    R7,SAVE7BAL    STORE PREVIOUS BAL REGISTER                02744
         BAL   R7,PRTXXX1     PRINT LABEL INFO                           02745
         L     R7,SAVE7BAL    RELOAD PREVIOUS BAL REGISTER               02746
         L     R3,SAVE3REG                                               02747
CEOV1Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  02748
         B     LABCHEND                                       SBG 04/00  02749
CEOV2    DS    0H                                             SBG 04/00  02750
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02751
         BO    CEOV2Z                YES. JUST TURN ON ISLABEL FLAG      02752
* -->>>>>>            CLEAR IDRC INDICATOR IN EOF2  ----  BELOW
         TM    PARMFLG5,X'10'       ARE WE TURNING OFF IDRC INDICATOR?
         BZ    CLRIDRV2             NO. SKIP ROUTINE.
         CLI   INAREA+34,C'P'       IS IDRC INDICATOR THERE?
         BNE   CLRIDRV2
         MVI   INAREA+34,C' '       BLANK THE INDICATOR IN THE VOL1
CLRIDRV2 DS    0H
* -->>>>>>            CLEAR IDRC INDICATOR IN EOF2  ----  ABOVE
         NI    LBLFLAG,X'F8'  TURN OFF HDR FLAGS IF EOV2      SBG 04/00  02753
         TM    PARMFLG2,X'04' CHANGE EOV TO EOF?              SBG 06/00  02754
         BZ    CEOVN2         NO, PROCESS ORDINARILY          SBG 06/00  02755
         OI    LBLFLAG,X'20'  INSTEAD, FLAG EOF2 SEEN         SBG 03/00  02756
         NI    LBLFLAG,FF-X'80'   UNFLAG EOV2                            02757
         MVC   INAREA(3),=C'EOF'  PLUG IN FOR LABEL COPY      SBG 06/00  02758
         B     CEOVY2                                         SBG 06/00  02759
CEOVN2   OI    LBLFLAG,X'80'  YES. FLAG EOV2 SEEN.            SBG 03/00  02760
CEOVY2   DS    0H                                             SBG 09/00  02761
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02762
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  02763
         BZ    CEOV2ND              NO. SKIP PUTTING OUT      SBG 09/00  02764
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  02765
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  02766
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  02767
         TM    PARMFLG2,X'04'       CHANGE EOV TO EOF?                   02768
         BO    CEOV2F               ACT AS THOUGH WE'VE SEEN EOF2        02769
         OI    EOLGFLAG,X'04'       INDICATE EOV2 SEEN ON TAPE           02770
         B     CEOV2ND              AND GET OUT                          02771
CEOV2F   DS    0H                                                        02772
         OI    EOLGFLAG,X'02'       INDICATE EOF2 SEEN ON TAPE           02773
CEOV2ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  02774
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  02775
         TM    PARMFLG1,X'80'   DO WE PRINT LABELS?           SBG 05/00  02776
         BZ    CEOV2Z           NO.                           SBG 05/00  02777
         ST    R3,SAVE3REG                                               02778
         LA    R3,INAREA                                                 02779
         ST    R7,SAVE7BAL    STORE PREVIOUS BAL REGISTER                02780
         BAL   R7,PRTXXX2     PRINT LABEL INFO                           02781
         L     R7,SAVE7BAL    RELOAD PREVIOUS BAL REGISTER               02782
         L     R3,SAVE3REG                                               02783
CEOV2Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  02784
         B     LABCHEND                                       SBG 04/00  02785
*- USER LABEL HANDLING CODE  ------  BELOW  --------------- *            02786
CUHL     DS    0H             HANDLE USER HEADER LABELS                  02787
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02788
         BO    CUHLEN                YES. JUST TURN ON ISLABEL FLAG      02789
         ST    R3,SAVE3REG                                               02790
         LA    R3,INAREA                                                 02791
         ST    R7,SAVE7BAL    STORE PREVIOUS BAL REGISTER                02792
         BAL   R7,PRTUSER     PRINT LABEL INFO                           02793
         L     R7,SAVE7BAL    RELOAD PREVIOUS BAL REGISTER               02794
         L     R3,SAVE3REG                                               02795
* ---------------- LABEL DUMPING CODE --------------------- *            02796
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?               02797
         BZ    CUHLEN               NO. SKIP PUTTING OUT                 02798
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA                    02799
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO                   02800
         PUT   LABLDUMP,LLINE       WRITE OUT INFO                       02801
CUHLEN   DS    0H                   END OF LABEL DUMPING CODE            02802
* ---------------- LABEL DUMPING CODE --------------------- *            02803
         OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL              02804
         B     LABCHEND                                                  02805
CUTL     DS    0H             HANDLE USER TRAILER LABELS                 02806
         TM    LBDQFLG,X'01'         JUST DOING PRELIM CHECK?            02807
         BO    CUTLEN                YES. JUST TURN ON ISLABEL FLAG      02808
         ST    R3,SAVE3REG                                               02809
         LA    R3,INAREA                                                 02810
         ST    R7,SAVE7BAL    STORE PREVIOUS BAL REGISTER                02811
         BAL   R7,PRTUSER     PRINT LABEL INFO                           02812
         L     R7,SAVE7BAL    RELOAD PREVIOUS BAL REGISTER               02813
         L     R3,SAVE3REG                                               02814
* ---------------- LABEL DUMPING CODE --------------------- *            02815
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?               02816
         BZ    CUTLEN               NO. SKIP PUTTING OUT                 02817
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA                    02818
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO                   02819
         PUT   LABLDUMP,LLINE       WRITE OUT INFO                       02820
CUTLEN   DS    0H                   END OF LABEL DUMPING CODE            02821
* ---------------- LABEL DUMPING CODE --------------------- *            02822
         OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL              02823
         B     LABCHEND                                                  02824
*- USER LABEL HANDLING CODE  ------  ABOVE  --------------- *            02825
NOTLABEL NI    ISLBLFLG,FF-X'01'  TURN OFF "IS LABEL" FLAG    SBG 04/00  02826
LABCHEND BR    R7                                             SBG 04/00  02827
* --------------------------------------------------------- * SBG 04/00  02828
*    BAL REGISTER IS R7.                                      SBG 04/00  02829
* --------------------------------------------------------- * SBG 04/00  02830
PARMCHK  DS    0H         CHECK PARMS AND FLAG THEIR          SBG 04/00  02831
*                         PRESENCE OR ABSENCE.                SBG 04/00  02832
*            (PERMISSIBLE PARMS ARE CODED IN PARMTABL.)       SBG 04/00  02833
PARMINIT L     R1,0(,R1)      GET PARM FROM JCL               SBG 03/00  02834
         LH    R5,0(,R1)      SAVE PARM LENGTH                SBG 04/00  02835
         ST    R5,PARMSLEN    STORE FULLWORD VALUE            SBG 04/00  02836
         LA    R2,PARMTABL    LOAD START OF PARM TABLE        SBG 04/00  02837
         LA    R4,2(,R1)      POINT TO START OF JCL PARMS     SBG 04/00  02838
         ST    R4,PARMSTRT    PUT ADDRESS INTO PGM STORAGE    SBG 05/00  02839
         LA    R1,0           USE R1 TO MEASURE LENGTH READ   SBG 04/00  02840
* ----------------------------------------------------------- SBG 05/00  02841
*   ONE PASS THRU PARM TABLE TO SET DEFAULT ENTRIES BEFORE    SBG 05/00  02842
*   LOOKING AT JCL OVERRIDES TO THE PARMS.                    SBG 05/00  02843
* ----------------------------------------------------------- SBG 05/00  02844
PARMDFLT DS    0H             SET DEFAULTS FROM PARM TABLE    SBG 05/00  02845
         CLI   0(R2),X'FF'    END OF PARM TABLE?              SBG 04/00  02846
         BE    PARMDEND       YES. DEFAULTS SET. CHECK PARMS. SBG 04/00  02847
         TM    1(R2),X'10'    IS THIS ENTRY A DEFAULT?        SBG 05/00  02848
         BO    PARMDSET       YES, GO SET IT.                 SBG 05/00  02849
         LA    R2,PTELEN(,R2)  NO. BOP TO TEST NEXT ENTRY,    SBG 04/00  02850
         B     PARMDFLT       AND LOOP UNTIL TABLE ENDS.      SBG 05/00  02851
PARMDSET TM    1(R2),X'01'    DO WE TURN THIS FLAG OFF?       SBG 05/00  02852
         BO    PARMDOFF       YES. FLAGS ARE TURNED OFF..     SBG 05/00  02853
         OC    PARMFLGS(PBYTES),PTEFLG(R2) NO. FLAG IS TURNED ON.        02854
         LA    R2,PTELEN(,R2)  NO. BOP TO TEST NEXT ENTRY,    SBG 04/00  02855
         B     PARMDFLT       CHECK MORE TABLE ENTRIES.       SBG 05/00  02856
PARMDOFF MVC   PARMFWRK(PBYTES),PTEFLG(R2)  PARM BYTES TO WRK            02857
         XC    PARMFWRK(PBYTES),EFFS        FLIP PARM BYTES              02858
         NC    PARMFLGS(PBYTES),PARMFWRK    TURN PARM BYTE(S) OFF        02859
         LA    R2,PTELEN(,R2)  NO. BOP TO TEST NEXT ENTRY,    SBG 04/00  02860
         B     PARMDFLT   LOOP BACK TILL ONE PASS THRU TABLE  SBG 05/00  02861
PARMDEND LA    R1,0           INITIALIZE COUNTING REGISTER    SBG 05/00  02862
         LA    R2,PARMTABL    LOAD START OF PARM TABLE        SBG 04/00  02863
         L     R4,PARMSTRT    GET ADDRESS FROM PGM STORAGE    SBG 05/00  02864
* ----------------------------------------------------------- SBG 05/00  02865
*   NOW CHECK EACH CHARACTER IN JCL, TO SEE IF IT'S A PARM.   SBG 05/00  02866
* ----------------------------------------------------------- SBG 05/00  02867
PARMLOOP C     R1,PARMSLEN    PAST THE END OF PARMS?          SBG 04/00  02868
         BNL   PARMFIN        YES - GET OUT                   SBG 04/00  02869
         LA    R2,PARMTABL   POINT BACK TO BEGINNING OF TABLE SBG 05/00  02870
         AP    PARMLCNT,=P'1'  COUNT PARM LOOPS FOR DEBUGGING SBG 05/00  02871
BOPPTBL  CLI   0(R2),X'FF'    END OF PARM TABLE?              SBG 04/00  02872
         BE    PRMNFND        YES. BUMP AND TRY AGAIN.        SBG 04/00  02873
         SR    R5,R5          CLEAR WORK REGISTER FOR REUSE   SBG 05/00  02874
         IC    R5,0(,R2)      LOAD LENGTH TO BE COMPARED      SBG 04/00  02875
         BCTR  R5,0           ONE LESS FOR EXECUTE            SBG 04/00  02876
         EX    R5,CMPPARM     COMPARE TABLE ENTRY TO PARM LOC SBG 04/00  02877
         BE    PRMFOUND       PARM FOUND AT THIS LOCATION     SBG 04/00  02878
         LA    R2,PTELEN(,R2)  NEXT TABLE ENTRY               SBG 04/00  02879
         B     BOPPTBL        INNER LOOP                      SBG 04/00  02880
PRMNFND  LA    R4,1(,R4)      FORWARD IN JCL PARMS            SBG 04/00  02881
         LA    R1,1(,R1)      MEASURE DISTANCE TRAVELED       SBG 04/00  02882
         B     PARMLOOP       TRY AGAIN                       SBG 04/00  02883
PRMFOUND MVC   PARMTENT(PTELEN),0(R2)  DUMP TABLE ENTRY FOUND SBG 05/00  02884
         TM    1(R2),X'01'         PARM ON OR OFF?            SBG 05/00  02885
         BO    PARMOFF             OFF                        SBG 05/00  02886
         OC    PARMFLGS(PBYTES),PTEFLG(R2)   ON. FLAG THE PARM FOUND     02887
         B     PARMGO                        AND GO ON                   02888
PARMOFF  MVC   PARMFWRK(PBYTES),PTEFLG(R2)   PARM BYTES TO WRK           02889
         XC    PARMFWRK(PBYTES),EFFS         FLIP PARM BITS              02890
         NC    PARMFLGS(PBYTES),PARMFWRK     TURN PARM BIT(S) OFF        02891
PARMGO   AP    PARMHITS,=P'1'    COUNT PARM HITS              SBG 05/00  02892
         IC    R5,0(,R2)      LENGTH OF PARM, FROM THE TABLE  SBG 04/00  02893
         LA    R1,0(R5,R1)    INCREMENT COUNT BY LENGTH       SBG 04/00  02894
         LA    R4,0(R5,R4)    SAME FOR SEARCH POSITION        SBG 04/00  02895
         B     PARMLOOP       LOOK FOR MORE PARMS             SBG 04/00  02896
PARMFIN  ST    R1,PRMCHRCT    HOW MANY CHARS WE SEARCHED --   SBG 04/00  02897
*                             COUNT FOR DEBUGGING             SBG 05/00  02898
PRMCHEND BR    R7                                             SBG 04/00  02899
CMPPARM  CLC   0(0,R4),2(R2)    ** EXECUTED **                SBG 04/00  02900
* --------------------------------------------------------- * SBG 05/00  02901
*    BAL REGISTER IS R7.                                      SBG 05/00  02902
* --------------------------------------------------------- * SBG 05/00  02903
CARDREAD DS    0H              CHECK SYSIN FOR KEYWORDS AND PARMS        02904
         GET   SYSIN,CARDIN                                              02905
         CLC   =C'OUTVOLALL=',CARDIN    KEYWORD PRESENT IN THIS CARD?    02906
         BE    CDOVOLAL          PROCESS THIS CARD FOR KEYWORD           02907
         CLC   =C'TAPEOWNER=',CARDIN    KEYWORD PRESENT IN THIS CARD?    02908
         BE    TPOWNRAL          PROCESS THIS CARD FOR KEYWORD           02909
         CLC   =C'FILELIMIT=',CARDIN    KEYWORD PRESENT IN THIS CARD?    02910
         BE    FILELGET          PROCESS THIS CARD FOR KEYWORD           02911
         CLC   =C'LABELIMIT=',CARDIN    KEYWORD PRESENT IN THIS CARD?    02912
         BE    LABELGET          PROCESS THIS CARD FOR KEYWORD           02913
         CLC   =C'PRINTRCDS=',CARDIN    KEYWORD PRESENT IN THIS CARD?    02912
         BE    PRINTGET          PROCESS THIS CARD FOR KEYWORD           02913
* ----                                                                   02914
CHKPARMS DS    0H                CHECK THIS CARD AGAINST PARMTABL        02915
         ST    R7,SAVE7BA1     SAVE BAL REGISTER                         02916
         LA    R4,CARDIN       POINT PARM SEARCH TO BEGINNING OF CARD    02917
         LA    R5,72           LOAD COLUMN LENGTH FOR SEARCH             02918
         ST    R5,PARMSLEN     LOAD LENGTH INTO FIELD FOR ROUTINE        02919
         LA    R2,PARMTABL     POINT R2 TO PARM TABLE                    02920
         L     R1,TOTCHRCT                                               02921
         A     R1,PRMCHRCT                                               02922
         ST    R1,TOTCHRCT                                               02923
         LA    R1,0            START SEARCH COUNT AT ZERO AGAIN          02924
         AP    TOTMHITS,PARMHITS                                         02925
         ZAP   PARMHITS,=P'0'                                            02926
         AP    TOTMLCNT,PARMLCNT                                         02927
         ZAP   PARMLCNT,=P'0'                                            02928
         BAL   R7,PARMLOOP     CHECK THIS CARD FOR PARMS                 02929
         L     R7,SAVE7BA1     RESTORE BAL REGISTER                      02930
         B     CARDREAD        GET ANOTHER CARD                          02931
* ----                                                                   02932
CDOVOLAL CLI   CARDIN+10,C' '    IS FIRST VOLSER CHARACTER BLANK?        02933
         BE    CARDREAD                 YES. IGNORE CARD                 02934
         MVC   VOLSTG(6),CARDIN+10                                       02935
         OI    PARMFLG2,X'40'    SET OUTVOL FLAG ON                      02936
         OI    OVERFLAG,X'01'    HOLD ORDER TO PROPAGATE OUTPUT VOLSER   02937
         B     CARDREAD          GET ANOTHER CARD                        02938
TPOWNRAL CLI   CARDIN+10,C' '    IS FIRST OWNER  CHARACTER BLANK?        02939
         BE    CARDREAD                 YES. IGNORE CARD                 02940
         MVC   TAPEOWNR(10),CARDIN+10                                    02941
         OI    PARMFLG2,X'40'    SET OUTVOL FLAG ON                      02942
         B     CARDREAD                                                  02943
FILELGET DS    0H                                                        02944
         CLI   CARDIN+10,C' '    IS FIRST NUMBER VALUE BLANK?            02945
         BE    CARDREAD          YES. IGNORE ENTIRE CARD                 02946
         CLI   CARDIN+10,X'F0'   SMALLER THAN ZERO?                      02947
         BL    CARDREAD          YES. IGNORE.                            02948
         CLI   CARDIN+10,X'F9'   BIGGER THAN 9?                          02949
         BH    CARDREAD          YES. IGNORE.                            02950
         OI    PARMFLG3,X'02'    SET FILE LIMIT OPTION ON                02951
         LA    R15,CARDIN+10     STARTING ADDRESS                        02952
         LR    R1,R15            LOAD R1 WITH THIS ADDRESS               02953
FILELNUM DS    0H                                                        02954
         LA    R15,1(,R15)       BUMP TO NEXT CHARACTER                  02955
         C     R15,=A(CARDIN+71) END OF CARD?                            02956
         BH    FILELGNM          YES, GET NUMBER                         02957
         CLI   0(R15),C' '       BLANK HERE?                             02958
         BE    FILELGNM          YES, GET NUMBER                         02959
         B     FILELNUM          NO. STEP UP ONE PLACE                   02960
FILELGNM DS    0H                                                        02961
         SR    R15,R1            HOW BIG IS THE NUMBER                   02962
         BCTR  R15,0             LOWER IT FOR EXECUTE                    02963
         EX    R15,PACK          COPY THE NUMBER TO WORK AREA            02964
         EX    R15,MVLIMNUM      COPY THE NUMBER TO MESSAGE AREA         02965
         CVB   R0,WORKA          CONVERT IT TO BINARY                    02966
         ST    R0,LINFILE        STORE THE VALUE FOR LATER USE           02967
         MP    WORKA,PL4NO3      MULTIPLY BY 3 IF SL FILES               02968
         CVB   R0,WORKA          CONVERT IT TO BINARY                    02969
         ST    R0,LSLFILE        STORE THE VALUE FOR LATER USE           02970
         MVC   LTGFILE(4),LINFILE   STUFF NL VALUE IN FOR STARTERS       02971
FILELCLG DS    0H                                                        02972
         B     CARDREAD                                                  02973
LABELGET DS    0H                                                        02974
         CLI   CARDIN+10,C' '    IS FIRST NUMBER VALUE BLANK?            02975
         BE    CARDREAD          YES. IGNORE ENTIRE CARD                 02976
         CLI   CARDIN+10,X'F0'   SMALLER THAN ZERO?                      02977
         BL    CARDREAD          YES. IGNORE.                            02978
         CLI   CARDIN+10,X'F9'   BIGGER THAN 9?                          02979
         BH    CARDREAD          YES. IGNORE.                            02980
         OI    PARMFLG4,X'10'    SET LABEL LIMIT OPTION ON               02981
         LA    R15,CARDIN+10     STARTING ADDRESS                        02982
         LR    R1,R15            LOAD R1 WITH THIS ADDRESS               02983
LABELNUM DS    0H                                                        02984
         LA    R15,1(,R15)       BUMP TO NEXT CHARACTER                  02985
         C     R15,=A(CARDIN+71) END OF CARD?                            02986
         BH    LABELGNM          YES, GET NUMBER                         02987
         CLI   0(R15),C' '       BLANK HERE?                             02988
         BE    LABELGNM          YES, GET NUMBER                         02989
         B     LABELNUM          NO. STEP UP ONE PLACE                   02990
LABELGNM DS    0H                                                        02991
         SR    R15,R1            HOW BIG IS THE NUMBER                   02992
         BCTR  R15,0             LOWER IT FOR EXECUTE                    02993
         EX    R15,PACKL         COPY THE NUMBER TO WORK AREA            02994
         EX    R15,MVLBLNUM      COPY THE NUMBER TO MESSAGE AREA         02995
         CVB   R0,WORKL          CONVERT IT TO BINARY                    02996
         ST    R0,LINLABEL       STORE THE VALUE FOR LATER USE           02997
LABELCLG DS    0H                                                        02998
         B     CARDREAD                                                  02999
PRINTGET DS    0H                                                        02974
         CLI   CARDIN+10,C' '    IS FIRST NUMBER VALUE BLANK?            02975
         BE    CARDREAD          YES. IGNORE ENTIRE CARD                 02976
         CLI   CARDIN+10,X'F0'   SMALLER THAN ZERO?                      02977
         BL    CARDREAD          YES. IGNORE.                            02978
         CLI   CARDIN+10,X'F9'   BIGGER THAN 9?                          02979
         BH    CARDREAD          YES. IGNORE.                            02980
         OI    PRTHEXOV,X'01'    MARK THAT A VALID CARD WAS READ
         OI    PARMFLG5,X'20'    SET HEXPRT OPTION ON                    02981
         LA    R15,CARDIN+10     STARTING ADDRESS                        02982
         LR    R1,R15            LOAD R1 WITH THIS ADDRESS               02983
PRINTNUM DS    0H                                                        02984
         LA    R15,1(,R15)       BUMP TO NEXT CHARACTER                  02985
         C     R15,=A(CARDIN+71) END OF CARD?                            02986
         BH    PRINTGNM          YES, GET NUMBER                         02987
         CLI   0(R15),C' '       BLANK HERE?                             02988
         BE    PRINTGNM          YES, GET NUMBER                         02989
         B     PRINTNUM          NO. STEP UP ONE PLACE                   02990
PRINTGNM DS    0H                                                        02991
         SR    R15,R1            HOW BIG IS THE NUMBER                   02992
         BCTR  R15,0             LOWER IT FOR EXECUTE                    02993
         EX    R15,PACKP         COPY THE NUMBER TO WORK AREA            02994
         EX    R15,MVPRTNUM      COPY THE NUMBER TO MESSAGE AREA         02995
         CVB   R0,WORKP          CONVERT IT TO BINARY                    02996
         ST    R0,PRTLIMIT       STORE THE VALUE FOR LATER USE           02997
         ST    R0,BCTLIMIT       INITIALIZE DECREMENT COUNTER            02997
PRINTCLG DS    0H                                                        02998
         B     CARDREAD                                                  02999
SYSINEND DS    0H                                                        03000
         TM    OPENDFLG,X'02'   IS SYSIN    DD OPEN?                     03001
         BZ    CARDREND         NO.  GET OUT.                            03002
         NI    OPENDFLG,FF-X'02'   MARK SYSIN FILE AS CLOSED             03003
         CLOSE (SYSIN)                                                   03004
CARDREND BR    R7                                                        03005
PACK     PACK  WORKA,0(0,1)          <<< EXECUTED >>>                    03006
PACKL    PACK  WORKL,0(0,1)          <<< EXECUTED >>>                    03007
PACKP    PACK  WORKP,0(0,1)          <<< EXECUTED >>>                    03007
MVLIMNUM MVC   LIMFMSG+11(0),0(R1)   <<< EXECUTED >>>                    03008
MVLBLNUM MVC   LIMLMSG+11(0),0(R1)   <<< EXECUTED >>>                    03009
MVPRTNUM MVC   LIMPMSG+11(0),0(R1)   <<< EXECUTED >>>                    03009
* --------------------------------------------------------- * SBG 05/00  03010
*    BAL REGISTER IS R7.                                      SBG 05/00  03011
* --------------------------------------------------------- * SBG 05/00  03012
VOL1PRT  DS    0H         PRINT MESSAGE THAT VOL1 LABEL WAS   SBG 04/00  03013
*                         ALTERED.                                       03014
         MVI   LINE-1,C' '                                               03015
         MVC   LINE,LINE-1           CLEAR OUTPUT LINE                   03016
         MVC   VOLALT+13(6),LINE     CLEAR OLDVOL FIELD IN MSG           03017
         MVC   VOLALT+35(6),LINE     CLEAR NEWVOL FIELD IN MSG           03018
         MVC   VOLALT+13(6),VOLORIG  MOVE OLD VOL TO MSG                 03019
         MVC   VOLALT+35(6),VOLNEW   MOVE NEW VOL TO MSG                 03020
* ----                                                                   03021
         TM    OVERFLAG,X'01'     ARE WE OVERLAYING ALL OUTPUT VOLSERS?  03022
         BZ    INDVVOLS           NO. REPORT INDIVIDUAL VOLS             03023
         MVC   VOLALT+35(6),VOLSTG   MOVE NEW VOLSER VALUE TO MSG        03024
INDVVOLS DS    0H                                                        03025
* ----                                                                   03026
         MVC   VOLDDN(5),LINE        CLEAR FIELD                         03027
         MVC   VOLDDN(5),VOLDD       MOVE DD NAME IN                     03028
         MVC   LINE(133),VOLALT      MOVE MESSAGE TO PRT                 03029
         PUT   SYSPRINT,LINE         WRITE MESSAGE                       03030
         BR    R7                    RETURN TO CALLER                    03031
* --------------------------------------------------------- * SBG 04/00  03032
*    BAL REGISTER IS R7.                                      SBG 04/00  03033
* --------------------------------------------------------- * SBG 04/00  03034
PRTXXX1  DS    0H                                             SBG 05/00  03035
*   R3 POINTS TO THE LABEL IMAGE TO BE PRINTED.                          03036
         MVI   LINE-1,C' '                                    SBG 05/00  03037
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 05/00  03038
         MVC   XXX1LBL+1(4),0(R3)   MOVE LABEL TYPE TO MESSAG SBG 05/00  03039
         MVC   XXX1VOL(6),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03040
         MVC   XXX1VOL(6),21(R3)     REPORT VOLUME SERIAL     SBG 05/00  03041
         MVC   XXX1DSN(17),LINE      CLEAR FIELD TO BLANKS    SBG 05/00  03042
         MVC   XXX1DSN(17),4(R3)     DATASET NAME             SBG 05/00  03043
         MVC   XXX1DSQ(4),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03044
         MVC   XXX1DSQ(4),31(R3)     DATASET SEQUENCE NUMBER  SBG 05/00  03045
         MVC   XXX1VSQ(4),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03046
         MVC   XXX1VSQ(4),27(R3)     VOLUME SEQUENCE NUMBER   SBG 05/00  03047
         MVC   XXX1BLC(6),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03048
         MVC   XXX1BLC(6),54(R3)     BLOCK COUNT - 6 DIGITS   SBG 05/00  03049
         MVC   XXX1BLCH(4),LINE      CLEAR FIELD TO BLANKS               03050
         MVC   XXX1BLCH(4),76(R3)    BLOCK COUNT HI ORDER DIGITS         03051
         MVC   XXX1CRD(6),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03052
         MVC   XXX1CRD(6),41(R3)     CREATE DATE - 6 DIGITS   SBG 05/00  03053
         MVC   XXX1EXD(6),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03054
         MVC   XXX1EXD(6),47(R3)     EXPIRE DATE - 6 DIGITS   SBG 05/00  03055
         MVC   LINE(133),XXX1LBL  MOVE INFO TO PRINT LINE     SBG 05/00  03056
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER       SBG 05/00  03057
PRTXXX1R BR    R7                                             SBG 05/00  03058
* --------------------------------------------------------- * SBG 04/00  03059
*    BAL REGISTER IS R7.                                      SBG 04/00  03060
* --------------------------------------------------------- * SBG 04/00  03061
PRTXXX2  DS    0H                                             SBG 05/00  03062
*   R3 POINTS TO THE LABEL IMAGE TO BE PRINTED.                          03063
         MVI   LINE-1,C' '                                    SBG 05/00  03064
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 05/00  03065
         MVC   XXX2LBL+1(4),0(R3)   MOVE LABEL TYPE TO MESSAG SBG 05/00  03066
         MVC   XXX2RFM(1),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03067
         MVC   XXX2RFM(1),4(R3)      RECFM                    SBG 05/00  03068
         MVC   XXX2BKL(5),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03069
         MVC   XXX2BKL(5),5(R3)      BLOCK LENGTH             SBG 05/00  03070
         MVC   XXX2RCL(5),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03071
         MVC   XXX2RCL(5),10(R3)     RECORD LENGTH            SBG 05/00  03072
         MVC   XXX2TDN(1),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03073
         MVC   XXX2TDN(1),15(R3)     TAPE DENSITY             SBG 05/00  03074
         MVC   XXX2JST(17),LINE      CLEAR FIELD TO BLANKS    SBG 05/00  03075
         MVC   XXX2JST(17),17(R3)     JOB/STEP NAME           SBG 05/00  03076
         MVC   XXX2IDR(3),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  03077
         CLI   34(R3),C'P'           INDICATE IDRC?           SBG 05/00  03078
         BNE   PRX2NOI               NO. SAY NO               SBG 05/00  03079
         MVC   XXX2IDR(3),=C'YES'     IDRC COMPRESSION        SBG 05/00  03080
         B     PRX2MOV                                        SBG 04/00  03081
PRX2NOI  MVC   XXX2IDR(3),=C'NO '                             SBG 04/00  03082
PRX2MOV  MVC   LINE(133),XXX2LBL  MOVE INFO TO PRINT LINE     SBG 05/00  03083
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER       SBG 05/00  03084
PRTXXX2R BR    R7                                             SBG 05/00  03085
* --------------------------------------------------------- * SBG 04/00  03086
*    BAL REGISTER IS R7.                                      SBG 04/00  03087
* --------------------------------------------------------- * SBG 04/00  03088
PRTUSER  DS    0H                                             SBG 05/00  03089
*   R3 POINTS TO THE LABEL IMAGE TO BE PRINTED.                          03090
         MVI   LINE-1,C' '                                    SBG 05/00  03091
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 05/00  03092
         MVI   USERLBL-1,C' '                                            03093
         MVC   USERLBL(133),USERLBL-1                                    03094
         MVC   USERLBL+1(80),0(R3)  MOVE LABEL IMAGE TO MESSAGE          03095
         MVC   LINE(133),USERLBL  MOVE INFO TO PRINT LINE                03096
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER                  03097
PRTUSERR BR    R7                                                        03098
* --------------------------------------------------------- *            03099
*    BAL REGISTER IS R7.                                                 03100
* --------------------------------------------------------- *            03101
PRTBLCNT DS    0H                                                        03102
         MVI   LINE-1,C' '                                               03103
         MVC   LINE,LINE-1    CLEAR PRINT LINE                           03104
         MVC   LINE(133),BLKCNTMS    MESSAGE TO PRINT LINE               03105
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER                  03106
PRTBLCNE BR    R7                                                        03107
* --------------------------------------------------------- *            03108
*    BAL REGISTER IS R7.                                                 03109
* --------------------------------------------------------- *            03110
BACKEXTH DS    0H             BACKSPACE OVER EXTRA HEADER LABELS         03111
         ST    R7,SAVE7REG                                               03112
         TM    WRLBLFLG,X'08'     EOF ON LABADDIN FILE?                  03113
         BO    BACKEXT1           DON'T BACKSPACE OVER LAST LABEL SET    03114
         MVC   OUTCCWPT(4),=A(BACKCCW)                                   03115
BACKEXT1 L     R7,SAVE7REG                                               03116
BACKEXTE BR    R7                                                        03117
* --------------------------------------------------------- *            03118
*    BAL REGISTER IS R7.                                                 03119
* --------------------------------------------------------- *            03120
CLEARSAV DS    0H             CLEAR HDR1, HDR2, AND UHL SAVE AREAS       03121
         ST    R7,SAVE7REG                                               03122
         TM    PARMFLG3,X'80'           IS LBLFIX OPTION ACTIVE?         03123
         BZ    CLEARSV1                 NO. BYPASS CLEAR                 03124
         MVI   HDR1SAV-1,C' '           PRIME WITH BLANK                 03125
         MVC   HDR1SAV(240),HDR1SAV-1     CLEAR                          03126
         MVC   UHL2SAV(240),UHL2SAV-1       HEADER                       03127
         MVC   UHL5SAV(240),UHL5SAV-1         SAVE                       03128
         MVC   UHL8SAV(80),UHL8SAV-1            AREAS                    03129
CLEARSV1 L     R7,SAVE7REG                                               03130
CLEARSVE BR    R7                                                        03131
* --------------------------------------------------------- *            03132
*    BAL REGISTER IS R7.                                                 03133
* --------------------------------------------------------- *            03134
FIXEXTLB DS    0H             FIX AFTER BROKEN EXTERNAL LABEL FILE       03135
         ST    R7,SAVE7REG                                               03136
         TM    PARMFLG3,X'80'           IS LBLFIX OPTION ACTIVE?         03137
         BZ    FIXEXTL1         NO. BYPASS LABEL FIX OPERATION           03138
* ------   DETERMINE HOW BROKEN THE LABEL FILE IS   ------ BELOW --- *   03139
         TM    LBLLFLAG,X'03'   DO WE HAVE AT LEAST HDR1 & HDR2          03140
         BNO   FIXEXTL1         NOT THAT MUCH. DON'T ATTEMPT TO FIX      03141
         TM    LBLLFLAG,X'70'   MISSING EOLHDR, EOF1 AND EOF2?           03142
         BZ    FIXALL3                                                   03143
         TM    LBLLFLAG,X'30'   MISSING EOF1 AND EOF2 ONLY?              03144
         BZ    FIXLAST2                                                  03145
         TM    LBLLFLAG,X'20'   MISSING ONLY EOF2?                       03146
         BZ    FIXLAST1                                                  03147
         B     FIXEXTL1         MISSING EOLTRLR DOESN'T GIVE ERROR       03148
* ------   DETERMINE HOW BROKEN THE LABEL FILE IS   ------ ABOVE --- *   03149
FIXALL3  DS    0H            REPLACE EOLHDR, EOF1, AND EOF2              03150
         L     R7,SAVE7REG                                               03151
         B     ENDHEADR      GO TO ENDHEADR PROCESSING AND THROW FLAG    03152
FIXLAST2 DS    0H               REPLACE EOF1 AND EOF2                    03153
         OI    LBLLFLAG,X'10'   MARK EOF1 SEEN                           03154
         L     R7,SAVE7REG                                               03155
         B     CORFEOF1         CREATE EOF1,FIX BLOCK COUNTS,AND WRITE   03156
FIXLAST1 DS    0H               REPLACE EOF2                             03157
         OI    LBLLFLAG,X'20'   MARK EOF2 SEEN                           03158
         L     R7,SAVE7REG                                               03159
         B     ADDEOF2          CREATE THE EOF2                          03160
FIXEXTL1 DS    0H                                                        03161
         OI    WRLBLFLG,X'10'   STOP WRITING LABELS                      03162
         L     R7,SAVE7REG                                               03163
FIXEXTLE BR    R7                                                        03164
* --------------------------------------------------------- *            03165
*    BAL REGISTER IS R7.                                                 03166
* --------------------------------------------------------- *            03167
CLEARIOB DS    0H             CLEAR THE PORTIONS OF THE OUTIOB THAT      03168
*                             IOS USES DURING EXCP PROCESSING.           03169
*                        WE DO NOT WANT TO BLINDLY REUSE THESE IOB'S.    03170
* ------------------------------------------------------------------- *  03171
         MVC   OUTIOB(4),IOB01                                           03172
         MVC   OUTCSW(8),FUL2ZERO                                        03173
         MVC   OUTDCBPT(4),FUL2ZERO                                      03174
         MVC   OUTDCBPT+4(4),FUL2ZERO                                    03175
         MVC   OUTDCBPT+8(4),IOB02                                       03176
CLEARIOE BR    R7                                                        03177
* --------------------------------------------------------- *            03178
*    BAL REGISTER IS R7.                                                 03179
* --------------------------------------------------------- *            03180
CHANGVOL DS    0H             PROCESS CHANGE VOLUME INFO FOR VOL1 LABEL  03181
* ----------------------------------  PROCESS CHGVOL KEYWORD  SBG 05/00  03182
         TM    WRLBLFLG,X'01'  ARE WE PROCESSING EXTERNAL LABELS NOW?    03183
         BO    CHEXTLAB        YES. JUST DO THAT STUFF.                  03184
         TM    LBLFLAG,X'04'  ARE WE WRITING A VOL1 LABEL?    SBG 05/00  03185
         BZ    CHANGVOE       NO, GET OUT OF THIS ROUTINE                03186
         TM    LBLFLAG,X'03'  IS THIS A HDR1 OR A HDR2?                  03187
         BNZ   CHANGVOE       NO. DON'T ATTEMPT TO CHANGE THIS.          03188
         TM    PARMFLG2,X'41' ARE WE CHANGING OUTPUT VOLSERS? SBG 05/00  03189
         BZ    CHANGVOE       NO, GET OUT OF THIS ROUTINE                03190
         MVC   INAREA+4(6),VOLCHG   PUT JCL VOLSER                       03191
         TM    PARMFLG2,X'40'  IS OUTVOL PARM IN EFFECT                  03192
         BZ    CHNOTOWN        NO. DON'T CHANGE OWNER INFORMATION        03193
         CLI   TAPEOWNR,C' '  IS THERE A TAPEOWNER VALUE                 03194
         BE    CHNOTOWN       NO--DON'T CHANGE OWNER INFORMATION THERE   03195
         MVC   INAREA+41(10),TAPEOWNR    MOVE TAPE OWNER INFO IF ANY     03196
         MVC   LINE(133),LINE-1                                          03197
         MVC   OWNRTID(10),LINE          CLEAR FIELD                     03198
         MVC   OWNRTID(10),TAPEOWNR      MOVE OWNER INFO INTO MSG        03199
         MVC   OWNRDDO(5),LINE           CLEAR FIELD                     03200
         MVC   OWNRDDO(5),DDOCHG         MOVE OUTPUT DDNAME INTO MSG     03201
         MVC   LINE(133),OWNRMSG                                         03202
         PUT   SYSPRINT,LINE                                             03203
CHNOTOWN DS    0H                                                        03204
         B     CHNOZAPV       TAPE INPUT - DON'T DO EXTERNAL LABELS      03205
*** ---  BELOW  --------  CHANGING VOLSER IN EXTERNAL LABELS             03206
CHEXTLAB DS    0H                                                        03207
         TM    WRLBLFLG,X'01'      IS INPUT FROM EXTERNAL LABELS?        03208
         BZ    CHNOZAPV            NO. DON'T AFFECT EXTLBLIN             03209
         TM    INIT1FLG,X'02'      SECOND PASS THRU TAPE INIT?           03210
         BO    CHNOZAPV            YES, SKIP SECOND WRITE                03211
         TM    LBLLFLAG,X'04'      VOL1 SEEN RECENTLY?                   03212
         BZ    CHNOZAPV            NO. DON'T CHANGE CARD                 03213
         TM    LBLLFLAG,X'03'      IS THIS A HDR1 OR HDR2?               03214
         BNZ   CHNOZAPV            YES. ONLY CHANGE VOL1 CARD.           03215
         TM    PARMFLG2,X'41'      ARE WE CHANGING OUTPUT VOLSERS?       03216
         BZ    CHNOZAPV            NO. BYPASS.                           03217
         MVC   EXTLBLIN+4(6),VOLCHG       VOL1 IS FROM EXTERNAL LABEL    03218
         TM    PARMFLG2,X'40'  IS OUTVOL PARM IN EFFECT                  03219
         BZ    CHNOZAPV        NO. DON'T CHANGE OWNER INFORMATION        03220
         CLI   TAPEOWNR,C' '       IS THERE ANY CHANGE IN TAPEOWNR?      03221
         BE    CHNOZAPV            NO INFO-THEREFORE NO CHANGE           03222
         MVC   EXTLBLIN+41(10),TAPEOWNR   CHANGE TAPE OWNER TOO          03223
         MVC   LINE(133),LINE-1                                          03224
         MVC   OWNRTID(10),LINE          CLEAR FIELD                     03225
         MVC   OWNRTID(10),TAPEOWNR      MOVE OWNER INFO INTO MSG        03226
         MVC   OWNRDDO(5),LINE           CLEAR FIELD                     03227
         MVC   OWNRDDO(5),DDOCHG         MOVE OUTPUT DDNAME INTO MSG     03228
         MVC   LINE(133),OWNRMSG                                         03229
         PUT   SYSPRINT,LINE                                             03230
CHNOZAPV DS    0H                                                        03231
*** ---  ABOVE  --------  CHANGING VOLSER IN EXTERNAL LABELS             03232
         TM    INIT1FLG,X'02'      SECOND PASS THRU TAPE INIT?           03233
         BO    CHGWRIT             YES, SKIP SECOND WRITE                03234
         TM    LBLFLAG,X'04'       VOL1 FROM TAPE COPY HERE?             03235
         BO    CHGPRINT            YES, PRINT.                           03236
         TM    LBLLFLAG,X'04'      VOL1 FROM EXTERNAL LABELS HERE?       03237
         BO    CHGPRINT            YES, PRINT                            03238
         B     CHGWRIT                                                   03239
CHGPRINT DS    0H                                                        03240
         TM    LBLFLAG,X'33'       HEADERS OR TRAILERS?                  03241
         BNZ   CHGWRIT             ANY OF ABOVE - DON'T PRINT MSG        03242
         TM    LBLLFLAG,X'33'      HEADERS OR TRAILERS IN EXTERNAL LBL   03243
         BNZ   CHGWRIT             ANY OF ABOVE - DON'T PRINT MSG        03244
         MVC   VOLNEW(6),VOLCHG    MOVE VOLUME NAME IN                   03245
         MVC   VOLDD(5),DDOCHG     MOVE THIS OUTPUT DDNAME IN            03246
         ST    R7,SAVE7RG1                                               03247
         BAL   R7,VOL1PRT   PRINT MESSAGE THAT VOLSER CHANGED SBG 05/00  03248
         L     R7,SAVE7RG1                                               03249
CHGWRIT  DS    0H                                             SBG 05/00  03250
* ----------------------------------  PROCESS CHGVOL KEYWORD  SBG 05/00  03251
CHANGVOE BR    R7                  END OF ROUTINE - RETURN               03252
         SPACE 3                                                         03253
* --------------------------------------------------------- *            03254
*    BAL REGISTER IS R7.                                                 03255
* --------------------------------------------------------- *            03256
*   R2 HAS TO POINT TO THE BYTE COUNT FOR THE LAST READ                  03257
*   R3 HAS TO POINT TO THE DOUBLEWORD COUNTER TO BE INCREMENTED          03258
* --------------------------------------------------------- *            03259
ADDCOUNT DS    0H                  ADD BYTE COUNT SUBROUTINE             03260
         L     R4,0(,R3)           LOAD HIGH ORDER COUNTER               03261
         L     R5,4(,R3)           LOAD LOW  ORDER COUNTER               03262
         AR    R5,R2               ADD TO BYTE COUNT                     03263
         BNO   ADDCNOOV            NO OVERFLOW, THEN BRANCH              03264
         LA    R4,1(,R4)           ELSE, OVERFLOW TO HIGH WORD           03265
         X     R5,=X'7FFFFFFF'     GET RID OF SIGN BIT                   03266
ADDCNOOV DS    0H                                                        03267
         ST    R4,0(,R3)           PUT UPDATED COUNTER IN STORAGE        03268
         ST    R5,4(,R3)           PUT UPDATED COUNTER IN STORAGE        03269
ADDCOUNE BR    R7                  END OF ROUTINE - RETURN               03270
* --------------------------------------------------------- *            03271
*    BAL REGISTER IS R7.                                                 03272
* --------------------------------------------------------- *            03273
*   R2 HAS TO POINT TO THE BLOCK COUNTER SAVE AREA  BLKCNTSV.            03274
*   R3 HAS TO POINT TO THE EOF1 OR EOV1 HI ORDER FIELD. +76              03275
* --------------------------------------------------------- *            03276
MOVEHICT DS    0H             MOVE HIGH 4 DIGITS OF BLOCK COUNT          03277
         CLI   0(R2),C'0'     IS THIS DIGIT ZERO?                        03278
         BE    MOVEHI09                                                  03279
         MVC   0(4,R3),0(R2)                                             03280
         B     MOVEHIEN                                                  03281
         LA    R2,1(,R2)                                                 03282
         LA    R3,1(,R3)                                                 03283
MOVEHI09 CLI   0(R2),C'0'     IS THIS DIGIT ZERO?                        03284
         BE    MOVEHI08                                                  03285
         MVC   0(3,R3),0(R2)                                             03286
         B     MOVEHIEN                                                  03287
         LA    R2,1(,R2)                                                 03288
         LA    R3,1(,R3)                                                 03289
MOVEHI08 CLI   0(R2),C'0'     IS THIS DIGIT ZERO?                        03290
         BE    MOVEHI07                                                  03291
         MVC   0(2,R3),0(R2)                                             03292
         B     MOVEHIEN                                                  03293
         LA    R2,1(,R2)                                                 03294
         LA    R3,1(,R3)                                                 03295
MOVEHI07 CLI   0(R2),C'0'     IS THIS DIGIT ZERO?                        03296
         BE    MOVEHIEN                                                  03297
         MVC   0(1,R3),0(R2)                                             03298
MOVEHIEN BR    R7                                                        03299
* --------------------------------------------------------- *            03300
*    BAL REGISTER IS R7.                                                 03301
* --------------------------------------------------------- *            03302
****                                                                     03303
****    AFTER ONE READ, LOGIC IS AS FOLLOWS:                             03304
****                                                                     03305
****      IF TAPE MARK  - JUST BACK SPACE FILE AND GO ON                 03306
****      IF LABEL FILE - BACK SPACE RECORD AND GO ON                    03307
****      IF DATA FILE  - BACK SPACE RECORD AND FORWARD SPACE FILE,      03308
****                      THEN BACK SPACE FILE OVER TAPE MARK.           03309
****      IF READ ERROR - PROCESS JUST LIKE ANY READ INPUT ERROR         03310
****                                                                     03311
* --------------------------------------------------------- *            03312
LBDQREAD DS    0H             DO ONE READ EXCP AND DECIDE WHAT TO DO     03313
         MVC   INECB,=F'0'    INITIALIZE IN'S ECB                        03314
         EXCP  INIOB          READ                                       03315
         WAIT  ECB=INECB      WAIT FOR READ                              03316
         TM    INCSW+4,X'01'  WAS TM READ?                               03317
         BO    LBDQTM         YES. BACKSPACE BACK OVER IT.               03318
         CLI   INECB,X'7F'    DID READ COMPLETE NORMALLY?                03319
         BNE   LBDQINER       NO -- DO ERROR PROCESSING                  03320
         XC    FULLWORK,FULLWORK     CLEAR AREA COMPLETELY               03321
         MVC   HALFWORK(2),INCCW+6   READ LENGTH                         03322
         L     R2,FULLWORK           LOAD FULLWORD LENGTH                03323
         XC    FULLWORK,FULLWORK     CLEAR AREA COMPLETELY               03324
         MVC   HALFWORK(2),INCSW+6   RESIDUAL BYTE COUNT                 03325
         L     R3,FULLWORK           LOAD FULLWORD LENGTH                03326
         SR    R2,R3                 R2=ACTUAL LENGTH READ               03327
         NI    ISLBLFLG,FF-X'01'     TURN OFF "ISLABEL" FLAG             03328
         C     R2,=F'80'             IS THIS AN 80-BYTE BLOCK?           03329
         BNE   LBDQDATA              NO. WE DON'T HAVE A LABEL FILE      03330
         ST    R7,SAVE7RG4    SAVE BAL REGISTER                          03331
         BAL   R7,LABELCHK    SEE IF YOU'VE GOT A LABEL FILE             03332
         L     R7,SAVE7RG4    RESTORE BAL REGISTER                       03333
         TM    ISLBLFLG,X'01' IS THE CURRENT FILE A LABEL FILE?          03334
         BO    LBDQLABL       JUST BACK SPACE RECORD AND PROCESS         03335
*                             NORMALLY WITHOUT CHANGING ANYTHING.        03336
*                             BUT IF IT IS A DATA FILE,                  03337
         B     LBDQDATA       BACK SPACE RECORD AND FORWARD SPACE FILE   03338
LBDQTM   DS    0H             READ EXCP ENCOUNTERED A TAPE MARK          03339
         MVC   INECB,=F'0'    INITIALIZE IN'S ECB                        03340
         MVC   INCCWPT(4),=A(BK1FCCW)    BACK SPACE OVER T.M.            03341
         EXCP  INIOB          DO THIS EXCP                               03342
         WAIT  ECB=INECB      WAIT FOR READ                              03343
         CLI   INECB,X'7F'    DID EXCP COMPLETE NORMALLY?                03344
         BNE   LBDQINER       NO -- ERROR                                03345
         MVC   INCCWPT(4),=A(INCCW)      RESTORE PROPER CCW POINTER      03346
         B     LBDQREND       GET OUT OF ROUTINE - WORK DONE             03347
LBDQINER DS    0H             READ EXCP ENCOUNTERED AN ERROR             03348
         B     INERR          HANDLE JUST LIKE ANY OTHER INPUT ERROR     03349
LBDQLABL DS    0H             READ EXCP ENCOUNTERED A LABEL FILE         03350
         MVC   INECB,=F'0'    INITIALIZE IN'S ECB                        03351
         MVC   INCCWPT(4),=A(BK1BCCW)    BACK SPACE OVER BLOCK READ      03352
         EXCP  INIOB          DO THIS EXCP                               03353
         WAIT  ECB=INECB      WAIT FOR READ                              03354
         CLI   INECB,X'7F'    DID EXCP COMPLETE NORMALLY?                03355
         BNE   LBDQINER       NO -- ERROR                                03356
         MVC   INCCWPT(4),=A(INCCW)      RESTORE PROPER CCW POINTER      03357
         B     LBDQREND       GET OUT OF ROUTINE - WORK DONE             03358
LBDQDATA DS    0H             READ EXCP ENCOUNTERED A DATA FILE          03359
         MVC   INECB,=F'0'    INITIALIZE IN'S ECB                        03360
         MVC   INCCWPT(4),=A(BYPDCCW)    BACK SPACE AND THEN FS FILE     03361
         EXCP  INIOB          DO THIS EXCP                               03362
         WAIT  ECB=INECB      WAIT FOR READ                              03363
         CLI   INECB,X'7F'    DID EXCP COMPLETE NORMALLY?                03364
         BNE   LBDQINER       NO -- ERROR                                03365
         MVC   INCCWPT(4),=A(INCCW)      RESTORE PROPER CCW POINTER      03366
         B     LBDQREND       GET OUT OF ROUTINE - WORK DONE             03367
LBDQREND BR    R7                                                        03368
* --------------------------------------------------------- *            03369
*    BAL REGISTER IS R7.                                                 03301
* --------------------------------------------------------- *            03302
****                                                                     03303
****  HEX PRINT ROUTINE - PRINT CURRENT RECORD JUST READ, IN HEX.        03304
****                                                                     03305
* --------------------------------------------------------- *            03312
HEXPRINT DS    0H
         TM    PARMFLG5,X'20' ARE WE DOING HEX PRINT?
         BZ    NOHEXPRO       NO. DON'T DO THIS CODE.
         ST    R5,R5HXPRT
         L     R5,SAVTRTCS
         USING TRTCSECT,R5
         L     R0,BCTLIMIT    LOAD REGISTER FOR COMPARE
         C     R0,=F'0'       HAVE WE PRINTED ALL WE SAID?
         BNH   NOHEXPRO       YES. DON'T EXECUTE THIS ROUTINE.
         L     R2,BYTESMVD    MAKE SURE R2 HAS CURRENT RECORD COUNT
         C     R2,=F'132'     IS RECORD MORE THAN 1 LINE LONG?
         BNH   MOVESIZ1       NO. JUST PRINT LENGTH OF RECORD.
         L     R2,=F'132'     YES. LIMIT TO 132 CHARS.
MOVESIZ1 DS    0H
         MVC   HEXPRTWK(133),HEXPRTWK-1 CLEAR OUTPUT AREA
         BCTR  R2,0           ONE LESS FOR EXECUTE
         MVC   LINE(133),LINE-1    CLEAR OUTPUT LINE
         EX    R2,MOVRULER    PUT IN HEX RULER
         PUT   SYSPRINT,LINE
         MVC   LINE(133),LINE-1    CLEAR OUTPUT LINE
         EX    R2,MOVDATIN    MOVE RECORD TO WORK AREA
         EX    R2,PRHEXL0     TRANSLATE TO REMOVE UNPRINTABLES
         MVC   LINE(133),LINE-1    CLEAR OUTPUT LINE
         EX    R2,MOVTOLIN    MOVE TRANSLATED DATA TO OUTPUT
         PUT   SYSPRINT,LINE
         EX    R2,MOVDATIN    MOVE RECORD TO WORK AREA
         EX    R2,PRHEXL1     TRANSLATE TO PRINT FIRST NIBBLE
         MVC   LINE(133),LINE-1    CLEAR OUTPUT LINE
         EX    R2,MOVTOLIN    MOVE 1ST HALF OF HEX TO OUTPUT
         PUT   SYSPRINT,LINE
         EX    R2,MOVDATIN    MOVE RECORD TO WORK AREA
         EX    R2,PRHEXL2     TRANSLATE TO PRINT LAST NIBBLE
         MVC   LINE(133),LINE-1    CLEAR OUTPUT LINE
         EX    R2,MOVTOLIN    MOVE 2ND HALF OF HEX TO OUTPUT
         PUT   SYSPRINT,LINE
         MVC   LINE(133),LINE-1    CLEAR OUTPUT LINE FOR LATER WORK
         B     HEXPREND
MOVDATIN MVC   HEXPRTWK(*-*),INAREA       ***  EXECUTED  ***
MOVRULER MVC   LINE+1(*-*),RULERHEX       ***  EXECUTED  ***
MOVTOLIN MVC   LINE+1(*-*),HEXPRTWK       ***  EXECUTED  ***
PRHEXL0  TR    HEXPRTWK(*-*),TRTBL0       ***  EXECUTED  ***
PRHEXL1  TR    HEXPRTWK(*-*),TRTBL1       ***  EXECUTED  ***
PRHEXL2  TR    HEXPRTWK(*-*),TRTBL2       ***  EXECUTED  ***
HEXPREND DS    0H
         L     R2,BYTESMVD    RESTORE R2 FOR LATER USE
NOHEXPRO DS    0H
         L     R5,R5HXPRT
         DROP  R5
         BR    R7             RETURN TO CALLER
* --------------------------------------------------------- *            03369
* - - - - - - END - SUBROUTINES   - - - - - - - - - - - - - - SBG 04/00  03370
         EJECT                                                           03371
* - - - - - - C O N S T A N T S   - - - - - - - - - - - - - - - - - - *  03372
BYTESMVD DS    0F             FULLWORD OF CURRENT BYTES MOVED            03373
BYTESCOH DC    H'0'           HI ORDER - SHOULD BE ALWAYS ZERO           03374
BYTESCOP DC    H'0'           CURRENT NUMBER OF BYTES COPIED FROM INPUT  03375
FUL2ZERO DC    2F'0'                                                     03376
IOB01    DC    X'02000000'                                               03377
IOB02    DC    X'00010000'                                               03378
PL4NO3   DC    PL4'3'                                                    03379
DBINF    DS    0D             BYTE COUNT SAVE AREA FOR INPUT FILE        03380
DBINFH   DC    F'0'                                                      03381
DBINFL   DC    F'0'                                                      03382
DBIN     DS    0D             BYTE COUNT SAVE AREA FOR INPUT TOTAL       03383
DBINH    DC    F'0'                                                      03384
DBINL    DC    F'0'                                                      03385
LABIN    DS    0D             BYTE COUNT SAVE AREA FOR INPUT LABELS      03386
LABINH   DC    F'0'                                                      03387
LABINL   DC    F'0'                                                      03388
WORKA    DC    D'0'                                                      03389
WORKL    DC    D'0'                                                      03390
WORKP    DC    D'0'                                                      03390
SAV01MLT DC    D'0'                                                      03391
LINLABEL DC    F'0'           LABEL LIMIT VALUE                          03392
PRTLIMIT DC    F'&HEXDFLA'    HEXPRT LIMIT VALUE - DEFAULT IS 4 RECORDS  03392
BCTLIMIT DC    F'&HEXDFLA'    HEXPRT DECREMENT VALUE - DEFAULT IS 4      03392
LINFILE  DC    F'0'           RAW FILE LIMIT VALUE - SAME FOR NL         03393
LSLFILE  DC    F'0'           SL  FILE LIMIT VALUE - 3X NL VALUE         03394
LTGFILE  DC    F'0'           TARGET NUMBER FOR FILE LIMIT VALUE         03395
BLOKCNT  DC    F'0'                                                      03396
FILECNT  DC    F'1'                                                      03397
LABELCNT DC    F'0'                                                      03398
SAVBYTES DC    X'0000'
EOFINFLG DC    X'00'          END OF INPUT TAPE FILES WITH LIMFILE       03399
EOFLBFLG DC    X'00'          END OF INPUT LABEL SETS WITH LIMLIMIT      03400
EXEOFLAG DC    X'00'          EXTRA EOFS WITH LABADDIN AND FILELIMIT     03401
UNEXFLAG DC    X'00'          UNIT EXCEPTION FLAG                        03402
*              X'01'          A UNIT EXCEPTION HAS OCCURRE ON AN OUTPUT  03403
INIT1FLG DC    X'00'          FLAG WRITING THE SECOND INIT LABEL         03404
SLFLAG   DC    X'00'          IF DID INITIAL READ, MARK IF SL TAPE       03405
*              X'01'          TAPE IS SL                                 03406
PRTHEXOV DC    X'00'          HEX PRINT OVERRIDE FLAG
*              X'01'          PRINTRCDS= HAS BEEN CODED IN SYSIN
LBDQFLG  DC    X'00'          X'01' IF DOING LBDQUICK PRELIM LAB CHECK   03407
WRLBLFLG DC    X'00'          FLAG TELLING IF WE ARE WRITING LABELS      03408
*              X'00'          WE ARE NOW WRITING DATA FROM THE           03409
*                             INPUT TAPE. X'01' IS OFF.                  03410
*              X'01'          WE ARE NOW WRITING LABELS FROM THE         03411
*                             EXTERNAL FILE                              03412
*              X'02'          WE ARE WRITING AN EXTRA TAPE MARK          03413
*              X'04'          WE CAME FROM THE ENDHEADR LABEL            03414
*              X'08'          WE CAME FROM THE LBLINEND LABEL            03415
*                             THIS MEANS EOF OF THE LABADDIN FILE        03416
*              X'10'          FINISHED FIXING LABELS                     03417
ISLBLFLG DC    X'00'          FLAG INDICATING WE JUST READ A LABEL       03418
*              X'00'          DATA IS NOT A LABEL                        03419
*              X'01'          DATA IS A LABEL                            03420
ENDITFLG DC    X'00'          FLAG INDICATING GET OUT FAST               03421
*              X'01'          BECAUSE OF LABLDUMP DD MISSING             03422
*              X'02'          BECAUSE OF SYSIN    DD MISSING             03423
*              X'04'          BECAUSE OF LABADDIN DD MISSING             03424
OPENDFLG DC    X'00'          FLAG INDICATING DCB IS OPEN                03425
*              X'01'          LABLDUMP DD IS OPEN                        03426
*              X'02'          SYSIN    DD IS OPEN                        03427
*              X'04'          LABADDIN DD IS OPEN                        03428
OUTBYT   DS    0F                                                        03429
OUTBYTH  DC    X'0000'        HI ORDER SO YOU USE A FULL REGISTER        03430
OUTBYTL  DC    X'0000'        OUTPUT BYTE COUNT BEFORE WRITE             03431
TOTBYTES DC    D'0'                COUNT OF TOTAL BYTES COPIED (BINARY)  03432
LABBYTES DC    D'0'                COUNT OF TOTAL BYTES IN LABELS        03433
FILBYTES DC    D'0'                COUNT OF TOTAL BYTES IN FILES         03434
TWO31    DC    P'2147483648'       2 TO THE 31ST                         03435
TAPEOWNR DC    CL10' '                                                   03436
INVOLUME DC    CL6'      '                                    SBG 03/00  03437
         DC    C'      '                                                 03438
         DC    C'0'                                                      03439
BLKCNTSV DC    C'0000000000'   SAVE FULL BLOCK COUNT FOR DATA FILES      03440
         DC    C'      '                                                 03441
DWORD    DC    D'0'                                                      03442
QWORD    DS    PL16                                                      03443
ZERO23   DC    23C'0'         TEST FOR IEHINITTED HDR1        SBG 03/00  03444
         CNOP  0,8                                                       03445
INCCW    DC    X'02',AL3(INAREA),X'2000',X'FFFF'              SBG 03/00  03446
OUTCCW   DC    X'01',AL3(INAREA),X'2000',X'FFFF'              SBG 03/00  03447
REWCCW   DC    X'07',AL3(INAREA),X'6000',X'FFFF'              SBG 03/00  03448
         DC    X'03',AL3(INAREA),X'2000',X'FFFF'                         03449
BACKCCW  DC    X'2F',AL3(INAREA),X'6000',X'FFFF'     BACKSPACE 2 FILES   03450
BK1FCCW  DC    X'2F',AL3(INAREA),X'6000',X'FFFF'     BACKSPACE ONE FILE  03451
         DC    X'03',AL3(INAREA),X'2000',X'FFFF'                         03452
BK1BCCW  DC    X'27',AL3(INAREA),X'6000',X'FFFF'     BACKSPACE BLOCK     03453
         DC    X'03',AL3(INAREA),X'2000',X'FFFF'                         03454
BYPDCCW  DC    X'27',AL3(INAREA),X'6000',X'FFFF'     BACKSPACE BLOCK     03455
         DC    X'3F',AL3(INAREA),X'6000',X'FFFF'     FWD SPACE FILE      03456
         DC    X'2F',AL3(INAREA),X'6000',X'FFFF'     BACK OVER T.M.      03457
         DC    X'03',AL3(INAREA),X'2000',X'FFFF'                         03458
INECB    DC    F'0'                                                      03459
INIOB    DC    X'02000000'                                               03460
         DC    A(INECB)                                                  03461
INCSW    DC    2F'0'                                                     03462
INCCWPT  DC    A(INCCW)                                                  03463
         DC    A(IN)                                                     03464
         DC    F'0'                                                      03465
         DC    X'00010000'                                               03466
OUTECB   DC    F'0'                                                      03467
OUTIOB   DC    X'02000000'                                               03468
         DC    A(OUTECB)                                                 03469
OUTCSW   DC    2F'0'                                                     03470
OUTCCWPT DC    A(OUTCCW)                                                 03471
OUTDCBPT DC    A(OUT1)                                                   03472
         DC    F'0'                                                      03473
         DC    X'00010000'                                               03474
REWECB   DC    F'0'                                                      03475
REWIOB   DC    X'02000000'                                               03476
         DC    A(REWECB)                                                 03477
REWCSW   DC    2F'0'                                                     03478
         DC    A(REWCCW)                                                 03479
REWDCBPT DC    A(OUT1)                                                   03480
         DC    F'0'                                                      03481
         DC    X'00010000'                                               03482
         SPACE 3                                                         03483
DDOCHG   DC    C'     '                                                  03484
DDOUT1   DC    C'OUT1 '                                                  03485
DDOUT2   DC    C'OUT2 '                                                  03486
DDOUT3   DC    C'OUT3 '                                                  03487
DDOUT4   DC    C'OUT4 '                                                  03488
DDOUT5   DC    C'OUT5 '                                                  03489
DDOUT6   DC    C'OUT6 '                                                  03490
DDOUT7   DC    C'OUT7 '                                                  03491
DDOUT8   DC    C'OUT8 '                                                  03492
DDOUT9   DC    C'OUT9 '                                                  03493
DDOUT10  DC    C'OUT10'                                                  03494
DDOUT11  DC    C'OUT11'                                                  03495
DDOUT12  DC    C'OUT12'                                                  03496
DDOUT13  DC    C'OUT13'                                                  03497
DDOUT14  DC    C'OUT14'                                                  03498
DDOUT15  DC    C'OUT15'                                                  03499
DDOUT16  DC    C'OUT16'                                                  03500
FLAGLIT  DC    C' - FLAGS - '                                            03501
* --------------------------                                             03502
EOLGFLAG DC    X'00'          END OF LABEL GROUP FLAG - FOR LABLDUMP     03503
*              X'01'          WE ARE IN A HDR GROUP                      03504
*              X'02'          WE ARE IN A EOF GROUP                      03505
*              X'04'          WE ARE IN A EOV GROUP                      03506
* --------------------------                                             03507
INEODFLG DC    X'00'             X'02' IF END OF DATA ON INPUT TAPE      03508
FLAG1    DC    X'00'                                                     03509
OP1      EQU   X'80'                                                     03510
OP2      EQU   X'40'                                                     03511
OP3      EQU   X'20'                                                     03512
OP4      EQU   X'10'                                                     03513
OP5      EQU   X'08'                                                     03514
OP6      EQU   X'04'                                                     03515
OP7      EQU   X'02'                                                     03516
OP8      EQU   X'01'                                                     03517
FLAG2    DC    X'00'                                                     03518
OP9      EQU   X'80'                                                     03519
OP10     EQU   X'40'                                                     03520
OP11     EQU   X'20'                                                     03521
OP12     EQU   X'10'                                                     03522
OP13     EQU   X'08'                                                     03523
OP14     EQU   X'04'                                                     03524
OP15     EQU   X'02'                                                     03525
OP16     EQU   X'01'                                                     03526
FLAG2A   DC    X'00'                                          SBG 03/00  03527
ERR      EQU   X'02'                                                     03528
EOV      EQU   X'01'                                                     03529
FF       EQU   X'FF'                                                     03530
FLAG3    DC    X'00'                                                     03531
FLAG4    DC    X'00'                                                     03532
FLAG4A   DC    X'00'         COPY IMAGE FOR SAFETY'S SAKE     SBG 03/00  03533
L80FLAG  DC    X'00'                                          SBG 03/00  03534
*              X'01'    LAST DATA WAS 80 BYTE RECORD          SBG 03/00  03535
* ---------- *                                                           03536
ABENDFLG DC    X'00'    Should we do an ABEND 069 ?
*              x'01'    Yes.
* ---------- *                                                           03536
LBLFLAG  DC    X'00'    FLAG WHEN TAPE LABELS ARE BEING READ IN          03537
*              X'01'    HDR1 HAS BEEN SEEN                    SBG 03/00  03538
*              X'02'    HDR2 HAS BEEN SEEN                    SBG 03/00  03539
*              X'04'    VOL1 HAS BEEN SEEN                    SBG 03/00  03540
*              X'08'    HDR1 IS FROM AN INITTED TAPE          SBG 03/00  03541
*              X'10'    EOF1 HAS BEEN SEEN                    SBG 04/00  03542
*              X'20'    EOF2 HAS BEEN SEEN                    SBG 04/00  03543
*              X'40'    EOV1 HAS BEEN SEEN                    SBG 04/00  03544
*              X'80'    EOV2 HAS BEEN SEEN                    SBG 04/00  03545
* ---------- *                                                           03546
LBLLFLAG DC    X'00'    FLAG TO IDENTIFY EXTERNAL LABELS BEING READ IN   03547
*              X'01'    HDR1 HAS BEEN READ IN                            03548
*              X'02'    HDR2 HAS BEEN READ IN                            03549
*              X'04'    VOL1 HAS BEEN READ IN                            03550
*              X'08'    UHL  HAS BEEN READ IN                            03551
*              X'10'    EOF1 HAS BEEN READ IN                            03552
*              X'20'    EOF2 HAS BEEN READ IN                            03553
*              X'40'    ----ENDOFLABELHEADER  HAS BEEN READ IN           03554
*              X'80'    ----ENTOFLABELTRAILER HAS BEEN READ IN           03555
* ---------- *                                                           03556
STRIPFLG DC    X'00'
*              X'01'    LABEL HAS BEEN ENCOUNTERED - SKIP IT AND T.M.
DATFLAG  DC    X'00'                                          SBG 03/00  03557
*              X'10'    NO REAL DATA HAS BEEN READ YET        SBG 03/00  03558
OVERFLAG DC    X'00'                                                     03559
*              X'01'    OUTVOLALL OVERRIDE OF CHGVOL                     03560
* --------------------------------------------------------- * SBG 04/00  03561
VOLDD    DC    C'     '                                                  03562
STOR7REG DS    F                                                         03563
SAV14T03 DC    6F'0'    SAVE REGS 14 THRU 03                  TEST       03564
SAV14T12 DC    16F'0'   SAVE REGS 14 THRU 12                  TEST       03565
BYTESPAT DC    X'40206B2020206B2020206B2020206B2020206B2020206B202120'   03566
         DC    C' BYTES COPIED SUCCESSFULLY FOR:'                        03567
         SPACE 3                                                         03568
LABELITH DC    CL80'----ENDOFLABELHEADER '                               03569
LABELITI DC    CL80'----ENDOFLABELHEADERINIT'                            03570
LABELITR DC    CL80'----ENDOFLABELTRAILER'                               03571
LABELITV DC    CL80'----ENDOFLABELTRAILEREOV'                            03572
* ------------------------ INITIALIZATION OF VOLUMES ---- BELOW ---- *   03573
VOL1LABL DS    0CL80                                                     03574
VOL1LIT  DC    CL4'VOL1'                                                 03575
VOL1SERL DC    CL6' '                                                    03576
VOL1FIL1 DC    CL31' '                                                   03577
VOL1ONER DC    CL10' '                                                   03578
VOL1FIL2 DC    CL29' '                                                   03579
* ------------------------ INITIALIZATION OF VOLUMES --------------- *   03580
HDR1INIT DS    0CL80                                                     03581
HDR1ILIT DC    CL4'HDR1'                                                 03582
HDR1IFIL DC    76C'0'                                                    03583
* ------------------------ INITIALIZATION OF VOLUMES ---- ABOVE ---- *   03584
TOTWLINE DC    C' TOTAL BYTES WITHOUT LABELS: '                          03585
TOTWPATT DC    X'40206B2020206B2020206B2020206B2020206B2020206B202120'   03586
         DC    CL78' '                                                   03587
TOTLLINE DC    C' TOTAL BYTES IN TAPE LABELS: '                          03588
TOTLPATT DC    X'40206B2020206B2020206B2020206B2020206B2020206B202120'   03589
         DC    CL78' '                                                   03590
TOTBLINE DC    C' TOTAL BYTES READ ON INPUT : '                          03591
TOTBPATT DC    X'40206B2020206B2020206B2020206B2020206B2020206B202120'   03592
         DC    CL78' '                                                   03593
BLKCNTMS DC    C' BLOCK COUNTS IN EOF1 AND EOV1 ARE BEING CORRECTED FO'  03594
         DC    C'R TAPE COPY OPERATION '                                 03595
         DC    CL58' '                                                   03596
INNOTOPN DC    C' CODE A DD CARD FOR //IN , SINCE THIS OPTION OF COPYM'  03597
         DC    C'ODS NEEDS TO READ AN INPUT TAPE. TO INIT TAPES, CODE '  03598
         DC    C'A PARM OF INITVOLS.'                                    03599
         DC    CL8' '                                                    03600
LDMPOUTM DC    C' LABELS ARE BEING DUMPED.  OUTPUT DSN=               '  03601
         DC    C'                             MEMBER=         VOLUME= '  03602
         DC    C'                          '                             03603
LDMPINMS DC    C' LABELS ARE BEING CREATED.  INPUT DSN=               '  03604
         DC    C'                             MEMBER=         VOLUME= '  03605
         DC    C'                          '                             03606
LDMPMSG  DC    C' WITH THE LABLDUMP PARM CODED, YOU HAVE TO CODE A //L'  03607
         DC    C'ABLDUMP DD CARD WITH LRECL=80,RECFM=FB. ANY BLKSIZE A'  03608
         DC    C' MULTIPLE OF 80           '                             03609
LIMFMSG  DC    C' FILELIMIT=           HAS BEEN CODED IN SYSIN. NUMBER'  03610
         DC    C' IS TREATED AS NL.                                   '  03611
         DC    CL27' '                                                   03612
LIMLMSG  DC    C' LABELIMIT=           HAS BEEN CODED IN SYSIN. NUMBER'  03613
         DC    C' REFLECTS THE COUNT OF ----ENDOFLABELTRAILER CARDS.  '  03614
         DC    CL27' '                                                   03615
LIMPMSG  DC    C' PRINTRCDS=           HAS BEEN CODED IN SYSIN. NUMBER'  03613
         DC    C' OF RECORDS FROM EACH TAPE FILE BEING PRINTED OUT.   '  03614
         DC    CL27' '                                                   03615
LIMHMSG  DC    C' HEXPRT OPTION IS ON IN DEFAULT MODE. '                 03613
         DC    CL6'&HEXDFLM'
         DC    C' RECORDS WILL'                                          03613
         DC    C' BE HEX PRINTED.  TO OVERRIDE, CODE PRINTRCDS=nnn in '  03614
         DC    C'SYSIN.'
         DC    CL17' '                                                   03615
STRPMSG  DC    C' STRIPPING LABELS FROM THE OUTPUT TAPES.  ANY LABELS '  03616
         DC    C'ENCOUNTERED ON INPUT, WILL NOT BE WRITTEN TO THE OUTP'  03617
         DC    C'UT TAPES.                 '                             03618
NSYSMSG  DC    C' WITH THE SYSIN    PARM CODED, YOU HAVE TO CODE A //S'  03616
         DC    C'YSIN    DD CARD WITH LRECL=80,RECFM=FB. ANY BLKSIZE A'  03617
         DC    C' MULTIPLE OF 80           '                             03618
NLABMSG  DC    C' WITH THE LABADDIN PARM CODED, CODE A //LABADDIN DD C'  03619
         DC    C'ARD POINTING TO A DATASET OR MEMBER CONTAINING LABEL '  03620
         DC    C'IMAGES.                   '                             03621
NOLABSL  DC    C' WITH THE LABADDIN PARM CODED, YOU CAN''T ADD LABELS '  03622
         DC    C'TO A TAPE THAT IS ALREADY STANDARD LABELED.          '  03623
         DC    C'                           '                            03624
DIAGMS1  DC    C' You have gotten to Diagnostic Message #1 - I am writ'
         DC    C'ing a Tape Mark right now.                           '
         DC    C'                          '
FORCENLM DC    C' *** File Limiting by NL file numbers has been forced'
         DC    C'.  Divide by 3 for the SL file number ***            '
         DC    C'                          '
FORCESLM DC    C' *** File Limiting by SL file numbers has been forced'
         DC    C'.  Multiply by 3 for the NL file number ***          '
         DC    C'                          '
TWOFORCE DC    C' *** File Limiting by SL and NL file numbers both spe'
         DC    C'cified.  SL is now in effect.  If NL is wanted, do no'
         DC    C't code PARM=SLLIM.        '
INEQC    DC    C' *********** EQUIPMENT CHECK ON INPUT -- COPY '         03625
         DC    C'TERMINATED '                                            03626
         DC    76C'*'                                                    03627
INDCK    DC    C' ********** DATA CHECK ON INPUT -- COPY TERMINATED '    03628
         DC    82C'*'                                                    03629
VOLALT   DC    C' VOL1 VOLSER XXXXXX WAS ALTERED TO XXXXXX'   SBG 03/00  03630
         DC    C' FOR DDNAME '                                           03631
VOLDDN   DC    C'     '                                                  03632
VOLFILL  DC    75C' '                    VOL1 CHANGE MESSAGE  SBG 03/00  03633
OWNRMSG  DC    C' VOL1 TAPE OWNER FIELD WAS CHANGED TO '                 03634
OWNRTID  DC    C'          '                                             03635
OWNRLIT1 DC    C' FOR DDNAME '                                           03636
OWNRDDO  DC    C'     '                                                  03637
OWNRFIL2 DC    68C' '                                                    03638
LTMRPT   DC    C' LEADING TAPE MARK WAS '                     SBG 03/00  03639
LTMRPTI  DC    C'       '                  COPIED OR SKIPPED  SBG 03/00  03640
         DC    103C' '                                        SBG 03/00  03641
EOVCHG   DC    C' EOV LABELS FOUND - CHANGED TO EOF AS PER '  SBG 06/00  03642
         DC    C'EOV2EOF PARM OR OPTION'                      SBG 06/00  03643
         DC    69C' '                                         SBG 06/00  03644
INITCREA DC    C'CREATED WITHOUT INPUT TAPE  '                           03645
INITMSG  DC    C' INITTED TAPE HAS BEEN '                                03646
INITCOPD DC    C'COPIED  - ORIGINAL VOLSER = '                           03647
INITSER  DC    C'      '                                      SBG 03/00  03648
INITBLNK DC    76C' '                                         SBG 03/00  03649
VOL1LBL  DC    C' VOL1 LABEL HAS BEEN DETECTED - VOLSER = '   SBG 03/00  03650
VOL1SER  DC    C'      '                                      SBG 03/00  03651
VOL1OWNT DC    C'     OWNER = '                               SBG 04/00  03652
VOL1OWNR DC    C'          '                                  SBG 04/00  03653
VOL1BLNK DC    63C' '                                         SBG 03/00  03654
         DC    C' '                                                      03655
USERLBL  DC    81C' '                                         SBG 03/00  03656
         DC    52C' '                                                    03657
XXX1LBL  DC    C' XXX1 LABEL: 1STVOL= '                       SBG 05/00  03658
XXX1VOL  DC    C'      '                                      SBG 05/00  03659
XXX1DSNL DC    C' DSN='                                       SBG 05/00  03660
XXX1DSN  DC    C'                 '                           SBG 05/00  03661
XXX1DSQL DC    C' DS SEQ #: '                                 SBG 05/00  03662
XXX1DSQ  DC    C'    '                                        SBG 05/00  03663
XXX1VSQL DC    C' VOL SEQ #: '                                SBG 05/00  03664
XXX1VSQ  DC    C'    '                                        SBG 05/00  03665
XXX1BLCL DC    C' BLK CNT: '                                  SBG 05/00  03666
XXX1BLCH DC    C'    '                                        SBG 05/00  03667
XXX1BLC  DC    C'      '                                      SBG 05/00  03668
XXX1CRDL DC    C' CRDATE: '                                   SBG 05/00  03669
XXX1CRD  DC    C'      '                                      SBG 05/00  03670
XXX1EXDL DC    C' EXDATE: '                                   SBG 05/00  03671
XXX1EXD  DC    C'      '                                      SBG 05/00  03672
XXX1BLNK DC    30C' '                                         SBG 03/00  03673
XXX2LBL  DC    C' XXX2 LABEL: RECFM= '                        SBG 05/00  03674
XXX2RFM  DC    C' '                                           SBG 05/00  03675
XXX2BKLL DC    C'   BLOCK LENGTH: '                           SBG 05/00  03676
XXX2BKL  DC    C'     '                                       SBG 05/00  03677
XXX2RCLL DC    C'   RECORD LENGTH: '                          SBG 05/00  03678
XXX2RCL  DC    C'     '                                       SBG 05/00  03679
XXX2TDNL DC    C'  TAPE DEN: '                                SBG 05/00  03680
XXX2TDN  DC    C' '                                           SBG 05/00  03681
XXX2JSTL DC    C'   JOB/JOB STEP: '                           SBG 05/00  03682
XXX2JST  DC    C'                 '                           SBG 05/00  03683
XXX2IDRL DC    C'   IDRC? '                                   SBG 05/00  03684
XXX2IDR  DC    C'   '                                         SBG 05/00  03685
XXX2BLNK DC    8C' '                                          SBG 03/00  03686
OUTEQC   DC    C' *********** EQUIPMENT CHECK ON DD XXXXX, UNIT '        03687
         DC    C'XXX, VOLUME XXXXXX -- THIS OUTPUT TERMINATED '          03688
         DC    41C'*'                                                    03689
OUTUNEX  DC    C' *********** TAPE HAS ENDED  ON DD XXXXX, UNIT '        03690
         DC    C'XXX, VOLUME XXXXXX -- THIS OUTPUT TERMINATED '          03691
         DC    41C'*'                                                    03692
OUTDCK   DC    C' **********       DATA CHECK ON DD XXXXX, UNIT '        03693
         DC    C'XXX, VOLUME XXXXXX -- THIS OUTPUT TERMINATED '          03694
         DC    41C'*'                                                    03695
FILEDONE DC    C' FILE 00000 CONTAINS 0000000 DATA BLOCKS'               03696
FILEPBYT DS    0CL44                                                     03697
FILEDFL1 DC    C' '                                                      03698
FILECONT DC    C'          '                                             03699
FILEDFL2 DC    C' '                                                      03700
FILEBYTE DC    C' 9,999,999,999,999,999,999'                             03701
         DC    C' BYTES'                                                 03702
FILETBYT DS    0CL44                                                     03703
FILEDFL3 DC    C'    '                                                   03704
FILECUMT DC    C'          '                                             03705
FILEDFL4 DC    C' '                                                      03706
FILETBYE DC    C' 9,999,999,999,999,999,999'                             03707
         DC    8C' '                                                     03708
SUCCESS  DC    C'0COPY CORRECTLY COMPLETED FOR OUT1, OUT2, OUT3, OU'     03709
         DC    C'T4, OUT5, OUT6, OUT7, OUT8, OUT9, OUT10, OUT11, OU'     03710
         DC    C'T12, OUT13, OUT14, OUT15, OUT16  '                      03711
         DC    C'       '          BLANKS FOR COVERING UP     SBG 03/00  03712
READOMSG DC    C'0THIS RUN OF THE COPYMODS PROGRAM IS READ-ONLY. JCL VOX 03713
               LSER: XXXXXX '                                 SBG 06/00  03714
         DC    66C' '                                         SBG 06/00  03715
SUCCESSR DC    C'0TAPE READ CORRECTLY COMPLETED FOR DDNAME IN, VOLUME SX 03716
               ERIAL XXXXXX '                                 SBG 06/00  03717
         DC    66C' '                                         SBG 06/00  03718
         DC    C' '                                                      03719
HEXPRTWK DC    CL133' '                                                  03720
         DC    C' '                                                      03719
LINE     DC    CL133' '                                                  03720
LINE44   DC    CL44' '                                                   03721
RULERHEX DS    0CL132
         DC    C'----+----1----+----2----+----3----+----4----+----5--'
         DC    C'--+----6----+----7----+----8----+----9----+----0----+'
         DC    C'----1----+----2----+----3----+----4'
REPLY    DC    C'      '                                                 03722
COPIED   DC    C'COPIED '                                     SBG 03/00  03723
SKIPPED  DC    C'SKIPPED'                                     SBG 03/00  03724
FULLWORK DS    0F                                             SBG 03/00  03725
         DC    H'0'                                           SBG 03/00  03726
HALFWORK DC    H'0'                HALFWORD WORK AREA         SBG 03/00  03727
         DC    2F'0'               FILLER                     SBG 05/00  03728
* --------------------------------------------------------- * SBG 05/00  03729
PARMFLGS DS    0CL5     5 CONTIGUOUS BYTES OF PARM FLAGS      SBG 04/00  03730
PARMFLG1 DC    X'00'                                          SBG 03/00  03731
*              X'DE'    LABEL INFORMATION WILL BE PRINTED     SBG 03/00  03732
*              X'20'    LEADING TAPE MARKS WILL BE SKIPPED    SBG 03/00  03733
PARMFLG2 DC    X'00'                                          SBG 03/00  03734
PARMFLG3 DC    X'00'                                          SBG 03/00  03735
PARMFLG4 DC    X'00'                                          SBG 03/00  03736
PARMFLG5 DC    X'00'                                          SBG 03/00  03737
* --------------------------------------------------------- * SBG 05/00  03738
PARMSLEN DC    F'0'                LENGTH OF PARMS            SBG 04/00  03739
PARMSTRT DC    F'0'                START ADDR OF JCL PARMS    SBG 05/00  03740
PRMCHRCT DC    F'0'                CHAR COUNT FOR PRM SEARCH  SBG 05/00  03741
TOTCHRCT DC    F'0'                CHAR COUNT FOR PRM SEARCH  SBG 05/00  03742
PARMHITS DC    PL4'0'              NUMBER OF PARM HITS        SBG 05/00  03743
TOTMHITS DC    PL4'0'              NUMBER OF PARM HITS        SBG 05/00  03744
PARMLCNT DC    PL4'0'              NUMBER OF PARM LOOPS       SBG 05/00  03745
TOTMLCNT DC    PL4'0'              NUMBER OF PARM LOOPS       SBG 05/00  03746
PARMTENT DC    CL15' '             PARM TABLE ENTRY DUMP      SBG 05/00  03747
         DC    CL7' '              FILLER                     SBG 03/00  03748
PARMFWRK DC    XL5'00'             FOR TURNING OFF PARM BYTES SBG 03/00  03749
* --------------------------------------------------------- * SBG 05/00  03750
*              FORMAT OF PARM TABLE                           SBG 04/00  03751
*              ONE ENTRY IS 15 BYTES                          SBG 04/00  03752
*                1ST BYTE:      LENGTH OF THIS PARM IN HEX    SBG 04/00  03753
*                2ND BYTE:      X'01' SAYS TURN FLAG OFF      SBG 04/00  03754
*                               X'00' SAYS TURN FLAG ON       SBG 04/00  03755
*                               X'10' SET ENTRY AS A DEFAULT  SBG 04/00  03756
*                NEXT 8 BYTES:  PARM NAME - LEFT JUSTIFIED    SBG 04/00  03757
*                NEXT 5 BYTES:  FLAG SETTINGS - 5 FLAGS,      SBG 04/00  03758
*                                WHICH ALLOWS FOR 40 PARMS    SBG 04/00  03759
*                                THAT DON'T HAVE TO BE        SBG 04/00  03760
*                                SEPARATED BY A COMMA.        SBG 04/00  03761
PBYTES   EQU   5                NUMBER OF PARM SWITCH BYTES   SBG 05/00  03762
* --------------------------------------------------------- * SBG 05/00  03763
PARMTABL DC    X'07',X'00',C'LTMSKIP ',X'2000000000' FIRST ENTRY         03764
PTELEN   EQU   *-PARMTABL                                                03765
PTEFLG   EQU   PTELEN-PBYTES                                             03766
         DC    X'07',X'00',C'SKIPLTM ',X'2000000000'                     03767
         DC    X'07',X'11',C'COPYLTM ',X'2000000000' DEFAULT             03768
         DC    X'07',X'01',C'LTMCOPY ',X'2000000000'                     03769
         DC    X'07',X'00',C'LBLINFO ',X'DE00000000'                     03770
         DC    X'06',X'00',C'PRINTL  ',X'DE00000000'                     03771
         DC    X'06',X'00',C'LABELS  ',X'DE00000000'                     03772
         DC    X'06',X'01',C'NOLABL  ',X'DE00000000'                     03773
         DC    X'07',X'11',C'NOLABEL ',X'DE00000000' DEFAULT             03774
         DC    X'04',X'00',C'HDR1    ',X'0200000000'                     03775
         DC    X'06',X'01',C'NOHDR1  ',X'0200000000'                     03776
         DC    X'04',X'00',C'HDR2    ',X'0400000000'                     03777
         DC    X'06',X'01',C'NOHDR2  ',X'0400000000'                     03778
         DC    X'04',X'00',C'EOF1    ',X'0800000000'                     03779
         DC    X'06',X'01',C'NOEOF1  ',X'0800000000'                     03780
         DC    X'04',X'00',C'EOF2    ',X'1000000000'                     03781
         DC    X'06',X'01',C'NOEOF2  ',X'1000000000'                     03782
         DC    X'04',X'00',C'EOV1    ',X'4000000000'                     03783
         DC    X'06',X'01',C'NOEOV1  ',X'4000000000'                     03784
         DC    X'04',X'00',C'EOV2    ',X'8000000000'                     03785
         DC    X'06',X'01',C'NOEOV2  ',X'8000000000'                     03786
         DC    X'04',X'00',C'HDRS    ',X'0600000000'                     03787
         DC    X'06',X'01',C'NOHDRS  ',X'0600000000'                     03788
         DC    X'04',X'00',C'EOFS    ',X'1800000000'                     03789
         DC    X'06',X'01',C'NOEOFS  ',X'1800000000'                     03790
         DC    X'04',X'00',C'EOVS    ',X'C000000000'                     03791
         DC    X'06',X'01',C'NOEOVS  ',X'C000000000'                     03792
         DC    X'06',X'00',C'CHGVOL  ',X'0001000000'                     03793
         DC    X'08',X'11',C'NOCHGVOL',X'0001000000' DEFAULT             03794
         DC    X'06',X'00',C'JCLVOL  ',X'0001000000'                     03795
         DC    X'08',X'01',C'NOJCLVOL',X'0001000000'                     03796
         DC    X'06',X'00',C'NEWVOL  ',X'0001000000'                     03797
         DC    X'08',X'01',C'NONEWVOL',X'0001000000'                     03798
         DC    X'06',X'10',C'VOLLBL  ',X'0002000000' DEFAULT             03799
         DC    X'08',X'01',C'NOVOLLBL',X'0002000000'                     03800
         DC    X'07',X'00',C'EOV2EOF ',X'0004000000'                     03801
         DC    X'08',X'00',C'EOVTOEOF',X'0004000000'                     03802
         DC    X'06',X'00',C'EOVCHG  ',X'0004000000'                     03803
         DC    X'08',X'11',C'NOEOVCHG',X'0004000000' DEFAULT             03804
         DC    X'04',X'00',C'READ    ',X'0008000000'                     03805
         DC    X'08',X'00',C'READONLY',X'0008000000'                     03806
         DC    X'07',X'00',C'NOWRITE ',X'0008000000'                     03807
         DC    X'07',X'11',C'WRITE   ',X'0008000000' DEFAULT             03808
         DC    X'08',X'00',C'LABLDUMP',X'0010000000'                     03809
         DC    X'08',X'11',C'NOLABLDU',X'0010000000' DEFAULT             03810
         DC    X'05',X'00',C'SYSIN   ',X'0020000000'                     03811
         DC    X'07',X'11',C'NOSYSIN ',X'0020000000' DEFAULT             03812
         DC    X'06',X'00',C'OUTVOL  ',X'0040000000'                     03813
         DC    X'08',X'00',C'NOOUTVOL',X'0040000000'                     03814
         DC    X'08',X'00',C'LABADDIN',X'0080800000' INCLUDE LBLFIX      03815
         DC    X'08',X'01',C'NOLABADD',X'0080000000'                     03816
         DC    X'06',X'10',C'BLKCNT  ',X'0100000000' DEFAULT             03817
         DC    X'08',X'01',C'NOBLKCNT',X'0100000000'                     03818
         DC    X'08',X'00',C'PRADDLBL',X'0000100000'                     03819
         DC    X'08',X'01',C'NOPRADDL',X'0000100000'                     03820
         DC    X'08',X'00',C'CORRBLKS',X'0000200000'                     03821
         DC    X'08',X'01',C'NOCORRBL',X'0000200000'                     03822
         DC    X'08',X'00',C'NOEXNULL',X'0000400000'                     03823
         DC    X'08',X'00',C'NOSLNULL',X'0000400000'                     03824
         DC    X'06',X'11',C'EXNULL  ',X'0000400000'                     03825
         DC    X'06',X'01',C'SLNULL  ',X'0000400000'                     03826
         DC    X'06',X'00',C'LBLFIX  ',X'0000800000'                     03827
         DC    X'08',X'01',C'NOLBLFIX',X'0000800000'                     03828
         DC    X'08',X'00',C'INITVOLS',X'0001010000'                     03829
         DC    X'08',X'00',C'INITTAPE',X'0001010000'                     03830
         DC    X'07',X'00',C'LIMFILE ',X'0000020000'                     03831
         DC    X'07',X'00',C'FILELIM ',X'0000020000'                     03832
         DC    X'08',X'01',C'NOLIMFIL',X'0000020000'                     03833
         DC    X'05',X'00',C'BYTES   ',X'0000040000'                     03834
         DC    X'07',X'01',C'NOBYTES ',X'0000040000'                     03835
         DC    X'06',X'00',C'CUMTOT  ',X'0000080000'                     03836
         DC    X'08',X'01',C'NOCUMTOT',X'0000080000'                     03837
         DC    X'08',X'00',C'LIMLABEL',X'0000001000'                     03838
         DC    X'08',X'01',C'NOLIMLAB',X'0000001000'                     03839
         DC    X'06',X'10',C'OPTION  ',X'0000002000'                     03840
         DC    X'08',X'01',C'NOOPTION',X'0000002000'                     03841
         DC    X'07',X'10',C'SUPPWTO ',X'0000004000'                     03842
         DC    X'08',X'01',C'NOSUPPWT',X'0000004000'                     03843
         DC    X'08',X'00',C'LBDQUICK',X'0000008000'                     03844
         DC    X'08',X'01',C'NOLBDQUI',X'0000008000'                     03845
         DC    X'06',X'00',C'CUMSEP  ',X'0000000100'                     03846
         DC    X'08',X'01',C'NOCUMSEP',X'0000000100'                     03847
         DC    X'05',X'00',C'STRIP   ',X'0000000200'                     03846
         DC    X'07',X'11',C'NOSTRIP ',X'0000000200'                     03846
         DC    X'05',X'00',C'NLLIM   ',X'0000000400'                     03846
         DC    X'07',X'01',C'NONLLIM ',X'0000000400'                     03846
         DC    X'05',X'00',C'SLLIM   ',X'0000000800'                     03846
         DC    X'07',X'01',C'NOSLLIM ',X'0000000800'                     03846
         DC    X'07',X'00',C'IDRCOFF ',X'0000000010'                     03846
         DC    X'08',X'01',C'NOIDRCOF',X'0000000010'                     03846
         DC    X'06',X'00',C'HEXPRT  ',X'0000000020'                     03846
         DC    X'08',X'01',C'NOHEXPRT',X'0000000020'                     03846
EFFS     DC    X'FFFFFFFFFFFFFFFF'                                       03848
* --------------------------------------------------------- *            03849
         SPACE 3                                                         03850
         LTORG                                                           03851
         SPACE 3                                                         03852
         DS    0D                                             SBG 09/00  03853
LBNEXLST DC    X'87',AL3(LBNJFCB)                                        03854
LBNJFCB  DC    44F'0'                                                    03855
         DS    0D                                             SBG 09/00  03856
LBLEXLST DC    X'87',AL3(LBLJFCB)                                        03857
LBLJFCB  DC    44F'0'                                                    03858
         DS    0D                                             SBG 05/00  03859
OUTEXLST DC    X'87',AL3(OUTJFCB)                                        03860
OUTJFCB  DC    44F'0'                                                    03861
         DS    0D                                             SBG 06/00  03862
INEXLST  DC    X'87',AL3(INJFCB)                              SBG 06/00  03863
INJFCB   DC    44F'0'                                         SBG 06/00  03864
         SPACE 3                                                         03865
INVOL    DC    C'      '     INPUT VOLUME NAME FROM VOL1 LABEL           03866
INVOLJ   DC    C'      '     INPUT VOLUME NAME FROM JCL VOLUME           03867
VOLORIG  DC    C'      '     JCL VOLUME NAME - FROM VOL1 LABEL           03868
VOLNEW   DC    C'      '     JCL VOLUME NAME - TO SUBSTITUTE             03869
VOLCHG   DC    C'      '                                                 03870
VOLSTG   DC    C'      '    CARD VOLUME NAME - TO OVERLAY OTHERS         03871
VOLALL   DS    0CL96         16 X 6                                      03872
VOLUME1  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03873
VOLUME2  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03874
VOLUME3  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03875
VOLUME4  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03876
VOLUME5  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03877
VOLUME6  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03878
VOLUME7  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03879
VOLUME8  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03880
VOLUME9  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03881
VOLUME10 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03882
VOLUME11 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03883
VOLUME12 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03884
VOLUME13 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03885
VOLUME14 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03886
VOLUME15 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03887
VOLUME16 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               03888
* --------------------------------------------------------- * SBG 05/00  03889
         SPACE 3                                                         03890
IN       DCB   MACRF=(E),DDNAME=IN,DEVD=TA,DSORG=PS,RECFM=U,           X 03891
               EXLST=INEXLST                                             03892
OUT1     DCB   MACRF=(E),DDNAME=OUT1,DEVD=TA,DSORG=PS,RECFM=U,         X 03893
               EXLST=OUTEXLST                                            03894
OUT2     DCB   MACRF=(E),DDNAME=OUT2,DEVD=TA,DSORG=PS,RECFM=U,         X 03895
               EXLST=OUTEXLST                                            03896
OUT3     DCB   MACRF=(E),DDNAME=OUT3,DEVD=TA,DSORG=PS,RECFM=U,         X 03897
               EXLST=OUTEXLST                                            03898
OUT4     DCB   MACRF=(E),DDNAME=OUT4,DEVD=TA,DSORG=PS,RECFM=U,         X 03899
               EXLST=OUTEXLST                                            03900
OUT5     DCB   MACRF=(E),DDNAME=OUT5,DEVD=TA,DSORG=PS,RECFM=U,         X 03901
               EXLST=OUTEXLST                                            03902
OUT6     DCB   MACRF=(E),DDNAME=OUT6,DEVD=TA,DSORG=PS,RECFM=U,         X 03903
               EXLST=OUTEXLST                                            03904
OUT7     DCB   MACRF=(E),DDNAME=OUT7,DEVD=TA,DSORG=PS,RECFM=U,         X 03905
               EXLST=OUTEXLST                                            03906
OUT8     DCB   MACRF=(E),DDNAME=OUT8,DEVD=TA,DSORG=PS,RECFM=U,         X 03907
               EXLST=OUTEXLST                                            03908
OUT9     DCB   MACRF=(E),DDNAME=OUT9,DEVD=TA,DSORG=PS,RECFM=U,         X 03909
               EXLST=OUTEXLST                                            03910
OUT10    DCB   MACRF=(E),DDNAME=OUT10,DEVD=TA,DSORG=PS,RECFM=U,        X 03911
               EXLST=OUTEXLST                                            03912
OUT11    DCB   MACRF=(E),DDNAME=OUT11,DEVD=TA,DSORG=PS,RECFM=U,        X 03913
               EXLST=OUTEXLST                                            03914
OUT12    DCB   MACRF=(E),DDNAME=OUT12,DEVD=TA,DSORG=PS,RECFM=U,        X 03915
               EXLST=OUTEXLST                                            03916
OUT13    DCB   MACRF=(E),DDNAME=OUT13,DEVD=TA,DSORG=PS,RECFM=U,        X 03917
               EXLST=OUTEXLST                                            03918
OUT14    DCB   MACRF=(E),DDNAME=OUT14,DEVD=TA,DSORG=PS,RECFM=U,        X 03919
               EXLST=OUTEXLST                                            03920
OUT15    DCB   MACRF=(E),DDNAME=OUT15,DEVD=TA,DSORG=PS,RECFM=U,        X 03921
               EXLST=OUTEXLST                                            03922
OUT16    DCB   MACRF=(E),DDNAME=OUT16,DEVD=TA,DSORG=PS,RECFM=U,        X 03923
               EXLST=OUTEXLST                                            03924
SYSPRINT DCB   MACRF=PM,DDNAME=SYSPRINT,DSORG=PS,RECFM=FA,LRECL=133,   X 03925
               BLKSIZE=133                                               03926
LABLDUMP DCB   MACRF=PM,DDNAME=LABLDUMP,DSORG=PS,RECFM=FB,LRECL=80,    X 03927
               EXLST=LBLEXLST                                            03928
LABADDIN DCB   MACRF=GM,DDNAME=LABADDIN,DSORG=PS,RECFM=FB,LRECL=80,    X 03929
               EXLST=LBNEXLST,EODAD=LBLINEND                             03930
SYSIN    DCB   MACRF=GM,DDNAME=SYSIN,DSORG=PS,RECFM=FB,LRECL=80,       X 03931
               EODAD=SYSINEND                                            03932
         DC    C' '              BLANK FOR CLEARING AREA      SBG 09/00  03933
LLINE    DC    CL80' '           OUTPUT AREA FOR LABEL DUMP   SBG 09/00  03934
SAVE2TO3 DC    2F'0'                                                     03935
SAVE3REG DC    F'0'                                                      03936
SAVE7BA1 DC    F'0'                                                      03937
SAVE7REG DC    F'0'                                                      03938
SAVE7BAL DC    F'0'                                                      03939
SAVE7RG1 DC    F'0'                                                      03940
SAVE7RG2 DC    F'0'                                                      03941
SAVE7RG3 DC    F'0'                                                      03942
SAVE7RG4 DC    F'0'                                                      03943
R5HXPRT  DC    F'0'                                                      03943
R7HXPRT  DC    F'0'                                                      03943
SAVTRTCS DC    F'0'
         DC    CL4' '                                                    03944
HDR1SAV  DC    CL80' '                                                   03945
HDR2SAV  DC    CL80' '                                                   03946
UHL1SAV  DC    CL80' '                                                   03947
UHL2SAV  DC    CL80' '                                                   03948
UHL3SAV  DC    CL80' '                                                   03949
UHL4SAV  DC    CL80' '                                                   03950
UHL5SAV  DC    CL80' '                                                   03951
UHL6SAV  DC    CL80' '                                                   03952
UHL7SAV  DC    CL80' '                                                   03953
UHL8SAV  DC    CL80' '                                                   03954
CARDIN   DC    CL80' '    SYSIN CARD INPUT AREA                          03955
EXTLBLIN DC    CL80' '    INPUT AREA FOR EXTERNAL LABELS                 03956
         DC    CL80' '    PADDING TO SEPARATE FROM INAREA     SBG 09/00  03957
TRTCSECT CSECT
TRTBL0   DS    0D
         DC    XL16'40404040404040404040404040404040'
         DC    XL16'40404040404040404040404040404040'
         DC    XL16'40404040404040404040404040404040'
         DC    XL16'40404040404040404040404040404040'
         DC    XL16'404040404040404040404A4B4C4D4E4F'
         DC    XL16'504040404040404040405A5B5C5D5E5F'
         DC    XL16'606140404040404040406A6B6C6D6E6F'
         DC    XL16'404040404040404040407A7B7C7D7E7F'
         DC    XL16'40818283848586878889404040404040'
         DC    XL16'40919293949596979899404040404040'
         DC    XL16'4040A2A3A4A5A6A7A8A9404040404040'
         DC    XL16'40404040404040404040404040404040'
         DC    XL16'C0C1C2C3C4C5C6C7C8C9404040404040'
         DC    XL16'D0D1D2D3D4D5D6D7D8D9404040404040'
         DC    XL16'E040E2E3E4E5E6E7E8E9404040404040'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9404040404040'
TRTBL1   DS    0D
         DC    XL16'F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0F0'
         DC    XL16'F1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F1'
         DC    XL16'F2F2F2F2F2F2F2F2F2F2F2F2F2F2F2F2'
         DC    XL16'F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3F3'
         DC    XL16'F4F4F4F4F4F4F4F4F4F4F4F4F4F4F4F4'
         DC    XL16'F5F5F5F5F5F5F5F5F5F5F5F5F5F5F5F5'
         DC    XL16'F6F6F6F6F6F6F6F6F6F6F6F6F6F6F6F6'
         DC    XL16'F7F7F7F7F7F7F7F7F7F7F7F7F7F7F7F7'
         DC    XL16'F8F8F8F8F8F8F8F8F8F8F8F8F8F8F8F8'
         DC    XL16'F9F9F9F9F9F9F9F9F9F9F9F9F9F9F9F9'
         DC    XL16'C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1C1'
         DC    XL16'C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2C2'
         DC    XL16'C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3C3'
         DC    XL16'C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4C4'
         DC    XL16'C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5C5'
         DC    XL16'C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6C6'
TRTBL2   DS    0D
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         DC    XL16'F0F1F2F3F4F5F6F7F8F9C1C2C3C4C5C6'
         EJECT                                                           04164
JFCBLK   DSECT                                                           03958
         IEFJFCBN LIST=YES                                               03959
COPYMODS CSECT                                                           03960
INAREA   DS    CL65535                                        SBG 03/00  03961
#PAN$AUD CSECT                                                           03962
$PAN#AUD DC    CL30'LEVEL 056 COPYMODS  06/23/03 '                       03963
         END                                                             03964
*          DATA SET COPYMOPT   AT LEVEL 056 AS OF 06/23/03               03965
   TITLE 'COPYMOPT -- TAPE COPY PROGRAM OPTIONS DISPLAY'                 03966
**************************************************************           03967
**************************************************************           03968
**                                                          **           03969
**                                                          **           03970
**  MODULE: COPYMOPT                                        **           03971
**                                                          **           03972
**                                                          **           03973
**  PURPOSE:  SUBROUTINE TO DISPLAY EXECUTION OPTIONS THAT  **           03974
**            HAVE BEEN SET FOR A RUN OF THE COPYMODS       **           03975
**            PROGRAM.                                      **           03976
**                                                          **           03977
**                                                          **           03978
**************************************************************           03979
**************************************************************           03980
         EJECT                                                           03981
         YREGS                                                           03982
COPYMOPT CSECT                                                           03983
         USING *,R15                                          SBG 03/00  03984
*  REG 1 IS POINTING TO THE PARM VALUES SET BY THE COPYMODS PROGRAM.     03985
         B     EYECATCH                                       SBG 03/00  03986
         DC    C'--- '            MAKE EYECATCHER VISIBLE     SBG 03/00  03987
         DC    C'COPYMOPT - DISPLAY OPTIONS FOR THE COPYMODS PROGRAM '   03988
         DC    C'&SYSDATE',C'  ',C'&SYSTIME ',C'--- '         SBG 03/00  03989
SAVEAREA DC    18F'0'                                                    03990
EYECATCH DS    0D             ENSURE ALIGNMENT                SBG 03/00  03991
         SAVE  (14,12)                                                   03992
         LR    R5,R1          SAVE PASSED QUANTITY                       03993
         LA    R1,SAVEAREA          NEW SAVE-AREA ADDR                   03994
         ST    R1,8(,R13)           FORWARD SAVE-AREA CHAIN PTR          03995
         ST    R13,4(,R1)           BACKWARD SAVE-AREA CHAIN PTR         03996
         LR    R13,R1               NEW SAVE AREA ADDRESS                03997
         DROP  R15                                                       03998
* -----                       SET UP TWO BASE REGISTERS                  03999
         USING COPYMOPT,R12,R11                                          04000
         LR    R12,R15                                                   04001
         LA    R11,4095(,R12)                                            04002
         LA    R11,1(,R11)                                               04003
         LR    R1,R5          RESTORE PARM POINTER                       04004
OPTMOVE  DS    0H                                                        04005
         MVC   PARMTBIN(5),0(R1)      MOVE PARMS INTO THIS PGM           04006
         SR    R1,R1                  DON'T POINT R1 INTO LAST PGM       04007
         SR    R5,R5                  DON'T POINT R5 INTO LAST PGM       04008
         OPEN  (SYSPRINT,OUTPUT)                                         04009
         MVC   LINE(133),LINE-1       CLEAR LINE                         04010
         MVC   LINE(133),DISPLINH                                        04011
         PUT   SYSPRINT,LINE                                             04012
         MVC   LINE(133),LINE-1       CLEAR LINE                         04013
         MVC   LINE(133),DISPLINO                                        04014
         PUT   SYSPRINT,LINE                                             04015
         MVC   LINE(133),LINE-1       CLEAR LINE                         04016
         PUT   SYSPRINT,LINE                                             04017
         BAL   R7,FILLOPTS                                               04018
         MVC   LINE(133),LINE-1       CLEAR LINE                         04019
         MVC   LINE(133),DISPOP02                                        04020
         PUT   SYSPRINT,LINE                                             04021
         MVC   LINE(133),LINE-1       CLEAR LINE                         04022
         MVC   LINE(133),DISPOP01                                        04023
         PUT   SYSPRINT,LINE                                             04024
         MVC   LINE(133),LINE-1       CLEAR LINE                         04025
         MVC   LINE(133),DISPOP03                                        04026
         PUT   SYSPRINT,LINE                                             04027
         CLOSE (SYSPRINT)                                                04028
* ----------------------------------------------------------------- *    04029
THEEND   EQU   *                                                         04030
THEEND1  DS    0H                                                        04031
         L     R13,4(,R13)                                               04032
         RETURN (14,12),RC=0                                             04033
         EJECT                                                           04034
* - - - - - - - -   SUBROUTINES   - - - - - - - - - - - - - - - - - *    04035
* ----------------------------------------------------------------- *    04036
*    BAL REGISTER IS R7.                                            *    04037
* ------------------------------------------------------------------*    04038
FILLOPTS DS    0H         FILL OPTIONS DISPLAY AREA AND PRINT            04039
         LA    R3,OPTABLE             POINT TO BEGINNING OF TABLE        04040
         LA    R6,DISPLIN1            POINT TO FIRST DISPLAY LINE        04041
         LA    R2,5(,R6)              POINT TO FIRST TARGET LOCATION     04042
FILLBCT  LA    R4,8                   LOAD BCT QUANTITY                  04043
FILLOOP  CLC   =X'FFFFFFFF',0(R3)                                        04044
         BE    FILOPEND                                                  04045
         MVC   PARMWORK(5),0(R3)      MOVE BYTES TO BE TESTED            04046
         NC    PARMWORK(5),PARMTBIN   CHECK IF BYTE IS ON                04047
         BZ    FILLZER                                                   04048
         MVC   0(10,R2),5(R3)         MOVE OPTION TO DISPLAY - BIT ON    04049
         LA    R3,OPTENTLN(,R3)       BUMP TO NEXT TABLE ENTRY           04050
         LA    R2,12(,R2)             BUMP TO NEXT DISPLAY AREA          04051
         BCT   R4,FILLOOP             LOOP BACK                          04052
         B     FILNEXTB                                                  04053
FILLZER  DS    0H                                                        04054
         MVC   0(10,R2),15(R3)        MOVE OPTION TO DISPLAY - BIT OFF   04055
         LA    R3,OPTENTLN(,R3)       BUMP TO NEXT TABLE ENTRY           04056
         LA    R2,12(,R2)             BUMP TO NEXT DISPLAY AREA          04057
         BCT   R4,FILLOOP             LOOP BACK                          04058
FILNEXTB DS    0H                                                        04059
         MVC   LINE(133),LINE-1       CLEAR OUTPUT AREA                  04060
         MVC   LINE(133),0(R6)        MOVE OPTION DISPLAY INTO LINE      04061
         PUT   SYSPRINT,LINE                                             04062
         LA    R6,133(,R6)            POINT TO BEGINNING OF NEXT LINE    04063
         LA    R2,37(,R2)             BUMP DISPLAY AREA TO NEXT LINE     04064
         B     FILLBCT                RELOAD BCT QUANTITY AND RELOOP     04065
FILOPEND BR    R7                                                        04066
* ----------------------------------------------------------------- *    04067
* ----------  CONSTANTS  ------------------------------------------ *    04068
         LTORG                                                           04069
         DS    0F                                                        04070
PARMTBIN DC    X'0000000000'                                             04071
PARMWORK DC    X'0000000000'                                             04072
PARMZERO DC    X'0000000000'                                             04073
OPTABLE  DS    0D                                                        04074
         DC    X'2000000000',C'LTMSKIP   ',C'LTMCOPY   '                 04075
OPTENTLN EQU   *-OPTABLE                                                 04076
         DC    X'0100000000',C'BLKCNT    ',C'NOBLKCNT  '                 04077
         DC    X'0200000000',C'HDR1      ',C'NOHDR1    '                 04078
         DC    X'0400000000',C'HDR2      ',C'NOHDR2    '                 04079
         DC    X'0800000000',C'EOF1      ',C'NOEOF1    '                 04080
         DC    X'1000000000',C'EOF2      ',C'NOEOF2    '                 04081
         DC    X'4000000000',C'EOV1      ',C'NOEOV1    '                 04082
         DC    X'8000000000',C'EOV2      ',C'NOEOV2    '                 04083
         DC    X'0010000000',C'LABLDUMP  ',C'NOLABLDU  '                 04084
         DC    X'0020000000',C'SYSIN     ',C'NOSYSIN   '                 04085
         DC    X'0040000000',C'OUTVOL ***',C'NOOUTVOL  '                 04086
         DC    X'0080000000',C'LABADDIN  ',C'NOLABADD  '                 04087
         DC    X'0001000000',C'CHGVOL    ',C'NOCHGVOL  '                 04088
         DC    X'0002000000',C'VOLLBL    ',C'NOVOLLBL  '                 04089
         DC    X'0004000000',C'EOVCHG    ',C'NOEOVCHG  '                 04090
         DC    X'0008000000',C'READONLY  ',C'WRITE     '                 04091
         DC    X'0000100000',C'PRADDLBL  ',C'NOPRADDL  '                 04092
         DC    X'0000200000',C'CORRBLKS  ',C'NOCORRBL  '                 04093
         DC    X'0000400000',C'NOEXNULL  ',C'EXNULL    '                 04094
         DC    X'0000800000',C'LBLFIX    ',C'NOLBLFIX  '                 04095
         DC    X'0000010000',C'INITVOLS  ',C'          '                 04096
         DC    X'0000020000',C'LIMFILE **',C'NOLIMFIL  '                 04097
         DC    X'0000040000',C'BYTES     ',C'NOBYTES   '                 04098
         DC    X'0000080000',C'CUMTOT    ',C'NOCUMTOT  '                 04099
         DC    X'0000001000',C'LIMLABEL *',C'NOLIMLAB  '                 04100
         DC    X'0000002000',C'OPTION    ',C'NOOPTION  '                 04101
         DC    X'0000004000',C'SUPPWTO   ',C'NOSUPPWT  '                 04102
         DC    X'0000008000',C'LBDQUICK  ',C'NOLBDQUI  '                 04103
         DC    X'0000000100',C'CUMSEP    ',C'NOCUMSEP  '                 04104
         DC    X'0000000200',C'STRIP     ',C'NOSTRIP   '                 04105
         DC    X'0000000400',C'NLLIM     ',C'NONLLIM   '                 04106
         DC    X'0000000800',C'SLLIM     ',C'NOSLLIM   '                 04107
         DC    X'0000000010',C'IDRCOFF   ',C'NOIDRCOF  '                 04108
HXPRT    DC    X'0000000020',C'HEXPRT    ',C'NOHEXPRT  '                 04109
         DC    X'0000000040',C'          ',C'          '                 04110
         DC    X'0000000080',C'          ',C'          '                 04111
         DC    X'0000000001',C'          ',C'          '                 04112
         DC    X'0000000002',C'          ',C'          '                 04113
         DC    X'0000000004',C'          ',C'          '                 04114
         DC    X'0000000008',C'          ',C'          '                 04115
         DC    X'FFFFFFFFFF'                                             04116
         ORG   HXPRT+10
         DS    0CL4
HXPRTNUM DS    CL4
         ORG
*  -----                                                                 04117
DISPAREA DS    0D                                                        04118
DISPLINH DS    0CL133                                                    04119
         DC    C'1    COPYMODS PROGRAM - EXTENDED TAPE COPY PROGRAM - '  04120
         DC    C'LEVEL 056 - OPTIONS DISPLAY                          '  04121
         DC    27C' '                                                    04122
DISPLINO DS    0CL133                                                    04123
         DC    C'-    OPTIONS IN EFFECT:                              '  04124
         DC    C'                                                     '  04125
         DC    27C' '                                                    04126
DISPOP01 DS    0CL133                                                    04127
         DC    C'      **  THE LIMFILE OPTION IS ONLY SET BY THE  FILE'  04128
         DC    C'LIMIT=   SYSIN CARD                                  '  04129
         DC    27C' '                                                    04130
DISPOP02 DS    0CL133                                                    04131
         DC    C'      *   THE LIMLABEL OPTION IS ONLY SET BY THE LABE'  04132
         DC    C'LIMIT=   SYSIN CARD                                  '  04133
         DC    27C' '                                                    04134
DISPOP03 DS    0CL133                                                    04135
         DC    C'      *** THE OUTVOL OPTION IS ONLY SET BY THE   TAPE'  04136
         DC    C'OWNER=   OR OUTVOLALL=   SYSIN CARDS                 '  04137
         DC    27C' '                                                    04138
SYSPRINT DCB   MACRF=PM,DDNAME=SYSPRINT,DSORG=PS,RECFM=FA,LRECL=133,   X 04139
               BLKSIZE=133                                               04140
         DC    C' '                                                      04141
LINE     DS    CL133                                                     04142
DISPLIN1 DS    0CL133                                                    04143
         DC    C'0    '                                                  04144
DISPL1A  DC    8CL12' '                                                  04145
         DC    32C' '                                                    04146
DISPLIN2 DS    0CL133                                                    04147
         DC    C'     '                                                  04148
DISPL2A  DC    8CL12' '                                                  04149
         DC    32C' '                                                    04150
DISPLIN3 DS    0CL133                                                    04151
         DC    C'     '                                                  04152
DISPL3A  DC    8CL12' '                                                  04153
         DC    32C' '                                                    04154
DISPLIN4 DS    0CL133                                                    04155
         DC    C'     '                                                  04156
DISPL4A  DC    8CL12' '                                                  04157
         DC    32C' '                                                    04158
DISPLIN5 DS    0CL133                                                    04159
         DC    C'     '                                                  04160
DISPL5A  DC    8CL12' '                                                  04161
         DC    32C' '                                                    04162
         SPACE 3                                                         04163
         EJECT                                                           04164
@PAN$AUD CSECT                                                           04165
$PAN#AUD DC    CL30'LEVEL 056 COPYMOPT  06/23/03 '                       04166
         END                                                             04167
