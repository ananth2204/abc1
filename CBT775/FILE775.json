{"INMR01": {"INMLRECL": 80, "INMFNODE": "N1", "INMFUID": "SBGOLOB", "INMTNODE": "A", "INMTUID": "A", "INMFTIME": "20201220012756000000", "INMNUMF": 1}, "INMR02": {"1": {"INMUTILN": "IEBCOPY", "INMSIZE": 411502, "INMDSORG": "PO", "INMTYPE": "None", "INMLRECL": 80, "INMBLKSZ": 5600, "INMRECFM": "FB", "INMDIR": 7, "INMDSNAM": "CBT.V500.FILE775.PDS", "numfile": 1}, "2": {"INMUTILN": "INMCOPY", "INMSIZE": 411502, "INMDSORG": "PS", "INMLRECL": 32756, "INMBLKSZ": 3120, "INMRECFM": "VS", "numfile": 1}}, "INMR03": {"1": {"INMSIZE": 411502, "INMDSORG": "PS", "INMLRECL": 80, "INMRECFM": "?"}}, "file": {"CBT.V500.FILE775.PDS": {"COPYR1": {"type": "PDS", "DS1DSORG": 512, "DS1BLKL": 5600, "DS1LRECL": 80, "DS1RECFM": "FB", "DS1KEYL": 0, "DS1OPTCD": 0, "DS1SMSFG": 0, "file_tape_blocksize": 3120, "DVAOPTS": 12336, "DVACLASS": 32, "DVAUNIT": 15, "DVAMAXRC": 32760, "DVACYL": 3340, "DVATRK": 15, "DVATRKLN": 58786, "DVAOVHD": 0, "num_header_records": 2, "DS1REFD": "200354", "DS1SCEXT": "b'\\x00\\x00\\x00'", "DS1SCALO": "b'\\x80\\x00\\x00\\xbe'", "DS1LSTAR": "b'\\x00\\x07\\x07'", "DS1TRBAL": "b'Uf'"}, "COPYR2": {"deb": "b'\\x01\\x00\\x00\\x00\\xff\\x00\\x00\\x00\\x8f\\x03\\xa0\\x00\\x04\\x9a\\xc0\\xd8'", "extents": ["b'\\x01\\x00\\x00\\x00\\xff\\x00\\x00\\x00\\x8f\\x03\\xa0\\x00\\x04\\x9a\\xc0\\xd8'", "b'X\\xf4\\xfd\\xd0\\x00\\x00\\x05J\\x00\\x07\\x05J\\x00\\x0e\\x00\\x08'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", "b'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'"]}, "members": {"$$$#DATE": {"ttr": 516, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x04K\\x00\\x00\\x01\\x075\\x1f\\x01\\x075\\x1f\\x13\\x07\\x00\\x0c\\x00\\x0c\\x00\\x00\\xc3\\xc2\\xe3`\\xf4\\xf7\\xf5@@@'", "ispf": {"version": "04.75", "flags": 0, "createdate": "2007-12-17T00:00:00", "modifydate": "2007-12-17T13:07:00", "lines": 12, "newlines": 12, "modlines": 0, "user": "CBT-475"}, "text": "REGULAR CBT TAPE - VERSION 475    FILE:  775\n\n    ORIGINAL DSNAME:  SBGOLOB.CBT475.FILE775\n    ---------------\n                    --RECFM-LRECL-BLKSIZE-DSORG\n                      FB    80    5600    PO\n\n   PDS117I 8 MEMBERS COUNTED; CUMULATIVE SIZE IS 3,357 RECORDS\n\n\nTIME THIS PDS WAS SHIPPED:   12/17/07    13:07:03    GMT-5:00\n\n", "mimetype": "text/plain", "datatype": "iso-8859-1", "extension": ".txt"}, "$$NOTE1": {"ttr": 518, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x02\\x00\\x15\\x01\\x075\\x1f\\x01\\x075\\x1f\\x12S\\x00!\\x00\\x15\\x00\\x00\\xe2\\xc2\\xc7\\xd6\\xd3\\xd6\\xc2@@@'", "ispf": {"version": "01.02", "flags": 0, "createdate": "2007-12-17T00:00:00", "modifydate": "2007-12-17T12:53:15", "lines": 33, "newlines": 21, "modlines": 0, "user": "SBGOLOB"}, "text": "Subject: New submission, in support of SHARE presentation 8247\nFrom:    \"Schneiderwent, Craig\" <craig.schneiderwent@dot.state.wi.us>\nDate:    Mon, 17 Dec 2007 10:50:19 -0600\nTo:      \"'sbgolob@cbttape.org'\" <sbgolob@cbttape.org>\n\n ---------------------------------------------------------------------\n\nInstallation Note:  This pds was created from Craig's zip file, and\n    its members are in a modified IEBUPDTE-like format, which preserves\n    ISPF statistics, called PDSLOAD format.  To restore the pds'es\n    that contain the source and copybook members, please run the job\n    in the member called $PDSLOAD.  It will create a temporary load\n    library containing the PDSLOAD program, and will then STEPLIB to\n    it, and create the install pds'es required.\n\n ---------------------------------------------------------------------\n\nThe enclosed file contains COBOL source code and copybooks for a\nproof-of-concept application I wrote, CICS COBOL responding to HTTP\nrequests.  This proof-of-concept application is the subject of SHARE\npresentation 8247, presented in San Diego in August of 2007 and to be\npresented again in Orlando in February of 2008.\n\nI'd like to point people at the cbttape.org website for these files\ninstead of the SHARE website because the SHARE site administrators\ninsist that all files be in Adobe PDF format.  I think the XMIT\nformat is more friendly to mainframe source code.\n\n\nBest wishes,\n\nCraig Schneiderwent\n\n", "mimetype": "text/plain", "datatype": "ebcdic", "extension": ".txt"}, "$INSNOTE": {"ttr": 520, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x01\\x00X\\x01\\x075\\x1f\\x01\\x075\\x1f\\x12R\\x00\\x07\\x00\\x07\\x00\\x00\\xe2\\xc2\\xc7\\xd6\\xd3\\xd6\\xc2@@@'", "ispf": {"version": "01.01", "flags": 0, "createdate": "2007-12-17T00:00:00", "modifydate": "2007-12-17T12:52:58", "lines": 7, "newlines": 7, "modlines": 0, "user": "SBGOLOB"}, "text": "Installation Note:  This pds was created from Craig's zip file, and\n    its members are in a modified IEBUPDTE-like format, which preserves\n    ISPF statistics, called PDSLOAD format.  To restore the pds'es\n    that contain the source and copybook members, please run the job\n    in the member called $PDSLOAD.  It will create a temporary load\n    library containing the PDSLOAD program, and will then STEPLIB to\n    it, and create the install pds'es required.\n", "mimetype": "text/plain", "datatype": "unknown-8bit", "extension": ".txt"}, "$PDSLOAD": {"ttr": 522, "alias": false, "halfwords": 30, "notes": 0, "parms": "b\"\\x01\\x15\\x00\\x04\\x01\\x026_\\x01\\x075\\x1f\\x12W\\x00'\\x00\\x08\\x00\\x00\\xe2\\xc2\\xc7\\xd6\\xd3\\xd6\\xc2@@@\"", "ispf": {"version": "01.21", "flags": 0, "createdate": "2002-12-31T00:00:00", "modifydate": "2007-12-17T12:57:04", "lines": 39, "newlines": 8, "modlines": 0, "user": "SBGOLOB"}, "text": "//SBGOLOBL JOB (ACCT#),PDSLOAD,\n// NOTIFY=&SYSUID,\n// CLASS=B,MSGCLASS=X\n//* --------------------------------------------------- *//\n//*      PDSLOAD JOB TO CREATE INSTALL LIBRARIES        *//\n//*         Change 'yourid.' to your userid ---         *//\n//*         Change 'volser'  to your output volser      *//\n//*     (THIS JOB WAS TESTED TO WORK ON MY SYSTEM)      *//\n//* --------------------------------------------------- *//\n//TSOBATCH EXEC PGM=IKJEFT01\n//SYSTSPRT DD SYSOUT=*\n//SYSTSIN DD *\n   RECEIVE INDS('this.pds.name(PDSLOAD)')\n   DSN ('yourid.TEMP.PDSLOAD') VOL(volser)\n/*\n//*\n//PDSLOAD PROC IPDS='yourid.CBT475.FILE775',       <=== CHANGE\n//             OPRE=yourid,\n//             QUAL=FILE775,\n//             MEMB=XXX,\n//             OUNT=SYSALLDA,\n//             OVL=volser,\n//             DSP1=NEW,\n//             DSP2=CATLG,\n//             DSP3='',\n//             P=30,S=60,D=44\n//*\n//LOAD   EXEC PGM=PDSLOAD\n//STEPLIB  DD DISP=SHR,DSN=yourid.TEMP.PDSLOAD\n//SYSPRINT DD SYSOUT=*\n//SYSUT1   DD DISP=SHR,DSN=&IPDS(&MEMB)\n//SYSUT2   DD UNIT=&OUNT,VOL=SER=&OVL,\n//             DSN=&OPRE..&QUAL..&MEMB,\n//             DISP=(&DSP1,&DSP2&DSP3),\n//             SPACE=(TRK,(&P,&S,&D),RLSE)\n//  PEND\n//*\n//S001 EXEC PDSLOAD,MEMB=COPYBOOK\n//S002 EXEC PDSLOAD,MEMB=SOURCE\n", "mimetype": "text/plain", "datatype": "unknown-8bit", "extension": ".txt"}, "@FILE775": {"ttr": 524, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x04K\\x00\\x00\\x01\\x075\\x1f\\x01\\x075\\x1f\\x13\\x06\\x00\\x13\\x00\\x13\\x00\\x00\\xc3\\xc2\\xe3`\\xf4\\xf7\\xf5@@@'", "ispf": {"version": "04.75", "flags": 0, "createdate": "2007-12-17T00:00:00", "modifydate": "2007-12-17T13:06:00", "lines": 19, "newlines": 19, "modlines": 0, "user": "CBT-475"}, "text": "//***FILE 775 is from Craig Schneiderwent and contains a proof of   *   FILE 775\n//*           concept application allowiing CICS COBOL to respond   *   FILE 775\n//*           to HTTP requests.  This proof-of-concept application  *   FILE 775\n//*           is the subject of SHARE presentation 8247, presented  *   FILE 775\n//*           in San Diego in August of 2007 and to be presented    *   FILE 775\n//*           again in Orlando in February of 2008.                 *   FILE 775\n//*                                                                 *   FILE 775\n//*       email:  craig.schneiderwent@dot.state.wi.us               *   FILE 775\n//*                                                                 *   FILE 775\n//*       The two significant members of this pds, called SOURCE    *   FILE 775\n//*       and COPYBOOK, are in an IEBUPDTE-like unloaded pds        *   FILE 775\n//*       format called PDSLOAD-format.  A job to create the two    *   FILE 775\n//*       required pds'es is included here, and it is in the        *   FILE 775\n//*       member $PDSLOAD.  The member called PDSLOAD contains      *   FILE 775\n//*       the PDSLOAD program, in TSO XMIT format, and it is        *   FILE 775\n//*       unloaded into a real load library by the $PDSLOAD job.    *   FILE 775\n//*                                                                 *   FILE 775\n//*       Enjoy!  (SG-12/07)                                        *   FILE 775\n//*                                                                 *   FILE 775\n", "mimetype": "text/plain", "datatype": "unknown-8bit", "extension": ".txt"}, "COPYBOOK": {"ttr": 526, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x00\\x00\\x00\\x01\\x075\\x1f\\x01\\x075\\x1f\\x128\\x01v\\x01v\\x00\\x00\\xc4\\xd6\\xe3\\xc3\\xe6\\xe2@@@@'", "ispf": {"version": "01.00", "flags": 0, "createdate": "2007-12-17T00:00:00", "modifydate": "2007-12-17T12:38:00", "lines": 374, "newlines": 374, "modlines": 0, "user": "DOTCWS"}, "text": "./ ADD NAME=$DEBUG01 0113-05224-05229-1521-00044-00006-00078-DOTCWS\n      *\n      * Created 16-Aug-2005 Craig Schneiderwent\n      *\n      * $DEBUG01, $DEBUG02, $DEBUG03 and $DEBUG04 comprise a set of\n      * debugging copybooks for use in COBOL programs.\n      *\n      * Place a \"COPY '$DEBUG01'.\" in the Configuration Section,\n      * a \"COPY '$DEBUG02'.\" statement in Working-Storage,\n      * a \"COPY '$DEBUG03'.\" as the first statement in the\n      * Procedure Division,\n      * and optionally a \"COPY '$DEBUG04'.\" in every spot you\n      * would like a CEE3DMP display of your Working-Storage.\n      *\n      * To enable this code, you must run with the LE runtime option\n      * \"DEBUG\".  This is done on the PARM line in your execution JCL:\n      *\n      * //TESTME   EXEC PGM=J8675309,PARM='/DEBUG'\n      *\n      * or, if you are running under IKJEFT01 or its brethren:\n      *\n      * //SYSTSIN  DD  *\n      *  DSN SYSTEM(D00S)\n      *  RUN  PROGRAM(J8675309) PLAN(J8675309) -\n      *  PARMS('/DEBUG')\n      *  END\n      *\n      * To disable this code completely, so it is not even compiled,\n      * comment out the \"COPY '$DEBUG01'.\" in the Configuration Section.\n      *\n      * To disable this code, so it is present but does not execute,\n      * you must run with the LE runtime option \"NODEBUG\".  This is\n      * done on the PARM line in your execution JCL:\n      *\n      * //TESTME   EXEC PGM=J8675309,PARM='/NODEBUG'\n      *\n      * or, if you are running under IKJEFT01 or its brethren:\n      *\n      * //SYSTSIN  DD  *\n      *  DSN SYSTEM(D00S)\n      *  RUN  PROGRAM(J8675309) PLAN(J8675309) -\n      *  PARMS('/NODEBUG')\n      *  END\n      *\n       Source-Computer. IBM-zSeries With Debugging Mode.\n./ ADD NAME=$DEBUG02 0108-05228-05229-1523-00029-00019-00036-DOTCWS\n      *\n      * Required by copybooks $DEBUG03 and $DEBUG04.\n      *\n       01  CEE3DMP-APLC-DEBUG-AREA.\n           05  APLC-DEBUG-ON-SW         PIC X(001) VALUE 'N'.\n               88  APLC-DEBUG-ON                  VALUE 'Y'.\n           05  CEE3DMP-TITL.\n               10                       PIC X(010) VALUE '+=+=+=+=+='.\n               10  CEE3DMP-TITL-SPFC.\n                   15  CEE3DMP-TITL-NM  PIC X(030) VALUE SPACES.\n                   15                   PIC X(001) VALUE SPACES.\n                   15  CEE3DMP-TITL-LN  PIC X(006) VALUE SPACES.\n                   15                   PIC X(001) VALUE SPACES.\n                   15  CEE3DMP-TITL-LBL PIC X(022) VALUE SPACES.\n               10                       PIC X(010) VALUE '+=+=+=+=+='.\n           05  CEE3DMP-OPTIONS          PIC X(255)\n               VALUE                                       'NOTRACEBACK\n      -                                                'THREAD(CURRENT)\n      -                                                      'VARIABLES\n      -                                                       'NOBLOCKS\n      -                                                      'NOSTORAGE\n      -                                                  'STACKFRAME(0)\n      -                                                   'PAGESIZE(60)\n      -                                                    'NOCONDITION\n      -                                                        'NOENTRY\n      -                                               'ENCLAVE(CURRENT)\n      -                                                     'REGSTOR(0)\n      -                                                  'NOGENOPTS '.\n           05  CEE3DMP-LEFB-CD          PIC X(012).\n./ ADD NAME=$DEBUG03 0107-05228-05228-1353-00020-00007-00025-DOTCWS\n       Declaratives.\n       Debug-Trace Section.\n           USE FOR DEBUGGING ON ALL PROCEDURES.\n       DEBUG-ACTION.\n           SET APLC-DEBUG-ON OF CEE3DMP-APLC-DEBUG-AREA TO TRUE\n           MOVE SPACES\n             TO CEE3DMP-TITL-SPFC OF CEE3DMP-APLC-DEBUG-AREA\n           MOVE DEBUG-NAME\n             TO CEE3DMP-TITL-NM OF CEE3DMP-APLC-DEBUG-AREA\n           MOVE DEBUG-LINE\n             TO CEE3DMP-TITL-LN OF CEE3DMP-APLC-DEBUG-AREA\n           DISPLAY\n               DEBUG-CONTENTS\n               SPACE\n               DEBUG-NAME\n               SPACE\n               DEBUG-LINE\n           .\n       End Declaratives.\n\n./ ADD NAME=$README  0104-07348-07351-1031-00014-00009-00000-DOTCWS\nThis dataset contains the copybooks needed to compile the source code\nfor SHARE session 8247 - Writing a web-enabled CICS/COBOL application,\npresented at SHARE 109 in San Diego in August of 2007 and SHARE 110 in\nOrlando in February of 2008.\n\nContact information: cschneidpublic@yahoo.com\n\nMember\n$DEBUG01  used to enable a paragraph trace of execution\n$DEBUG02  data areas used by $DEBUG03\n$DEBUG03  DECLARATIVES section to enable a paragraph trace\nIMAG      the SHARE logo\nJ7200521  commarea needed to call J7200521\n\n./ ADD NAME=IMAG     0101-07099-07099-1613-00234-00234-00000-DOTCWS\n      *    SHARE LOGO\n           05  PIC X(100)\n               VALUE          X'FFD8FFE000104A46494600010200006400640000\n      -                        'FFEC00114475636B79000100040000003C0000FF\n      -                        'EE002641646F62650064C0000000010300150403\n      -                        '060A0D000004BB0000079C00000B1C00000F18FF\n      -                      'DB0084000604040405040605050609060506090B'.\n           05  PIC X(100)\n               VALUE          X'080606080B0C0A0A0B0A0A0C100C0C0C0C0C0C10\n      -                        '0C0E0F100F0E0C1313141413131C1B1B1B1C1F1F\n      -                        '1F1F1F1F1F1F1F1F010707070D0C0D181010181A\n      -                        '1511151A1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F\n      -                      '1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F1F'.\n           05  PIC X(100)\n               VALUE          X'1F1F1F1F1F1F1F1F1F1F1F1F1FFFC2001108007B\n      -                        '007D03011100021101031101FFC400D400010001\n      -                        '0501000000000000000000000000030204050607\n      -                        '0101010101010101000000000000000000000001\n      -                      '0203040510000104010304010304030000000000'.\n           05  PIC X(100)\n               VALUE          X'0003000102040520111210301306144050157021\n      -                        '333531323411000102040205070A050500000000\n      -                        '00000111020021120331041041712213205161A1\n      -                        '325223308191B1D1E14262721450C1B23373F182\n      -                      '9263241200010500000000000000000000000000'.\n           05  PIC X(100)\n               VALUE          X'4050708011211301000202010303040203010100\n      -                        '0000000100112131411051613071A1208191C1F0\n      -                        'B14050D17060FFDA000C03010002110311000001\n      -                        'EA800000044608D70B837D0000010B38ED73C46B\n      -                      '96999EDA867B460DD93A116C6CA002CAF3D4FAF9'.\n           05  PIC X(100)\n               VALUE          X'2D6E2928B3C4B2E7EBC373F4D2BB3A7452500031\n      -                        'FAE5AB74F28B99AF56DAE319AE5AD63D1ADF2F6E\n      -                        'F09D7000016579EBDD3CFE9411A485BDCE235C79\n      -                        'FF009FEA6E6BD7000016B718ED73AA5A6C819C76\n      -                      'B9DA6B16979E93C7DDB4E7B75600161AE50335AC'.\n           05  PIC X(100)\n               VALUE          X'654B0DCDADCD092ADD4D5E63ADEB4000042CC165\n      -                        'C4BE122D4A000000000000000000000000000001\n      -                        'A597A6CE6900DDCD7CC31BC9A89873A01AD98F37\n      -                        'A073531875D38928EDA9C94C5AF694E686057B2A\n      -                      '73F30076805B959290027202A2B233C2623212EC'.\n           05  PIC X(100)\n               VALUE          X'18A222B23252A213C0545D162547A66800000000\n      -                        '0000000000000000FFDA0008010100010502EC90\n      -                        'A21B1BD8312247F701AC1E6AE5FBFD89985044CA\n      -                        '558A3E64CED7B259D75324E6FD3D4DDA37C99BC6\n      -                      'C1FF002778BA6E166204ECD99AE2B8A78A60926A'.\n           05  PIC X(100)\n               VALUE          X'CFAF908A5530E04D90C709607207BD6C6210DB4D\n      -                        'FF00F9B8AE2ABF898BE71C512D599292C956FD97\n      -                        'A8FF0063AAE7F0715C53C570775F08EEAD578894\n      -                        'E2CEC5878C9EA3FD8EAB0DC86D5E6BC4264F2132\n      -                      '91CAA6F2752525928ED6BD4C266BBA0FF35E7F08'.\n           05  PIC X(100)\n               VALUE          X'D34D5435C6CCB8A932932F8C6926C611D47175D9\n      -                        '428D484B59BFD22392F1AF1413462DF6ACB7B04A\n      -                        'A5AC7DDCB96C2867CCF989E7CD1CC2CD653F1F5B\n      -                        '19EC26B379673346C74CBEC991AEE02C4C1CE65C\n      -                      'B8E41CBE709D73AD8625DF5D3DBFC9A3D6F95EC0'.\n           05  PIC X(100)\n               VALUE          X'0ADF17D817B19496F2D90FC955BE22C0A2F71FE5\n      -                        'C806C5755A70257F7154E78F8BF4257AE5431086\n      -                        'CBC00E7E00735E007398444518C62D30848A400C\n      -                        '9A3168B4C2222F8957A9E0462BBDC929CEDB294E\n      -                      'D415639A64B312F8E73BBBBCEF6FBDA74D3B880F'.\n           05  PIC X(100)\n               VALUE          X'6242246CC4EE6B8CA6F6A3F62FFFDA0008010200\n      -                        '010502FA6D9715B76DB53F69B5BF65B4EFF46FAF\n      -                        '7D7BADFF0045BFFFDA0008010300010502FA5DD7\n      -                        '365E44D367EDC9D6FA3651776ED4BAB2DD6FD072\n      -                      'ECCB4F1526E8DD875B75DF40FF00C697DD715C76'.\n           05  PIC X(100)\n               VALUE          X'D3B2E0B8266EC3F5DBF42BFFDA0008010202063F\n      -                        '02801FFFDA0008010302063F0249D069C6FFDA00\n      -                        '08010101063F02F22B71E1839DC523F7AB3CCC9F\n      -                        'BA3C0B04F4BCA750587B2ED22D8B65C1AD1AD479\n      -                      '1DE781B4C4897EC8F0581A79DD3F644EEA33FD52'.\n           05  PIC X(100)\n               VALUE          X'F7C2BDC5C79CCF4DD73A4D168AB8E1DA1148BBC4\n      -                        '7F76D82FF547FCD90B89DEBC45B1C92F676A37AE\n      -                        '1E46E34BB6456ACCB9D75941097B34FBCE18B6CB\n      -                        '13ADD1FF003E45AE3DEBEE2FEA908B997BE19F6F\n      -                      'C23E0B5A03711096D818399A1394EF3695BB8478'.\n           05  PIC X(100)\n               VALUE          X'765A3A5DBD137903984BD5A38CDC476FDBA2E7F1\n      -                        '1FD43967CDC8905852291CEE94311D517098820E\n      -                        '0718733BA522E7F11FD4DE596899E689EEED89B9\n      -                        '7646EDB5DB12348E8944CAE93F30061F70B1C2DF\n      -                      '0C8AD2588D7C94B258D66B73949F4478D997BBA1'.\n           05  PIC X(100)\n               VALUE          X'9B83AA1C6D042E452A49E4C9B1BCE03AE3795D15\n      -                        '0B2DABBC93F4F91C34C87E15F6B62D712F494BB0\n      -                        '53808E1E732A2D3109AC7F53A3EC4DB6D1C42CAE\n      -                        '6B28FB116DB471032B9ACF436E34075C7B91AD3D\n      -                      '7032D98B42D543771C71F568B4D65B6BF88092BD'.\n           05  PIC X(100)\n               VALUE          X'116CE67261ACB936CF11D18C32EB7B371A1C3CF1\n      -                        '6786C0FE22AAF427B618E190F0DE86A9E075E973\n      -                        '6FBEE59CCB4057B454D32940B565EEB9969D6B85\n      -                        '3A8A6AD176C554712EB85516B2F557C3BAD15686\n      -                      '652D6F70D1AD6FCCEC62D66734C0CBB22DA51373'.\n           05  PIC X(100)\n               VALUE          X'6436E326D78A879E32DF4BBF28C9DDCC5CFBAB6F\n      -                        '607318F5403BB8C5A7B0231CD05A3A1232BFDFF9\n      -                        '4592ECE5F0F14936E9DD5E6C74F8969AFF00A803\n      -                        '096D818399A13457C36D7DE40B15F0DB5F7902E8\n      -                      'AF86DAFBC8163C4635E98541611A100C008F118D'.\n           05  PIC X(100)\n               VALUE          X'7A61505801D6DAE0DECA81284684030023C4635E\n      -                        '9854163F659FE234DCB96D5686A199D7394F547C\n      -                        '41CD2B84BB07D660A2E2525F520D92105150071C\n      -                        '3A5DAFD101A4AB29AAA44D683D516EB574CD7C35\n      -                      '1A8A75C3C356584B6FA63A2AEEEA9FBA02D5D211'.\n           05  PIC X(100)\n               VALUE          X'0769BEF818A553DDD8A366302AEDD532E08ADD92\n      -                        '8B971AA855313A9BB7A7543A44E1F0FCBED8716D\n      -                        '4BA822FC476FE05FFFDA0008010103013F21F47C\n      -                        '2E503E61AD90E27E67ED0963BC187F07798E3509\n      -                      '81996DD3E8FC1584DB878FEDA884E2D7FC462CAC'.\n           05  PIC X(100)\n               VALUE          X'F0BE75FBCF27CD57E5EAA11AFC1DD752AA789C3F\n      -                        '8A7CCB94E5AF7829B7E9A0CA205E76CE24F61A3F\n      -                        '054547A07294F059B40EC29F62DB893835BC1C6B\n      -                        'F89A346BF3030CD81783FD0670CF0FD40F8FA8DF\n      -                      'BDFDA1D3260BAE3B5F98EEE7917CC26BD90BFA40'.\n           05  PIC X(100)\n               VALUE          X'ADB961B5B801C9FF001E8AD37EFF00F6875CBF48\n      -                        'BB10051EF041D4EC0B35E47B3052B0A1E18ABF27\n      -                        'FC7A0B1B84B86F73B28F29CAFC0FED9A117777F1\n      -                        '2BD176090CDB2EEB72EEE097E3F807EA3BF04486\n      -                      'DF5C38FA40AB6E51F0313F222AFD88A2B39A14F7'.\n           05  PIC X(100)\n               VALUE          X'62BB8F4B6EA72DF771FDCD5CF8CBF537D7F7A3E2\n      -                        '04AD9420D3DD6FA01586724E653DE51E61CE5FBC\n      -                        'D087B7FAA186D888328065C3DE5E4B25F5668D39\n      -                        'E898B394C16CF6E2146DE530573DB9E9B2146556\n      -                      'D63B461B3A8CB0A8DF7E8014246E2C76F7838331'.\n           05  PIC X(100)\n               VALUE          X'2346D8732D1E837746CBFCCF3C6D71DAA8AD86A0\n      -                        'E1F79DBA97E46B4A1B1BB06B885EE5B710DA96D7\n      -                        '5D0F81105D6DD63B41E626157A759EFD035B8B4C\n      -                        '39BF420EE3BF850E49AA230D4ABE0593F8DEF0CD\n      -                      '81A3105F8326A0D63FF42087DA6B2AFC1034114B'.\n           05  PIC X(100)\n               VALUE          X'C78EAE5B7DFF00B519E17A81F82BA054E5DF39DE\n      -                        'EAE2D6ADEF9CEF757D02A72EF9CEF7572ABC0053\n      -                        'DAE012630283D88E0A9C053F3316A00A078BD40A\n      -                        '4C60501E0955E0029ED7036CBFF8F1D432153197\n      -                      '72B82F0E27294001383BBBC16710B56DE296B3C2'.\n           05  PIC X(100)\n               VALUE          X'DB2BE66BC5C9B1B2EDC9A13998502CB04C5596D4\n      -                        '401128DC5D5CA9A73BCCA206DC2E8A02F2A2E1D5\n      -                        '58B172AB1A28D35B77D92EAB5C8B9996AB6060FF\n      -                        '0071EAD43205967D85D1F98F4A87718CD0C31AFD\n      -                      'CA6DA041836D609C2B681AB615AE6AB036EBCFE2'.\n           05  PIC X(100)\n               VALUE          X'02CCCE85EDE29657F327FA1FFFDA000801020301\n      -                        '3F21FF0016A5FA15E9895F45CA3AF54CA95D0FAE\n      -                        '0F47D025CBE95F46FF00515D177F4DF5D7D03FF0\n      -                        'DFFFDA0008010303013F21FF00150465EDF52282\n      -                      '2D952A54B33C43D2D654A95BCCA7045C7D21A4A9'.\n           05  PIC X(100)\n               VALUE          X'52A54B4A7A2B2FD0D7A68988A8C6317D4EDD4BBB\n      -                        '580D3A575BCB40C035E88257FE16FFDA000C0301\n      -                        '00021103110000109249249093249249F3324A0C\n      -                        '927CD0F0CA2492177C6AC324923266F5F3249251\n      -                      '8340F32495D70CD2B9249238DD92492492492492'.\n           05  PIC X(100)\n               VALUE          X'492492492492492494CB64B2D14C96C82502884C\n      -                        '8249241240249009249248249249249249249249\n      -                        '24924924FFDA0008010103013F10F4599BEFF333\n      -                        '09AE1E17B5D83E507E9F7BAAA13F8CD6973B212E\n      -                      'F4BCFA22AD4EC43F0B72E42BC2D7C2FC4EC4DB53'.\n           05  PIC X(100)\n               VALUE          X'F9BB602EB8DA603C8521F376DE3EE2F54FE52028\n      -                        'B6B431DE22D7493763E6A33C728447BACF6FA5CC\n      -                        '0A82850387DE588C5BFEB4A2156D5DADCF0F42EF\n      -                        '271FD6932565610F2B5DEC331203B46894DA36E4\n      -                      '857BBF8AF7897144960766E6494AC341DAFC1C43'.\n           05  PIC X(100)\n               VALUE          X'EAA07F2ACF04F646D20B5B0CC2338FDC2F06D567\n      -                        'CE811430E2E2AED5078AA72E58E29D40784F768F\n      -                        '8F6F458D4BF85678231E1990C740AFE09DD60953\n      -                        'ECB7F12BF6ACD17B0BE085494672149339088BC8\n      -                      '397DCF43802991ECA53344303E500F82D864B3CB'.\n           05  PIC X(100)\n               VALUE          X'7FE101F706F8B102BB458FC85FCC65DF64BE614B\n      -                        '4A8017C0603EDD3205461396AD0DC5F5C4811651\n      -                        '357F4BC025082ED952955B94F0CE833C3451F78C\n      -                        '82C18182D1EEEA3B765797330EA53788AA82AE83\n      -                      '3066BBC35FCD266576C0FE87CC1AF905FC2ABF30'.\n           05  PIC X(100)\n               VALUE          X'2140558C803C9DE00146BEB1414D019772A981F6\n      -                        '44D4D3DA5AB57E5FF2A115ED20FF005441F04024\n      -                        'A09506E9B854A77555DAF20F3D38FC310D193931\n      -                        'C761DC4DC1C8E95016361014ED400F748F9B8D0E\n      -                      'B11B8BD3EDD089242A8855C8B975D5B396DB00E1'.\n           05  PIC X(100)\n               VALUE          X'3981E0246814877A81570EAF0329B80F6F34A969\n      -                        '7A5AFA9CA58746A5501FB2041AD228A082F829BE\n      -                        '33D1D6C65E6AD995BEE822432D376E6D4E1BE826\n      -                        '0440265CA818BAF552E00D55AA255C010ED0178D\n      -                      '7C93E07A6279A09022D65806664A810634A3AC50'.\n           05  PIC X(100)\n               VALUE          X'6A7CC938C9D48EE804CAB5C75C365AB757BC8D99\n      -                        '9B6EEEF48E94DAB2A0BF7CA79B94FA05C95EB943\n      -                        'BDF4A2D59564F7CA79B9CCD1C9DBC2D5D417F544\n      -                        '3760A084A4112E1D855A839A346414434C1A8132\n      -                      '8082680A027334F276F0B57502021B10913A91CD'.\n           05  PIC X(100)\n               VALUE          X'1941B82203A3753388E33A0807B915DA8118D6A3\n      -                        'C5382A05CA390B59781086288CC8F61CFC8E9E19\n      -                        '05A6A346059C0A220C459012516C685150615D84\n      -                        'B40A2D5B5E6968AE2B312C0C7C4CA17BFA00BC30\n      -                      '386F040726DC970183143694041D3196B6AC8B1A'.\n           05  PIC X(100)\n               VALUE          X'162817296D8B5D3D997002460146B8D5665BD44A\n      -                        '38AC015E0382D44174E0C00A4C6C1626D148D205\n      -                        '603FD11FFFDA0008010203013F10FF00144C127B\n      -                        'A0BD305CC09C4B972E5083C8F4B7972E5EB12CED\n      -                      '812139CF476972E5CB9497CDC14D7A1B745A53DE'.\n           05  PIC X(100)\n               VALUE          X'0210843F53B928688B59E970612B291511DFA259\n      -                        '72E5FF00E13FFFDA0008010303013F10F4AA547D\n      -                        '1D8309ACC73ECF7980BA7CFD0FD68A9B9B27A8C1\n      -                        'A85C02BF239837D1FAF6F500825A3EF98FE60953\n      -                      '6FB7FCE8FA48C652FF00102B4DDCB46CD9293BA3'.\n           05  PIC X(066)\n               VALUE          X'F58BA105CCAB6C51A270B11AEFA04B0F8B8FD213\n      -                        '551DD9CADED881BC981D091259C41B6CE5E60358\n      -                        '1E86917A69003FD5575A95D6BAD743E823F49D4E\n      -                        'A7FF0007FFD9'.\n./ ADD NAME=J7200521 0106-06103-06285-1606-00027-00155-00011-DOTCWS\n      * CommArea for J7200521\n           05  :PRFX:TXT-LN PIC 9(008) COMP-5.\n               88  :PRFX:TXT-LN-VALID VALUES 1 THROUGH 648.\n      * The 648 bytes comes from the maximum (as of CICS TS 2.2)\n      * length of a WRITE OPERATOR message being 690 and then\n      * subtracting the number of bytes in the prefix area: message\n      * number, message type, applid, userid, etc. which is 42.\n           05  :PRFX:CALLER  PIC X(008).\n           05  :PRFX:MSG-NB  PIC X(004).\n           05  :PRFX:MSG-TY  PIC X(001).\n               88  :PRFX:MSG-TY-INFO     VALUE 'I'.\n               88  :PRFX:MSG-TY-WARN     VALUE 'W'.\n               88  :PRFX:MSG-TY-ERR      VALUE 'E'.\n               88  :PRFX:MSG-TY-SVR      VALUE 'S'.\n               88  :PRFX:MSG-TY-VALID    VALUES 'I' 'W' 'E' 'S'.\n           05  :PRFX:RESP    PIC S9(008) COMP-5.\n           05  :PRFX:RESP2   PIC S9(008) COMP-5.\n           05  :PRFX:RC      PIC S9(008) COMP-5.\n               88  :PRFX:RC-NORMAL                VALUE +0.\n               88  :PRFX:RC-INVD-PARM             VALUE +4.\n               88  :PRFX:RC-BAD                   VALUE +16.\n           05  :PRFX:TXT.\n               10  :PRFX:TXT-BYTES\n                   OCCURS 1 TO 648\n                   DEPENDING :PRFX:TXT-LN\n                   PIC X(001).\n      * End CommArea for J7200521\n", "mimetype": "text/plain", "datatype": "ebcdic", "extension": ".txt"}, "PDSLOAD": {"ttr": 769, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x00\\x00\\x00\\x01\\x01\\x15\\x7f\\x01\\x01\\x15\\x7f\\x156\\x00e\\x00e\\x00\\x00\\xd3\\xd6\\xc1\\xc4\\xd3\\xc9\\xc2@@@'", "ispf": {"version": "01.00", "flags": 0, "createdate": "2001-06-06T00:00:00", "modifydate": "2001-06-06T15:36:00", "lines": 101, "newlines": 101, "modlines": 0, "user": "LOADLIB"}, "mimetype": "application/xmit", "datatype": "binary", "extension": ".xmi"}, "SOURCE": {"ttr": 772, "alias": false, "halfwords": 30, "notes": 0, "parms": "b'\\x01\\x00\\x00\\x00\\x01\\x075\\x1f\\x01\\x075\\x1f\\x128\\n\\xd4\\n\\xd4\\x00\\x00\\xc4\\xd6\\xe3\\xc3\\xe6\\xe2@@@@'", "ispf": {"version": "01.00", "flags": 0, "createdate": "2007-12-17T00:00:00", "modifydate": "2007-12-17T12:38:00", "lines": 2772, "newlines": 2772, "modlines": 0, "user": "DOTCWS"}, "text": "./ ADD NAME=$README  0105-07348-07351-1031-00013-00002-00000-DOTCWS\nThis dataset contains the source code for the SHARE session 8247 -\nWriting a web-enabled CICS/COBOL program, presented at SHARE 109 in\nSan Diego in August of 2007 and SHARE 110 in Orlando in February\nof 2008.\n\nContact information: cschneidpublic@yahoo.com\n\nMember\nHTTPSAMP  the sample web-enabled CICS/COBOL application\nJ7200501  translates EIBRESP value to its mnemonic\nJ7200521  encapsulate the CICS WRITE OPERATOR function\nJ7200524  encapsulate LE services to obtain and format time/date\n\n./ ADD NAME=HTTPSAMP 0199-06355-07348-1609-02118-04786-00000-DOTCWS\n       Identification Division.\n       Program-ID.    HTTPSAMP.\n       Author.        Craig Schneiderwent.\n      *\n      * The intent of this program is to provide both proof of concept\n      * and example code for CICS applications that wish to be invoked\n      * via an http or https request.\n      *\n      * Invoke via\n      * https://your.url.here:####/CICS/CWBA/HTTPSAMP?t=<rplyTy>\n      * Where #### is your designated port number.\n      *\n      *\n      * Where <rplyTy> is\n      * html - HTML page\n      * xml  - XML artificially inflated to > 32K for demo purposes\n      * imag - image (jpeg) to demonstrate it can be done\n      * form - HTML form which can be sent back via HTTP POST to\n      *        demo HTTP POST processing\n      *\n      * One other optional parameter that can be passed\n      * c=y  - include a Content-Type header\n      * c=n  - do not include a Content-Type header\n      *\n      * Multiple parameters are passed as follows:\n      * HTTPSAMP?t=html&c=n\n      *\n      * This program also demonstrates multiple methods of passing\n      * data from the web side to the CICS/COBOL side.  One can pass\n      * a parameter on an HTTP GET method as indicated above, or one\n      * can pass data on an HTTP POST method as is done with HTML form\n      * processing.  Note that an HTTP POST is not limited to HTML form\n      * processing.  One could also pass e.g. XML, and the CICS COBOL\n      * program would then do a WEB RECEIVE to obtain the XML.\n      *\n      * Much of what is in here comes from the RFCs (Requests for\n      * Comment) for the http protocol.  The RFCs are available at\n      * http://www.ietf.org/rfc.html.\n      *\n      * Some RFCs of note:\n      *\n      * Hypertext Transfer Protocol -- HTTP/1.0\n      * http://www.ietf.org/rfc/rfc1945.txt?number=1945\n      *\n      * Hypertext Transfer Protocol -- HTTP/1.1\n      * http://www.ietf.org/rfc/rfc2616.txt?number=2616\n      *\n      * HTTP Header Field Registrations\n      * http://www.ietf.org/rfc/rfc4229.txt?number=4229\n      *\n      * HTTP Authentication: Basic and Digest Access Authentication\n      * http://www.ietf.org/rfc/rfc2617.txt?number=2617\n      *\n      *\n      * This program seeks to make judicious use of the WRITE OPERATOR\n      * API, logging errors of note while working hard to avoid a\n      * situation where the CICS JESMSGLG would be flooded with\n      * messages.  Thus the messages written to the JESMSGLG are _not_\n      * the result of \"business logic\" errors, but actual application\n      * bugs or CICS errors that may require some action be taken.\n      *\n      * Note that the WEB * CICS APIs are not threadsafe in CICS\n      * TS 2.2, but they are threadsafe in CICS TS 3.1.  In order to\n      * be a good CICS citizen, this program restricts itself to\n      * threadsafe CICS APIs.  The J7200521 subroutine executes the\n      * WRITE OPERATOR API on our behalf, as it is not threadsafe.\n      * By LINKing to this subroutine, we avoid the TCB switching\n      * problems that would result from dynamically or statically\n      * calling J7200521.\n      *\n      * The CICS TS Application Programming Guide has an extensive\n      * discussion of threadsafe and its implications.\n      *\n      * Debugging code left in for illustrative purposes is marked\n      * with a '#debug' beginning in column 1.\n      *\n      *\n       Environment Division.\n       Configuration Section.\n#debug COPY '$DEBUG01'.\n       Data Division.\n       Working-Storage Section.\n       01  CONSTANTS.\n           05  MYNAME                  PIC X(008) VALUE 'HTTPSAMP'.\n           05  CICS-ERR-PGM            PIC X(008) VALUE 'J7200501'.\n           05  CICS-WTO-PGM            PIC X(008) VALUE 'J7200521'.\n           05  HTTP-DT-TM-PGM          PIC X(008) VALUE 'J7200524'.\n      *\n      *        This is used to get a date/time string in an HTTP-\n      *        approved format.\n      *\n           05  DT-PIC-STRN.\n               10                      PIC S9(004) COMP-5 VALUE +80.\n               10                      PIC X(080)\n                   VALUE 'Www, DD Mmm YYYY HH:MI:SS GMT'.\n      *\n      *        This is used to indicate we want GMT time from J7200524.\n      *\n           05  GMT-TM-FL               PIC X(001) VALUE 'N'.\n      *\n      *        This is used to retrieve the client code page.\n      *\n           05  HTTP-CHARSET-HDR        PIC X(014)\n               VALUE 'Accept-Charset'.\n      *\n      *        The following HTTP-CNTE-TY-* constants are for the\n      *        Content-Type HTTP protocol header.  Unsurprisingly,\n      *        they specify what content type the message body\n      *        consists of.\n      *\n           05  HTTP-CNTE-TY-HTML       PIC X(009) VALUE 'text/html'.\n           05  HTTP-CNTE-TY-XML        PIC X(008) VALUE 'text/xml'.\n           05  HTTP-CNTE-TY-IMAG       PIC X(010) VALUE 'image/jpeg'.\n      *\n      *        The host code page is used in translating to/from\n      *        the client code page.  The problem here is that the\n      *        host code page is set at compile time for each\n      *        program.  The current default at WisDOT is\n      *        CODEPAGE(037).\n      *\n      *        This constant _must_ reflect the correct code page.\n      *\n           05  HOST-CD-PG              PIC X(008) VALUE '037     '.\n      *\n      *        These are the names of the input fields in the HTML\n      *        form defined in FORM-RPLY.  They are used to retrieve\n      *        the values of the fields with WEB READ FORMFIELD.\n      *\n           05  FORM-FLD-NM-TY-LIT      PIC X(004) VALUE 'type'.\n           05  FORM-FLD-NM-CNTE-LIT    PIC X(007) VALUE 'cntehdr'.\n      *\n      *        These constants are used in the HTTP protocol header.\n      *\n           05  HTTP-PTCL-HDR-SRVR-LIT  PIC X(006)\n               VALUE 'Server'.\n           05  HTTP-PTCL-HDR-SRVR      PIC X(004)\n               VALUE 'CICS'.\n           05  HTTP-PTCL-HDR-DT-LIT    PIC X(004)\n               VALUE 'Date'.\n           05  HTTP-PTCL-HDR-CNTE-TY-LIT PIC X(012)\n               VALUE 'Content-Type'.\n           05  HTTP-PTCL-HDR-CACHE-CNTL-LIT PIC X(013)\n               VALUE 'Cache-Control'.\n           05  HTTP-PTCL-HDR-CACHE-CNTL PIC X(008)\n               VALUE 'no-cache'.\n           05  PTCL-LIT                 PIC X(004)\n               VALUE 'http'.\n      *\n      *        These are application-specific status codes returned\n      *        to the caller.\n      *\n           05  RPLY-STUS-CD-LITS.\n               10  STUS-0001           PIC X(050)\n                   VALUE '0001 Success'.\n               10  STUS-0002           PIC X(050)\n                   VALUE '0002 Internal Application Error'.\n               10  STUS-0003           PIC X(050)\n                   VALUE '0003 Bad Request Received From Client'.\n               10  STUS-0004           PIC X(050)\n                   VALUE '0004 Request URI Too Long'.\n               10  STUS-0005           PIC X(050)\n                   VALUE '0005 Request Query String Too Long'.\n\n      *    Due to its size, this buffer is defined such that\n      *    it can be displayed in a minimum number of lines\n      *    in a core dump.  Not that I expect any...\n       01  WS-RPLY-BUFR.\n           05  PIC X(050) OCCURS 40960.\n\n#debug COPY '$DEBUG02'.\n\n       01  SWITCHES.\n           05  NON-HTTP-RQST-DONE-SW   PIC X(001)  VALUE SPACE.\n               88  NON-HTTP-RQST-DONE              VALUE 'Y'.\n           05  HAVE-ERR-MSG-SUFX-SW    PIC X(001)  VALUE SPACE.\n               88  HAVE-ERR-MSG-SUFX               VALUE 'Y'.\n           05  HTTP-HDR-NOT-FND-SW     PIC X(001)  VALUE SPACE.\n               88  HTTP-HDR-NOT-FND                VALUE 'Y'.\n           05  FORM-FLD-NOT-FND-SW     PIC X(001)  VALUE SPACE.\n               88  FORM-FLD-NOT-FND                VALUE 'Y'.\n           05  CICS-ERR-SW             PIC X(001)  VALUE SPACE.\n               88  CICS-ERR                        VALUE 'Y'.\n           05  BINARY-CONTENT-SW       PIC X(001)  VALUE SPACE.\n               88  BINARY-CONTENT                  VALUE 'Y'.\n\n       01  WORK-AREAS.\n           05  WTO-LN                  PIC 9(008)  COMP-5 VALUE 1.\n           05  WTO-SUFX-LN             PIC 9(008)  COMP-5 VALUE 1.\n           05  WS-RESP                 PIC S9(008) COMP-5 VALUE +0.\n           05  WS-RESP2                PIC S9(008) COMP-5 VALUE +0.\n           05  WS-RPLY-BUFR-LN         PIC S9(008) COMP-5 VALUE +0.\n           05  WS-HTTP-HDR-TO-RTV-LN   PIC S9(008) COMP-5 VALUE +0.\n           05  WS-HTTP-HDR-BUFR-LN     PIC S9(008) COMP-5 VALUE +0.\n           05  WS-HTTP-MTHD-LN         PIC S9(008) COMP-5 VALUE +0.\n           05  WS-HTTP-VERS-LN         PIC S9(008) COMP-5 VALUE +0.\n           05  WS-HTTP-PATH-LN         PIC S9(008) COMP-5 VALUE +0.\n           05  WS-HTTP-QRY-STRN-LN     PIC S9(008) COMP-5 VALUE +0.\n           05  WS-AUTH-CVDA            PIC S9(008) COMP-5 VALUE +0.\n           05  WS-CLNT-NM-LN           PIC S9(008) COMP-5 VALUE +0.\n           05  WS-CLNT-ADDR-LN         PIC S9(008) COMP-5 VALUE +0.\n           05  WS-SRVR-NM-LN           PIC S9(008) COMP-5 VALUE +0.\n           05  WS-SRVR-ADDR-LN         PIC S9(008) COMP-5 VALUE +0.\n           05  WS-FORM-FLD-NM-LN       PIC S9(008) COMP-5 VALUE +0.\n           05  WS-FORM-FLD-VAL-LN      PIC S9(008) COMP-5 VALUE +0.\n           05  WS-SSL-TY-CVDA          PIC S9(008) COMP-5 VALUE +0.\n           05  WTO-CA-LN               PIC S9(008) COMP-5 VALUE +0.\n           05  FORM-RPLY-URL-PTR       PIC S9(008) COMP-5 VALUE +1.\n           05  WS-HTTP-MTHD            PIC X(080) VALUE SPACES.\n           05  WS-HTTP-VERS            PIC X(080) VALUE SPACES.\n           05  WS-HTTP-PATH.\n               10                      PIC X(050) OCCURS 10.\n           05  WS-HTTP-QRY-STRN.\n               10                      PIC X(050) OCCURS 10.\n           05  WS-HTTP-QRY-STRN-PARMS  PIC X(050) OCCURS 10\n               INDEXED QRY-STRN-INDX.\n           05  WS-RPLY-TY              PIC X(008) VALUE SPACES.\n           05  WS-FORM-FLD-NM          PIC X(016) VALUE SPACES.\n           05  WS-MSNG-FORM-FLD-NM     PIC X(016) VALUE SPACES.\n           05  WS-FORM-FLD-VAL         PIC X(004) VALUE SPACES.\n           05  WS-RPLY-CNTE-HDR-FL     PIC X(001) VALUE SPACES.\n           05  WS-CICS-RESP-MNEMONIC   PIC X(025) VALUE SPACES.\n           05  WS-TRUNC-ITEM           PIC X(025) VALUE SPACES.\n           05  WS-HTTP-HDR-TO-RTV      PIC X(050) VALUE SPACES.\n           05  WS-CICS-APPLID          PIC X(008) VALUE SPACES.\n           05  THIS-USERID             PIC X(008) VALUE SPACES.\n           05  THIS-USERNAME           PIC X(020) VALUE SPACES.\n           05  WS-DOC-TOKN             PIC X(016) VALUE SPACES.\n           05  MSG-NB                  PIC X(004) VALUE SPACES.\n               88  MSG-NB-CICS-ERR                VALUE '0004'.\n           05  WTO-TXT.\n               10                      PIC X(050) OCCURS 13.\n               10                      PIC X(040).\n           05  WTO-SUFX.\n               10                      PIC X(050) OCCURS 13.\n               10                      PIC X(040).\n           05  CICS-API-FAILED         PIC X(030) VALUE SPACES.\n           05  CICS-API-FAILED-LOC     PIC X(004) VALUE SPACES.\n           05  CICS-RESP-DSPL          PIC 9(010) VALUE ZEROES.\n           05  CICS-RESP-DSPL-X\n               REDEFINES\n               CICS-RESP-DSPL          PIC X(010).\n           05  CICS-RESP2-DSPL         PIC 9(010) VALUE ZEROES.\n           05  CICS-RESP2-DSPL-X\n               REDEFINES\n               CICS-RESP2-DSPL         PIC X(010).\n           05  WS-HTTP-HDR-BUFR.\n               10                      PIC X(050) OCCURS 5.\n           05  WS-HTTP-CLNT-CHARSET    PIC X(040) VALUE SPACES.\n           05  WS-DUMMY-BUFR.\n               10                      PIC X(050) OCCURS 10.\n           05  WS-CLNT-NM              PIC X(080) VALUE SPACES.\n           05  WS-CLNT-ADDR            PIC X(015) VALUE SPACES.\n           05  WS-SRVR-NM              PIC X(080) VALUE SPACES.\n           05  WS-SRVR-ADDR            PIC X(015) VALUE SPACES.\n           05  WS-TCPIP-SRVC-NM        PIC X(008) VALUE SPACES.\n           05  WS-PORT-NB              PIC X(005) VALUE SPACES.\n           05  WS-RPLY-STUS-CD         PIC X(050) VALUE SPACES.\n\n       01  WTO-CA.\n           COPY J7200521 REPLACING ==:PRFX:== BY ==WTO-CA-==.\n\n      * These are used in contructing and sending the HTTP\n      * protocol headers.\n       01  HTTP-PTCL-HDR-AREAS.\n           05  HTTP-PTCL-HDR-DT        PIC X(080) VALUE SPACES.\n           05  HTTP-PTCL-HDR-CNTE-TY   PIC X(025) VALUE SPACES.\n           05  HTTP-PTCL-HDR-NM        PIC X(080) VALUE SPACES.\n           05  HTTP-PTCL-HDR-NM-LN     PIC S9(008) COMP-5 VALUE +0.\n           05  HTTP-PTCL-HDR-VAL       PIC X(080) VALUE SPACES.\n           05  HTTP-PTCL-HDR-VAL-LN    PIC S9(008) COMP-5 VALUE +0.\n\n      * You'll see a lot of x'0D25' constants in some of the *-RPLY\n      * structures that follow.  That value translates into the\n      * familiar CRLF (Carriage Return, Line Feed) ASCII sequence.\n       01  HTML-RPLY.\n           05                    PIC X(006)  VALUE '<html>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(017)  VALUE '<h1 align=center>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05  RPLY-STUS-CD      PIC X(050)  VALUE SPACES.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(005)  VALUE '</h1>'.\n           05                    PIC X(017)  VALUE '<h2 align=center>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05  RPLY-TRANID       PIC X(004)  VALUE SPACES.\n           05                    PIC X(001)  VALUE '-'.\n           05  RPLY-PGM          PIC X(008)  VALUE SPACES.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(005)  VALUE '</h2>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(006)  VALUE '<body>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<ul>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(008)  VALUE 'Region: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-APPL-ID      PIC X(008)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(008)  VALUE 'Method: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-HTTP-MTHD    PIC X(080)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(009)  VALUE 'Version: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-HTTP-VERS    PIC X(080)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(006)  VALUE 'Path: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-HTTP-PATH    PIC X(512)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(014)  VALUE 'Query String: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-HTTP-QRY-STRN PIC X(512)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(016)  VALUE 'Authentication: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-AUTH-TY      PIC X(012)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(010)  VALUE 'SSL Type: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-SSL-TY       PIC X(012)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(016)  VALUE 'Client Address: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-CLNT-ADDR    PIC X(015)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(013)  VALUE 'Client Name: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-CLNT-NM      PIC X(080)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(014)  VALUE 'TCPIPSERVICE: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-TCPIPSERVICE PIC X(008)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(016)  VALUE 'Server Address: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-SRVR-ADDR    PIC X(015)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(013)  VALUE 'Server Name: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-SRVR-NM      PIC X(080)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(013)  VALUE 'Server Port: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-SRVR-PORT    PIC X(005)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(009)  VALUE 'User ID: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-USER-ID      PIC X(008)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(011)  VALUE 'User Name: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-USER-NM      PIC X(020)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<li>'.\n           05                    PIC X(004)  VALUE '<b> '.\n           05                    PIC X(005)  VALUE 'GMT: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05  RPLY-GMT          PIC X(080)  VALUE SPACES.\n           05                    PIC X(005)  VALUE '</li>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(005)  VALUE '</ul>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05  RPLY-INVD-HINT    PIC X(690)  VALUE SPACES.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(007)  VALUE '</body>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(007)  VALUE '</html>'.\n\n       01  FORM-RPLY.\n           05                    PIC X(006)  VALUE '<html>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(017)  VALUE '<h1 align=center>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05  RPLY-STUS-CD      PIC X(050)  VALUE SPACES.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(005)  VALUE '</h1>'.\n           05                    PIC X(017)  VALUE '<h2 align=center>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05  RPLY-TRANID       PIC X(004)  VALUE SPACES.\n           05                    PIC X(001)  VALUE '-'.\n           05  RPLY-PGM          PIC X(008)  VALUE SPACES.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(005)  VALUE '</h2>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(006)  VALUE '<body>'.\n           05                    PIC X(006)  VALUE '<form '.\n           05                    PIC X(007)  VALUE 'action='.\n           05  FORM-RPLY-URL     PIC X(080)  VALUE SPACES.\n           05                    PIC X(014)  VALUE 'method=\"POST\" '.\n           05                    PIC X(013)  VALUE 'name=\"form1\">'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(003)  VALUE '<b>'.\n           05                    PIC X(012)  VALUE 'Reply Type: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(007)  VALUE '<input '.\n           05                    PIC X(012)  VALUE 'type=\"text\" '.\n           05                    PIC X(009)  VALUE 'size=\"4\" '.\n           05                    PIC X(012)  VALUE 'name=\"type\" '.\n           05                    PIC X(014)  VALUE 'maxlength=\"4\">'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(003)  VALUE '<b>'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(003)  VALUE '<b>'.\n           05                    PIC X(013)  VALUE 'Content-type '.\n           05                    PIC X(008)  VALUE 'Header: '.\n           05                    PIC X(004)  VALUE '</b>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(007)  VALUE '<input '.\n           05                    PIC X(016)  VALUE 'type=\"checkbox\" '.\n           05                    PIC X(016)  VALUE 'name=\"cntehdr\">'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(007)  VALUE '<input '.\n           05                    PIC X(014)  VALUE 'type=\"submit\" '.\n           05                    PIC X(016)  VALUE 'value=\"Request\" '.\n           05                    PIC X(015)  VALUE 'name=\"Button1\" '.\n           05                    PIC X(015)  VALUE 'class=\"button\">'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(007)  VALUE '</form>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(007)  VALUE '</body>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(007)  VALUE '</html>'.\n\n       01  INVD-RPLY.\n           05                    PIC X(006)  VALUE '<html>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(017)  VALUE '<h1 align=center>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05  RPLY-STUS-CD      PIC X(050)  VALUE SPACES.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(005)  VALUE '</h1>'.\n           05                    PIC X(017)  VALUE '<h2 align=center>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05  RPLY-TRANID       PIC X(004)  VALUE SPACES.\n           05                    PIC X(001)  VALUE '-'.\n           05  RPLY-PGM          PIC X(008)  VALUE SPACES.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(005)  VALUE '</h2>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(006)  VALUE '<body>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(014)  VALUE 'Query String: '.\n           05  RPLY-HTTP-QRY-STRN PIC X(512)  VALUE SPACES.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(042)\n               VALUE 'Must contain a t=&lt reply type &gt where '.\n           05                    PIC X(034)\n               VALUE '&lt reply type &gt is html or xml '.\n           05                    PIC X(016)\n               VALUE 'or form or imag '.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(004)  VALUE '<br>'.\n           05  RPLY-INVD-HINT    PIC X(690)  VALUE SPACES.\n           05                    PIC X(004)  VALUE '<br>'.\n           05                    PIC X(005)  VALUE 'GMT: '.\n           05  RPLY-GMT          PIC X(080)  VALUE SPACES.\n           05                    PIC X(007)  VALUE '</body>'.\n           05                    PIC X(002)  VALUE X'0D25'.\n           05                    PIC X(007)  VALUE '</html>'.\n\n       01  XML-RPLY.\n           05  XML-OCCURS        PIC 9(004)  VALUE 100.\n           05  XML-RPLY-TBL\n               OCCURS 1 TO 2000\n               DEPENDING XML-OCCURS\n               INDEXED XML-RPLY-INDX.\n               10  RPLY-STUS-CD      PIC X(050)  VALUE SPACES.\n               10  RPLY-TRANID       PIC X(004)  VALUE SPACES.\n               10  RPLY-PGM          PIC X(008)  VALUE SPACES.\n               10  RPLY-APPL-ID      PIC X(008)  VALUE SPACES.\n               10  RPLY-HTTP-MTHD    PIC X(080)  VALUE SPACES.\n               10  RPLY-HTTP-VERS    PIC X(080)  VALUE SPACES.\n               10  RPLY-HTTP-PATH    PIC X(512)  VALUE SPACES.\n               10  RPLY-HTTP-QRY-STRN PIC X(512)  VALUE SPACES.\n               10  RPLY-AUTH-TY      PIC X(012)  VALUE SPACES.\n               10  RPLY-SSL-TY       PIC X(012)  VALUE SPACES.\n               10  RPLY-CLNT-ADDR    PIC X(015)  VALUE SPACES.\n               10  RPLY-CLNT-NM      PIC X(080)  VALUE SPACES.\n               10  RPLY-TCPIPSERVICE PIC X(008)  VALUE SPACES.\n               10  RPLY-SRVR-ADDR    PIC X(015)  VALUE SPACES.\n               10  RPLY-SRVR-NM      PIC X(080)  VALUE SPACES.\n               10  RPLY-SRVR-PORT    PIC X(005)  VALUE SPACES.\n               10  RPLY-USER-ID      PIC X(008)  VALUE SPACES.\n               10  RPLY-USER-NM      PIC X(020)  VALUE SPACES.\n               10  RPLY-GMT          PIC X(080)  VALUE SPACES.\n\n      * This is the hex representation of the SHARE logo.  Its primary\n      * purpose is to show that a JPEG graphic can be sent from a\n      * CICS COBOL program.  It's just showing off, really.\n       01  IMAG-RPLY.\n           COPY IMAG.\n\n      * This area is used in creating a core dump.  It is sometimes\n      * useful to have such a thing when an error occurs, even if\n      * an abend is inappropriate.\n       01  LCL-APLC-DEBUG-AREA.\n           05  CEE3DMP-TITL.\n               10                       PIC X(010) VALUE '+=+=+=+=+='.\n               10  CEE3DMP-TITL-SPFC    PIC X(060) VALUE SPACES.\n               10                       PIC X(010) VALUE '=+=+=+=+=+'.\n           05  CEE3DMP-OPTIONS.\n               10  PIC X(020) VALUE 'TRACEBACK'.\n               10  PIC X(020) VALUE 'THREAD(CURRENT)'.\n               10  PIC X(020) VALUE 'VARIABLES'.\n               10  PIC X(020) VALUE 'PAGESIZE(60)'.\n               10  PIC X(020) VALUE 'NOCONDITION'.\n               10  PIC X(020) VALUE 'ENCLAVE(CURRENT)'.\n               10  CEE3DMP-OPTIONS-PAD-TO-255 PIC X(135).\n           05  CEE3DMP-LEFB-CD          PIC X(012).\n\n       Linkage Section.\n       01  DFHCOMMAREA PIC X(001).\n\n       Procedure Division.\n#debug     COPY '$DEBUG03'.\n\n#debug     DISPLAY\n#debug         MYNAME\n#debug         ' Begin'\n\n           PERFORM 0100-INIT\n\n      *    Presume everything will go okay - move in a\n      *    \"success\" status message\n           MOVE STUS-0001 TO WS-RPLY-STUS-CD\n\n      *    Obtain information about our current environment,\n      *    this is going to be sent back as a demonstration\n      *    of these API calls.  They may also be of use,\n      *    particularly the HTTP-QRY-STRN, in providing a key\n      *    such as a DID# for an inquiry.\n           PERFORM 8000-WHO-IS-CALLING\n           PERFORM 8010-GET-HTTP-MTHD\n           PERFORM 8020-GET-HTTP-VERS\n           PERFORM 8030-GET-HTTP-PATH\n\n      *    We need this for translating from our code page to the\n      *    client's code page.  Think EBCDIC to ASCII but more\n      *    complicated.\n           PERFORM 1040-GET-CLNT-CD-PG\n\n           IF WS-HTTP-MTHD(1:WS-HTTP-MTHD-LN) = 'POST'\n      *        We were invoked via an HTTP POST.  For purposes of this\n      *        application, that implies that an HTML form was sent.\n      *        We will now retrieve the fields from the form and\n      *        proceed accordingly.\n      *        The http method was retrieved in 8010-GET-HTTP-MTHD.\n               PERFORM 1050-GET-FORM-FLDS\n           ELSE\n      *        Presume we were invoked with an HTTP GET, and that the\n      *        query string contains information instructing us on how\n      *        to proceed.\n      *        A complete list of HTTP methods can be found in section\n      *        9 \"Method Definitions\" of RFC 2616 \"Hypertext Transfer\n      *        Protocol -- HTTP/1.1\"\n               PERFORM 8040-GET-HTTP-QRY-STRN\n               PERFORM 1030-PARSE-QRY-STRN\n           END-IF\n\n      *    An application could also be coded to WEB RECEIVE an\n      *    XML datastream instead of WEB READing FORMFIELDs or\n      *    processing the query string.\n\n      *    Create the document which will contain the reply text.  The\n      *    document is just a place for CICS to store our reply.\n           PERFORM 8050-DOC-CRTE\n\n      *    We need GMT time for the http protocol header and\n      *    some of our reply parameters.\n           PERFORM 1010-GET-GMT-TM\n\n      *    Build the reply to send back to the requestor, note that\n      *    the Content-type protocol header is also set in the\n      *    paragraphs that create the different content types.\n           PERFORM 1000-BLD-RPLY\n\n      *    Send the http protocol header to the requestor.\n           PERFORM 1020-SEND-HTTP-PTCL-HDR\n\n      *    Finally, send the reply.\n           PERFORM 8090-WEB-SEND\n\n#debug     DISPLAY\n#debug         MYNAME\n#debug         ' End'\n\n           EXEC CICS RETURN END-EXEC\n           .\n\n       0100-INIT.\n      *\n      * I got some strange behavior when I tried using a Local-Storage\n      * section to force reinitialization of the VALUE clauses.  I\n      * suspect this has something to do with how the CICS Web\n      * Interface invokes application programs.  After some puzzling\n      * over storage dumps, I decided the clearest solution was to\n      * do \"old school\" initialization logic by hand.\n      *\n           INITIALIZE\n               WORK-AREAS\n               HTTP-PTCL-HDR-AREAS\n               HTML-RPLY\n               FORM-RPLY\n               INVD-RPLY\n               SWITCHES\n               WS-RPLY-BUFR\n               LCL-APLC-DEBUG-AREA\n\n           MOVE 1 TO WTO-LN\n                     WTO-SUFX-LN\n\n           MOVE +1 TO FORM-RPLY-URL-PTR\n           .\n\n       1000-BLD-RPLY.\n      *\n      * In a real application, you'd be calling subroutines that\n      * implement business logic and probably building an XML data\n      * stream in reply.\n      *\n\n           EVALUATE WS-RPLY-TY\n               WHEN 'HTML    '\n                    PERFORM 2010-BLD-HTML-RPLY\n               WHEN 'XML     '\n                    PERFORM 2020-BLD-XML-RPLY\n               WHEN 'FORM    '\n                    PERFORM 2060-BLD-FORM-RPLY\n               WHEN 'IMAG    '\n                    PERFORM 2070-BLD-IMAG-RPLY\n               WHEN OTHER\n                    PERFORM 2030-BLD-INVD-RPLY\n           END-EVALUATE\n           .\n\n       1010-GET-GMT-TM.\n      *\n      * Obtain current GMT date/time for http protocol header.\n      *\n           CALL HTTP-DT-TM-PGM USING\n               GMT-TM-FL\n               DT-PIC-STRN\n               HTTP-PTCL-HDR-DT\n           END-CALL\n           .\n\n       1020-SEND-HTTP-PTCL-HDR.\n      *\n      * The RFCs indicate that one should include an http protocol\n      * header in order to be a good internet citizen.  It's not that\n      * hard, so here it is.\n      *\n      * A definitive list of HTTP headers can be found in section 14\n      * \"Header Field Definitions\" of RFC 2616 \"Hypertext Transfer\n      * Protocol -- HTTP/1.1\"\n      *\n      * CICS does not allow direct modification of the HTTP status\n      * code in the protocol header, and only allows certain HTTP\n      * status codes to be set.  This is per the \"CICS Internet\n      * Guide.\"  So, rather than using the HTTP status code, I have\n      * invented, purely for demonstration purposes, an\n      * application status code.  This is what you see in the\n      * RPLY-STUS-CD field.\n      *\n\n      *    Server\n           MOVE HTTP-PTCL-HDR-SRVR-LIT TO HTTP-PTCL-HDR-NM\n           MOVE LENGTH OF HTTP-PTCL-HDR-SRVR-LIT\n             TO HTTP-PTCL-HDR-NM-LN\n           MOVE HTTP-PTCL-HDR-SRVR TO HTTP-PTCL-HDR-VAL\n           MOVE LENGTH OF HTTP-PTCL-HDR-SRVR\n             TO HTTP-PTCL-HDR-VAL-LN\n           PERFORM 8100-WEB-WRITE\n\n      *    Date\n           MOVE HTTP-PTCL-HDR-DT-LIT TO HTTP-PTCL-HDR-NM\n           MOVE LENGTH OF HTTP-PTCL-HDR-DT-LIT\n             TO HTTP-PTCL-HDR-NM-LN\n           MOVE HTTP-PTCL-HDR-DT TO HTTP-PTCL-HDR-VAL\n           MOVE LENGTH OF HTTP-PTCL-HDR-DT\n             TO HTTP-PTCL-HDR-VAL-LN\n           PERFORM 8100-WEB-WRITE\n\n           IF WS-RPLY-CNTE-HDR-FL = 'N'\n      *        Request from client to NOT send the Content-type\n      *        http protocol header.  This is to demonstrate\n      *        what happens if this header is absent.\n      *        In a real application you should just send this header.\n               CONTINUE\n           ELSE\n      *        Content-Type\n               MOVE HTTP-PTCL-HDR-CNTE-TY-LIT TO HTTP-PTCL-HDR-NM\n               MOVE LENGTH OF HTTP-PTCL-HDR-CNTE-TY-LIT\n                 TO HTTP-PTCL-HDR-NM-LN\n               MOVE HTTP-PTCL-HDR-CNTE-TY TO HTTP-PTCL-HDR-VAL\n               MOVE LENGTH OF HTTP-PTCL-HDR-CNTE-TY\n                 TO HTTP-PTCL-HDR-VAL-LN\n               PERFORM 8100-WEB-WRITE\n           END-IF\n\n      *    This header isn't defined for HTTP 1.0, but it works under\n      *    CICS TS 2.2 and doesn't seem to cause any harm.\n      *    Cache-Control\n           MOVE HTTP-PTCL-HDR-CACHE-CNTL-LIT TO HTTP-PTCL-HDR-NM\n           MOVE LENGTH OF HTTP-PTCL-HDR-CACHE-CNTL-LIT\n             TO HTTP-PTCL-HDR-NM-LN\n           MOVE HTTP-PTCL-HDR-CACHE-CNTL TO HTTP-PTCL-HDR-VAL\n           MOVE LENGTH OF HTTP-PTCL-HDR-CACHE-CNTL\n             TO HTTP-PTCL-HDR-VAL-LN\n           PERFORM 8100-WEB-WRITE\n           .\n\n       1030-PARSE-QRY-STRN.\n      *\n      * The query string is everything that comes after the ? in the\n      * URL.  This is a common way to pass parameters to server\n      * applications.  Multiple parameters are typically presented in\n      * \"keyword=value\" format, separated by the ampersand ('&')\n      * character.\n      *\n           UNSTRING\n               WS-HTTP-QRY-STRN\n                 DELIMITED '&'\n             INTO\n      *        We don't accept this many parms, but coding it this\n      *        way allows illustration of multiple parm processing.\n               WS-HTTP-QRY-STRN-PARMS(1)\n               WS-HTTP-QRY-STRN-PARMS(2)\n               WS-HTTP-QRY-STRN-PARMS(3)\n               WS-HTTP-QRY-STRN-PARMS(4)\n               WS-HTTP-QRY-STRN-PARMS(5)\n               WS-HTTP-QRY-STRN-PARMS(6)\n               WS-HTTP-QRY-STRN-PARMS(7)\n               WS-HTTP-QRY-STRN-PARMS(8)\n               WS-HTTP-QRY-STRN-PARMS(9)\n               WS-HTTP-QRY-STRN-PARMS(10)\n           END-UNSTRING\n\n      *    Convert to upper case for convenience of processing.\n           PERFORM VARYING QRY-STRN-INDX FROM 1 BY 1\n           UNTIL QRY-STRN-INDX > 10\n               INSPECT WS-HTTP-QRY-STRN-PARMS(QRY-STRN-INDX)\n                 REPLACING ALL LOW-VALUE BY SPACE\n               MOVE FUNCTION UPPER-CASE(WS-HTTP-QRY-STRN-PARMS\n                                        (QRY-STRN-INDX) )\n                 TO WS-HTTP-QRY-STRN-PARMS(QRY-STRN-INDX)\n           END-PERFORM\n\n           PERFORM VARYING QRY-STRN-INDX FROM 1 BY 1\n           UNTIL QRY-STRN-INDX > 10\n           OR WS-HTTP-QRY-STRN-PARMS(QRY-STRN-INDX) = SPACES\n               EVALUATE WS-HTTP-QRY-STRN-PARMS(QRY-STRN-INDX)(1:2)\n                   WHEN 'C='\n                        MOVE WS-HTTP-QRY-STRN-PARMS(QRY-STRN-INDX)(3:1)\n                          TO WS-RPLY-CNTE-HDR-FL\n                   WHEN 'T='\n                        MOVE WS-HTTP-QRY-STRN-PARMS(QRY-STRN-INDX)(3:8)\n                          TO WS-RPLY-TY\n                   WHEN OTHER\n      *                 Unrecognized parameter, force return of the\n      *                 \"invalid input\" html page.\n                        MOVE 'INVD    '  TO WS-RPLY-TY\n                        STRING\n                            'Invalid query string parm = '\n                              DELIMITED SIZE\n                            WS-HTTP-QRY-STRN-PARMS(QRY-STRN-INDX)(1:2)\n                              DELIMITED SIZE\n                          INTO\n                            RPLY-INVD-HINT OF INVD-RPLY\n                        END-STRING\n               END-EVALUATE\n           END-PERFORM\n           .\n\n       1040-GET-CLNT-CD-PG.\n      *\n      *    We must specify the client's code page when we send\n      *    a response.  The code page is present in the http\n      *    protocol header, so we will retrieve it from there.\n      *\n           INITIALIZE\n               WS-HTTP-HDR-BUFR\n               WS-HTTP-HDR-TO-RTV\n           MOVE HTTP-CHARSET-HDR TO WS-HTTP-HDR-TO-RTV\n           MOVE LENGTH OF HTTP-CHARSET-HDR TO WS-HTTP-HDR-TO-RTV-LN\n           MOVE LENGTH OF WS-HTTP-HDR-BUFR TO WS-HTTP-HDR-BUFR-LN\n           PERFORM 8070-WEB-READ-HDR\n           IF HTTP-HDR-NOT-FND\n      *        Since there doesn't appear to be a client code page\n      *        in the protocol header, we'll use an innocuous default.\n      *        This default comes from section 3.7.1 \"Canonicalization\n      *        and Text Defaults\" of RFC 2616 \"Hypertext Transfer\n      *        Protocol -- HTTP/1.1\"\n               INITIALIZE WS-HTTP-CLNT-CHARSET\n               MOVE 'ISO-8859-1' TO WS-HTTP-CLNT-CHARSET\n           ELSE\n               PERFORM 8080-UNSTRN-CHARSET\n           END-IF\n           .\n\n       1050-GET-FORM-FLDS.\n      *\n      * Retrieve the form fields present in the FORM-RPLY HTML stream.\n      *\n      * This demonstrates an alternate way to provide input from a\n      * browser to a server program.\n      *\n           MOVE FORM-FLD-NM-TY-LIT TO WS-FORM-FLD-NM\n           MOVE LENGTH OF FORM-FLD-NM-TY-LIT TO WS-FORM-FLD-NM-LN\n           PERFORM 8110-WEB-READ-FORMFIELD\n           IF FORM-FLD-NOT-FND\n      *        Force a return of the INVD-RPLY page.\n               MOVE 'INVD' TO WS-RPLY-TY\n           ELSE\n               MOVE WS-FORM-FLD-VAL(1:WS-FORM-FLD-VAL-LN)\n                 TO WS-RPLY-TY\n           END-IF\n\n           MOVE FORM-FLD-NM-CNTE-LIT TO WS-FORM-FLD-NM\n           MOVE LENGTH OF FORM-FLD-NM-CNTE-LIT TO WS-FORM-FLD-NM-LN\n           PERFORM 8110-WEB-READ-FORMFIELD\n           IF FORM-FLD-NOT-FND\n               CONTINUE\n           ELSE\n               IF WS-FORM-FLD-VAL(1:WS-FORM-FLD-VAL-LN) = 'ON'\n                   MOVE 'Y' TO WS-RPLY-CNTE-HDR-FL\n               END-IF\n           END-IF\n           .\n\n       2010-BLD-HTML-RPLY.\n      *\n      * This is just building a reply that shows we got here and\n      * what information we can get via standard APIs.\n      *\n           MOVE EIBTRNID         TO RPLY-TRANID\n                                 OF HTML-RPLY\n           MOVE MYNAME           TO RPLY-PGM\n                                 OF HTML-RPLY\n           MOVE WS-CICS-APPLID   TO RPLY-APPL-ID\n                                 OF HTML-RPLY\n      *    Reference modification is used for MTHD, VERS, PATH and\n      *    QRY-STRN because they are padded with x'00' by the API\n      *    that retrieved them.\n           MOVE WS-HTTP-MTHD(1:WS-HTTP-MTHD-LN)\n                                 TO RPLY-HTTP-MTHD\n                                 OF HTML-RPLY\n           MOVE WS-HTTP-VERS(1:WS-HTTP-VERS-LN)\n                                 TO RPLY-HTTP-VERS\n                                 OF HTML-RPLY\n           MOVE WS-HTTP-PATH(1:WS-HTTP-PATH-LN)\n                                 TO RPLY-HTTP-PATH\n                                 OF HTML-RPLY\n           MOVE WS-HTTP-QRY-STRN(1:WS-HTTP-QRY-STRN-LN)\n                                 TO RPLY-HTTP-QRY-STRN\n                                 OF HTML-RPLY\n           MOVE WS-CLNT-NM       TO RPLY-CLNT-NM\n                                 OF HTML-RPLY\n           MOVE WS-CLNT-ADDR     TO RPLY-CLNT-ADDR\n                                 OF HTML-RPLY\n           MOVE WS-SRVR-NM       TO RPLY-SRVR-NM\n                                 OF HTML-RPLY\n           MOVE WS-SRVR-ADDR     TO RPLY-SRVR-ADDR\n                                 OF HTML-RPLY\n           MOVE WS-PORT-NB       TO RPLY-SRVR-PORT\n                                 OF HTML-RPLY\n           MOVE WS-TCPIP-SRVC-NM TO RPLY-TCPIPSERVICE\n                                 OF HTML-RPLY\n           MOVE THIS-USERID      TO RPLY-USER-ID\n                                 OF HTML-RPLY\n           MOVE THIS-USERNAME    TO RPLY-USER-NM\n                                 OF HTML-RPLY\n           MOVE HTTP-PTCL-HDR-DT TO RPLY-GMT\n                                 OF HTML-RPLY\n\n           EVALUATE WS-AUTH-CVDA\n      *        These may deserve to be factored out into their own\n      *        subroutine, ala J7200501.\n               WHEN DFHVALUE(AUTOAUTH)\n                    MOVE 'AUTOAUTH    ' TO RPLY-AUTH-TY\n                                        OF HTML-RPLY\n               WHEN DFHVALUE(AUTOREGISTER)\n                    MOVE 'AUTOREGISTER' TO RPLY-AUTH-TY\n                                        OF HTML-RPLY\n               WHEN DFHVALUE(BASICAUTH)\n                    MOVE 'BASICAUTH   ' TO RPLY-AUTH-TY\n                                        OF HTML-RPLY\n               WHEN DFHVALUE(CERTIFICAUTH)\n                    MOVE 'CERTIFICAUTH' TO RPLY-AUTH-TY\n                                        OF HTML-RPLY\n               WHEN DFHVALUE(NOAUTHENTIC)\n                    MOVE 'NOAUTHENTIC ' TO RPLY-AUTH-TY\n                                        OF HTML-RPLY\n               WHEN OTHER\n                    MOVE 'UNKNOWN     ' TO RPLY-AUTH-TY\n                                        OF HTML-RPLY\n           END-EVALUATE\n           EVALUATE WS-SSL-TY-CVDA\n      *        These may deserve to be factored out into their own\n      *        subroutine, ala J7200501.\n               WHEN DFHVALUE(SSL)\n                    MOVE 'SSL         ' TO RPLY-SSL-TY\n                                        OF HTML-RPLY\n               WHEN DFHVALUE(NOSSL)\n                    MOVE 'NOSSL       ' TO RPLY-SSL-TY\n                                        OF HTML-RPLY\n               WHEN DFHVALUE(CLIENTAUTH)\n                    MOVE 'CLIENTAUTH  ' TO RPLY-SSL-TY\n                                        OF HTML-RPLY\n               WHEN OTHER\n                    MOVE 'UNKNOWN     ' TO RPLY-SSL-TY\n                                        OF HTML-RPLY\n           END-EVALUATE\n\n           IF CICS-ERR\n               IF WS-RPLY-STUS-CD = STUS-0001\n                   MOVE STUS-0003 TO WS-RPLY-STUS-CD\n               END-IF\n               MOVE WTO-TXT(1:WTO-LN)\n                 TO RPLY-INVD-HINT OF HTML-RPLY\n           END-IF\n\n           MOVE WS-RPLY-STUS-CD         TO RPLY-STUS-CD\n                                        OF HTML-RPLY\n\n           MOVE LENGTH OF HTML-RPLY TO WS-RPLY-BUFR-LN\n           MOVE HTML-RPLY TO WS-RPLY-BUFR\n      *    Insert the reply text into the reply document\n           PERFORM 8060-DOC-ISRT\n\n           MOVE HTTP-CNTE-TY-HTML   TO HTTP-PTCL-HDR-CNTE-TY\n           .\n\n       2020-BLD-XML-RPLY.\n      *\n      * This is just building a reply that shows we got here and\n      * what information we can get via standard APIs.\n      *\n      * This is contrived to end up being larger than 32K.\n      *\n           PERFORM VARYING XML-RPLY-INDX FROM 1 BY 1\n           UNTIL XML-RPLY-INDX > XML-OCCURS\n               INITIALIZE XML-RPLY-TBL(XML-RPLY-INDX)\n               MOVE EIBTRNID         TO RPLY-TRANID\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE MYNAME           TO RPLY-PGM\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-CICS-APPLID   TO RPLY-APPL-ID\n                                     OF XML-RPLY(XML-RPLY-INDX)\n      *    Reference modification is used for MTHD, VERS, PATH and\n      *    QRY-STRN because they are padded with x'00' by the API\n      *    that retrieved them.  That makes for messy XML.\n               MOVE WS-HTTP-MTHD(1:WS-HTTP-MTHD-LN)\n                                     TO RPLY-HTTP-MTHD\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-HTTP-VERS(1:WS-HTTP-VERS-LN)\n                                     TO RPLY-HTTP-VERS\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-HTTP-PATH(1:WS-HTTP-PATH-LN)\n                                     TO RPLY-HTTP-PATH\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-HTTP-QRY-STRN(1:WS-HTTP-QRY-STRN-LN)\n                                     TO RPLY-HTTP-QRY-STRN\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-CLNT-NM       TO RPLY-CLNT-NM\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-CLNT-ADDR     TO RPLY-CLNT-ADDR\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-SRVR-NM       TO RPLY-SRVR-NM\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-SRVR-ADDR     TO RPLY-SRVR-ADDR\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-PORT-NB       TO RPLY-SRVR-PORT\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE WS-TCPIP-SRVC-NM TO RPLY-TCPIPSERVICE\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE THIS-USERID      TO RPLY-USER-ID\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE THIS-USERNAME    TO RPLY-USER-NM\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               MOVE HTTP-PTCL-HDR-DT TO RPLY-GMT\n                                     OF XML-RPLY(XML-RPLY-INDX)\n               EVALUATE WS-AUTH-CVDA\n      *            These may deserve to be factored out into their own\n      *            subroutine, ala J7200501.\n                   WHEN DFHVALUE(AUTOAUTH)\n                        MOVE 'AUTOAUTH    ' TO RPLY-AUTH-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n                   WHEN DFHVALUE(AUTOREGISTER)\n                        MOVE 'AUTOREGISTER' TO RPLY-AUTH-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n                   WHEN DFHVALUE(BASICAUTH)\n                        MOVE 'BASICAUTH   ' TO RPLY-AUTH-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n                   WHEN DFHVALUE(CERTIFICAUTH)\n                        MOVE 'CERTIFICAUTH' TO RPLY-AUTH-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n                   WHEN DFHVALUE(NOAUTHENTIC)\n                        MOVE 'NOAUTHENTIC ' TO RPLY-AUTH-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n                   WHEN OTHER\n                        MOVE 'UNKNOWN     ' TO RPLY-AUTH-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n               END-EVALUATE\n               EVALUATE WS-SSL-TY-CVDA\n      *            These may deserve to be factored out into their own\n      *            subroutine, ala J7200501.\n                   WHEN DFHVALUE(SSL)\n                        MOVE 'SSL         ' TO RPLY-SSL-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n                   WHEN DFHVALUE(NOSSL)\n                        MOVE 'NOSSL       ' TO RPLY-SSL-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n                   WHEN DFHVALUE(CLIENTAUTH)\n                        MOVE 'CLIENTAUTH  ' TO RPLY-SSL-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n                   WHEN OTHER\n                        MOVE 'UNKNOWN     ' TO RPLY-SSL-TY\n                                            OF XML-RPLY(XML-RPLY-INDX)\n               END-EVALUATE\n               MOVE WS-RPLY-STUS-CD         TO RPLY-STUS-CD\n                                            OF XML-RPLY(XML-RPLY-INDX)\n           END-PERFORM\n\n      *    I tested sending a 1 megabyte XML data stream.  This program\n      *    completed processing in short order (< 1 second, which is\n      *    the granularity of the clock I was using.  MS Internet\n      *    Explorer took 10+ seconds to display the results.  I don't\n      *    know how much of that was network traversal time and how\n      *    much of that was MSIE rendering the XML.\n           XML GENERATE WS-RPLY-BUFR\n               FROM XML-RPLY\n               COUNT IN WS-RPLY-BUFR-LN\n           END-XML\n\n      *    Insert the reply text into the reply document\n           PERFORM 8060-DOC-ISRT\n\n           MOVE HTTP-CNTE-TY-XML    TO HTTP-PTCL-HDR-CNTE-TY\n           .\n\n       2030-BLD-INVD-RPLY.\n      *\n      * This is just building an HTML reply indicating something\n      * is wrong.\n      *\n           MOVE EIBTRNID         TO RPLY-TRANID\n                                 OF INVD-RPLY\n           MOVE MYNAME           TO RPLY-PGM\n                                 OF INVD-RPLY\n           MOVE WS-HTTP-QRY-STRN TO RPLY-HTTP-QRY-STRN\n                                 OF INVD-RPLY\n           MOVE HTTP-PTCL-HDR-DT TO RPLY-GMT\n                                 OF INVD-RPLY\n\n           EVALUATE TRUE\n               WHEN CICS-ERR\n                    MOVE WTO-TXT(1:WTO-LN)\n                      TO RPLY-INVD-HINT OF INVD-RPLY\n               WHEN FORM-FLD-NOT-FND\n                    STRING\n                        'You must send a form with a field named \"'\n                          DELIMITED SIZE\n                        WS-FORM-FLD-NM(1:WS-FORM-FLD-NM-LN)\n                          DELIMITED SIZE\n                        '\" if invoking '\n                          DELIMITED SIZE\n                        MYNAME\n                          DELIMITED SIZE\n                        ' with an HTTP POST.'\n                          DELIMITED SIZE\n                      INTO\n                        RPLY-INVD-HINT OF INVD-RPLY\n                    END-STRING\n           END-EVALUATE\n\n           IF WS-RPLY-STUS-CD = STUS-0001\n               MOVE STUS-0003 TO WS-RPLY-STUS-CD\n           END-IF\n\n           MOVE WS-RPLY-STUS-CD\n             TO RPLY-STUS-CD\n             OF INVD-RPLY\n\n      *    Insert the reply text into the reply document\n           MOVE LENGTH OF INVD-RPLY TO WS-RPLY-BUFR-LN\n           MOVE INVD-RPLY TO WS-RPLY-BUFR\n           PERFORM 8060-DOC-ISRT\n\n           MOVE HTTP-CNTE-TY-HTML   TO HTTP-PTCL-HDR-CNTE-TY\n           .\n\n       2060-BLD-FORM-RPLY.\n      *\n      * Populate the fields on the HTML page containing the form to\n      * be sent back to the browser, add it to the document.\n      *\n      * In true pseudo-conversational style, we expect the form to\n      * be populated by the user sitting in front of the browser\n      * and then sent back to us.  That processing is handled in\n      * the mainline code, where we check to see if we were invoked\n      * via an HTTP POST.\n      *\n           MOVE EIBTRNID         TO RPLY-TRANID\n                                 OF FORM-RPLY\n           MOVE MYNAME           TO RPLY-PGM\n                                 OF FORM-RPLY\n\n      *\n      *    The reply-to URL for the HTML form is constructed here.  The\n      *    pieces of the original URL are used, so if the URL used to\n      *    invoke this program changes, this code need not change.\n      *\n           STRING PTCL-LIT DELIMITED SIZE\n             INTO FORM-RPLY-URL\n             POINTER FORM-RPLY-URL-PTR\n           END-STRING\n\n           IF WS-SSL-TY-CVDA = DFHVALUE(SSL)\n               STRING 's' DELIMITED SIZE\n                 INTO FORM-RPLY-URL POINTER FORM-RPLY-URL-PTR\n               END-STRING\n           END-IF\n\n           STRING\n               '://'        DELIMITED SIZE\n               WS-SRVR-NM(1:WS-SRVR-NM-LN) DELIMITED SIZE\n               ':'          DELIMITED SIZE\n               WS-PORT-NB   DELIMITED SIZE\n               WS-HTTP-PATH(1:WS-HTTP-PATH-LN) DELIMITED SIZE\n               '?'          DELIMITED SIZE\n               WS-HTTP-QRY-STRN(1:WS-HTTP-QRY-STRN-LN) DELIMITED SIZE\n             INTO FORM-RPLY-URL\n             POINTER FORM-RPLY-URL-PTR\n             OVERFLOW\n               PERFORM 2061-FORM-URL-OVRF-ERR\n             NOT OVERFLOW\n               PERFORM 2062-FORM-OK\n           END-STRING\n\n      *    Insert the reply text into the reply document\n           PERFORM 8060-DOC-ISRT\n\n           MOVE HTTP-CNTE-TY-HTML   TO HTTP-PTCL-HDR-CNTE-TY\n           .\n\n       2061-FORM-URL-OVRF-ERR.\n           MOVE 'Query string is too long' TO RPLY-INVD-HINT\n                                           OF INVD-RPLY\n\n           MOVE EIBTRNID         TO RPLY-TRANID\n                                 OF INVD-RPLY\n           MOVE MYNAME           TO RPLY-PGM\n                                 OF INVD-RPLY\n           MOVE WS-HTTP-QRY-STRN TO RPLY-HTTP-QRY-STRN\n                                 OF INVD-RPLY\n           MOVE HTTP-PTCL-HDR-DT TO RPLY-GMT\n                                 OF INVD-RPLY\n\n           MOVE STUS-0005               TO WS-RPLY-STUS-CD\n           MOVE WS-RPLY-STUS-CD         TO RPLY-STUS-CD\n                                        OF INVD-RPLY\n           MOVE LENGTH OF INVD-RPLY TO WS-RPLY-BUFR-LN\n           MOVE INVD-RPLY TO WS-RPLY-BUFR\n           .\n\n       2062-FORM-OK.\n           MOVE WS-RPLY-STUS-CD         TO RPLY-STUS-CD\n                                        OF FORM-RPLY\n           MOVE LENGTH OF FORM-RPLY TO WS-RPLY-BUFR-LN\n           MOVE FORM-RPLY TO WS-RPLY-BUFR\n           .\n\n       2070-BLD-IMAG-RPLY.\n      *\n      * Send an image back to the requestor.\n      *\n      *\n           SET BINARY-CONTENT TO TRUE\n           MOVE LENGTH OF IMAG-RPLY TO WS-RPLY-BUFR-LN\n           MOVE IMAG-RPLY TO WS-RPLY-BUFR\n           PERFORM 8060-DOC-ISRT\n\n           MOVE HTTP-CNTE-TY-IMAG   TO HTTP-PTCL-HDR-CNTE-TY\n           .\n\n       8000-WHO-IS-CALLING.\n      *\n      * Obtain information about the current invocation\n      * environment - region name, who is executing this transaction,\n      * etc.\n      *\n      * Significant points here, if your application is supposed\n      * to be executed via https, it would be a good idea to check\n      * the value returned in SSLTYPE to ensure SSL is in effect.\n      * Also, some of the information obtained from the EXTRACT TCPIP\n      * API is included in the error messages written to the log.  This\n      * information is often helpful in debugging.\n      *\n           EXEC CICS ASSIGN\n               APPLID(WS-CICS-APPLID)\n               USERID(THIS-USERID)\n               USERNAME(THIS-USERNAME)\n           END-EXEC\n\n           MOVE LENGTH OF WS-CLNT-NM   TO WS-CLNT-NM-LN\n           MOVE LENGTH OF WS-CLNT-ADDR TO WS-CLNT-ADDR-LN\n           MOVE LENGTH OF WS-SRVR-NM   TO WS-SRVR-NM-LN\n           MOVE LENGTH OF WS-SRVR-ADDR TO WS-SRVR-ADDR-LN\n\n           EXEC CICS\n               EXTRACT TCPIP\n               AUTHENTICATE(WS-AUTH-CVDA)\n               CLIENTNAME(WS-CLNT-NM)\n               CNAMELENGTH(WS-CLNT-NM-LN)\n               CLIENTADDR(WS-CLNT-ADDR)\n               CADDRLENGTH(WS-CLNT-ADDR-LN)\n               SERVERNAME(WS-SRVR-NM)\n               SNAMELENGTH(WS-SRVR-NM-LN)\n               SERVERADDR(WS-SRVR-ADDR)\n               SADDRLENGTH(WS-SRVR-ADDR-LN)\n               SSLTYPE(WS-SSL-TY-CVDA)\n               TCPIPSERVICE(WS-TCPIP-SRVC-NM)\n               PORTNUMBER(WS-PORT-NB)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    INITIALIZE CICS-API-FAILED\n                    MOVE 'EXTRACT TCPIP' TO CICS-API-FAILED\n                    MOVE '8000'        TO CICS-API-FAILED-LOC\n                    PERFORM 8900-GET-CICS-RESP-MNEMONIC\n           END-EVALUATE\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN DFHRESP( INVREQ )\n                    PERFORM 8910-MAKE-CICS-ERR-MSG\n                    PERFORM 9100-WTO\n               WHEN DFHRESP( LENGERR )\n                    IF WS-RESP2 = 1\n      *                 Other values of RESP2 indicate that one of\n      *                 the address or name fields was truncated, and\n      *                 that's not significant enough for me to write\n      *                 code to deal with it right now. The address\n      *                 fields are all the right length, so it would\n      *                 just be a name field.\n                        PERFORM 8910-MAKE-CICS-ERR-MSG\n                        PERFORM 9100-WTO\n                    END-IF\n           END-EVALUATE\n\n           EVALUATE TRUE\n      *        This code makes the later uses of reference\n      *        modification on the client name work correctly.\n               WHEN WS-CLNT-NM-LN > LENGTH OF WS-CLNT-NM\n      *             The client name was truncated, but for our\n      *             purposes what we got was sufficient.\n                    MOVE LENGTH OF WS-CLNT-NM   TO WS-CLNT-NM-LN\n               WHEN WS-CLNT-NM-LN = 0\n      *             The client name was not found.\n                    MOVE 1                      TO WS-CLNT-NM-LN\n           END-EVALUATE\n\n           EVALUATE TRUE\n      *        This code makes the later uses of reference\n      *        modification on the server name work correctly.\n               WHEN WS-SRVR-NM-LN > LENGTH OF WS-SRVR-NM\n      *             The server name was truncated, but for our\n      *             purposes what we got was sufficient.\n                    MOVE LENGTH OF WS-SRVR-NM   TO WS-SRVR-NM-LN\n               WHEN WS-SRVR-NM-LN = 0\n      *             The server name was not found.\n                    MOVE 1                      TO WS-SRVR-NM-LN\n           END-EVALUATE\n\n#debug     DISPLAY\n#debug         MYNAME\n#debug         SPACE\n#debug         THIS-USERID\n#debug         SPACE\n#debug         THIS-USERNAME\n#debug         SPACE\n#debug         WS-CLNT-NM\n#debug         SPACE\n#debug         WS-CLNT-ADDR\n#debug         SPACE\n#debug         WS-SRVR-NM\n#debug         SPACE\n#debug         WS-SRVR-ADDR\n#debug         ':'\n#debug         WS-PORT-NB\n           .\n\n       8010-GET-HTTP-MTHD.\n      *\n      * Obtain the http method - GET, POST, etc.\n      *\n           MOVE LENGTH OF WS-HTTP-MTHD TO WS-HTTP-MTHD-LN\n           EXEC CICS\n               WEB EXTRACT\n               HTTPMETHOD(WS-HTTP-MTHD)\n               METHODLENGTH(WS-HTTP-MTHD-LN)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN DFHRESP( INVREQ )\n                    SET NON-HTTP-RQST-DONE TO TRUE\n               WHEN DFHRESP( LENGERR )\n                    INITIALIZE WS-TRUNC-ITEM\n                    MOVE 'http-method' TO WS-TRUNC-ITEM\n                    PERFORM 8920-MAKE-TRUNC-SUFX\n      *             This was truncated, but we want the length set\n      *             so that we can use it in reference modification\n      *             later.\n                    MOVE LENGTH OF WS-HTTP-MTHD TO WS-HTTP-MTHD-LN\n           END-EVALUATE\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    IF NON-HTTP-RQST-DONE\n      *                 This is an interesting situation.  I would\n      *                 suggest that a new error message be defined to\n      *                 indicate this condition.  Such an error message\n      *                 could be modeled on the existing CICS error\n      *                 message UDOT0004E.\n                        CONTINUE\n                    ELSE\n                        INITIALIZE CICS-API-FAILED\n                        MOVE 'WEB-EXTRACT' TO CICS-API-FAILED\n                        MOVE '8010'        TO CICS-API-FAILED-LOC\n                        PERFORM 8900-GET-CICS-RESP-MNEMONIC\n                        PERFORM 8910-MAKE-CICS-ERR-MSG\n                        PERFORM 9100-WTO\n                    END-IF\n           END-EVALUATE\n           .\n\n       8020-GET-HTTP-VERS.\n      *\n      * Obtain the http version string.  This is from the http\n      * headers that accompany the request.\n      *\n           MOVE LENGTH OF WS-HTTP-VERS TO WS-HTTP-VERS-LN\n           EXEC CICS\n               WEB EXTRACT\n               HTTPVERSION(WS-HTTP-VERS)\n               VERSIONLEN(WS-HTTP-VERS-LN)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN DFHRESP( INVREQ )\n                    SET NON-HTTP-RQST-DONE TO TRUE\n               WHEN DFHRESP( LENGERR )\n                    INITIALIZE WS-TRUNC-ITEM\n                    MOVE 'http-version' TO WS-TRUNC-ITEM\n                    PERFORM 8920-MAKE-TRUNC-SUFX\n      *             This was truncated, but we want the length set\n      *             so that we can use it in reference modification\n      *             later.\n                    MOVE LENGTH OF WS-HTTP-VERS TO WS-HTTP-VERS-LN\n           END-EVALUATE\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    IF NON-HTTP-RQST-DONE\n      *                 This is an interesting situation.  I would\n      *                 suggest that a new error message be defined to\n      *                 indicate this condition.  Such an error message\n      *                 could be modeled on the existing CICS error\n      *                 message UDOT0004E.\n                        CONTINUE\n                    ELSE\n                        INITIALIZE CICS-API-FAILED\n                        MOVE 'WEB-EXTRACT' TO CICS-API-FAILED\n                        MOVE '8020'        TO CICS-API-FAILED-LOC\n                        PERFORM 8900-GET-CICS-RESP-MNEMONIC\n                        PERFORM 8910-MAKE-CICS-ERR-MSG\n                        PERFORM 9100-WTO\n                    END-IF\n           END-EVALUATE\n           .\n\n       8030-GET-HTTP-PATH.\n      *\n      * Obtain the http path - the bit that comes between the first\n      * slash after \"http://\" and the question mark.\n      *\n           MOVE LENGTH OF WS-HTTP-PATH TO WS-HTTP-PATH-LN\n           EXEC CICS\n               WEB EXTRACT\n               PATH(WS-HTTP-PATH)\n               PATHLENGTH(WS-HTTP-PATH-LN)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN DFHRESP( INVREQ )\n                    SET NON-HTTP-RQST-DONE TO TRUE\n               WHEN DFHRESP( LENGERR )\n                    MOVE STUS-0004 TO WS-RPLY-STUS-CD\n                    INITIALIZE WS-TRUNC-ITEM\n                    MOVE 'http-path' TO WS-TRUNC-ITEM\n                    PERFORM 8920-MAKE-TRUNC-SUFX\n      *             This was truncated, but we want the length set\n      *             so that we can use it in reference modification\n      *             later.\n                    MOVE LENGTH OF WS-HTTP-PATH TO WS-HTTP-PATH-LN\n           END-EVALUATE\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    IF NON-HTTP-RQST-DONE\n      *                 This is an interesting situation.  I would\n      *                 suggest that a new error message be defined to\n      *                 indicate this condition.  Such an error message\n      *                 could be modeled on the existing CICS error\n      *                 message UDOT0004E.\n                        CONTINUE\n                    ELSE\n                        INITIALIZE CICS-API-FAILED\n                        MOVE 'WEB-EXTRACT' TO CICS-API-FAILED\n                        MOVE '8030'        TO CICS-API-FAILED-LOC\n                        PERFORM 8900-GET-CICS-RESP-MNEMONIC\n                        PERFORM 8910-MAKE-CICS-ERR-MSG\n                        PERFORM 9100-WTO\n                    END-IF\n           END-EVALUATE\n           .\n\n       8040-GET-HTTP-QRY-STRN.\n      *\n      * Obtain the http query string - the bit that comes after\n      * the question mark.\n      *\n           MOVE LENGTH OF WS-HTTP-QRY-STRN TO WS-HTTP-QRY-STRN-LN\n           EXEC CICS\n               WEB EXTRACT\n               QUERYSTRING(WS-HTTP-QRY-STRN)\n               QUERYSTRLEN(WS-HTTP-QRY-STRN-LN)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN DFHRESP( INVREQ )\n                    SET NON-HTTP-RQST-DONE TO TRUE\n               WHEN DFHRESP( LENGERR )\n                    INITIALIZE WS-TRUNC-ITEM\n                    MOVE 'http-query-string' TO WS-TRUNC-ITEM\n                    PERFORM 8920-MAKE-TRUNC-SUFX\n      *             This was truncated, but we want the length set\n      *             so that we can use it in reference modification\n      *             later.\n                    MOVE LENGTH OF WS-HTTP-QRY-STRN\n                      TO WS-HTTP-QRY-STRN-LN\n           END-EVALUATE\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    IF NON-HTTP-RQST-DONE\n      *                 This is an interesting situation.  I would\n      *                 suggest that a new error message be defined to\n      *                 indicate this condition.  Such an error message\n      *                 could be modeled on the existing CICS error\n      *                 message UDOT0004E.\n                        CONTINUE\n                    ELSE\n                        INITIALIZE CICS-API-FAILED\n                        MOVE 'WEB-EXTRACT' TO CICS-API-FAILED\n                        MOVE '8040'        TO CICS-API-FAILED-LOC\n                        PERFORM 8900-GET-CICS-RESP-MNEMONIC\n                        PERFORM 8910-MAKE-CICS-ERR-MSG\n                        PERFORM 9100-WTO\n                    END-IF\n           END-EVALUATE\n           .\n\n       8050-DOC-CRTE.\n      *\n      * Create the document into which we will insert the http\n      * protocol header(s) and html/text/xml that constitue\n      * the reply to be sent to the requestor.\n      *\n      * If you take a look at 8090-WEB-SEND, you'll see that we use\n      * the WS-DOC-TOKN to indicate which document we want to send\n      * as a reply.\n      *\n           EXEC CICS\n               DOCUMENT CREATE\n               DOCTOKEN(WS-DOC-TOKN)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    INITIALIZE CICS-API-FAILED\n                    MOVE 'DOCUMENT-CREATE' TO CICS-API-FAILED\n                    MOVE '8050'            TO CICS-API-FAILED-LOC\n                    PERFORM 8900-GET-CICS-RESP-MNEMONIC\n                    PERFORM 8910-MAKE-CICS-ERR-MSG\n                    PERFORM 9100-WTO\n           END-EVALUATE\n           .\n\n       8060-DOC-ISRT.\n      *\n      * Insert the content of WS-RPLY-BUFR into the reply document.\n      *\n      * This example application only does one insert per reply.  The\n      * CICS documentation indicates one can do multiple inserts, with\n      * each being added to the \"bottom\" of the document.  One can\n      * also create \"bookmarks\" within the document and insert at a\n      * bookmark location.\n      *\n           IF BINARY-CONTENT\n               EXEC CICS\n                   DOCUMENT INSERT\n                   DOCTOKEN(WS-DOC-TOKN)\n                   BINARY(WS-RPLY-BUFR)\n                   LENGTH(WS-RPLY-BUFR-LN)\n                   RESP(WS-RESP)\n                   RESP2(WS-RESP2)\n               END-EXEC\n           ELSE\n               EXEC CICS\n                   DOCUMENT INSERT\n                   DOCTOKEN(WS-DOC-TOKN)\n                   TEXT(WS-RPLY-BUFR)\n                   LENGTH(WS-RPLY-BUFR-LN)\n                   HOSTCODEPAGE(HOST-CD-PG)\n                   RESP(WS-RESP)\n                   RESP2(WS-RESP2)\n               END-EXEC\n           END-IF\n\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    INITIALIZE CICS-API-FAILED\n                    MOVE 'DOCUMENT-INSERT' TO CICS-API-FAILED\n                    MOVE '8060'            TO CICS-API-FAILED-LOC\n                    PERFORM 8900-GET-CICS-RESP-MNEMONIC\n                    PERFORM 8910-MAKE-CICS-ERR-MSG\n                    PERFORM 9100-WTO\n           END-EVALUATE\n           .\n\n       8070-WEB-READ-HDR.\n      *\n      * Obtain the http protocol header item specified in\n      * WS-HTTP-HDR-TO-RTV.\n      *\n           INITIALIZE HTTP-HDR-NOT-FND-SW\n           EXEC CICS\n               WEB READ\n               HTTPHEADER(WS-HTTP-HDR-TO-RTV)\n               NAMELENGTH(WS-HTTP-HDR-TO-RTV-LN)\n               VALUE(WS-HTTP-HDR-BUFR)\n               VALUELENGTH(WS-HTTP-HDR-BUFR-LN)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    INITIALIZE CICS-API-FAILED\n                    MOVE 'WEB-READ-HTTPHEADER' TO CICS-API-FAILED\n                    MOVE '8070'            TO CICS-API-FAILED-LOC\n                    PERFORM 8900-GET-CICS-RESP-MNEMONIC\n                    PERFORM 8930-MAKE-HTTP-HDR-ERR-SUFX\n           END-EVALUATE\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN DFHRESP( NOTFND )\n                    IF WS-RESP2 = 1\n      *                 Requested header was not found\n                        SET HTTP-HDR-NOT-FND TO TRUE\n                    ELSE\n                        PERFORM 8910-MAKE-CICS-ERR-MSG\n                        PERFORM 9100-WTO\n                    END-IF\n               WHEN OTHER\n                    PERFORM 8910-MAKE-CICS-ERR-MSG\n                    PERFORM 9100-WTO\n           END-EVALUATE\n           .\n\n       8080-UNSTRN-CHARSET.\n      *\n      * Get the first client code page sent on the http header.  This\n      * is used on the WEB SEND API call to convert from the host\n      * code page (probably 037 EBCDIC) to the client code page (which\n      * we don't know, probably ISO-8859-1).\n      *\n      * This isn't very robust, and could probably benefit from its\n      * own subroutine for parsing out the preferred code page instead\n      * of just arbitrarily using the first code page listed.\n      *\n      * See http://www.ietf.org/rfc/rfc2616.txt?number=2616, section\n      * 14.2 for the full syntax of the Accept-Charset protocol\n      * header.\n      *\n           UNSTRING WS-HTTP-HDR-BUFR\n             DELIMITED ',' OR ';' OR SPACE\n             INTO\n               WS-HTTP-CLNT-CHARSET\n               WS-DUMMY-BUFR\n           END-UNSTRING\n           .\n\n       8090-WEB-SEND.\n      *\n      * Send the reply constructed in the document referenced by\n      * WS-DOC-TOKN back to the requester.\n      *\n           EXEC CICS\n               WEB SEND\n               DOCTOKEN(WS-DOC-TOKN)\n               CLNTCODEPAGE(WS-HTTP-CLNT-CHARSET)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    INITIALIZE CICS-API-FAILED\n                    MOVE 'WEB-SEND'        TO CICS-API-FAILED\n                    MOVE '8090'            TO CICS-API-FAILED-LOC\n                    PERFORM 8900-GET-CICS-RESP-MNEMONIC\n           END-EVALUATE\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN DFHRESP( NOTFND )\n                    IF WS-RESP2 = 7\n      *                 Requested client code page is bad\n                        PERFORM 8940-MAKE-CLNT-CD-PG-ERR-SUFX\n                    END-IF\n                    PERFORM 8910-MAKE-CICS-ERR-MSG\n                    PERFORM 9100-WTO\n               WHEN DFHRESP( NOTFND )\n                    PERFORM 8910-MAKE-CICS-ERR-MSG\n                    PERFORM 9100-WTO\n           END-EVALUATE\n           .\n\n       8100-WEB-WRITE.\n      *\n      * Send the reply constructed in the document referenced by\n      * WS-DOC-TOKN back to the requester.\n      *\n           EXEC CICS\n               WEB WRITE\n               HTTPHEADER(HTTP-PTCL-HDR-NM)\n               NAMELENGTH(HTTP-PTCL-HDR-NM-LN)\n               VALUE(HTTP-PTCL-HDR-VAL)\n               VALUELENGTH(HTTP-PTCL-HDR-VAL-LN)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN OTHER\n                    INITIALIZE CICS-API-FAILED\n                    MOVE 'WEB-WRITE'       TO CICS-API-FAILED\n                    MOVE '8100'            TO CICS-API-FAILED-LOC\n                    PERFORM 8900-GET-CICS-RESP-MNEMONIC\n                    PERFORM 8910-MAKE-CICS-ERR-MSG\n                    PERFORM 9100-WTO\n           END-EVALUATE\n           .\n\n       8110-WEB-READ-FORMFIELD.\n      *\n      * Read the specified field from the HTML form with which this\n      * program was invoked.\n      *\n           MOVE LENGTH OF WS-FORM-FLD-VAL TO WS-FORM-FLD-VAL-LN\n           INITIALIZE FORM-FLD-NOT-FND-SW\n           EXEC CICS\n               WEB READ\n               FORMFIELD(WS-FORM-FLD-NM)\n               NAMELENGTH(WS-FORM-FLD-NM-LN)\n               VALUE(WS-FORM-FLD-VAL)\n               VALUELENGTH(WS-FORM-FLD-VAL-LN)\n               CLNTCODEPAGE(WS-HTTP-CLNT-CHARSET)\n               HOSTCODEPAGE(HOST-CD-PG)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    MOVE FUNCTION UPPER-CASE(WS-FORM-FLD-VAL)\n                      TO WS-FORM-FLD-VAL\n               WHEN OTHER\n      *             Provide some human-readable info for debugging.\n                    INITIALIZE CICS-API-FAILED\n                    MOVE 'WEB-READ-FORMFIELD' TO CICS-API-FAILED\n                    MOVE '8110'            TO CICS-API-FAILED-LOC\n                    PERFORM 8900-GET-CICS-RESP-MNEMONIC\n           END-EVALUATE\n           EVALUATE WS-RESP\n               WHEN DFHRESP( NORMAL )\n                    CONTINUE\n               WHEN DFHRESP( NOTFND )\n                    IF WS-RESP2 = 1\n      *                 Form field was not found.\n                        SET FORM-FLD-NOT-FND TO TRUE\n                        MOVE WS-FORM-FLD-NM(1:WS-FORM-FLD-NM-LN)\n                          TO WS-MSNG-FORM-FLD-NM\n                    ELSE\n                        PERFORM 8910-MAKE-CICS-ERR-MSG\n                        PERFORM 9100-WTO\n                    END-IF\n               WHEN DFHRESP( INVREQ )\n                    EVALUATE WS-RESP2\n                        WHEN 11\n      *                      Requested client code page is bad\n                             PERFORM 8940-MAKE-CLNT-CD-PG-ERR-SUFX\n                        WHEN 12\n      *                      Requested server code page is bad\n                             PERFORM 8950-MAKE-SRVR-CD-PG-ERR-SUFX\n                        WHEN 14\n      *                      Requested client and server code page\n      *                      combination is bad.\n                             PERFORM 8960-MAKE-C-S-CD-PG-ERR-SUFX\n                    END-EVALUATE\n                    IF WS-RESP2 = 13\n      *                 The POST request didn't provide a form.\n                        SET FORM-FLD-NOT-FND TO TRUE\n                    ELSE\n                        PERFORM 8910-MAKE-CICS-ERR-MSG\n                        PERFORM 9100-WTO\n                    END-IF\n               WHEN OTHER\n                    PERFORM 8910-MAKE-CICS-ERR-MSG\n                    PERFORM 9100-WTO\n           END-EVALUATE\n           .\n\n       8900-GET-CICS-RESP-MNEMONIC.\n      *\n      * Obtain the mnemonic text for the RESP code that resulted\n      * from the most recent CICS API call.\n      *\n           CALL CICS-ERR-PGM USING\n               WS-RESP\n               WS-CICS-RESP-MNEMONIC\n           END-CALL\n           .\n\n       8910-MAKE-CICS-ERR-MSG.\n      *\n      * Concatenate fields to create a meaningful error message\n      * to be written to the JESMSGLG.  This should assist in\n      * debugging any problems that occur.\n      *\n           MOVE SPACES   TO WTO-TXT\n           MOVE WS-RESP  TO CICS-RESP-DSPL\n           MOVE WS-RESP2 TO CICS-RESP2-DSPL\n           SET MSG-NB-CICS-ERR TO TRUE\n           SET WTO-CA-MSG-TY-ERR      TO TRUE\n           STRING\n               CICS-API-FAILED\n                 DELIMITED BY SPACE\n               SPACE\n                 DELIMITED BY SIZE\n               CICS-RESP-DSPL-X\n                 DELIMITED BY SPACE\n               SPACE\n                 DELIMITED BY SIZE\n               WS-CICS-RESP-MNEMONIC\n                 DELIMITED BY SPACE\n               SPACE\n                 DELIMITED BY SIZE\n               CICS-RESP2-DSPL-X\n                 DELIMITED BY SPACE\n               SPACE\n                 DELIMITED BY SIZE\n               CICS-API-FAILED-LOC\n                 DELIMITED BY SIZE\n             INTO\n               WTO-TXT\n             WITH POINTER\n               WTO-LN\n           END-STRING\n\n           IF HAVE-ERR-MSG-SUFX\n               STRING\n                   SPACE\n                     DELIMITED BY SIZE\n                   WTO-SUFX(1:WTO-SUFX-LN)\n                     DELIMITED BY SIZE\n                 INTO\n                   WTO-TXT\n                 WITH POINTER\n                   WTO-LN\n               END-STRING\n           END-IF\n\n           INITIALIZE HAVE-ERR-MSG-SUFX-SW\n           .\n\n       8920-MAKE-TRUNC-SUFX.\n      *\n      * Construct operator message suffix indicating which item\n      * was truncated.\n      *\n           SET HAVE-ERR-MSG-SUFX TO TRUE\n           INITIALIZE WTO-SUFX\n           MOVE 1 TO WTO-SUFX-LN\n           STRING\n               WS-TRUNC-ITEM\n                 DELIMITED SPACE\n               ' was truncated'\n                 DELIMITED SIZE\n               ' client IP: '\n                 DELIMITED SIZE\n               WS-CLNT-ADDR\n                 DELIMITED SIZE\n               ' client name: '\n                 DELIMITED SIZE\n               WS-CLNT-NM(1:WS-CLNT-NM-LN)\n                 DELIMITED SIZE\n             INTO\n               WTO-SUFX\n             POINTER\n               WTO-SUFX-LN\n           END-STRING\n           .\n\n       8930-MAKE-HTTP-HDR-ERR-SUFX.\n      *\n      * Construct operator message suffix indicating which http\n      * header item was being processed when the error occurred.\n      *\n           SET HAVE-ERR-MSG-SUFX TO TRUE\n           INITIALIZE WTO-SUFX\n           MOVE 1 TO WTO-SUFX-LN\n           STRING\n               WS-HTTP-HDR-TO-RTV(1:WS-HTTP-HDR-TO-RTV-LN)\n                 DELIMITED SIZE\n               ' was being procesed'\n                 DELIMITED SIZE\n               ' client IP: '\n                 DELIMITED SIZE\n               WS-CLNT-ADDR\n                 DELIMITED SIZE\n               ' client name: '\n                 DELIMITED SIZE\n               WS-CLNT-NM(1:WS-CLNT-NM-LN)\n                 DELIMITED SIZE\n             INTO\n               WTO-SUFX\n             POINTER\n               WTO-SUFX-LN\n           END-STRING\n           .\n\n       8940-MAKE-CLNT-CD-PG-ERR-SUFX.\n      *\n      * Construct operator message suffix indicating the client\n      * code page that was invalid.\n      *\n           SET HAVE-ERR-MSG-SUFX TO TRUE\n           INITIALIZE WTO-SUFX\n           MOVE 1 TO WTO-SUFX-LN\n           STRING\n               ' client code page is '\n                 DELIMITED SIZE\n               WS-HTTP-CLNT-CHARSET\n                 DELIMITED SIZE\n               ' client IP: '\n                 DELIMITED SIZE\n               WS-CLNT-ADDR\n                 DELIMITED SIZE\n               ' client name: '\n                 DELIMITED SIZE\n               WS-CLNT-NM(1:WS-CLNT-NM-LN)\n                 DELIMITED SIZE\n             INTO\n               WTO-SUFX\n             POINTER\n               WTO-SUFX-LN\n           END-STRING\n           .\n\n       8950-MAKE-SRVR-CD-PG-ERR-SUFX.\n      *\n      * Construct operator message suffix indicating the server\n      * code page that was invalid.\n      *\n           SET HAVE-ERR-MSG-SUFX TO TRUE\n           INITIALIZE WTO-SUFX\n           MOVE 1 TO WTO-SUFX-LN\n           STRING\n               ' server code page is '\n                 DELIMITED SIZE\n               HOST-CD-PG\n                 DELIMITED SIZE\n               ' server IP: '\n                 DELIMITED SIZE\n               WS-SRVR-ADDR\n                 DELIMITED SIZE\n               ' port: '\n                 DELIMITED SIZE\n               WS-PORT-NB\n                 DELIMITED SIZE\n               ' server name: '\n                 DELIMITED SIZE\n               WS-SRVR-NM(1:WS-SRVR-NM-LN)\n                 DELIMITED SIZE\n             INTO\n               WTO-SUFX\n             POINTER\n               WTO-SUFX-LN\n           END-STRING\n           .\n\n       8960-MAKE-C-S-CD-PG-ERR-SUFX.\n      *\n      * Construct operator message suffix indicating the client and\n      * server code page combination that was invalid.\n      *\n           SET HAVE-ERR-MSG-SUFX TO TRUE\n           INITIALIZE WTO-SUFX\n           MOVE 1 TO WTO-SUFX-LN\n           STRING\n               ' client code page is '\n                 DELIMITED SIZE\n               WS-HTTP-CLNT-CHARSET\n                 DELIMITED SIZE\n               ' client IP: '\n                 DELIMITED SIZE\n               WS-CLNT-ADDR\n                 DELIMITED SIZE\n               ' client name: '\n                 DELIMITED SIZE\n               WS-CLNT-NM(1:WS-CLNT-NM-LN)\n                 DELIMITED SIZE\n               ' server code page is '\n                 DELIMITED SIZE\n               HOST-CD-PG\n                 DELIMITED SIZE\n               ' server IP: '\n                 DELIMITED SIZE\n               WS-SRVR-ADDR\n                 DELIMITED SIZE\n               ' port: '\n                 DELIMITED SIZE\n               WS-PORT-NB\n                 DELIMITED SIZE\n               ' server name: '\n                 DELIMITED SIZE\n               WS-SRVR-NM(1:WS-SRVR-NM-LN)\n                 DELIMITED SIZE\n             INTO\n               WTO-SUFX\n             POINTER\n               WTO-SUFX-LN\n           END-STRING\n           .\n\n       9100-WTO.\n      *\n      * In order to avoid issues with the WRITE OPERATOR CICS API\n      * not being threadsafe, it is encapsulated in its own program\n      * object and we LINK to it instead of dynamically CALLing it.\n      * The CICS Programming Guide has a good explanation of\n      * threadsafe and its implications.\n      *\n      * And just look at how messy life gets if you encounter an\n      * error within error handling code.\n      *\n           SET CICS-ERR TO TRUE\n           MOVE WTO-LN  TO WTO-CA-TXT-LN\n           MOVE WTO-TXT TO WTO-CA-TXT\n           MOVE MSG-NB  TO WTO-CA-MSG-NB\n           MOVE MYNAME  TO WTO-CA-CALLER\n           MOVE LENGTH OF WTO-CA TO WTO-CA-LN\n\n           EXEC CICS\n               LINK\n               PROGRAM(CICS-WTO-PGM)\n               COMMAREA(WTO-CA)\n               LENGTH(WTO-CA-LN)\n               RESP(WS-RESP)\n               RESP2(WS-RESP2)\n           END-EXEC\n\n           IF WTO-CA-RC-NORMAL AND WS-RESP = DFHRESP(NORMAL)\n               CONTINUE\n           ELSE\n               PERFORM 8900-GET-CICS-RESP-MNEMONIC\n               DISPLAY\n                 MYNAME\n                 SPACE\n                 CICS-WTO-PGM\n                 ' RC = '\n                 WTO-CA-RC\n                 ' RESP = '\n                 WS-RESP\n                 ' CICS RESP MNEMONIC = '\n                 WS-CICS-RESP-MNEMONIC\n                 ' RESP2 = '\n                 WS-RESP2\n                 ' attempting to write operator '\n                 WTO-CA-TXT(1:WTO-CA-TXT-LN)\n               STRING\n                   MYNAME DELIMITED SIZE\n                   ' State dump in 9100-WTO ' DELIMITED SIZE\n                 INTO\n                   CEE3DMP-TITL-SPFC OF LCL-APLC-DEBUG-AREA\n               END-STRING\n               CALL 'CEE3DMP' USING\n                   CEE3DMP-TITL    OF LCL-APLC-DEBUG-AREA\n                   CEE3DMP-OPTIONS OF LCL-APLC-DEBUG-AREA\n                   CEE3DMP-LEFB-CD OF LCL-APLC-DEBUG-AREA\n               END-CALL\n           END-IF\n           .\n\n       End Program HTTPSAMP.\n./ ADD NAME=J7200501 0206-01276-07150-1111-00242-00181-00060-DOTCWS\n       PROCESS XOPTS(FLAG(I),COBOL3,NOLINKAGE)\n       Identification Division.\n       Program-ID. J7200501.\n       Author. Craig Schneiderwent.\n      *\n      * Return the mnemonic for a given CICS EIBRESP value.\n      *\n       Data Division.\n       Linkage Section.\n       01  RESP-CD  PIC 9(008) COMP-5.\n       01  RESP-TXT PIC X(025).\n       Procedure Division Using\n           RESP-CD\n           RESP-TXT\n           .\n\n           EVALUATE RESP-CD\n               WHEN DFHRESP( NORMAL )\n                    MOVE 'NORMAL' TO RESP-TXT\n               WHEN DFHRESP( ERROR  )\n                    MOVE 'ERROR' TO RESP-TXT\n               WHEN DFHRESP( RDATT )\n                    MOVE 'RDATT' TO RESP-TXT\n               WHEN DFHRESP( WRBRK )\n                    MOVE 'WRBRK' TO RESP-TXT\n               WHEN DFHRESP( EOF )\n                    MOVE 'EOF' TO RESP-TXT\n               WHEN DFHRESP( EODS )\n                    MOVE 'EODS' TO RESP-TXT\n               WHEN DFHRESP( EOC )\n                    MOVE 'EOC' TO RESP-TXT\n               WHEN DFHRESP( INBFMH )\n                    MOVE 'INBFMH' TO RESP-TXT\n               WHEN DFHRESP( ENDINPT )\n                    MOVE 'ENDINPT' TO RESP-TXT\n               WHEN DFHRESP( NONVAL )\n                    MOVE 'NONVAL' TO RESP-TXT\n               WHEN DFHRESP( NOSTART )\n                    MOVE 'NOSTART' TO RESP-TXT\n               WHEN DFHRESP( TERMIDERR )\n                    MOVE 'TERMIDERR' TO RESP-TXT\n               WHEN DFHRESP( FILENOTFOUND )\n                    MOVE 'FILENOTFOUND' TO RESP-TXT\n               WHEN DFHRESP( NOTFND )\n                    MOVE 'NOTFND' TO RESP-TXT\n               WHEN DFHRESP( DUPREC )\n                    MOVE 'DUPREC' TO RESP-TXT\n               WHEN DFHRESP( DUPKEY )\n                    MOVE 'DUPKEY' TO RESP-TXT\n               WHEN DFHRESP( INVREQ )\n                    MOVE 'INVREQ' TO RESP-TXT\n               WHEN DFHRESP( IOERR )\n                    MOVE 'IOERR' TO RESP-TXT\n               WHEN DFHRESP( NOSPACE )\n                    MOVE 'NOSPACE' TO RESP-TXT\n               WHEN DFHRESP( NOTOPEN )\n                    MOVE 'NOTOPEN' TO RESP-TXT\n               WHEN DFHRESP( ENDFILE )\n                    MOVE 'ENDFILE' TO RESP-TXT\n               WHEN DFHRESP( ILLOGIC )\n                    MOVE 'ILLOGIC' TO RESP-TXT\n               WHEN DFHRESP( LENGERR )\n                    MOVE 'LENGERR' TO RESP-TXT\n               WHEN DFHRESP( QZERO )\n                    MOVE 'QZERO' TO RESP-TXT\n               WHEN DFHRESP( SIGNAL )\n                    MOVE 'SIGNAL' TO RESP-TXT\n               WHEN DFHRESP( QBUSY )\n                    MOVE 'QBUSY' TO RESP-TXT\n               WHEN DFHRESP( ITEMERR )\n                    MOVE 'ITEMERR' TO RESP-TXT\n               WHEN DFHRESP( PGMIDERR )\n                    MOVE 'PGMIDERR' TO RESP-TXT\n               WHEN DFHRESP( TRANSIDERR )\n                    MOVE 'TRANSIDERR' TO RESP-TXT\n               WHEN DFHRESP( ENDDATA )\n                    MOVE 'ENDDATA' TO RESP-TXT\n               WHEN DFHRESP( EXPIRED )\n                    MOVE 'EXPIRED' TO RESP-TXT\n               WHEN DFHRESP( RETPAGE )\n                    MOVE 'RETPAGE' TO RESP-TXT\n               WHEN DFHRESP( RTEFAIL )\n                    MOVE 'RTEFAIL' TO RESP-TXT\n               WHEN DFHRESP( RTESOME )\n                    MOVE 'RTESOME' TO RESP-TXT\n               WHEN DFHRESP( TSIOERR )\n                    MOVE 'TSIOERR' TO RESP-TXT\n               WHEN DFHRESP( MAPFAIL )\n                    MOVE 'MAPFAIL' TO RESP-TXT\n               WHEN DFHRESP( INVERRTERM )\n                    MOVE 'INVERRTERM' TO RESP-TXT\n               WHEN DFHRESP( INVMPSZ )\n                    MOVE 'INVMPSZ' TO RESP-TXT\n               WHEN DFHRESP( IGREQID )\n                    MOVE 'IGREQID' TO RESP-TXT\n               WHEN DFHRESP( OVERFLOW )\n                    MOVE 'OVERFLOW' TO RESP-TXT\n               WHEN DFHRESP( INVLDC )\n                    MOVE 'INVLDC' TO RESP-TXT\n               WHEN DFHRESP( NOSTG )\n                    MOVE 'NOSTG' TO RESP-TXT\n               WHEN DFHRESP( JIDERR )\n                    MOVE 'JIDERR' TO RESP-TXT\n               WHEN DFHRESP( QIDERR )\n                    MOVE 'QIDERR' TO RESP-TXT\n               WHEN DFHRESP( NOJBUFSP )\n                    MOVE 'NOJBUFSP' TO RESP-TXT\n               WHEN DFHRESP( DSSTAT )\n                    MOVE 'DSSTAT' TO RESP-TXT\n               WHEN DFHRESP( SELNERR )\n                    MOVE 'SELNERR' TO RESP-TXT\n               WHEN DFHRESP( FUNCERR )\n                    MOVE 'FUNCERR' TO RESP-TXT\n               WHEN DFHRESP( UNEXPIN )\n                    MOVE 'UNEXPIN' TO RESP-TXT\n               WHEN DFHRESP( NOPASSBKRD )\n                    MOVE 'NOPASSBKRD' TO RESP-TXT\n               WHEN DFHRESP( NOPASSBKWR )\n                    MOVE 'NOPASSBKWR' TO RESP-TXT\n               WHEN DFHRESP( SYSIDERR )\n                    MOVE 'SYSIDERR' TO RESP-TXT\n               WHEN DFHRESP( ISCINVREQ )\n                    MOVE 'ISCINVREQ' TO RESP-TXT\n               WHEN DFHRESP( ENQBUSY )\n                    MOVE 'ENQBUSY' TO RESP-TXT\n               WHEN DFHRESP( ENVDEFERR )\n                    MOVE 'ENVDEFERR' TO RESP-TXT\n               WHEN DFHRESP( IGREQCD )\n                    MOVE 'IGREQCD' TO RESP-TXT\n               WHEN DFHRESP( SESSIONERR )\n                    MOVE 'SESSIONERR' TO RESP-TXT\n               WHEN DFHRESP( SYSBUSY )\n                    MOVE 'SYSBUSY' TO RESP-TXT\n               WHEN DFHRESP( SESSBUSY )\n                    MOVE 'SESSBUSY' TO RESP-TXT\n               WHEN DFHRESP( NOTALLOC )\n                    MOVE 'NOTALLOC' TO RESP-TXT\n               WHEN DFHRESP( CBIDERR )\n                    MOVE 'CBIDERR' TO RESP-TXT\n               WHEN DFHRESP( INVEXITREQ )\n                    MOVE 'INVEXITREQ' TO RESP-TXT\n               WHEN DFHRESP( INVPARTNSET )\n                    MOVE 'INVPARTNSET' TO RESP-TXT\n               WHEN DFHRESP( INVPARTN )\n                    MOVE 'INVPARTN' TO RESP-TXT\n               WHEN DFHRESP( PARTNFAIL )\n                    MOVE 'PARTNFAIL' TO RESP-TXT\n               WHEN DFHRESP( USERIDERR )\n                    MOVE 'USERIDERR' TO RESP-TXT\n               WHEN DFHRESP( NOTAUTH )\n                    MOVE 'NOTAUTH' TO RESP-TXT\n               WHEN DFHRESP( SUPPRESSED )\n                    MOVE 'SUPPRESSED' TO RESP-TXT\n               WHEN DFHRESP( NOSPOOL )\n                    MOVE 'NOSPOOL' TO RESP-TXT\n               WHEN DFHRESP( TERMERR )\n                    MOVE 'TERMERR' TO RESP-TXT\n               WHEN DFHRESP( ROLLEDBACK )\n                    MOVE 'ROLLEDBACK' TO RESP-TXT\n               WHEN DFHRESP( END )\n                    MOVE 'END' TO RESP-TXT\n               WHEN DFHRESP( DISABLED )\n                    MOVE 'DISABLED' TO RESP-TXT\n               WHEN DFHRESP( ALLOCERR )\n                    MOVE 'ALLOCERR' TO RESP-TXT\n               WHEN DFHRESP( STRELERR )\n                    MOVE 'STRELERR' TO RESP-TXT\n               WHEN DFHRESP( OPENERR )\n                    MOVE 'OPENERR' TO RESP-TXT\n               WHEN DFHRESP( SPOLBUSY )\n                    MOVE 'SPOLBUSY' TO RESP-TXT\n               WHEN DFHRESP( SPOLERR )\n                    MOVE 'SPOLERR' TO RESP-TXT\n               WHEN DFHRESP( NODEIDERR )\n                    MOVE 'NODEIDERR' TO RESP-TXT\n               WHEN DFHRESP( TASKIDERR )\n                    MOVE 'TASKIDERR' TO RESP-TXT\n               WHEN DFHRESP( TCIDERR )\n                    MOVE 'TCIDERR' TO RESP-TXT\n               WHEN DFHRESP( DSNNOTFOUND )\n                    MOVE 'DSNNOTFOUND' TO RESP-TXT\n               WHEN DFHRESP( LOADING )\n                    MOVE 'LOADING' TO RESP-TXT\n               WHEN DFHRESP( MODELIDERR )\n                    MOVE 'MODELIDERR' TO RESP-TXT\n               WHEN DFHRESP( OUTDESCRERR )\n                    MOVE 'OUTDESCRERR' TO RESP-TXT\n               WHEN DFHRESP( PARTNERIDERR )\n                    MOVE 'PARTNERIDERR' TO RESP-TXT\n               WHEN DFHRESP( PROFILEIDERR )\n                    MOVE 'PROFILEIDERR' TO RESP-TXT\n               WHEN DFHRESP( NETNAMEIDERR )\n                    MOVE 'NETNAMEIDERR' TO RESP-TXT\n               WHEN DFHRESP( LOCKED )\n                    MOVE 'LOCKED' TO RESP-TXT\n               WHEN DFHRESP( RECORDBUSY )\n                    MOVE 'RECORDBUSY' TO RESP-TXT\n               WHEN DFHRESP( UOWNOTFOUND )\n                    MOVE 'UOWNOTFOUND' TO RESP-TXT\n               WHEN DFHRESP( UOWLNOTFOUND )\n                    MOVE 'UOWLNOTFOUND' TO RESP-TXT\n               WHEN DFHRESP( LINKABEND )\n                    MOVE 'LINKABEND' TO RESP-TXT\n               WHEN DFHRESP( CHANGED )\n                    MOVE 'CHANGED' TO RESP-TXT\n               WHEN DFHRESP( PROCESSBUSY )\n                    MOVE 'PROCESSBUSY' TO RESP-TXT\n               WHEN DFHRESP( ACTIVITYBUSY )\n                    MOVE 'ACTIVITYBUSY' TO RESP-TXT\n               WHEN DFHRESP( PROCESSERR )\n                    MOVE 'PROCESSERR' TO RESP-TXT\n               WHEN DFHRESP( ACTIVITYERR )\n                    MOVE 'ACTIVITYERR' TO RESP-TXT\n               WHEN DFHRESP( CONTAINERERR )\n                    MOVE 'CONTAINERERR' TO RESP-TXT\n               WHEN DFHRESP( EVENTERR )\n                    MOVE 'EVENTERR' TO RESP-TXT\n               WHEN DFHRESP( TOKENERR )\n                    MOVE 'TOKENERR' TO RESP-TXT\n               WHEN DFHRESP( NOTFINISHED )\n                    MOVE 'NOTFINISHED' TO RESP-TXT\n               WHEN DFHRESP( POOLERR )\n                    MOVE 'POOLERR' TO RESP-TXT\n               WHEN DFHRESP( TIMERERR )\n                    MOVE 'TIMERERR' TO RESP-TXT\n               WHEN DFHRESP( SYMBOLERR )\n                    MOVE 'SYMBOLERR' TO RESP-TXT\n               WHEN DFHRESP( TEMPLATERR )\n                    MOVE 'TEMPLATERR' TO RESP-TXT\n               WHEN DFHRESP( RESUNAVAIL )\n                    MOVE 'RESUNAVAIL' TO RESP-TXT\n               WHEN DFHRESP( CHANNELERR )\n                    MOVE 'CHANNELERR' TO RESP-TXT\n               WHEN DFHRESP( CCSIDERR )\n                    MOVE 'CCSIDERR' TO RESP-TXT\n               WHEN OTHER\n                    MOVE 'UNKNOWN' TO RESP-TXT\n           END-EVALUATE\n\n           GOBACK\n           .\n\n./ ADD NAME=J7200521 0211-06103-06286-1305-00271-00155-00061-DOTCWS\n       Identification Division.\n       Program-ID.    J7200521.\n       Author.        Craig Schneiderwent.\n      *\n      * Encapsulate the CICS WRITE OPERATOR function.  Caller must\n      * specify a message number, which will be prefixed with 'UDOT'\n      * and a message type of 'I' (Informational), 'W' (Warning),\n      * 'E' (Error), or 'S' (Severe).\n      *\n      * Good practice is to document the message, currently the place\n      * to do that is in MVS/QuickRef.  These messages will be used\n      * by on-call and operations staff in problem resolution\n      * situations - do your best to help them out with meaningful\n      * diagnostics in the message and good documentation of the\n      * message.\n      *\n      * In order to avoid issues with the WRITE OPERATOR CICS API\n      * not being threadsafe, it is encapsulated here in its own\n      * program object and we LINK to it instead of dynamically\n      * CALLing it.\n      *\n      * The CICS Programming Guide has a good explanation of\n      * threadsafe and its implications.\n      *\n      *\n      * Sample Use:\n      *\n      *Working-Storage Section.\n      *01  CONSTANTS.\n      *    05  MYNAME                  PIC X(008) VALUE 'J8675309'.\n      *    05  CICS-ERR-TXT-PGM        PIC X(008) VALUE 'J7200501'.\n      *    05  CICS-WTO-PGM            PIC X(008) VALUE 'J7200521'.\n      *    05  MSG-NB                  PIC X(004) VALUE '0005'.\n      *\n      *01  WORK-AREAS.\n      *    05  CICS-RESP               PIC S9(008) COMP-5.\n      *    05  CICS-RESP2              PIC S9(008) COMP-5.\n      *    05  WTO-CA-LN               PIC 9(008)  COMP-5.\n      *    05  DATA-TXT                PIC X(025)\n      *        VALUE 'Test message'.\n      *\n      *01  WTO-CA.\n      *    COPY J7200521 REPLACING ==:PRFX:== BY ==WTO-==.\n      *\n      *Procedure Division.\n      *    MOVE LENGTH OF DATA-TXT TO WTO-TXT-LN\n      *    MOVE DATA-TXT TO WTO-TXT\n      *    MOVE '0005' TO WTO-MSG-NB\n      *    SET WTO-MSG-TY-ERR TO TRUE\n      *    MOVE MYNAME TO WTO-CALLER\n      *    MOVE LENGTH OF WTO-CA TO WTO-CA-LN\n      *    EXEC CICS LINK\n      *        PROGRAM(CICS-WTO-PGM)\n      *        COMMAREA(WTO-CA)\n      *        LENGTH(WTO-CA-LN)\n      *        RESP(CICS-RESP)\n      *        RESP2(CICS-RESP2)\n      *    END-EXEC\n      *\n      *    IF WTO-RC-NORMAL AND CICS-RESP = DFHRESP(NORMAL)\n      *        CONTINUE\n      *    ELSE\n      *        ...error handling\n      *    END-IF\n      *\n      * Return Codes:\n      * 0  - Success\n      * 4  - Invalid parameter(s)\n      *      An error message will be DISPLAYed\n      * 16 - Failure\n      *\n      *\n       Environment Division.\n       Configuration Section.\n       Data Division.\n       Working-Storage Section.\n       01  CONSTANTS.\n           05  MYNAME                  PIC X(008) VALUE 'J7200521'.\n           05  CICS-ERR-PGM            PIC X(008) VALUE 'J7200501'.\n           05  ERR-MSG-PRFX            PIC X(004) VALUE 'UDOT'.\n\n       01  WORK-AREAS.\n           05  ERR-MSG-LN              PIC 9(008) COMP-5 VALUE 1.\n           05  CICS-APPL-ID            PIC X(008) VALUE SPACES.\n           05  THIS-USERID             PIC X(008) VALUE SPACES.\n           05  ERR-MSG-WTO.\n               10                      PIC X(050) OCCURS 13.\n               10                      PIC X(040).\n           05  CICS-API-FAILED         PIC X(030) VALUE SPACES.\n           05  CICS-API-FAILED-LOC     PIC X(004) VALUE SPACES.\n           05  CICS-RESP-TXT           PIC X(025) VALUE SPACES.\n           05  CICS-RESP-DSPL          PIC 9(010) VALUE ZEROES.\n           05  CICS-RESP-DSPL-X\n               REDEFINES\n               CICS-RESP-DSPL          PIC X(010).\n           05  CICS-RESP2-DSPL         PIC 9(010) VALUE ZEROES.\n           05  CICS-RESP2-DSPL-X\n               REDEFINES\n               CICS-RESP2-DSPL         PIC X(010).\n\n\n       Linkage Section.\n       01  DFHCOMMAREA.\n           COPY J7200521 REPLACING ==:PRFX:== BY ==LS-==.\n\n       Procedure Division Using\n           DFHCOMMAREA\n           .\n\n\n           SET LS-RC-NORMAL TO TRUE\n           INITIALIZE ERR-MSG-WTO\n           PERFORM 0100-EDIT-PARMS\n\n           IF LS-RC-NORMAL\n               CONTINUE\n           ELSE\n               EXEC CICS RETURN END-EXEC\n           END-IF\n\n           EXEC CICS ASSIGN\n               APPLID(CICS-APPL-ID)\n               USERID(THIS-USERID)\n               NOHANDLE\n           END-EXEC\n\n           MOVE EIBRESP  TO LS-RESP\n           MOVE EIBRESP2 TO LS-RESP2\n\n           IF EIBRESP = DFHRESP( NORMAL )\n               PERFORM 9040-FMT-MSG-01\n               PERFORM 9100-WTO\n           ELSE\n      *        The documentation for CICS TS 2.2 doesn't list any\n      *        way for the above CICS ASSIGN call to fail, but this\n      *        routine is likely to be called as an application is\n      *        failing.  Hence the \"belt _and_ suspenders\" technique.\n               MOVE 'ASSIGN' TO CICS-API-FAILED\n               MOVE 'MAIN'   TO CICS-API-FAILED-LOC\n               PERFORM 9200-DSPL-CICS-ERR\n               SET LS-RC-BAD TO TRUE\n           END-IF\n\n           EXEC CICS RETURN END-EXEC\n           .\n\n       0100-EDIT-PARMS.\n           IF LS-MSG-TY-VALID\n               CONTINUE\n           ELSE\n               DISPLAY\n                   MYNAME\n                   ' message type ('\n                   LS-MSG-TY\n                   ') is invalid.  Valid values are I W E S.'\n               SET LS-RC-INVD-PARM TO TRUE\n           END-IF\n\n           IF LS-TXT-LN-VALID\n               CONTINUE\n           ELSE\n               DISPLAY\n                   MYNAME\n                   ' message length ('\n                   LS-TXT-LN\n                   ') is invalid.  0 < length <= 690.'\n               SET LS-RC-INVD-PARM TO TRUE\n           END-IF\n           .\n\n       9040-FMT-MSG-01.\n\n           MOVE SPACES TO ERR-MSG-WTO\n           MOVE +1     TO ERR-MSG-LN\n           STRING\n               ERR-MSG-PRFX\n                 DELIMITED BY SIZE\n               LS-MSG-NB\n                 DELIMITED BY SIZE\n               LS-MSG-TY\n                 DELIMITED BY SIZE\n               SPACE\n                 DELIMITED BY SIZE\n               CICS-APPL-ID\n                 DELIMITED BY SIZE\n               SPACE\n                 DELIMITED BY SIZE\n               EIBTRNID\n                 DELIMITED BY SIZE\n               SPACE\n                 DELIMITED BY SIZE\n               LS-CALLER\n                 DELIMITED BY SIZE\n               SPACE\n                 DELIMITED BY SIZE\n               THIS-USERID\n                 DELIMITED BY SIZE\n               SPACE\n                 DELIMITED BY SIZE\n               LS-TXT(1:LS-TXT-LN)\n                 DELIMITED BY SIZE\n             INTO\n               ERR-MSG-WTO\n             WITH POINTER\n               ERR-MSG-LN\n           END-STRING\n           .\n\n       9100-WTO.\n      *\n      *    The NOHANDLE is here because if an error occurs during\n      *    error processing, an abend is too likely to create an\n      *    abend loop.\n      *\n           EXEC CICS\n                WRITE OPERATOR\n                TEXT(ERR-MSG-WTO)\n                TEXTLENGTH(ERR-MSG-LN)\n                NOHANDLE\n           END-EXEC\n\n           MOVE EIBRESP  TO LS-RESP\n           MOVE EIBRESP2 TO LS-RESP2\n           IF EIBRESP = DFHRESP( NORMAL )\n               CONTINUE\n           ELSE\n               MOVE 'WRITE OPERATOR' TO CICS-API-FAILED\n               MOVE '9100'           TO CICS-API-FAILED-LOC\n               SET LS-RC-BAD TO TRUE\n               PERFORM 9200-DSPL-CICS-ERR\n           END-IF\n           .\n\n       9200-DSPL-CICS-ERR.\n      *\n      * This is really a last ditch effort at error determination.  If\n      * the ASSIGN or WRITE OPERATOR calls fail, this paragraph will\n      * provide at least some indication of the problem.\n      *\n           CALL CICS-ERR-PGM USING\n               LS-RESP\n               CICS-RESP-TXT\n           END-CALL\n           MOVE LS-RESP    TO CICS-RESP-DSPL\n           MOVE LS-RESP2   TO CICS-RESP2-DSPL\n\n           DISPLAY\n               MYNAME\n               SPACE\n               CICS-API-FAILED\n               ' FAILED AT '\n               CICS-API-FAILED-LOC\n               SPACE\n               ' RESP = '\n               CICS-RESP-DSPL\n               ' RESP TEXT = '\n               CICS-RESP-TXT\n               ' RESP2 = '\n               CICS-RESP2-DSPL\n               ' CALLER = '\n               LS-CALLER\n               ' MESSAGE # = '\n               LS-MSG-NB\n               ' MESSAGE TYPE = '\n               LS-MSG-TY\n               ' WTO TEXT LENGTH = '\n               LS-TXT-LN\n               ' WTO TEXT = '\n               LS-TXT(1:LS-TXT-LN)\n           .\n\n./ ADD NAME=J7200524 0201-06248-07165-1238-00123-00032-00004-DOTCWS\n       Identification Division.\n       Program-ID.    J7200524.\n      *\n      * This program wraps up the LE callable services necessary to\n      * obtain the current date and time (GMT or local) and format\n      * that date and/or time according to a format string.  This\n      * is conceptually similar to the C function strftime().\n      *\n      * Valid values for the format string can be found by looking\n      * up the CEEDATM callable service in the Language Environment\n      * Programming Reference.\n      *\n      * If errors are encountered in any of the LE callable services,\n      * the service will display a message.  It appears that CEEMSG\n      * is used for this purpose.\n      *\n      * Under systems other than CICS, Language Environment writes\n      * the message to the ddname of the file specified in the MSGFILE\n      * run-time option. Under CICS, the message is written to a\n      * transient data queue named CESE.\n      *\n      * Currently, this means that in batch the message is likely to\n      * be found in SYSOUT and in CICS it's likely to be found in\n      * CEEMSG.\n      *\n      *Working-Storage Section.\n      *01  CONSTANTS.\n      *    05  MYNAME                  PIC X(008) VALUE 'J8675309'.\n      *    05  FMT-DT-TM-PGM           PIC X(008) VALUE 'J7200524'.\n      *\n      *01  LCL-TM-SW               PIC X(001).\n      *    88  LCL-TM                         VALUE 'Y'.\n      *    88  GMT-TM                         VALUE 'N'.\n      *\n      *01  DT-PIC-STRN.\n      *    05  DT-PIC-STRN-LEN     PIC S9(004) COMP-5 VALUE +80.\n      *    05  DT-PIC-STRN-VAL     PIC X(080)\n      *        VALUE 'Www, DD Mmm YYYY HH:MI:SS GMT'.\n      *\n      *01  FMT-DT-TM               PIC X(080) VALUE SPACES.\n      *\n      *Procedure Division.\n      *    SET GMT-TM TO TRUE\n      *    CALL J7200524-PGM USING\n      *        LCL-TM-SW\n      *        DT-PIC-STRN\n      *        FMT-DT-TM\n      *    END-CALL\n      *\n\n       Environment Division.\n       Data Division.\n       Working-Storage Section.\n       01  CONSTANTS.\n           05  MYNAME                  PIC X(008) VALUE 'J7200524'.\n\n       01  WORK-AREAS.\n           05  GMT-LILIAN              PIC 9(008) COMP-5 VALUE 0.\n           05  GMT-FLOT                           COMP-2 VALUE 0.0.\n           05  OSET-HRS                           COMP-2 VALUE 0.0.\n           05  OSET-MIN                           COMP-2 VALUE 0.0.\n           05  OSET-SEC                           COMP-2 VALUE 0.0.\n\n       Linkage Section.\n      * Input -  Switch indicating whether to pass back local time\n      *          or GMT.  A value of 'Y' in this field indicates\n      *          local time should be used.  Any value other than 'Y'\n      *          indicates GMT should be used.\n       01  LCL-TM-SW               PIC X(001).\n           88  LCL-TM                         VALUE 'Y'.\n\n      * Input -  Date picture string prefixed by its length.  Valid\n      *          picture string formatting is documented in the\n      *          Language Environment Programming Reference.\n       01  DT-PIC-STRN.\n           05  DT-PIC-STRN-LEN     PIC S9(004) COMP-5.\n           05  DT-PIC-STRN-VAL\n               OCCURS 1 TO 80\n               DEPENDING DT-PIC-STRN-LEN\n                                   PIC X(001).\n\n      * Output - GMT date/time formatted according to the content\n      *          of DT-PIC-STRN-VAL.\n       01  FMT-DT-TM               PIC X(080).\n\n       Procedure Division Using\n           LCL-TM-SW\n           DT-PIC-STRN\n           FMT-DT-TM\n           .\n\n           MOVE SPACES TO FMT-DT-TM\n\n      *    Obtain GMT time.\n           CALL 'CEEGMT' USING\n               GMT-LILIAN\n               GMT-FLOT\n               OMITTED\n           END-CALL\n\n           IF LCL-TM\n      *        If local time requested, obtain its offset from GMT\n      *        and compute local time.\n               CALL 'CEEGMTO' USING\n                   OSET-HRS\n                   OSET-MIN\n                   OSET-SEC\n                   OMITTED\n               END-CALL\n               ADD OSET-SEC TO GMT-FLOT\n           END-IF\n\n      *    Format the date according to the passed picture string.\n           CALL 'CEEDATM' USING\n               GMT-FLOT\n               DT-PIC-STRN\n               FMT-DT-TM\n               OMITTED\n           END-CALL\n\n           MOVE 0       TO RETURN-CODE\n           GOBACK.\n\n", "mimetype": "text/plain", "datatype": "ebcdic", "extension": ".txt"}}}}, "SCRIPTOPTIONS": {"filename": "./CBT775/FILE775.XMI", "LRECL": 80, "loglevel": 30, "outputfolder": "CBT775", "encoding": "cp1140", "unnum": true, "quiet": false, "force": false, "binary": false, "modifydate": true}}