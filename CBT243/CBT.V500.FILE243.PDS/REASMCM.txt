*PROCESS M,OPT(TIME);
 /*
//PGMVYCI JOB 'IBI','V CHERNYAK',REGION=1000K,NOTIFY=PGMVYC,CLASS=A,
//        MSGCLASS=A,MSGLEVEL=(1,1),USER=PGMVYC,PASSWORD=CH
//        EXEC PLIXCL,PARM.LKED='LET,NCAL'
/*ROUTE PRINT IBIVM.PGMVYC
//PLI.SYSIN     DD DSN=PGMVYC.REASM.PLI(REASMCM),DISP=SHR
//PLI.SYSLIB    DD DSN=PGMVYC.REASM.PLI,DISP=SHR
//LKED.SYSLMOD  DD DSN=PGMVYC.REASM.SUBLOAD(REASMCM),DISP=SHR
//
 */
 /* REASMCM: SUBROUTINE TO TEST COMMAND FOR SOME CONDITION.
             'BRANCH' - TEST IF COMMAND IS BRANCH-CLASS COMMAND
             'USING'  - TEST IF COMMAND IS USING/DROP TYPE
             'PRIV'   - TEST IF IT'S PRIVATE COMMAND
    EXAMPLE OF USE:
    IF REASMCM(@, OPER, 'PRIV') THEN ...
 */
 REASMCM:
   PROC(@, CMD, COND) REORDER RED RETURNS(BIT(1));
   DCL 1   @(256) ALIGNED CONNECTED,
        2  N     CHAR(6),
        2  V     BIT(16) ALIGNED,
        2  F     BIN FIXED,
        2  P     BIT(1),
        CMD      CHAR(*),
        COND     CHAR(*);
   DCL  I;
   DCL  SUBSTR BUILTIN;

   IF  (COND='BRANCH') &
       (SUBSTR(CMD,1,1) = 'B') THEN RETURN('1'B);

   IF  (COND='USING') &
       (CMD='USING' | CMD='DROP') THEN RETURN('1'B);

   DO I=1 TO 256 WHILE(@(I).V Â¬= 0);
     IF CMD = @(I).N THEN DO;
       SELECT (COND);
         WHEN ('PRIV') DO;
           RETURN (@(I).P);
         END;
         OTHER
           RETURN ('0'B);
       END;
     END;
   END;

   RETURN('0'B);
 END REASMCM;
