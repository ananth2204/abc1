  FORMAT:MACRO(%PR,%PU,%NJP,%AC,%DDNAME=,%DEST=,%CONTROL=,%COPIES=,
  %FORMS=,%CARRIAGE=,%TRAIN=,%OVFL=,%INT=,%FROM=,%ERDEST=,
  %USER=,%PRINT=) ;
   IF %SPOOL ¬= 'ASP' THEN
      SIGNAL 2,'ASP FORMAT CARD GENERATED FOR %SPOOL' ;
   IF %PR = '' & %PU = '' & %NJP = '' & %AC = '' THEN
      STOP 'ASP FORMAT MACRO: PR | PU | NJP | AC NOT CODED' ;
   IF %PR = 'PR' & (%PU = 'PU' | %NJP = 'NJP' | %AC = 'AC') THEN
      STOP 'ASP FORMAT MACRO: TOO MANY TYPES %PR,%PU,%NJP,%AC' ;
   IF %PU = 'PU' & (%NJP = 'NJP' | %AC = 'AC') THEN
      STOP 'ASP FORMAT MACRO: TOO MANY TYPES %PR,%PU,%NJP,%AC' ;
   IF %NJP = 'NJP' & %AC = 'AC' THEN
      STOP 'ASP FORMAT MACRO: TOO MANY TYPES %PR,%PU,%NJP,%AC' ;
   IF %PR = 'PR' THEN
   DO ;
      %DDNAME = 'PR,DDNAME=%DDNAME' ;
      IF %DEST     ¬= '' THEN %DDNAME = '%DDNAME,DEST=%DEST' ;
      IF %CONTROL  ¬= '' THEN %DDNAME = '%DDNAME,CONTROL=%CONTROL' ;
      IF %COPIES   ¬= '' THEN %DDNAME = '%DDNAME,COPIES=%COPIES' ;
      IF %FORMS    ¬= '' THEN %DDNAME = '%DDNAME,FORMS=%FORMS' ;
      IF %CARRIAGE ¬= '' THEN %DDNAME = '%DDNAME,CARRIAGE=%CARRIAGE' ;
      IF %TRAIN    ¬= '' THEN %DDNAME = '%DDNAME,TRAIN=%TRAIN' ;
      IF %OVFL     ¬= '' THEN %DDNAME = '%DDNAME,OVFL=%OVFL' ;
   END ;
   IF %PU = 'PU' THEN
   DO ;
      %DDNAME = 'PU,DDNAME=%DDNAME' ;
      IF %DEST     ¬= '' THEN %DDNAME = '%DDNAME,DEST=%DEST' ;
      IF %COPIES   ¬= '' THEN %DDNAME = '%DDNAME,COPIES=%COPIES' ;
      IF %FORMS    ¬= '' THEN %DDNAME = '%DDNAME,FORMS=%FORMS' ;
      IF %INT      ¬= '' THEN %DDNAME = '%DDNAME,INT=%INT' ;
   END ;
   IF %NJP = 'NJP' THEN
   DO ;
      %DDNAME = 'NJP,FROM=%FROM,DEST=%DEST' ;
      IF %FROM = '' | %DEST = '' THEN
         STOP 'ASP FORMAT CARD INVALID FOR .NJP.://*FORMAT %DDNAME' ;
   END ;
   IF %AC = 'AC' THEN
   DO ;
      IF %DDNAME = '' THEN
         STOP 'ASP FORMAT CARD INVALID FOR .AC.://*FORMAT %DDNAME' ;
      IF %ERDEST   ¬= '' THEN %DDNAME = '%DDNAME,ERDEST=%ERDEST' ;
      IF %PRINT    ¬= '' THEN %DDNAME = '%DDNAME,PRINT=%PRINT' ;
      IF %USER     ¬= '' THEN %DDNAME = '%DDNAME,USER=%USER' ;
   END ;
   OPCNTL '//*FORMAT %DDNAME' AFTER JOBCARD ;
   END ;
