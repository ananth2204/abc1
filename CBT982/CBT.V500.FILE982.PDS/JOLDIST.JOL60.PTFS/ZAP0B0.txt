//CLARKEZ JOB (1011,1011),CLARK1,MSGCLASS=X,NOTIFY=CLARKE
//ZAP EXEC PGM=IMASPZAP
//SYSLIB   DD  DSN=SYS2.LINKLIB,DISP=SHR
//SYSPRINT DD  SYSOUT=*
//SYSIN DD *
* PROBLEM: WHEN A DATA SET IS DELETED THEN ALLOCATED AND RECATLOGUED,
*          THE DATA SET IS DELETED AT THE END OF THE JOB.
*
* IN FACT, THREE ARE THREE MAIN PROBLEMS THAT SEEM TO OCCUR ON
*          F4 ONLY:-
*
* 1.       JOL SIGNALLED THAT AN ABEND OCCURRED, BUT NO DUMP WAS
*          TAKEN.
*
*          IN FACT, AN ABEND DID OCCUR, (AN 0B0), AND F4 DID NOT
*          SIGNAL THIS. WHY NO DUMP WAS TAKEN IS STILL TO BE RESOLVED.
*
* 2.       JOL PLACES DATA SETS ON THE PASSED DATA SET QUEUE MORE THAN
*          ONCE ON OCCASSIONS.
*
*          F4 BECOMES CONFUSED AND DELETES THE DATA SET.
*
*    ****  NOTE THIS ALSO HAPPENS WITH JCL - DOCUMENTATION TO FOLLOW.
*
* 3.       WHEN JOL DELETE OR KEPT A DATA SET, IT DID NOT SEARCH
*          THE PASS QUEUE FOR SECOND AND SUBSEQUENT DATA SET NAMES.
*
*
* SOLUTION: ZAP SCHEDULER AS FOLLOWS:-
*
*
* FIX1 :- REMOVE PDQ NAMES FOR KEEP
*
 NAME $JOLSH35 UJE07KEE
 BASE 5248
 VER 561A 47E0,B3DC       IS IT ISAM? NO GO OUT
 REP 561A 0700,0700       NEVER GO OUT
 IDRDATA PDQKEEP
*
* FIX2 :- REMOVE PDQ NAMES FOR DELETE
*
 NAME $JOLSH35 UJE08SCR
 BASE 5840
 VER 5C36 58DD,0004       PREPARE TO RETURN
 REP 5C36 58F0,B100       ADDRESS OF PASS QUEUE LOOKUP RTN
 REP 5C3A 05EF            CALL IT
 REP 5C3C 47F0,B394       BRANCH TO REMOVE FROM PDQ IF THERE
 IDRDATA PDQDEL
*
* FIX3 :- REPAIR 0B0 ABEND
*
 NAME $JOLSH35 UJEISPDQ
 BASE 81F8
 VER 855A 95F2,3027       '2' FOR F4/MVS?
 VER 855E 47F0,B380       ALWAYS BRANCH
 REP 855E 4770,B380       NOT A '2', THEREFORE BRANCH
 IDRDATA ABEND0B0
