//CLARKEZ JOB (1011,1011),CLARK1,MSGCLASS=X,NOTIFY=CLARKE
//ZAP EXEC PGM=IMASPZAP
//SYSLIB   DD  DSN=CLARKE.JOL40.LOAD,DISP=SHR
//SYSPRINT DD  SYSOUT=*
//SYSIN DD *
* MEMBER J40VOLRF
* THIS PTF CORRECTS A NUMBER OF PROBLEMS WITH VOLREFS TO GENERATION
*    DATA SETS.
*
*    ****  THESE ERRORS ONLY OCCUR UNDER CERTAIN CIRCUMSTANCES.  ***
*
* 1.  WHEN 'NOCAT' IS SPECIFIED, THE VOLREF IS IGNORED.
*
* 2.  WHEN 'CAT' IS SPECIFIED, THE VOLREF IS IGNORED.
*
*
******************************************************************
*
* FORCE OUTPUT OF $$VREF DD CARDS WHEN NOCAT IS SPECIFIED.
*
 NAME UJC00MN UJC24RUN
 BASE 20A8
 VER 253E 4740,B3B8      BL  C24EVRF1
 VER 254E 4710,B4C6      BO  C24FORCE
 VER 2556 4770,B4C6      BNE C24FORCE
 REP 253E 4780,B3B8      BE  C24EVRF1
 REP 254E 4710,B4CA      SKIP OVER MARKING THE DATA SET AS USED
 REP 2556 4770,B4CA      (AS ABOVE)
 IDRDATA  MAKEVREF
*
*
******************************************************************
*
* STOP ANY VOLREF FOR OLD (INPUT) GENERATION DATA SETS.
*
* IF THE GDG IS NOT IN THE PASSED DATA SET QUEUE, THE JOB WILL
*    GET A JCL ERROR, WHICH IS BETTER THAN ACTUALLY TRYING TO OPEN
*    THE DATA SET.
*
*
 NAME UJG00MN UJG00MN
 VER 0160 4780,C16C      IF VOLREF, GOTO G00VREF1
 VER 04CE C4CE,C4D0      VERIFY ZAP AREA IF FREE
 REP 04CE 91C0,8058      IS THIS AN INPUT DATA SET ?
 REP 04D2 4740,C16C      NO, CHECK VOLUME REFERENCES THEN
 REP 04D6 954D,8048      IS THIS A GDG ?
 REP 04DA 4770,C16C      NO, CHECK VOLUME REFERENCES THEN
 REP 04DE D22B,8061,2176 CLEAR THE VOLUME FIELD
 REP 04E4 47F0,C262      RETURN TO MAINLINE, CONTINUE PROCESSING.
 REP 0160 4780,C4CE      BRANCH TO PATCH AREA.
 IDRDATA  OLDVREF
*
*
******************************************************************
*
* FORCE A VOLREF IF NOT A GDG DATA SET.
*
 NAME UJG00MN UJG00MN
 VER 0186 D22B,8061,2176 CLEAR THE VOLUME FIELD
 REP 0186 0700,0700,0700 DON'T CLEAR THE VOLUME FIELD
 IDRDATA  MAKEVREF
