*          DATA SET CBT990     AT LEVEL 037 AS OF 10/31/00               00001
   TITLE 'COPYMODS -- TAPE COPY PROGRAM'                                 00002
**************************************************************           00003
**************************************************************           00004
**                                                          **           00005
**                                                          **           00006
**  MODULE: COPYMODS.   WRITTEN BY PAUL TOKHEIM, AFAFC.     **           00007
**                                                          **           00008
**                                                          **           00009
**  PURPOSE: COPY ALL FILES OF AN INPUT TAPE TO ONE TO 16   **           00010
**     OUTPUT TAPES.  THE ORIGINAL PURPOSE OF THIS PROGRAM  **           00011
**     IS FOR COPYING THE SHARE MVS MODS TAPE.              **           00012
**                                                          **           00013
**                                                          **           00014
**  METHOD: COPYMODS FIRST DETERMINES WHICH OUTPUT DD'S ARE **           00015
**    PRESENT. THE INPUT TAPE IS READ USING EXCP AND THE    **           00016
**    APPROPRIATE OUTPUT TAPES ARE WRITTEN USING EXCP.      **           00017
**    ANY LABELS ON THE INPUT WILL BE COPIED. ANY LABELS ON **           00018
**    THE OUTPUT TAPES WILL BE DESTROYED.  IF AN ERROR      **           00019
**    OCCURS ON THE INPUT TAPE, THE PROGRAM WILL ABEND WITH **           00020
**    A USER 69 ABEND.  IF AN ERROR OCCURS ON AN OUTPUT     **           00021
**    TAPE, THE PROGRAM WILL QUIT WRITING TO THE TAPE       **           00022
**    WHICH ENCOUNTERED THE ERROR.                          **           00023
**                                                          **           00024
**                                                          **           00025
**************************************************************           00026
**  NEW FEATURES ADDED BY SAM GOLOB:              SBG 09/00 **           00027
**                                                          **           00028
**                                                          **           00029
**   1.  64K BLOCKS ON A TAPE CAN BE COPIED.                **           00030
**                                                          **           00031
**   2.  UP TO 16 OUTPUT DDNAMES ALLOWED.                   **           00032
**                                                          **           00033
**   3.  INITTED TAPES, AND SL MULTIVOLUME TAPES CAN        **           00034
**       BE CORRECTLY COPIED.                               **           00035
**                                                          **           00036
**   4.  ALL STANDARD LABEL INFORMATION, OR ANY             **           00037
**       PARTICULAR LABEL TYPES, CAN BE PRINTED, IF         **           00038
**       FOUND ON THE INPUT TAPE.                           **           00039
**                                                          **           00040
**   5.  A FLEXIBLE TABLE-DRIVEN PARM KEYWORD SCANNER       **           00041
**       WAS ADDED.  THIS ALLOWS FOR EASY SETTING OF        **           00042
**       PROGRAM DEFAULTS, AND KEYWORD SYNONYMS.  SEE       **           00043
**       LABEL PARMTABL.                                    **           00044
**                                                          **           00045
**   6.  OPTIONALLY, THE VOLSER OF THE OUTPUT TAPES         **           00046
**       CAN BE SET TO THE JCL VOLSER, INSTEAD OF THE       **           00047
**       INPUT TAPE'S VOLSER.                               **           00048
**                                                          **           00049
**   7.  TAPES WITH LEADING TAPE MARKS CAN BE COPIED        **           00050
**       EITHER AS-IS, OR WITH THE LEADING TAPE MARKS       **           00051
**       LEFT OFF.                                          **           00052
**                                                          **           00053
**   8.  EOV LABELS IN THE MIDDLE OF A TAPE, CAN NOW BE     **           00054
**       CHANGED TO EOF LABELS, IF THE TAPE WAS CREATED     **           00055
**       AS A COMPOSITE, BY THE COPYFILE PROGRAM.  THE      **           00056
**       PARM IS EOV2EOF (SEE PARMTABL FOR ALL ACCURATE     **           00057
**       AND CURRENT PARM KEYWORD SETTINGS).  THIS ALSO     **           00058
**       WORKS WHEN ADDING EXTERNAL LABELS TO AN NL TAPE.   **           00059
**                                                          **           00059
**   9.  COPYMODS CAN NOW BE RUN READ-ONLY FOR THE INPUT    **           00060
**       TAPE, USING PARMS OF READ, READONLY, OR NOWRITE.   **           00061
**                                                          **           00062
**  10.  COPYMODS CAN READ A TAPE (EITHER WHILE COPYING     **           00063
**       IT, OR IN READ-ONLY MODE), AND DUMP ALL THE TAPE   **           00064
**       LABELS TO AN FB-80 OUTPUT FILE WITH A DDNAME OF    **           00065
**       LABLDUMP.  USE A PARM OF LABLDUMP TO INVOKE THIS   **           00066
**       SERVICE.                                           **           00067
**                                                          **           00068
**  11.  COPYMODS CAN READ AN SL TAPE AND DUMP THE LABELS   **           00069
**       OFF INTO AN OUTPUT FILE.  THESE LABEL IMAGES HAVE  **           00070
**       EXTRA CONTROL CARDS ADDED.  THESE LABELS CAN BE    **           00071
**       MERGED WITH THE FILES IN AN NL VERSION OF THE      **           00072
**       SAME TAPE, AND A NEW SL TAPE CREATED.  BY DEFAULT, **           00073
**       BLOCK COUNTS IN THE EOF1 AND EOV1 OF THE OUTPUT    **           00074
**       TAPE ARE CORRECTED TO SHOW THE ACTUAL BLOCK        **           00075
**       COUNTS ON THE TAPE, BUT THIS ACTION CAN BE         **           00076
**       MANUALLY TURNED OFF WITH A PARM SETTING.           **           00077
**                                                          **           00078
**       IF YOU CODE A PARM OF SYSIN IN THE PARM FIELD OF   **           00079
**       THE EXEC CARD, THEN COPYMODS NOW TAKES PARM INPUT  **           00080
**       FROM SYSIN, AND THESE CAN OVERRIDE THE OTHER PARMS **           00081
**       IN THE EXEC CARD, BECAUSE SYSIN IS SEARCHED LATER. **           00082
**                                                          **           00083
**       OUTVOLALL=VOLSER , STARTING IN COLUMN1 OF A SYSIN  **           00084
**       CARD, WILL CAUSE ALL OUTPUT VOL1 LABELS TO BE      **           00085
**       OVERWRITTEN WITH THE CODED VOLSER.  THE REST OF    **           00086
**       THAT CARD IS NOT SEARCHED FOR PARMS.               **           00087
**                                                          **           00088
**  12.  OVERLAYING OF THE VOLSER (IN THE VOL1 LABEL)       **           00088
**       CAN ALSO BE DONE IF YOU ARE ADDING EXTERNAL        **           00088
**       LABELS TO AN NL TAPE.  THE OUTPUT TAPES CAN        **           00088
**       HAVE DIFFERENT VOLSER'S FROM THE VOL1 LABEL        **           00088
**       IN THE EXTERNAL LABEL DATASET.                     **           00088
**                                                          **           00088
**  13.  LABLDUMP AND LABADDIN NOW TAKE IBM STANDARD USER   **           00088
**       LABELS INTO ACCOUNT.  THEREFORE, YOU CAN MAKE A    **           00088
**       TAPE WITH ANY USER LABELS YOU WANT, EVEN THOUGH    **           00088
**       YOUR SYSTEM CAN'T CREATE SUCH A TAPE BY ITSELF.    **           00088
**       LABLDUMP DUMPS ALL THE LABEL RECORDS FROM AN SL    **           00088
**       TAPE TO AN EXTERNAL FILE (WITH SPECIAL CONTROL     **           00088
**       CARDS), AND LABADDIN CAN ADD THESE LABELS TO AN    **           00088
**       NL TAPE TO MAKE AN SL TAPE.  (OF COURSE, YOU CAN   **           00088
**       EDIT THE LABEL FILE ON DISK BEFORE USING IT TO     **           00088
**       CREATE A NEW SL TAPE FROM AN NL TAPE.)             **           00088
**                                                          **           00088
**  14.  DEFAULT ACTION OF COPYMODS WITH LABADDIN IS THAT   **           00088
**       IT IS "LABEL DRIVEN".  THAT IS, IF THERE ARE MORE  **           00088
**       NL TAPE FILES THAN EXTERNAL LABELS, THE PROGRAM    **           00088
**       STOPS WHEN IT RUNS OUT OF LABELS.  IF THERE ARE    **           00088
**       MORE LABEL SETS THAN FILES, THE OUTPUT TAPE IS     **           00088
**       WRITTEN WITH NULL STANDARD LABEL FILES UNTIL THE   **           00088
**       LABEL DATASET IS EXHAUSTED, EVEN AFTER THE LAST    **           00088
**       DATA FILE HAS BEEN WRITTEN.                        **           00088
**                                                          **           00088
**       A NEW OPTION CALLED NOEXNULL ALLOWS COPYMODS TO    **           00088
**       STOP AS SOON AS THE NL TAPE FILES ARE EXHAUSTED,   **           00088
**       EVEN IF THERE ARE ADDITIONAL LABEL SETS IN THE     **           00088
**       EXTERNAL LABEL DATASET.                            **           00088
**                                                          **           00088
**  15.  WHEN DOING LABADDIN PROCESSING, IF THE LAST LABEL  **           00088
**       SET IN THE EXTERNAL LABEL FILE HAS A HDR1 AND A    **           00088
**       HDR2 LABEL, BUT NO ENDOFLABELHEADER AND NO EOF1    **           00088
**       AND NO EOF2, THE LBLFIX PARAMETER ALLOWS THE       **           00088
**       PROGRAM TO ACT AS IF THESE CONTROL CARDS WERE      **           00088
**       THERE.  THE EOF1 IS BUILT FROM THE HDR1 AND THE    **           00088
**       MEASURED BLOCK COUNT, AND THE EOF2 IS BUILT FROM   **           00088
**       THE HDR2.                                          **           00088
**                                                          **           00088
**  16.  COPYMODS CAN NOW INIT TAPES WITHOUT COPYING AN     **           00088
**       INPUT TAPE.  USE A PARM OF INITVOLS.               **           00088
**                                                          **           00088
**  17.  COPYMODS CAN NOW CHANGE THE OWNER INFORMATION      **           00088
**       IN THE VOL1 LABEL.  USE THE TAPEOWNER= KEYWORD     **           00088
**       IN A SYSIN CARD.                                   **           00088
**                                                          **           00088
**  18.  COPYMODS CAN LIMIT ITSELF IN THE NUMBER OF FILES   **           00088
**       COPIED, IF THE FILELIMIT=NN KEYWORD IS CODED IN    **           00088
**       SYSIN.  IF THE INPUT IS SL, THEN THE FILELIMIT     **           00088
**       IS INTERPRETED AS SL FILES.  IF NOT, THEN IT IS    **           00088
**       INTERPRETED AS NL.                                 **           00088
**                                                          **           00088
**  19.  USING THE "BYTES" PARAMETER, COPYMODS WILL REPORT  **           00088
**       BYTE COUNTS FOR ALL FILES IN THE INPUT TAPE, AND   **           00088
**       TOTAL BYTES FOR THE ENTIRE TAPE.                   **           00088
**                                                          **           00088
**************************************************************           00089
         EJECT                                                           00090
**************************************************************           00091
**  CHANGE LOG:                                             **           00092
**                                                          **           00093
** LEVEL 003                                                **           00094
**  03/03/00 - ALLOW COPYING OF 64K BLOCKS        SBG 03/00 **           00095
**                                                          **           00096
** LEVEL 004                                                **           00097
**  03/03/00 - CHECK FOR DOUBLE TAPE MARK AFTER   SBG 03/00 **           00098
**             A HEADER LABEL.  THIS MEANS AN SL  SBG 03/00 **           00099
**             FILE WITHOUT ANY DATA IN IT.  AND  SBG 03/00 **           00100
**             IF THIS IS THE CASE, DON'T STOP    SBG 03/00 **           00101
**             COPYING FILES.                     SBG 03/00 **           00102
**                                                          **           00103
** LEVEL 005                                                **           00104
**  03/03/00 - GET AWAY FROM R13 AS BASE, USE     SBG 03/00 **           00105
**             R12,R11.                           SBG 03/00 **           00106
**                                                          **           00107
** LEVEL 006                                                **           00108
**  03/12/00 - ENLARGED THE PROGRAM TO ALLOW UP   SBG 03/00 **           00109
**             TO 16 OUTPUT TAPES FROM OUT1 TO    SBG 03/00 **           00110
**             OUT16.                             SBG 03/00 **           00111
**                                                          **           00112
** LEVEL 007 AND 008                                        **           00113
**  03/14/00 - CLEANED UP SPELLING ON ERROR       SBG 03/00 **           00114
**             MESSAGES AND FIXED DOCUMENTATION.  SBG 03/00 **           00115
**             ADDED EYECATCHERS COSMETICALLY.    SBG 03/00 **           00116
**                                                          **           00117
** LEVEL 009                                                **           00118
**  03/21/00 - STOP AFTER INITTED MVS TAPE        SBG 03/00 **           00119
**                                                          **           00120
** LEVEL 010                                                **           00121
**  03/24/00 - FIXED THE BLOCK SIZE CALCULATIONS  SBG 03/00 **           00122
**             FOR BLOCK SIZES FROM 32K TO 64K.   SBG 03/00 **           00123
**                                                          **           00124
**             I MADE AN ATTEMPT TO COPY DOS/VSE  SBG 03/00 **           00125
**             TAPES THAT HAVE LEADING TAPE       SBG 03/00 **           00126
**             MARKS.  THERE IS A CHOICE TO       SBG 03/00 **           00127
**             EITHER COPY ALL THE LEADING        SBG 03/00 **           00128
**             TAPEMARKS TO AN OUTPUT TAPE, OR TO SBG 03/00 **           00129
**             DISCARD THEM ALL.  YOU USE A PARM  SBG 03/00 **           00130
**             OF LTMSKIP TO DISCARD LEADING      SBG 03/00 **           00131
**             TAPEMARKS, AND ANY OTHER PARM, OR  SBG 03/00 **           00132
**             NO PARM, WILL CAUSE THE PROGRAM TO SBG 03/00 **           00133
**             COPY THEM TO THE OUTPUT TAPES.     SBG 03/00 **           00134
**                                                          **           00135
** LEVEL 011                                                **           00136
**  03/24/00 - PROPERLY ACCOUNT FOR INITTED TAPE  SBG 03/00 **           00137
**             BY ENDING THE JOB NORMALLY AFTER   SBG 03/00 **           00138
**             ONE TAPEMARK.                      SBG 03/00 **           00139
**                                                SBG 03/00 **           00140
**             IF VOL1 LABEL IS DETECTED, THEN    SBG 03/00 **           00141
**             PUT OUT A MESSAGE SAYING SO, AND   SBG 03/00 **           00142
**             INDICATING THE VOLSER THAT WAS     SBG 03/00 **           00143
**             FOUND.  THIS PROGRAM WAS WRITTEN   SBG 03/00 **           00144
**             ORIGINALLY WITH THE INTENT OF      SBG 03/00 **           00145
**             HANDLING NL TAPES, SO THAT THE     SBG 03/00 **           00146
**             CONDITIONS WHICH RESULT FROM       SBG 03/00 **           00147
**             HAVING SL TAPES, HAD TO BE         SBG 03/00 **           00148
**             ACCOUNTED FOR LATER.               SBG 03/00 **           00149
**                                                          **           00150
** LEVEL 012                                                **           00151
**  04/19/00 - ACCOUNT FOR SL EOV1 AND EOV2       SBG 04/00 **           00152
**             HAVING ONLY ONE TAPE MARK AFTER              **           00153
**             THEM.                                        **           00154
**                                                          **           00155
** LEVEL 013                                                **           00156
**  04/30/00 - ORGANIZE THE CHECK FOR STANDARD    SBG 04/00 **           00157
**             LABEL TYPES, AND THE SETTING OF              **           00158
**             FLAGS TO INDICATE EACH TYPE.                 **           00159
**             SEE NEW SUBROUTINE CALLED LABELCHK.          **           00160
**             MOVE NON-LABEL-RELATED FLAGS OUT             **           00161
**             OF THE LBLFLAG FLAG.  PREPARE FOR            **           00162
**             EASY PRINTING OF LABEL CONTENTS,             **           00163
**             BUT NO EXTRA PRINTING IS DONE AT             **           00164
**             THIS LEVEL.                                  **           00165
**                                                          **           00166
** LEVEL 014                                                **           00167
**  05/02/00 - ADDED A FLEXIBLE TABLE-DRIVEN      SBG 05/00 **           00168
**             PARM SCANNER THAT IS EASY TO                 **           00169
**             MODIFY, AND TO SUPPLY SYNONYMS               **           00170
**             FOR THE PARMS.  ADDED SUPPORT,               **           00171
**             VIA THE LBLINFO PARM, TO PRINT               **           00172
**             HDR1, HDR2, EOF1, EOF2, EOV1,                **           00173
**             EOV2 LABEL INFORMATION, IF IT IS             **           00174
**             FOUND ON THE INPUT TAPE.  THAT IS,           **           00175
**             IF THE INPUT TAPE IS SL.                     **           00176
**                                                          **           00177
**             FOR A LIST OF PERMISSIBLE PARMS,             **           00178
**             SEE LABEL PARMTABL.                          **           00179
**                                                          **           00180
** LEVEL 015                                                **           00181
**  05/07/00 - GAVE THE PARM SCANNER THE ABILITY  SBG 05/00 **           00182
**             TO TURN OFF A PARM FLAG AS WELL AS           **           00183
**             THE ABILITY TO TURN IT ON. INCREASED         **           00184
**             THE SIZE OF A PARM TABLE ENTRY BY ONE        **           00185
**             BYTE.                                        **           00186
**                                                          **           00187
** LEVEL 016                                                **           00188
**  05/08/00 - GAVE THE PARM SCANNER THE ABILITY  SBG 05/00 **           00189
**             TO SET ANY PARM SETTING AS A                 **           00190
**             DEFAULT.  A SETTING FOR A DEFAULT            **           00191
**             ENTRY THAT IS LATER IN THE TABLE,            **           00192
**             WILL OVERRIDE A SETTING FOR A                **           00193
**             DEFAULT THAT WAS SET EARLIER IN THE          **           00194
**             TABLE.  SETTING A PARM EXPLICITLY            **           00195
**             IN THE JCL, WILL OVERRIDE ANY                **           00196
**             DEFAULT SETTING FOR THAT PARM.               **           00197
**                                                          **           00198
** LEVEL 017                                                **           00199
**  05/11/00 - USED THE PARM SCANNER TO MAKE A    SBG 05/00 **           00200
**             DIFFERENCE BETWEEN PRINTING VARIOUS          **           00201
**             KINDS OF TAPE LABELS.  IF YOU WANT           **           00202
**             ALL OF THEM, YOU JUST HAVE A PARM            **           00203
**             THAT THROWS ALL OF THE FLAGS.  ALL           **           00204
**             OF THIS IS CODED IN PARMTABL AND             **           00205
**             THE FLAGS ARE USED IN PRTXXX1 AND            **           00206
**             PRTXXX2.                                     **           00207
**                                                          **           00208
** LEVEL 018                                                **           00209
**  05/22/00 - ADDED THE PROVISION TO CHANGE THE  SBG 05/00 **           00210
**             VOLSER OF THE COPIED TAPES, TO               **           00211
**             MATCH THE VOLSER INDICATED IN THE            **           00212
**             OUTXX DD NAMES.  THIS IS DONE WITH           **           00213
**             THE CHGVOL PARM KEYWORD.  THIS               **           00214
**             ACTION ONLY OCCURS IF THE INPUT              **           00215
**             TAPE IS SL, AND SO A VOL1 LABEL IS           **           00216
**             DETECTED.  THE COPIED VOL1 LABEL             **           00217
**             IS ALTERED BEFORE THE WRITE.                 **           00218
**                                                          **           00219
** LEVEL 019                                                **           00220
**  06/06/00 - ADDED THE PROVISION TO FIX EOV1    SBG 06/00 **           00221
**             AND EOV2 LABELS THAT ARE IN THE              **           00222
**             MIDDLE OF A TAPE.  OF COURSE THIS            **           00223
**             ISN'T SUPPOSED TO HAPPEN, BUT IT             **           00224
**             CAN HAPPEN WHEN YOU COPY FILES               **           00225
**             WITH THE COPYFILE PROGRAM, FROM              **           00226
**             THE END OF ONE TAPE, TO THE                  **           00227
**             BEGINNING OR THE MIDDLE OF                   **           00228
**             ANOTHER.  COPYFILE HAS NOT BEEN              **           00229
**             FIXED AS YET NOT TO DO THIS, BUT IT          **           00230
**             COPIES THE EOV LABELS AS IS.  THIS           **           00231
**             NEW OPTION IS CALLED EOVCHG OR               **           00232
**             EOV2EOF; THE EOV LABELS ARE                  **           00233
**             CHANGED (IN THE COPIED TAPES) TO             **           00234
**             EOF, AND A MESSAGE IS WRITTEN THAT           **           00235
**             REPORTS THIS FACT.                           **           00236
**                                                          **           00237
** LEVEL 020                                                **           00238
**  06/29/00 - ADDED THE PARM OF READ OR READONLY SBG 06/00 **           00239
**             TO ALLOW A RUN OF COPYMODS THAT              **           00240
**             JUST READS THE INPUT TAPE, AND DOES          **           00241
**             NOT MAKE COPIES.                             **           00242
**                                                          **           00243
** LEVEL 021                                                **           00244
**  07/06/00 - FIX COPYMODS TO CORRECTLY COPY     SBG 07/00 **           00245
**             IEHINITTED TAPES.                            **           00246
**                                                          **           00247
** LEVEL 022                                                **           00248
**  09/10/00 - COPYMODS CAN DUMP THE IBM STANDARD SBG 09/00 **           00249
**             LABELS FROM A TAPE, TO AN FB-80              **           00250
**             OUTPUT FILE.  PARM IS LABLDUMP.              **           00251
**                                                          **           00252
** LEVEL 023                                      SBG 09/00 **           00253
**  09/11/00 - ALLOWS LIMITED SYSIN INPUT OPTIONALLY.       **           00254
**             ONLY IMPLEMENTATION SO FAR IS TO             **           00255
**             CHANGE ALL OUTPUT VOLSER'S TO THE            **           00256
**             SAME VALUE, BUT NOT NECESSARILY TO           **           00257
**             WHAT IS IN THE OUTX  DD CARD.  IN            **           00258
**             ORDER TO USE THE FACILITY, YOU HAVE          **           00259
**             TO CODE                                      **           00260
**             OUTVOLALL=XXXXXX STARTING IN COL 1           **           00261
**             OF THE SYSIN CARD FILE.  IF THERE            **           00262
**             ARE NO VALID OUTVOLALL= CARDS IN             **           00263
**             SYSIN, THEN THE EFFECT IS THE SAME           **           00264
**             AS CODING CHGVOL.                            **           00265
**                                                          **           00266
**             FIXED LABEL DUMP OPTION SO THAT THE          **           00267
**             DUMPED LABELS HAVE CONTROL CARDS             **           00268
**             AFTER THEM.  THE EXTERNAL ADD LABELS         **           00269
**             FUNCTION IN LEVEL 24 NEEDS THESE             **           00270
**             CONTROL CARDS.                               **           00271
**                                                          **           00272
** LEVEL 024                                      SBG 09/00 **           00273
**  09/14/00 - ADDED CAPABILITY OF CREATING SL              **           00274
**             OUTPUT COPIES FROM NL INPUT AND A            **           00275
**             SET OF LABELS CREATED BY LABLDUMP.           **           00276
**             CHANGED THE DCB NAMES AND DD CARDS           **           00277
**             AND OPTION NAMES FOR LABEL DUMP AND          **           00278
**             RESTORE.                                     **           00279
**                                                          **           00280
**             CHANGED PROGRAM INITIALIZATION TO            **           00281
**             A STANDARD FORM.  GOT RID OF PRIME           **           00282
**             AND TERME MACROS.  HAVE 5 BASE               **           00283
**             REGISTERS TO LEAVE ROOM FOR EXPANSION.       **           00284
**                                                          **           00285
**             CHECK FOR VOL1 RECORD AS FIRST RECORD        **           00286
**             ON THE INPUT TAPE.  WON'T WRITE MORE         **           00287
**             LABELS ON AN SL TAPE, AND WON'T              **           00288
**             DAMAGE THE OUTPUT TAPES, IF THE INPUT        **           00289
**             TAPE IS SL, ACCIDENTALLY.                    **           00290
**                                                          **           00291
** LEVEL 025                                      SBG 09/00 **           00292
**  09/20/00 - COPYMODS CAN NOW TAKE INPUT FROM             **           00293
**             SYSIN AND SEARCH FOR ALL PARMS.              **           00294
**             TO INVOKE THIS, YOU HAVE TO CODE             **           00295
**             A PARM OF 'SYSIN' ON THE EXEC CARD.          **           00296
**             ANY CARD IN SYSIN WHICH IS NOT A             **           00297
**             KEYWORD PARAMETER (THE ONLY ONE              **           00298
**             CURRENTLY SUPPORTED IS OUTVOLALL= )          **           00299
**             IS SEARCHED BY THE PARMLOOP ROUTINE,         **           00300
**             AND ANY PARM THAT IS CODED IN THE            **           00301
**             PARM TABLE, CAN BE CODED IN SYSIN,           **           00302
**             AND IT WILL OVERRIDE THE PARM IN             **           00303
**             THE EXEC CARD (SINCE SYSIN IS                **           00304
**             SCANNED LATER IN THE PROCESSING).            **           00305
**                                                          **           00306
**             INCLUDED A BLOCK COUNT CORRECTION AS         **           00307
**             DEFAULT, WHEN WRITING STANDARD LABELS        **           00308
**             FROM AN EXTERNAL FILE.  THE CORRECTED        **           00309
**             BLOCK COUNTS ARE WRITTEN TO THE EOF1         **           00310
**             AND EOV1 LABELS IN THE OUTPUT TAPES.         **           00311
**                                                          **           00312
**             WHEN WRITING TAPE LABELS FROM AN EXTERNAL    **           00313
**             FILE, INCLUDED AN OPTION TO PRINT THEIR      **           00314
**             CONTENTS, IN THE SAME WAY, AS PRINTING       **           00315
**             THE CONTENTS OF STANDARD LABELS FOUND        **           00316
**             WHEN COPYING AN INPUT TAPE.                  **           00317
**                                                          **           00318
** LEVEL 026                                      SBG 09/00 **           00319
**  09/22/00 - ON LABADDIN, COPYMODS SHOULD                 **           00320
**             RESPECT CHGVOL AND OUTVOLALL= .              **           00321
**                                                          **           00322
** LEVEL 027                                      SBG 09/00 **           00319
**  09/22/00 - ON LABADDIN, COPYMODS SHOULD                 **           00320
**             BE ABLE TO DO EOV2EOF PROCESSING             **           00321
**                                                          **           00322
** LEVEL 028                                      SBG 09/00 **           00319
**  09/25/00 - ON LABADDIN AND LABLDUMP, PUT IN             **           00320
**             STANDARD USER LABEL SUPPORT.                 **           00321
**                                                          **           00322
** LEVEL 029                                      SBG 09/00 **           00319
**  09/25/00 - FIX LABEL PRINTING REPORTS FOR               **           00320
**             STANDARD USER LABELS.                        **           00321
**                                                          **           00322
** LEVEL 030                                      SBG 09/00 **           00319
**  09/27/00 - CORRBLKS PARM ALLOWS FIXING OF               **           00320
**             EOF1 AND EOV1 BLOCK COUNTS IN THE            **           00321
**             OUTPUT TAPES, DURING THE COPY.               **           00322
**             WRITE MESSAGE THAT THIS IS IN EFFECT.        **           00322
**                                                          **           00322
**             FIXED THE EYECATCHERS A BIT.                 **           00322
**                                                          **           00322
**             AGAIN FIXED COPY OF INITTED TAPES.           **           00322
**                                                          **           00322
** LEVEL 031                                      SBG 09/00 **           00319
**  09/28/00 - MADE SURE WITH LABADDIN WHEN YOU             **           00320
**             HAVE EXTRA LABELS AND ADD NULL FILES,        **           00322
**             THAT 2 TM'S ARE WRITTEN AFTER THE            **           00322
**             HDR2 RECORDS, BEFORE THE EOF1'S.             **           00322
**                                                          **           00322
** LEVEL 032                                      SBG 10/00 **           00319
**  10/02/00 - NEW NOEXNULL OPTION CONTROLS                 **           00320
**             LABADDIN PROCESSING WHEN THERE ARE           **           00322
**             MORE LABELS IN THE EXTERNAL LABEL            **           00322
**             DATASET, THAN THERE ARE NL FILES             **           00322
**             IN THE INPUT TAPE.  DEFAULT IS TO            **           00322
**             WRITE EXTRA NULL SL FILES.  NOEXNULL         **           00322
**             SAYS TO STOP AT THE END OF NL FILES          **           00322
**             AND NOT WRITE NULL SL FILES TO               **           00322
**             CORRESPOND TO THE EXTRA EXTERNAL             **           00322
**             LABELS.                                      **           00322
**                                                          **           00322
**             THIS HAS TO BE DONE WITH A TECHNIQUE         **           00322
**             OF WRITING AN EXTRA HEADER LABEL SET,        **           00322
**             AND THEN BACKING OVER IT AND CLOSING.        **           00322
**                                                          **           00322
** LEVEL 033                                      SBG 10/00 **           00319
**  10/05/00 - NEW LBLFIX OPTION FIXES LABADDIN             **           00320
**             PROCESSING WHEN THE LAST LABEL SET           **           00322
**             IN THE EXTERNAL LABEL FILE IS PARTLY         **           00322
**             MISSING.  ALL YOU NEED IS A HDR1 AND         **           00322
**             A HDR2 LABEL IN THE LAST LABEL SET,          **           00322
**             AND COPYMODS (WITH LBLFIX ON) WILL           **           00322
**             ACT AS IF AN ENDOFLABELHEADER CARD           **           00322
**             WERE THERE (SO IT WRITES A TAPEMARK          **           00322
**             AND THE DATA AND A TAPEMARK), AND IT         **           00322
**             CONSTRUCTS THE EOF1 FROM THE HDR1            **           00322
**             PLUS THE MEASURED BLOCK COUNTS FROM          **           00322
**             THE DATA FILE.  AN EOF2 IS COPIED            **           00322
**             FROM THE EXISTING HDR2 AND EOF IS            **           00322
**             PUT IN.  2 TAPEMARKS ARE WRITTEN ON          **           00322
**             THE END.                                     **           00322
**                                                          **           00322
** LEVEL 034                                      SBG 10/00 **           00319
**  10/10/00 - WHEN AN ERROR THAT IS NOT A UNIT             **           00320
**             CHECK IS PRESENT ON AN OUTPUT TAPE           **           00322
**             DRIVE, NO REWIND IS PERFORMED BEFORE         **           00322
**             THE CLOSE.  THIS LETS THE CLOSE DO           **           00322
**             THE REWIND, AND LEAVES THE WRITTEN           **           00322
**             DATA ON THE TAPE.  THIS WAY, A TAPE          **           00322
**             THAT WAS INCOMPLETELY WRITTEN IS             **           00322
**             NOT ERASED.                                  **           00322
**                                                          **           00322
**             END-OF-TAPE (UNIT EXCEPTION ON WRITE)        **           00322
**             CONDITION IS FLAGGED WITH A PROPER           **           00322
**             MESSAGE FOR THE CONTEXT, AND THE WTOR        **           00322
**             FOR THAT DRIVE IS BYPASSED.                  **           00322
**                                                          **           00322
**             THIS PROBLEM HAS EXISTED SINCE THE           **           00322
**             FIRST VERSION OF THIS PROGRAM.               **           00322
**                                                          **           00322
**             CAREFUL TO FLAG ALL THE EXTRA DD             **           00322
**             NAMES AS CLOSED BEFORE CLOSING THEM.         **           00322
**             THESE ARE THE OPENDFLG SETTINGS.             **           00322
**                                                          **           00322
** LEVEL 035                                      SBG 10/00 **           00319
**  10/12/00 - TRY TO FIX COPYING OF INITTED                **           00320
**             TAPES, BY NOT REUSING THE WRITE              **           00322
**             IOB WITHOUT REFRESHING THE PARTS             **           00322
**             THAT ARE USED BY IOS.  THIS IS THE           **           00322
**             CLEARIOB SUBROUTINE. (IT DOESN'T HELP.)      **           00322
**                                                          **           00322
**             LABLDUMP OF AN IEHINITTED TAPE               **           00322
**             PRODUCES AN ENDOFLABELHEADERINIT             **           00322
**             CARD, IN ANTICIPATION OF CREATING            **           00322
**             A TAPE INITIALIZATION ROUTINE FROM           **           00322
**             EXTERNAL LABELS.  (INITVOLS IN THE           **           00322
**             NEXT LEVEL, IS BETTER.)                      **           00322
**                                                          **           00322
**             FIXED BUG OF WRITING 2 EOV2 LABELS.          **           00322
**                                                          **           00322
** LEVEL 036                                      SBG 10/00 **           00319
**  10/17/00 - CAN INIT TAPES FROM PROGRAM-GENERATED        **           00320
**             CARD IMAGES.  ADD TAPEOWNER= KEYWD           **           00322
**             IN SYSIN DD NAME.  THIS KEYWORD CAN          **           00322
**             ALSO CHANGE TAPE OWNER INFORMATION           **           00322
**             IN THE VOL1 LABEL FOR REGULAR COPIES,        **           00322
**             ALTHOUGH IT WAS WRITTEN FOR TAPE INITS.      **           00322
**                                                          **           00322
**             TO INIT TAPES WITH NO INPUT TAPE,            **           00322
**             USE A PARM OF INITVOLS.                      **           00322
**                                                          **           00322
**             TAPEOWNER=  AND  OUTVOLALL=  KEYWORDS        **           00322
**             BOTH TURN ON THE OUTVOL PARM OPTION.         **           00322
**                                                          **           00322
**             CONSOLIDATED CHGVOL CODE INTO A              **           00322
**             SUBROUTINE TO SIMPLIFY THE PROGRAM.          **           00322
**                                                          **           00322
**             CLEANED CHGVOL CODE TO HANDLE LABADDIN       **           00322
**             AS WELL AS TAPE INPUT, WITHOUT THEM          **           00322
**             STEPPING ON EACH OTHER.                      **           00322
**                                                          **           00322
** LEVEL 037                                      SBG 10/00 **           00319
**  10/24/00 - ADDED FILELIMIT= KEYWORD TO SYSIN            **           00320
**             CARDS.  THE PROGRAM FEELS FOR SL OR          **           00322
**             NL TAPES ON THE INPUT TAPE.  IF THE          **           00322
**             INPUT TAPE IS SL, THEN THE FILELIMIT         **           00322
**             IS MULTIPLIED BY 3, AND THE BIGGER           **           00322
**             VALUE IS USED.                               **           00322
**                                                          **           00322
**             COPYMODS WILL ONLY COPY INPUT TAPE           **           00322
**             FILES UP TO THE LIMIT OF THE FILELIMIT       **           00322
**             VALUE, IF THERE IS ONE.                      **           00322
**                                                          **           00322
**             INTERNALLY, THE FILELIMIT= KEYWORD           **           00322
**             SETS THE PARM VALUE OF LIMFILE OR            **           00322
**             FILELIM, AND THAT PARM IS WHAT DRIVES        **           00322
**             THE PROGRAM ACTION.                          **           00322
**                                                          **           00322
**             BYTES PARM KEYWORD ADDED.  IF SO, THE        **           00322
**             PROGRAM COUNTS BYTES READ FROM THE           **           00322
**             INPUT TAPE FILES, AND TOTALS THEM AT         **           00322
**             THE END.  NOBYTES KEYWORD WILL NULLIFY       **           00322
**             THIS ACTION.                                 **           00322
**                                                          **           00322
**************************************************************           00323
**************************************************************           00324
         EJECT                                                           00325
         YREGS                                                           00326
COPYMODS CSECT                                                           00327
         USING *,R15                                          SBG 03/00  00328
         B     EYECATCH                                       SBG 03/00  00329
         DC    C'--- '            MAKE EYECATCHER VISIBLE     SBG 03/00  00330
         DC    C'COPYMODS - 16 OUTPUT TAPES VERSION - '       SBG 03/00  00331
         DC    C'&SYSDATE',C'  ',C'&SYSTIME ',C'--- '         SBG 03/00  00332
         DC    C'PARM INPUT IN SYSIN '                                   00333
SAVEAREA DC    18F'0'                                                    00334
EYECATCH DS    0D             ENSURE ALIGNMENT                SBG 03/00  00335
         SAVE  (14,12)                                                   00336
         LR    R5,R1          SAVE PARM POINTER                          00337
         LA    R1,SAVEAREA          NEW SAVE-AREA ADDR                   00338
         ST    R1,8(,R13)           FORWARD SAVE-AREA CHAIN PTR          00339
         ST    R13,4(,R1)           BACKWARD SAVE-AREA CHAIN PTR         00340
         LR    R13,R1               NEW SAVE AREA ADDRESS                00341
         DROP  R15                                                       00342
* -----                       SET UP FIVE BASE REGISTERS                 00343
         USING COPYMODS,R12,R11,R10,R9,R8                                00344
         LR    R12,R15                                                   00345
         LA    R11,4095(,R12)                                            00346
         LA    R11,1(,R11)                                               00347
         LA    R10,4095(,R11)                                            00348
         LA    R10,1(,R10)                                               00349
         LA    R9,4095(,R10)                                             00350
         LA    R9,1(,R9)                                                 00351
         LA    R8,4095(,R9)                                              00352
         LA    R8,1(,R8)                                                 00353
         LR    R1,R5          RESTORE PARM POINTER                       00354
         BAL   R6,PARMCHK       FLAG ALL PARMS CODED,         SBG 04/00  00355
*                          AND CHECK FOR SYSIN ADDITIONALLY.  SBG 09/00  00356
* ----------------------------------------------------------------- *    00357
OPNSYSIN TM    PARMFLG2,X'20'   DO WE NEED SYSIN?                        00358
         BZ    OPNSYSNE         NO. GO FURTHER IN PROCESSING             00359
         OPEN  (SYSIN,INPUT)                                             00360
         TM    SYSIN+48,X'10'        IS THE DD OPEN  ?                   00361
         BZ    NOSYSIN        NO. FLAG THE ERROR & MESSAGE               00362
         OI    OPENDFLG,X'02'     FLAG THAT SYSIN IS OPEN                00363
         B     OPNSYSNE           AND CONTINUE PROCESSING.               00364
NOSYSIN  MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     00365
         MVC   LINE(133),NSYSMSG   DISPLAY MISSING DD MESSAGE            00366
         PUT   SYSPRINT,LINE                                             00367
         OI    ENDITFLG,X'02'   FLAG THAT SYSIN NOT OPEN.                00368
OPNSYSNE DS    0H                                                        00369
* ----------------------------------------------------------------- *    00370
CHEKCARD TM    PARMFLG2,X'20'     TEST IF SYSIN IS NEEDED.               00371
         BZ    CHEKCEND           ISN'T. NO POINT TO READ CARDS.         00372
         TM    OPENDFLG,X'02'     IS SYSIN OPEN ?                        00373
         BZ    CHEKCEND           ISN'T THERE SO CAN'T LOOK AT IT.       00374
         BAL   R6,CARDREAD        CHECK SYSIN FOR PARMS AND OVERRIDES    00375
CHEKCEND DS    0H                                                        00376
* ----------------------------------------------------------------- *    00377
*    SUBMITTED PARMS SHOULD BE FINALIZED BY NOW                     *    00378
* ----------------------------------------------------------------- *    00379
         BAL   R7,CLEARSAV      CLEAR SAVE AREAS IF LBLFIX IS ON
         TM    PARMFLG1,X'20'   ARE WE SKIPPING LTM'S?        SBG 04/00  00380
         BZ    COPYLTMS         NO. WE'RE COPYING THEM.       SBG 04/00  00381
*                               YES. WE'RE SKIPPING THEM, SO  SBG 04/00  00382
         MVC   LTMRPTI,SKIPPED  MOVE INDICATOR TO REPORT      SBG 03/00  00383
         B     SKIPLTMS         AND DO OTHER INITIALIZATION   SBG 03/00  00384
COPYLTMS MVC   LTMRPTI,COPIED   MOVE INDICATOR TO REPORT      SBG 03/00  00385
SKIPLTMS DS    0H                                             SBG 06/00  00386
* ----- * ----- * ------
         TM    PARMFLG3,X'C0'   IS NOEXNULL OR LBLFIX ON?
         BZ    NONOEXNL         NO. BYPASS ADJUSTMENT
         OI    PARMFLG2,X'80'   LABADDIN HAS TO BE ON
NONOEXNL DS    0H
* ----- * ----- * ------
*  -------------- CODE TO MAKE SURE LABADDIN DOES NOT OCCUR              00387
*  -------------- TOGETHER WITH LABLDUMP OPTION. ---------------- *      00388
         TM    PARMFLG2,X'80'          ARE WE CREATING LABELS?           00389
         BZ    CANLBDMP                NO. WE CAN DUMP LABELS.           00390
         NI    PARMFLG2,FF-X'10'       YES. TURN OFF LABLDUMP            00391
         NI    PARMFLG2,FF-X'08'       YES. TURN OFF READ ONLY TOO       00392
*                                      BECAUSE WE'RE COPYING TO SL.      00393
         OI    WRLBLFLG,X'01'      INITIALIZE TO READ LABELS             00394
CANLBDMP DS    0H                                                        00395
*  -------------------------------------------------------------- *      00396
         STM   R14,R3,SAV14T03   GET READY TO SAVE INPUT VOL  SBG 06/00  00397
         RDJFCB IN                                                       00398
         MVC   INVOLJ(6),INJFCB+118    SAVE INPUT VOLUME FROM JCL        00399
         MVC   SUCCESSR+60(6),INJFCB+118   COPY TO READ MESSG SBG 06/00  00400
         MVC   READOMSG+60(6),INJFCB+118   COPY TO READ MESSG SBG 06/00  00401
         LM    R14,R3,SAV14T03   RESTORE REGISTERS                TEST   00402
         XC    FULLWORK,FULLWORK  CLEAR WORK AREA             SBG 03/00  00403
         MVC   FILECNT,=F'1'  INITIALIZE FOR FILE NUMBER                 00404
         MVI   DATFLAG,X'10' INITIALIZE FLAG-NO DATA READ YET SBG 03/00  00405
         SPACE 3                                                         00406
OPENSYSP DS    0H                                                        00407
*                                                                        00408
*  DETERMINE WHICH OUTPUT DD'S ARE PRESENT                               00409
*                                                                        00410
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  00411
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  00412
         BO    OPENS      YES--SKIP ALL THE TIOT FOR OUT DD'S SBG 06/00  00413
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  00414
         L     R2,16          R2=CVT                                     00415
         L     R2,0(,R2)      R2=TCB WORDS                               00416
         L     R2,4(,R2)      R2=MY TCB                                  00417
         L     R2,12(,R2)     R2=TIOT                                    00418
         LA    R2,24(,R2)     R2=FIRST DD ENTRY                          00419
TIOTLOOP CLC   0(4,R2),=XL4'00' END OF TIOT?                             00420
         BE    OVOLOV         YES, CHECK FOR OUTPUT VOL OVERRIDES        00421
         CLC   4(8,R2),OUT1+40  OUTPUT FILE NUMBER 1?                    00422
         BNE   TIOT1          NO                                         00423
         OI    FLAG1,OP1      SHOW IT                                    00424
         STM   R14,R3,SAV14T03                                    TEST   00425
         RDJFCB OUT1                                                     00426
         MVC   VOLUME1(6),OUTJFCB+118    SAVE VOLUME SERIAL              00427
         MVC   VOLDD,DDOUT1                                              00428
         LM    R14,R3,SAV14T03                                    TEST   00429
         B     TIOTNEXT       CONTINUE                                   00430
TIOT1    CLC   4(8,R2),OUT2+40  OUTPUT FILE NUMBER 2?                    00431
         BNE   TIOT2          NO                                         00432
         OI    FLAG1,OP2      SHOW IT                                    00433
         STM   R14,R3,SAV14T03                                    TEST   00434
         RDJFCB OUT2                                                     00435
         MVC   VOLUME2(6),OUTJFCB+118    SAVE VOLUME SERIAL              00436
         MVC   VOLDD,DDOUT2                                              00437
         LM    R14,R3,SAV14T03                                    TEST   00438
         B     TIOTNEXT       CONTINUE                                   00439
TIOT2    CLC   4(8,R2),OUT3+40  OUTPUT FILE NUMBER 3?                    00440
         BNE   TIOT3          NO                                         00441
         OI    FLAG1,OP3      SHOW IT                                    00442
         STM   R14,R3,SAV14T03                                    TEST   00443
         RDJFCB OUT3                                                     00444
         MVC   VOLUME3(6),OUTJFCB+118    SAVE VOLUME SERIAL              00445
         MVC   VOLDD,DDOUT3                                              00446
         LM    R14,R3,SAV14T03                                    TEST   00447
         B     TIOTNEXT       CONTINUE                                   00448
TIOT3    CLC   4(8,R2),OUT4+40  OUTPUT FILE NUMBER 4?                    00449
         BNE   TIOT4          NO                                         00450
         OI    FLAG1,OP4      SHOW IT                                    00451
         STM   R14,R3,SAV14T03                                    TEST   00452
         RDJFCB OUT4                                                     00453
         MVC   VOLUME4(6),OUTJFCB+118    SAVE VOLUME SERIAL              00454
         MVC   VOLDD,DDOUT4                                              00455
         LM    R14,R3,SAV14T03                                    TEST   00456
         B     TIOTNEXT       CONTINUE                                   00457
TIOT4    CLC   4(8,R2),OUT5+40  OUTPUT FILE NUMBER 5?                    00458
         BNE   TIOT5          NO                                         00459
         OI    FLAG1,OP5      SHOW IT                                    00460
         STM   R14,R3,SAV14T03                                    TEST   00461
         RDJFCB OUT5                                                     00462
         MVC   VOLUME5(6),OUTJFCB+118    SAVE VOLUME SERIAL              00463
         MVC   VOLDD,DDOUT5                                              00464
         LM    R14,R3,SAV14T03                                    TEST   00465
         B     TIOTNEXT       CONTINUE                                   00466
TIOT5    CLC   4(8,R2),OUT6+40  OUTPUT FILE NUMBER 6?                    00467
         BNE   TIOT6          NO                                         00468
         OI    FLAG1,OP6      SHOW IT                                    00469
         STM   R14,R3,SAV14T03                                    TEST   00470
         RDJFCB OUT6                                                     00471
         MVC   VOLUME6(6),OUTJFCB+118    SAVE VOLUME SERIAL              00472
         MVC   VOLDD,DDOUT6                                              00473
         LM    R14,R3,SAV14T03                                    TEST   00474
         B     TIOTNEXT       CONTINUE                                   00475
TIOT6    CLC   4(8,R2),OUT7+40  OUTPUT FILE NUMBER 7?                    00476
         BNE   TIOT7          NO                                         00477
         OI    FLAG1,OP7      SHOW IT                                    00478
         STM   R14,R3,SAV14T03                                    TEST   00479
         RDJFCB OUT7                                                     00480
         MVC   VOLUME7(6),OUTJFCB+118    SAVE VOLUME SERIAL              00481
         MVC   VOLDD,DDOUT7                                              00482
         LM    R14,R3,SAV14T03                                    TEST   00483
         B     TIOTNEXT       CONTINUE                                   00484
TIOT7    CLC   4(8,R2),OUT8+40  OUTPUT FILE NUMBER 8?                    00485
         BNE   TIOT8          NO                                         00486
         OI    FLAG1,OP8      SHOW IT                                    00487
         STM   R14,R3,SAV14T03                                    TEST   00488
         RDJFCB OUT8                                                     00489
         MVC   VOLUME8(6),OUTJFCB+118    SAVE VOLUME SERIAL              00490
         MVC   VOLDD,DDOUT8                                              00491
         LM    R14,R3,SAV14T03                                    TEST   00492
         B     TIOTNEXT       CONTINUE                                   00493
TIOT8    CLC   4(8,R2),OUT9+40  OUTPUT FILE NUMBER 9?                    00494
         BNE   TIOT9          NO                                         00495
         OI    FLAG2,OP9      SHOW IT                                    00496
         STM   R14,R3,SAV14T03                                    TEST   00497
         RDJFCB OUT9                                                     00498
         MVC   VOLUME9(6),OUTJFCB+118    SAVE VOLUME SERIAL              00499
         MVC   VOLDD,DDOUT9                                              00500
         LM    R14,R3,SAV14T03                                    TEST   00501
         B     TIOTNEXT       CONTINUE                                   00502
TIOT9    CLC   4(8,R2),OUT10+40  OUTPUT FILE NUMBER 10?                  00503
         BNE   TIOT10         NO                                         00504
         OI    FLAG2,OP10     SHOW IT                                    00505
         STM   R14,R3,SAV14T03                                    TEST   00506
         RDJFCB OUT10                                                    00507
         MVC   VOLUME10(6),OUTJFCB+118    SAVE VOLUME SERIAL             00508
         MVC   VOLDD,DDOUT10                                             00509
         LM    R14,R3,SAV14T03                                    TEST   00510
         B     TIOTNEXT       CONTINUE                                   00511
TIOT10   CLC   4(8,R2),OUT11+40  OUTPUT FILE NUMBER 11?                  00512
         BNE   TIOT11         NO                                         00513
         OI    FLAG2,OP11     SHOW IT                                    00514
         STM   R14,R3,SAV14T03                                    TEST   00515
         RDJFCB OUT11                                                    00516
         MVC   VOLUME11(6),OUTJFCB+118    SAVE VOLUME SERIAL             00517
         MVC   VOLDD,DDOUT11                                             00518
         LM    R14,R3,SAV14T03                                    TEST   00519
         B     TIOTNEXT       CONTINUE                                   00520
TIOT11   CLC   4(8,R2),OUT12+40  OUTPUT FILE NUMBER 12?                  00521
         BNE   TIOT12         NO                                         00522
         OI    FLAG2,OP12     SHOW IT                                    00523
         STM   R14,R3,SAV14T03                                    TEST   00524
         RDJFCB OUT12                                                    00525
         MVC   VOLUME12(6),OUTJFCB+118    SAVE VOLUME SERIAL             00526
         MVC   VOLDD,DDOUT12                                             00527
         LM    R14,R3,SAV14T03                                    TEST   00528
         B     TIOTNEXT       CONTINUE                                   00529
TIOT12   CLC   4(8,R2),OUT13+40  OUTPUT FILE NUMBER 13?                  00530
         BNE   TIOT13         NO                                         00531
         OI    FLAG2,OP13     SHOW IT                                    00532
         STM   R14,R3,SAV14T03                                    TEST   00533
         RDJFCB OUT13                                                    00534
         MVC   VOLUME13(6),OUTJFCB+118    SAVE VOLUME SERIAL             00535
         MVC   VOLDD,DDOUT13                                             00536
         LM    R14,R3,SAV14T03                                    TEST   00537
         B     TIOTNEXT       CONTINUE                                   00538
TIOT13   CLC   4(8,R2),OUT14+40  OUTPUT FILE NUMBER 14?                  00539
         BNE   TIOT14         NO                                         00540
         OI    FLAG2,OP14     SHOW IT                                    00541
         STM   R14,R3,SAV14T03                                    TEST   00542
         RDJFCB OUT14                                                    00543
         MVC   VOLUME14(6),OUTJFCB+118    SAVE VOLUME SERIAL             00544
         MVC   VOLDD,DDOUT14                                             00545
         LM    R14,R3,SAV14T03                                    TEST   00546
         B     TIOTNEXT       CONTINUE                                   00547
TIOT14   CLC   4(8,R2),OUT15+40  OUTPUT FILE NUMBER 15?                  00548
         BNE   TIOT15         NO                                         00549
         OI    FLAG2,OP15     SHOW IT                                    00550
         STM   R14,R3,SAV14T03                                    TEST   00551
         RDJFCB OUT15                                                    00552
         MVC   VOLUME15(6),OUTJFCB+118    SAVE VOLUME SERIAL             00553
         MVC   VOLDD,DDOUT15                                             00554
         LM    R14,R3,SAV14T03                                    TEST   00555
         B     TIOTNEXT       CONTINUE                                   00556
TIOT15   CLC   4(8,R2),OUT16+40  OUTPUT FILE NUMBER 16?                  00557
         BNE   TIOTNEXT       NO                                         00558
         OI    FLAG2,OP16     SHOW IT                                    00559
         STM   R14,R3,SAV14T03                                    TEST   00560
         RDJFCB OUT16                                                    00561
         MVC   VOLUME16(6),OUTJFCB+118    SAVE VOLUME SERIAL             00562
         MVC   VOLDD,DDOUT16                                             00563
         LM    R14,R3,SAV14T03                                    TEST   00564
         B     TIOTNEXT       CONTINUE                                   00565
TIOTNEXT SR    R3,R3                                                     00566
         IC    R3,0(,R2)      R3=LENGTH OF DD ENTRY                      00567
         AR    R2,R3          R2=NEXT DD ENTRY                           00568
         B     TIOTLOOP       GO CHECK IT                                00569
*  ---------------------------------------------------------  SBG 09/00  00570
*  --------  DO WE PROPAGATE OUTPUT VOLSER TO ALL OUTPUTS ? --------*    00571
OVOLOV   TM    PARMFLG2,X'20'    IS SYSIN PRESENT                        00572
         BZ    NOVOLOV           NO. CAN'T OVERRIDE OUTPUT VOLSERS.      00573
         TM    OVERFLAG,X'01'    IS THERE AN OVERRIDE PENDING?           00574
         BZ    NOVOLOV           NOPE.  JUST GET OUT.                    00575
         MVC   VOLALL,VOLSTG     PROPAGATE VOLSER TO ALL OUTPUTS         00576
NOVOLOV  DS    0H                                                        00577
*  ---------------------------------------------------------  SBG 09/00  00578
         SPACE 3                                                         00579
*  -----------------------------------------------------------------  *  00580
*                                                                        00581
*  OPEN ALL FILES   -  EXCEPT SYSIN, WHICH IS FINISHED ALREADY           00582
*                                                                        00583
*  -----------------------------------------------------------------  *  00584
OPENS    DS    0H               START OPENING FILES                      00585
         OPEN  (SYSPRINT,OUTPUT)                                         00586
         TM    PARMFLG3,X'01'    INIT TAPES ONLY?
         BO    OPENMOVE
*----- TESTS FOR EXTRA DD CARDS REQUIRED - EXTRA FILES TO BE OPENED.     00587
         TM    PARMFLG2,X'10'   DO WE DUMP LABELS?            SBG 09/00  00588
         BZ    OPNLABIN         NO. CHECK IF WE NEED LABADDIN.    09/00  00589
         OPEN  (LABLDUMP,OUTPUT)                              SBG 09/00  00590
         TM    LABLDUMP+48,X'10'     IS THE DD OPEN  ?                   00591
         BZ    NOLBLDD        NO. FLAG ERROR AND CHECK LABADDIN.         00592
         OI    OPENDFLG,X'01'     FLAG THAT LABLDUMP IS OPEN.            00593
         B     OPNLABIN           CHECK FOR LABADDIN DDNAME              00594
NOLBLDD  MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     00595
         MVC   LINE(133),LDMPMSG   DISPLAY MISSING DD MESSAGE            00596
         PUT   SYSPRINT,LINE                                             00597
         OI    ENDITFLG,X'01'   FLAG THAT LABLDUMP NOT OPEN.             00598
OPNLABIN TM    PARMFLG2,X'80'   DO WE NEED LABADDIN?                     00599
         BZ    CHKENDIT         NO. SEE IF ANYTHING ELSE IS BAD          00600
         OPEN  (LABADDIN,INPUT)                                          00601
         TM    LABADDIN+48,X'10'     IS THE DD OPEN  ?                   00602
         BZ    NOLABIN        NO. FLAG THE ERROR & MESSAGE               00603
         OI    OPENDFLG,X'04'     FLAG THAT LABADDIN IS OPEN.            00604
         B     CHKENDIT        GO CHECK IF WE HAVE TO END.               00605
NOLABIN  MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     00606
         MVC   LINE(133),NLABMSG   DISPLAY MISSING DD MESSAGE            00607
         PUT   SYSPRINT,LINE                                             00608
         OI    ENDITFLG,X'04'   FLAG THAT LABADDIN NOT OPEN.             00609
CHKENDIT TM    ENDITFLG,X'07'   CHECK IF WE HAVE TO END                  00610
         BZ    OPENIN           NOTHING WRONG.  GO ON.                   00611
ENDEM    DS    0H            WE GOTTA GET OUT. WHICH DDS STILL OPEN?     00612
         CLOSE (SYSPRINT)                                                00613
         TM    OPENDFLG,X'01'   IS LABLDUMP DD OPEN?                     00614
         BZ    TRYCSYSN         NO.  TRY IF SYSIN IS OPEN.               00615
         NI    OPENDFLG,FF-X'01'   MARK FILE AS CLOSED
         CLOSE (LABLDUMP)                                                00616
TRYCSYSN TM    OPENDFLG,X'02'   IS SYSIN    DD OPEN?                     00617
         BZ    TRYCLABN         NO.  TRY LABADDIN.                       00618
         NI    OPENDFLG,FF-X'02'   MARK FILE AS CLOSED
         CLOSE (SYSIN)                                                   00619
TRYCLABN TM    OPENDFLG,X'04'   IS LABADDIN DD OPEN?                     00620
         BZ    REALYEND         NO.  GET OUT.                            00621
         NI    OPENDFLG,FF-X'04'   MARK FILE AS CLOSED
         CLOSE (LABADDIN)                                                00622
REALYEND B     THEEND1                                                   00623
         EJECT                                                           00624
OPENIN   OPEN  (IN,INPUT)                                                00625
         TM    PARMFLG3,X'02'     LIMIT FILES TO BE COPIED?
         BO    OPENINCK           DO PRELIMINARY OPEN IF SO
* -------------- LABADDIN CHECK FOR SL TAPE ------------------------ *   00626
         TM    PARMFLG2,X'80'     ARE WE DOING LABADDIN ?                00627
         BZ    NOINITOP           NO. DON'T DO PRELIMINARY OPEN          00628
* ----                                                                   00629
OPENINCK DS    0H
         LA    R2,IN              POINT TO IN DCB                        00630
         ST    R2,REWDCBPT        TELL IOB TO REWIND IN                  00631
         MVC   REWECB,=F'0'       INITIALIZE REW'S ECB                   00632
         EXCP  REWIOB                                                    00633
         WAIT  ECB=REWECB                                                00634
         MVC   INECB,=F'0'        INITIALIZE IN'S ECB                    00635
         EXCP  INIOB                                                     00636
         WAIT  ECB=INECB                                                 00637
         CLC   INAREA(4),=C'VOL1' IS THE TAPE IBM SL ?                   00638
         BNE   RESETIN            NO. JUST REWIND TO REPOSITION.         00639
         OI    SLFLAG,X'01'       INDICATE INPUT TAPE IS SL
         TM    PARMFLG2,X'80'     ARE WE HERE FOR LABADDIN?
         BO    OPENINXX           VOL1 IS NOT LEGITIMATE FOR LABADDIN
****** ------ BELOW ------ SL FILE NUMBERS.
         TM    PARMFLG3,X'02'     ARE WE LIMITING INPUT FILES?
         BZ    OPENINXX           NO, GET OUT OF ROUTINE
         CLC   LINFILE,=F'0'      IS THERE A POSITIVE LIMIT NUMBER?
         BE    RESETIN            NO. JUST RESET TAPE W/O ERROR MSG
         MVC   LTGFILE(4),LSLFILE    MOVE IN 3 TIMES SET LIMIT FOR SL
         MVC   LIMFMSG+68(2),=C'SL'  MOVE SL INTO FILE NUMBER MESSAGE
         B     RESETIN            REWIND INPUT TAPE WITHOUT ERROR MSG
OPENINXX DS    0H
****** ------ ABOVE ------ SL FILE NUMBERS.
* --                         WE HAVE VOL1 LABEL. NASTY MSG AND QUIT.     00640
         MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     00641
         MVC   LINE(133),NOLABSL  DISPLAY NO SL ON SL MSG                00642
         PUT   SYSPRINT,LINE      WRITE MSG                              00643
         TM    OPENDFLG,X'02'   IS SYSIN    DD OPEN?                     00644
         BZ    RESETLAD         NO.  TRY LABADDIN.                       00645
         NI    OPENDFLG,FF-X'02'   MARK FILE AS CLOSED
         CLOSE (SYSIN)                                                   00646
RESETLAD TM    OPENDFLG,X'04'   IS LABADDIN DD OPEN?                     00647
         BZ    RESETEND         NO.  GET OUT.                            00648
         NI    OPENDFLG,FF-X'04'   MARK FILE AS CLOSED
         CLOSE (LABADDIN)                                                00649
RESETEND CLOSE (IN)                                                      00650
         B     THEEND1                                                   00651
* --                      NO VOL1 LABEL. ASSUME NL TAPE SO CONTINUE.     00652
RESETIN  DS    0H                                                        00653
         MVC   REWECB,=F'0'                                              00654
         EXCP  REWIOB                                                    00655
         WAIT  ECB=REWECB                                                00656
NOINITOP DS    0H                                                        00657
* -------------- LABADDIN CHECK FOR SL TAPE ------------------------ *   00658
         TM    PARMFLG2,X'10'     TEST IF LABLDUMP IS NEEDED.            00659
         BZ    NOLBLDMP           ISN'T. NO POINT TO RDJFCB.             00660
READJLDM RDJFCB LABLDUMP                MOVE JFCB TO AREA                00661
         LTR   R15,R15                  DDNAME SHOULD BE THERE           00662
         BNZ   NOLBLDD                  IF NOT, FLAG                     00663
         ST    R7,SAVE7REG              SAVE R7                          00664
         LA    R7,LBLJFCB               POINT TO JFCB AREA               00665
         USING JFCBLK,R7                MAP THE AREA                     00666
         MVC   LDMPOUTM+38(44),JFCBDSNM                                  00667
         MVC   LDMPOUTM+89(8),JFCBELNM                                   00668
         MVC   LDMPOUTM+105(6),JFCBVOLS                                  00669
         MVC   LINE(133),LINE-1                                          00670
         MVC   LINE(133),LDMPOUTM                                        00671
         PUT   SYSPRINT,LINE                                             00672
         DROP  R7                                                        00673
         L     R7,SAVE7REG              RESTORE R7                       00674
NOLBLDMP DS    0H               SKIP LABLDUMP RDJFCB.         SBG 09/00  00675
         TM    PARMFLG2,X'80'     TEST IF LABLDUMP IS NEEDED.            00676
         BZ    NOLBLSIN           ISN'T. NO POINT TO RDJFCB.             00677
READJLIN RDJFCB LABADDIN                MOVE JFCB TO AREA                00678
         LTR   R15,R15                  DDNAME SHOULD BE THERE           00679
         BNZ   NOLABIN                  IF NOT, FLAG                     00680
         ST    R7,SAVE7REG              SAVE R7                          00681
         LA    R7,LBNJFCB               POINT TO JFCB AREA               00682
         USING JFCBLK,R7                MAP THE AREA                     00683
         MVC   LDMPINMS+38(44),JFCBDSNM                                  00684
         MVC   LDMPINMS+89(8),JFCBELNM                                   00685
         MVC   LDMPINMS+105(6),JFCBVOLS                                  00686
         MVC   LINE(133),LINE-1                                          00687
         MVC   LINE(133),LDMPINMS                                        00688
         PUT   SYSPRINT,LINE                                             00689
         DROP  R7                                                        00690
         L     R7,SAVE7REG              RESTORE R7                       00691
NOLBLSIN DS    0H               SKIP LABADDIN RDJFCB.         SBG 09/00  00692
* --- READ ONLY CODE ------------------ BELOW --------------- SBG 06/00  00693
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  00694
         BZ    OPENMOVE   NO. CONTINUE WITH ALL THE OPENS.    SBG 06/00  00695
*                         OTHERWISE PUT INITIAL READONLY MSG  SBG 06/00  00696
         MVC   LINE(133),READOMSG    MOVE READ-ONLY MESSAGE   SBG 06/00  00697
         PUT   SYSPRINT,LINE  WRITE INITIAL MESSAGE SHOWING READONLY     00698
* -- FILE LIMIT MESSAGE IF APPLICABLE --- BELOW --- *
         TM    PARMFLG3,X'02'   IS FILE LIMITATION IN EFFECT?
         BZ    NOLIMFMR         NO, SKIP MESSAGE
         MVC   LINE,LINE-1      CLEAR MSG LINE
         MVC   LINE(133),LIMFMSG    MOVE MESSAGE TEXT IN
         PUT   SYSPRINT,LINE
NOLIMFMR DS    0H
* -- FILE LIMIT MESSAGE IF APPLICABLE --- ABOVE --- *
         B     READIN                                         SBG 06/00  00699
* --- READ ONLY CODE ------------------ ABOVE --------------- SBG 06/00  00700
OPENMOVE MVC   FLAG3(2),FLAG1 SAVE INDICATION OF WHICH FILES ARE HERE    00701
*                             THIS ALSO MOVES FLAG2 TO FLAG4  SBG 03/00  00702
*  ---------------------------------------------------------  SBG 03/00  00703
         TM    PARMFLG3,X'01'   INIT TAPES ONLY?
         BZ    OPENOINT
         MVC   INITCOPD,INITCREA    MOVE APPROPRIATE MESSAGE IN
         B     NOCORPRT
OPENOINT DS    0H
* ---- BLOCK COUNT CORRECTION ON TAPE COPY - PRINT MESSAGE -------- *    00703
         TM    PARMFLG3,X'20'   IS BLOCK COUNT CORRECTION IN EFFECT
         BZ    NOCORPRT         IF NOT, DON'T PRINT MESSAGE
         ST    R7,SAVE7REG
         BAL   R7,PRTBLCNT      LET THE USER KNOW OPTION IS ACTIVE
         L     R7,SAVE7REG
NOCORPRT DS    0H
* ---- BLOCK COUNT CORRECTION ON TAPE COPY - PRINT MESSAGE -------- *    00703
* -- FILE LIMIT MESSAGE IF APPLICABLE --- BELOW --- *
         TM    PARMFLG3,X'02'   IS FILE LIMITATION IN EFFECT?
         BZ    NOLIMFMS         NO, SKIP MESSAGE
         MVC   LINE,LINE-1      CLEAR MSG LINE
         MVC   LINE(133),LIMFMSG    MOVE MESSAGE TEXT IN
         PUT   SYSPRINT,LINE
NOLIMFMS DS    0H
* -- FILE LIMIT MESSAGE IF APPLICABLE --- ABOVE --- *
         TM    FLAG1,OP1      OUTPUT 1 PRESENT?                          00704
         BZ    OPEN1          NO                                         00705
         OPEN  (OUT1,OUTPUT)                                             00706
OPEN1    TM    FLAG1,OP2      OUTPUT 2 PRESENT?                          00707
         BZ    OPEN2          NO                                         00708
         OPEN  (OUT2,OUTPUT)                                             00709
OPEN2    TM    FLAG1,OP3      OUTPUT 3 PRESENT?                          00710
         BZ    OPEN3          NO                                         00711
         OPEN  (OUT3,OUTPUT)                                             00712
OPEN3    TM    FLAG1,OP4      OUTPUT 4 PRESENT?                          00713
         BZ    OPEN4          NO                                         00714
         OPEN  (OUT4,OUTPUT)                                             00715
OPEN4    TM    FLAG1,OP5      OUTPUT 5 PRESENT?                          00716
         BZ    OPEN5          NO                                         00717
         OPEN  (OUT5,OUTPUT)                                             00718
OPEN5    TM    FLAG1,OP6      OUTPUT 6 PRESENT?                          00719
         BZ    OPEN6          NO                                         00720
         OPEN  (OUT6,OUTPUT)                                             00721
OPEN6    TM    FLAG1,OP7      OUTPUT 7 PRESENT?                          00722
         BZ    OPEN7          NO                                         00723
         OPEN  (OUT7,OUTPUT)                                             00724
OPEN7    TM    FLAG1,OP8      OUTPUT 8 PRESENT?                          00725
         BZ    OPEN8          NO                                         00726
         OPEN  (OUT8,OUTPUT)                                             00727
OPEN8    TM    FLAG2,OP9      OUTPUT 9 PRESENT?                          00728
         BZ    OPEN9          NO                                         00729
         OPEN  (OUT9,OUTPUT)                                             00730
OPEN9    TM    FLAG2,OP10     OUTPUT 10 PRESENT?                         00731
         BZ    OPEN10         NO                                         00732
         OPEN  (OUT10,OUTPUT)                                            00733
OPEN10   TM    FLAG2,OP11     OUTPUT 11 PRESENT?                         00734
         BZ    OPEN11         NO                                         00735
         OPEN  (OUT11,OUTPUT)                                            00736
OPEN11   TM    FLAG2,OP12     OUTPUT 12 PRESENT?                         00737
         BZ    OPEN12         NO                                         00738
         OPEN  (OUT12,OUTPUT)                                            00739
OPEN12   TM    FLAG2,OP13     OUTPUT 13 PRESENT?                         00740
         BZ    OPEN13         NO                                         00741
         OPEN  (OUT13,OUTPUT)                                            00742
OPEN13   TM    FLAG2,OP14     OUTPUT 14 PRESENT?                         00743
         BZ    OPEN14         NO                                         00744
         OPEN  (OUT14,OUTPUT)                                            00745
OPEN14   TM    FLAG2,OP15     OUTPUT 15 PRESENT?                         00746
         BZ    OPEN15         NO                                         00747
         OPEN  (OUT15,OUTPUT)                                            00748
OPEN15   TM    FLAG2,OP16     OUTPUT 16 PRESENT?                         00749
         BZ    READIN         NO                                         00750
         OPEN  (OUT16,OUTPUT)                                            00751
         SPACE 3                                                         00752
* --------------------------------------------------------- *            00753
*                                                           *            00754
*  READ INPUT                                               *            00755
*                                                           *            00756
* --------------------------------------------------------- *            00757
*                                                           *            00756
*    THIS IS WHERE RECORDS ARE READ IN FROM.  IF EXTERNAL   *            00758
*    LABELS ARE BEING MERGED WITH A NL TAPE TO MAKE AN SL   *            00759
*    TAPE, THEN A SET OF LABELS IS READ IN AT INEXTLAB      *            00760
*    AND THE TAPE DATA IS READ IN FROM THE INPUT TAPE, AT   *            00761
*    THIS POINT.  THE DIFFERENCE WHEN WRITING THE OUTPUTS,  *            00762
*    IS CREATED BY POINTING THE OUTIOB EITHER AT THE INAREA *            00762
*    WHEN WRITING TAPE BLOCKS, OR AT THE EXTLABIN AREA,     *            00756
*    WHEN WRITING THE OUTPUT TAPES FROM THE EXTERNAL LABELS.*            00756
*                                                           *            00756
* --------------------------------------------------------- *            00763
READIN   DS    0H                                                        00764
         TM    PARMFLG3,X'01'     INITTING TAPES ONLY?
         BO    TLITWRIT
         NI    L80FLAG,FF-X'01'   TURN OFF 80-BYTE INDICATOR  SBG 03/00  00764
         NI    LBLFLAG,FF-X'04'   TURN OFF VOL1 FLAG                     00765
         MVI   INECB,X'00'    INITIALIZE ECB                             00766
* ------------------------------------------------------------------ *   00767
*   DO WE GET RECORDS FROM THE "IN" DDNAME, IN OTHER WORDS,          *   00768
*   FROM THE INPUT TAPE?  OR DO WE GET RECORDS FROM THE EXTERNAL     *   00769
*   LABEL FILE?  THIS IS DETERMINED BY THE SETTING OF WRLBLFLG,X'01' *   00770
* ------------------------------------------------------------------ *   00771
         TM    PARMFLG2,X'80' IS LABEL WRITE OPTION ON?                  00772
         BZ    NONLSL0        NO. IGNORE THIS CODE                       00773
         TM    WRLBLFLG,X'01' CHECK FLAG TO WRITE FROM LABADDIN          00774
         BO    INEXTLAB       GO GET LABELS FROM EXTERNAL FILE           00775
NONLSL0  DS    0H                                                        00776
* ----------------------------------------------------------- SBG 09/00  00777
INFROMIN DS    0H             INPUT IS FROM THE INPUT TAPE               00778
***** --------------- LIMITING FILES ------------------ ***** BELOW *
         TM    PARMFLG3,X'02'     LIMITING FILES?
         BZ    INOLIMIT           NO - BYPASS THIS CODE
         TM    EOFINFLG,X'01'     AT LOGICAL END OF INPUT?
         BZ    INOLIMIT           NOT YET - JUST GO ON
         B     READIN1            SIMULATE SECOND TAPE MARK BY FORCE
*                                 AND DON'T DO MORE READS OF INPUT TAPE
INOLIMIT DS    0H
***** --------------- LIMITING FILES ------------------ ***** ABOVE *
         EXCP  INIOB          READ                                       00779
         WAIT  ECB=INECB      WAIT FOR READ                              00780
         TM    INCSW+4,X'01'  WAS TM READ?                               00781
         BO    READIN1        YES                                        00782
         CLI   INECB,X'7F'    DID READ COMPLETE NORMALLY?                00783
         BNE   INERR          NO -- ERROR                                00784
         MVI   OUTCCW,X'01'   SET OUTPUT CCW TO WRITE                    00785
*        LH    R2,INCCW+6     R2=READ LENGTH                  SBG 03/00  00786
         XC    FULLWORK,FULLWORK     CLEAR AREA COMPLETELY    SBG 03/00  00787
         MVC   HALFWORK(2),INCCW+6   READ LENGTH              SBG 03/00  00788
         L     R2,FULLWORK    LOAD R2 WITH FULL LOW ORDER     SBG 03/00  00789
*        LH    R3,INCSW+6     R3=RESIDUAL BYTE COUNT          SBG 03/00  00790
         MVC   HALFWORK(2),INCSW+6   RESIDUAL BYTE COUNT      SBG 03/00  00791
         L     R3,FULLWORK    LOAD R3 WITH FULL LOW ORDER     SBG 03/00  00792
         SR    R2,R3          R2=ACTUAL LENGTH READ                      00793
**** ----  BYTE COUNTS ---- BELOW
         TM    PARMFLG3,X'04' ARE WE COUNTING BYTES?
         BZ    INNOBYTE       NO, SKIP INCREMENT
         LA    R3,DBIN        POINT REGISTER TO COUNTER
         BAL   R7,ADDCOUNT    INCREMENT WITH BYTE COUNT
INNOBYTE DS    0H
**** ----  BYTE COUNTS ---- ABOVE
         NI    DATFLAG,FF-X'10'  SHOW REAL DATA HAS BEEN READ SBG 03/00  00794
*  --- BELOW ---  CODE TO DETECT SL BEFORE 2 TAPE MARKS.      SBG 03/00  00795
         C     R2,=F'80'      DID WE READ 80-BYTE BLOCK LAST? SBG 03/00  00796
         BNE   READGO1        NO. SKIP THIS PROCESSING.       SBG 03/00  00797
         OI    L80FLAG,X'01'  INDICATE 80-BYTE RECORD READ    SBG 03/00  00798
         BAL   R6,LABELCHK    CHECK FOR ALL KINDS OF SL       SBG 04/00  00799
*                             FORMATS, AND SET FLAGS          SBG 04/00  00800
*                             ACCORDINGLY.  OPTIONALLY        SBG 04/00  00801
*                             PRINT LABEL INFO FOUND.         SBG 04/00  00802
*  --- ABOVE ---  CODE TO DETECT SL BEFORE 2 TAPE MARKS.      SBG 03/00  00803
*                                                             SBG 04/00  00804
*  --- BELOW ---  DON'T ADD LABELS TO SL TAPE ---------.      SBG 03/00  00805
         TM    PARMFLG2,X'80'     ARE WE ADDING LABELS?                  00806
         BZ    READGO1            NO. WE CAN GO ON.                      00807
         TM    ISLBLFLG,X'01'     DID WE JUST READ A LABEL?              00808
         BZ    READGO1            NO DON'T CHECK FOR SL                  00809
         MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     00810
         MVC   LINE(133),NOLABSL  DISPLAY NO SL ON SL MSG                00811
         PUT   SYSPRINT,LINE      WRITE MSG                              00812
         NI    OPENDFLG,FF-X'04'  MARK FILE AS CLOSED
         CLOSE (LABADDIN)                                                00813
         TM    OPENDFLG,X'02'     IS SYSIN OPEN?                         00814
         BZ    NOSLSOUT           NO. DON'T HAVE TO CLOSE IT             00815
         NI    OPENDFLG,FF-X'02'  MARK FILE AS CLOSED
         CLOSE (SYSIN)                                                   00816
NOSLSOUT B     CLOSMALL           CLOSE OTHER FILES AND SCRAM            00817
*  --- ABOVE ---  DON'T ADD LABELS TO SL TAPE ---------.      SBG 03/00  00818
         EJECT
*  ----------------------------------------------------------------  *
*  --- BELOW ---  CODE TO READ IN EXTERNAL LABELS TO THE OUTPUT TAPES.   00819
INEXTLAB DS    0H           WRITE A BLOCK OF LABELS TO OUTPUT TAPE       00820
*                           INPUT IS FROM THE EXTERNAL LABEL FILE        00821
*  ----------------------------------------------------------------  *
         TM    PARMFLG2,X'80'   IS LABEL WRITE OPTION SET?               00822
         BZ    GETBLOKZ         NO. NEVER COME HERE AGAIN.               00823
**** --------- END OF DATA ON TAPE INPUT ----   BELOW   ---- ****
         TM    INEODFLG,X'02'   DID WE RUN OUT OF TAPE DATA?
         BZ    STILTAPE
         TM    WRLBLFLG,X'02'   ARE WE WRITING AN EXTRA TAPEMARK?
         BZ    STILTAPE
         B     WRTTAPMK
STILTAPE DS    0H
**** --------- END OF DATA ON TAPE INPUT ----   ABOVE   ---- ****
         TM    WRLBLFLG,X'08'       COMING HERE FROM EOF ON LABADDIN?
         BZ    DOTHEGET             NO. DO THE FILE GETS.
         TM    PARMFLG3,X'80'       IS LBLFIX IN EFFECT?
         BO    LBLINEND             GO TO EOFRTN AND FIX MISSING DATA
         B     CLOSMALL             EOD. DON'T TRY TO GET MORE.
DOTHEGET DS    0H
         GET   LABADDIN,EXTLBLIN                                         00824
         CLI   EXTLBLIN,C'*'    IS IT A COMMENT CARD?                    00825
         BE    INEXTLAB         IF IT IS, IGNORE IT.                     00826
         CLC   =C'----ENDOFLABELHEADER ',EXTLBLIN                        00827
         BE    ENDHEADR       YES, WRITE TAPE MARK & REINIT WRITE        00828
         CLC   =C'----ENDOFLABELTRAILER',EXTLBLIN                        00829
         BE    ENDTRAIL             YES. INDICATE DATA FOLLOWS           00830
* ---------------------------------  EOV2EOF  BELOW  ------------- *
         CLC   =C'----ENDOFLABELTRAILEREOV',EXTLBLIN                     00831
*        BE    LBLINEND       EOV2. ONLY ONE TAPEMARK AND OUT            00832
         BNE   NTRALEOV            NOT FOLLOWING AN EOV TRAILER
         OI    LBLLFLAG,X'80'      SAY YOU'VE SEEN THIS CONTROL CARD
         NI    LBLLFLAG,FF-X'40'   SHOW NOT AT ENDOFHEADER
         TM    PARMFLG2,X'04'      EOV TO EOF PROCESSING IN EFFECT?
         BZ    TRAILEOV            NO. ONE TAPE MARK AND OUT
TRAILEOF B     ENDTRAIL            YES. TREAT LIKE A TRAILER
TRAILEOV B     LBLINEND            NO EOV2EOF. SAME AS BEFORE.
NTRALEOV DS    0H
* ---------------------------------  EOV2EOF  ABOVE  ------------- *
         CLC   EXTLBLIN(4),=C'VOL1' IS THE CARD A VOL1?                  00833
         BNE   NLABVOL1             NO. CHECK FOR OTHER CARDS
         OI    LBLLFLAG,X'04'       SHOW VOL1 SEEN IN EXTERNAL LABELS
         B     GOTVOL01             PROCESS THE VOL1                     00834
NLABVOL1 DS    0H
***** ----- *****  CHECK EXTERNAL LABELS FOR TYPE - BELOW
         CLC   EXTLBLIN(4),=C'HDR1'
         BNE   NLABHDR1
         OI    LBLLFLAG,X'01'       SHOW HDR1 HAS BEEN SEEN
         NI    LBLLFLAG,FF-X'30'    SHOW NOT TRAILERS
         MVC   HDR1SAV(80),EXTLBLIN  SAVE HDR1 CARD
         B     ENDIBMSL
NLABHDR1 DS    0H
         CLC   EXTLBLIN(4),=C'HDR2'
         BNE   NLABHDR2
         OI    LBLLFLAG,X'02'       SHOW HDR2 HAS BEEN SEEN
         NI    LBLLFLAG,FF-X'30'    SHOW NOT TRAILERS
         MVC   HDR2SAV(80),EXTLBLIN  SAVE HDR2 CARD
         B     ENDIBMSL
NLABHDR2 DS    0H
***** ----- *****
         CLC   EXTLBLIN(4),=C'EOF1'
         BNE   NLABEOF1
         OI    LBLLFLAG,X'10'       SHOW EOF1 HAS BEEN SEEN
         NI    LBLLFLAG,FF-X'07'    SHOW NOT HEADERS OR VOL1
         B     ENDIBMSL
NLABEOF1 DS    0H
         CLC   EXTLBLIN(4),=C'EOF2'
         BNE   NLABEOF2
         OI    LBLLFLAG,X'20'       SHOW EOF2 HAS BEEN SEEN
         NI    LBLLFLAG,FF-X'07'    SHOW NOT HEADERS OR VOL1
         B     ENDIBMSL
NLABEOF2 DS    0H
***** ----- *****
         CLC   EXTLBLIN(4),=C'EOV1'
         BNE   NLABEOV1
         OI    LBLLFLAG,X'10'       AS IF EOF1 HAS BEEN SEEN
         NI    LBLLFLAG,FF-X'07'    SHOW NOT HEADERS OR VOL1
         B     ENDIBMSL
NLABEOV1 DS    0H
         CLC   EXTLBLIN(4),=C'EOV2'
         BNE   NLABEOV2
         OI    LBLLFLAG,X'20'       AS IF EOF2 HAS BEEN SEEN
         NI    LBLLFLAG,FF-X'07'    SHOW NOT HEADERS OR VOL1
         B     ENDIBMSL
NLABEOV2 DS    0H
ENDIBMSL DS    0H
***** ----- *****  CHECK EXTERNAL LABELS FOR TYPE - ABOVE
ISITHDR  CLC   EXTLBLIN(3),=C'HDR'  IS THE CARD A HDR?                   00835
         BE    WRTLABEL             ASSUME THAT HDRS FOLLOW              00836
* -------------- EOF2EOV BELOW ----------------- *
ISITEOV  DS    0H
         CLC   EXTLBLIN(3),=C'EOV'
         BNE   NOEOF2V
         TM    PARMFLG2,X'04'       IS EOV2EOF IN EFFECT?
         BZ    NOEOF2V
         MVC   EXTLBLIN(3),=C'EOF'
NOEOF2V  DS    0H
* -------------- EOF2EOV ABOVE ----------------- *
* ----------                                                             00837
         TM    PARMFLG1,X'01'       ARE WE CORRECTING BLOCK COUNTS?      00838
         BZ    BLNOCORR             NO. SKIP THIS.                       00839
ISITEOF1 CLC   EXTLBLIN(4),=C'EOF1'     DO ON EOF1                       00840
         BE    CORBLKCT                                                  00841
         CLC   EXTLBLIN(4),=C'EOV1'     DO ON EOV1                       00842
         BE    CORBLKCT                                                  00843
BLNOCORR B     EOFOREOV                                                  00844
****** ----- LABEL FIX CODE FOR EOF2 OR EOV2 ----- ****** BELOW
ADDEOF2  TM    WRLBLFLG,X'08'       COMING FROM LBLINEND?
         BZ    NOMKEOF2             WE STILL CAN GET A REAL ONE.
         TM    PARMFLG3,X'80'       FIXING LABELS?
         BZ    NOMKEOF2             NO. DON'T MAKE EOF2 IF MISSING
MAKEEOF2 DS    0H
         MVC   EXTLBLIN(80),HDR2SAV
         MVC   EXTLBLIN(3),=C'EOF'
NOMKEOF2 DS    0H
****** ----- LABEL FIX CODE FOR EOF2 OR EOV2 ----- ****** ABOVE
* ----------                                                             00845
EOFOREOV CLC   EXTLBLIN(2),=C'EO'   EOF OR EOV ?                         00846
         BE    WRTLABEL             SET UP TO WRITE ANOTHER SET          00847
**** ---- ****
         CLC   EXTLBLIN(3),=C'UHL'  USER HEADER LABEL ?
         BNE   NOTLUHL
         OI    LBLLFLAG,X'08'       MARK THAT UHL SEEN IN EXT LABELS
         B     WRTLABEL             WRITE USER HEADER LABELS TO OUTPUTS
NOTLUHL  DS    0H
**** ---- ****
         CLC   EXTLBLIN(3),=C'UTL'  USER TRAILER LABEL ?
         BE    WRTLABEL             LEGIT. WRITE TO OUTPUTS.
         B     INEXTLAB     UNKNOWN, GET ANOTHER LABADDIN RECORD         00848
ENDHEADR DS    0H                                                        00849
         OI    LBLLFLAG,X'40'   FLAG THAT YOU'VE SEEN ENDHDR CNTL CARD
         OI    WRLBLFLG,X'04'   ALWAYS SAY WHEN YOU'RE COMING FROM HERE
         NI    LBLLFLAG,FF-X'80'    SHOW NOT AT ENDOFTRAILER
*** -----
         TM    INEODFLG,X'02'       END OF DATA ON INPUT TAPE
         BZ    NOEODFL1
         OI    WRLBLFLG,X'02'       FLAG TO WRITE AN EXTRA TAPE MARK
         B     ENDTRAIL
NOEODFL1 DS    0H
*** -----
         NI    WRLBLFLG,FF-X'01'    DON'T COME HERE NEXT TIME            00850
WRTMNDAT B     FINLABEL             WTM AND SET UP TO WRITE DATA         00851
ENDTRAIL DS    0H                                                        00852
         OI    WRLBLFLG,X'01'       COME HERE NEXT TIME                  00853
         MVI   LBLLFLAG,X'00'       CLEAR ALL FLAGS THAT LABELS SEEN
         OI    LBLLFLAG,X'80'   FLAG THAT YOU'VE SEEN ENDTRLR CNTL CARD
         BAL   R7,CLEARSAV          CLEAR LBLFIX SAVE AREAS
         B     WRTTAPMK                                                  00854
* -- CORRECT BLOCK COUNT IN EOF1 AND EOV1 WHEN WRITING OUTSIDE LABELS    00855
CORBLKCT DS    0H                                                        00856
         TM    PARMFLG2,X'80'    TEST IF EXTERNAL LABELS BEING ADDED     00857
         BZ    NOCORBLK          NO. BYPASS.                             00858
         TM    PARMFLG1,X'01'    TEST IF BLOCK COUNT CORRECTION WANTED   00859
         BZ    NOCORBLK          NO. BYPASS.                             00860
*** ---  FIXING LABELS  --- ***
         TM    PARMFLG3,X'80'    LABEL FIXING TURNED ON?
         BZ    NOFIXL1           NO. DON'T FIX.
         TM    LBLLFLAG,X'10'    HAVE WE SEEN A REAL EOF1?
         BO    NOFIXL1           YES. DON'T CREATE ONE.
CORFEOF1 MVC   EXTLBLIN(80),HDR1SAV   MOVE SAVED HDR1 AS EOF1
         MVC   EXTLBLIN(3),=C'EOF'    MARK AS AN EOF1 LABEL
NOFIXL1  DS    0H
*** ---  FIXING LABELS  --- ***
         MVC   EXTLBLIN+54(6),BLKCNTSV+1    MOVE IN SAVED BLK COUNT      00861
NOCORBLK B     EOFOREOV                                                  00862
* -- CORRECT BLOCK COUNT IN EOF1 AND EOV1 WHEN WRITING OUTSIDE LABELS    00863
GOTVOL01 DS    0H                                                        00864
         OI    LBLFLAG,X'04'         ACT AS IF WE SAW A VOL1 ON INPUT    00865
         MVC   VOLORIG(6),EXTLBLIN+4   MOVE IN ORIGINAL "VOLSER"         00866
* ----       REPORT OUTVOLALL= VOLUME  ---  BELOW                        00867
         TM    OVERFLAG,X'01'          OUTVOLALL= IS CODED?              00868
         BZ    NOOVLALL                NOPE. DON'T CHANGE REPORT         00869
         MVC   VOLNEW(6),VOLSTG        OVERLAY NEW VOLSER FOR ALL OUTS   00870
NOOVLALL DS    0H                                                        00871
* ----       REPORT OUTVOLALL= VOLUME  ---  ABOVE                        00872
         B     WRTLABEL                                                  00873
WRTLABEL OI    WRLBLFLG,X'01'                                            00874
* --------------- PRINT LABEL TO BE WRITTEN ------------------- *        00875
         TM    PARMFLG3,X'10' DO WE PRINT EXT LABELS TO BE WRITTEN       00876
         BZ    NOPRTEXT       FLAG IS NOT ON. DON'T REPORT THEM          00877
TRYPXXX0 DS    0H                                                        00878
         CLC   EXTLBLIN(4),=C'VOL1'                                      00879
         BNE   TRYPUSER                                                  00880
         MVI   LINE-1,C' '                                    SBG 09/00  00881
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 09/00  00882
         MVC   VOL1SER(6),LINE       CLEAR FIELD TO BLANKS    SBG 09/00  00883
         MVC   VOL1SER(6),EXTLBLIN+4   REPORT VOLUME SERIAL   SBG 09/00  00884
         MVC   VOL1OWNR(10),LINE     CLEAR FIELD TO BLANKS    SBG 09/00  00885
         MVC   VOL1OWNR(10),EXTLBLIN+41   OWNER INFORMATION   SBG 09/00  00886
         MVC   LINE(133),VOL1LBL  INDICATE THAT VOL1 FOUND    SBG 09/00  00887
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER       SBG 09/00  00888
         B     NOPRTEXT                                                  00889
TRYPUSER DS    0H                                                        00878
         CLC   EXTLBLIN(3),=C'UHL'     USER HEADER LABEL?                00879
         BE    PUSERPR                 YES.  PRINT ENTIRE LABEL.         00880
         CLC   EXTLBLIN(3),=C'UTL'     USER TRAILER LABEL?               00879
         BE    PUSERPR                 YES.  PRINT ENTIRE LABEL.         00880
         B     TRYPXXX1
PUSERPR  ST    R3,SAVE3REG
         LA    R3,EXTLBLIN
         BAL   R7,PRTUSER     PRINT LABEL INFO
         L     R3,SAVE3REG
         B     NOPRTEXT                                                  00889
TRYPXXX1 CLC   EXTLBLIN(4),=C'HDR1'                                      00890
         BE    PXXX1PR
         CLC   EXTLBLIN(4),=C'EOF1'
         BE    PXXX1PR
         CLC   EXTLBLIN(4),=C'EOV1'
         BE    PXXX1PR
         B     TRYPXXX2                                                  00891
PXXX1PR  ST    R3,SAVE3REG                                               00892
         LA    R3,EXTLBLIN                                               00893
         BAL   R7,PRTXXX1     PRINT LABEL INFO                           00894
         L     R3,SAVE3REG                                               00895
         B     NOPRTEXT                                                  00896
TRYPXXX2 CLC   EXTLBLIN(4),=C'HDR2'                                      00897
         BE    PXXX2PR                                                   00898
         CLC   EXTLBLIN(4),=C'EOF2'                                      00898
         BE    PXXX2PR                                                   00898
         CLC   EXTLBLIN(4),=C'EOV2'                                      00898
         BE    PXXX2PR                                                   00898
         B     NOPRTEXT                                                  00898
PXXX2PR  ST    R3,SAVE3REG                                               00899
         LA    R3,EXTLBLIN                                               00900
         BAL   R7,PRTXXX2     PRINT LABEL INFO                           00901
         L     R3,SAVE3REG                                               00902
NOPRTEXT DS    0H             DON'T PRINT EXTERNAL LABEL ON REPORT       00903
* --------------- PRINT LABEL TO BE WRITTEN ------------------- *        00904
         MVC   OUTCCW+1(3),=AL3(EXTLBLIN)  SET UP LABEL WRITE            00905
         MVC   OUTCCW+6(2),=H'80'          LOAD LENGTH OF WRITE          00906
         MVI   OUTCCW,X'01'   SET UP OUTCCW FOR WRITE                    00907
         B     WRITE1         WRITE LABEL RECORD                         00908
FINLABEL MVC   OUTCCW+1(3),=AL3(INAREA)    SET UP DATA WRITE             00909
WRTTAPMK DS    0H                                                        00910
*** ----------------
         TM    INEODFLG,X'02'
         BZ    NOEODNOW
         TM    WRLBLFLG,X'04'
         BO    ONEFRHDR             ONLY ONE EXTRA TAPEMARK FROM ENDHDR
         TM    WRLBLFLG,X'02'       DO WE WRITE AN EXTRA TAPEMARK?
         BZ    NOEODNOW             WE'RE WRITING ANYWAY.
         NI    WRLBLFLG,FF-X'02'    TURN OFF FLAG FOR SECOND PASS
ONEFRHDR NI    WRLBLFLG,FF-X'04'    AFTER THIS, NOT COMING FROM ENDHDR
NOEODNOW DS    0H
*** ----------------
         MVI   OUTCCW,X'1F'   TAPE MARK OPCODE                           00910
         B     WRITE1         WRITE TAPE MARK                            00911
* ------------------ SPECIAL ROUTINES ------------------------------- *  00912
GETBLOKZ DS    0H             SHOULD NEVER GET HERE IF NO EXT LAB ADD    00913
         NI    WRLBLFLG,FF-X'01'  SAFETY-NEVER RETURN HERE AGAIN         00914
         B     READIN             AND GO BACK WHERE YOU STARTED          00915
* ------------------ SPECIAL ROUTINES ------------------------------- *  00916
LBLINEND DS    0H             STOP COPYING AFTER YOU RUN OUT OF LABELS   00917
         OI    WRLBLFLG,X'08'    SHOW EOF ON LABADDIN
** BELOW *** ------------------- *** FIX INCOMPLETE LABEL SET *** -- **
         TM    PARMFLG3,X'80'    IS LBLFIX IN EFFECT?
         BZ    NOFIXLBL          NO. DON'T TRY IT.
         BAL   R7,FIXEXTLB       DO FIX EXTERNAL LABEL SET PROCESSING
         TM    WRLBLFLG,X'10'    FINISHED FIXING LABELS
         BZ    NOFIXLBL          NO. KEEP CYCLING TILL DONE
         B     CLOSMALL          FINISHED, GET OUT.
NOFIXLBL DS    0H
** ABOVE *** ------------------- *** FIX INCOMPLETE LABEL SET *** -- **
         MVI   OUTCCW,X'1F'   ORDER SECOND TAPE MARK TO BE WRITTEN       00918
         B     READIN2        WRITE OUTPUTS AND FINISH                   00919
* ------------------------------------------------------------------- *  00926
*                                                                        00920
*      WE ASSUME THAT    ----ENDOFLABELTRAILER                           00921
*      WAS THE LAST RECORD IN THE LABEL FILE, AND                        00922
*      IT CAUSED ONE TAPE MARK TO HAVE BEEN WRITTEN                      00923
*      ALREADY.                                                          00924
*                                                                        00925
* ------------------ SPECIAL ROUTINES ------------------------------- *  00926
*  --- ABOVE ---  CODE TO READ IN EXTERNAL LABELS TO THE OUTPUT TAPES.   00927
         EJECT
READGO1  STH   R2,OUTCCW+6    STORE FOR WRITE                 SBG 03/00  00928
         STH   R2,OUTBYTL     STORE FOR TALLYING BYTE COUNT LATER
         ST    R7,STOR7REG                                               00929
         L     R7,BLOKCNT                                                00930
         LA    R7,1(,R7)      ADD 1 TO COUNT OF DATA BLOCKS              00931
         ST    R7,BLOKCNT                                                00932
         L     R7,STOR7REG                                               00933
* ------------  WHEN COPYING AN INITTED TAPE ----- BELOW ------  *
         TM    LBLFLAG,X'08'    WAS INITTED HDR1 SEEN?
         BZ    NOINITT1         DON'T CHANGE PROCESSING IF NOT
         OI    FLAG2A,EOV       YES. WRITE AND GET OUT OF PROGRAM.
NOINITT1 DS    0H
* ------------  WHEN COPYING AN INITTED TAPE ----- ABOVE ------  *
         B     WRITE1         CONTINUE                                   00934
*                                                             SBG 04/00  00935
*  --- BELOW ---  PROCESSING WHEN TAPE MARK WAS ENCOUNTERED   SBG 04/00  00936
READIN1  DS    0H             COME HERE IF TM WAS READ        SBG 04/00  00937
* ------------------------- ADD LABEL TO NL CODE ----------- *           00943
         TM    PARMFLG2,X'80'   ADDING EXTERNAL LABELS ?                 00939
         BZ    NONLSL1          NO.  BYPASS.                             00940
         OI    WRLBLFLG,X'01'   NEXT READ, GO ADD MORE LABELS            00941
*** ---
         TM    INEODFLG,X'02'   ARE WE PAST END OF DATA ON TAPE?
         BO    WRITE1           GO DIRECTLY TO WRITE. DO NOT PASS GO.
*                               DO NOT COLLECT 200 DOLLARS.
*** ---
NONLSL1  DS    0H                                                        00942
* ------------------------- ADD LABEL TO NL CODE ----------- *           00943
* -----------------  LABEL DUMP CODE - WHEN TO ADD CONTROL RECORDS -- *  00943
         TM    PARMFLG2,X'10'   DUMPING LABELS TO EXTERNAL FILE?         00939
         BZ    NOCNTLWR         NO.  BYPASS THIS SECTION OF CODE.        00940
         TM    EOLGFLAG,X'01'   DO WE WRITE CONTROL RECD FOR EOH?
         BO    WRCTLHDR         YES. PUT IT OUT.
         TM    EOLGFLAG,X'02'   DO WE WRITE CONTROL RECD FOR EOF?
         BO    WRCTLEOF         YES. PUT IT OUT.
         TM    EOLGFLAG,X'04'   DO WE WRITE CONTROL RECD FOR EOV?
         BO    WRCTLEOV         YES. PUT IT OUT.
         B     NOCNTLWR         NOT READY TO WRITE CNTL RECD. OUT.
WRCTLHDR DS    0H
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01821
         MVC   LLINE(80),LABELITH   MARK END OF LABEL         SBG 09/00  01822
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01823
         B     CTWRDONE         FINISHED WRITING CONTROL RECORD
WRCTLEOF DS    0H
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01862
         MVC   LLINE(80),LABELITR   MARK END OF LABEL         SBG 09/00  01863
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01864
         B     CTWRDONE         FINISHED WRITING CONTROL RECORD
WRCTLEOV DS    0H
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01918
         MVC   LLINE(80),LABELITV   MARK END OF LABEL         SBG 09/00  01919
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01920
         B     CTWRDONE         FINISHED WRITING CONTROL RECORD
CTWRDONE NI    EOLGFLAG,FF-X'07'     TURN OFF FLAGS AFTER WRITE
NOCNTLWR DS    0H
* -----------------  LABEL DUMP CODE - WHEN TO ADD CONTROL RECORDS -- *  00943
         TM    DATFLAG,X'10'  NO DATA READ YET?               SBG 03/00  00944
         BZ    READINGO       DATA WAS READ-PROCESS NORMALLY  SBG 03/00  00945
         CLC   LTMRPTI,SKIPPED   WE SKIP LEADING TAPEMARKS?   SBG 03/00  00946
         BNE   RDNOSKIP                                       SBG 03/00  00947
         MVI   LINE-1,C' '                                    SBG 03/00  00948
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 03/00  00949
         MVC   LINE(133),LTMRPT  INDICATE LEADING TM SKIPPED  SBG 03/00  00950
         PUT   SYSPRINT,LINE  WRITE MESSAGE                   SBG 03/00  00951
         B     READIN         DO ANOTHER READ                 SBG 03/00  00952
RDNOSKIP DS    0H                                             SBG 03/00  00953
         MVI   LINE-1,C' '                                    SBG 03/00  00954
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 03/00  00955
         MVC   LINE(133),LTMRPT  INDICATE LEADING TM COPIED   SBG 03/00  00956
         PUT   SYSPRINT,LINE  WRITE MESSAGE                   SBG 03/00  00957
         B     MARKFILE                                       SBG 03/00  00958
READINGO DS    0H                                             SBG 04/00  00959
         ST    R7,STOR7REG                                               00960
         L     R7,FILECNT                                                00961
         CVD   R7,DWORD       CONVERT FILE NUMBER TO DECIMAL  SBG 03/00  00962
         OI    DWORD+7,X'0F'  MAKE SIGN READABLE                         00963
         UNPK  FILEDONE+6(5),DWORD+5(3)  UNPACK FILE NUMBER              00964
         ST    R7,FILECNT                                                00965
         L     R7,BLOKCNT                                                00966
         CVD   R7,DWORD       CONVERT BLOCK COUNT TO DECIMAL             00967
         OI    DWORD+7,X'0F'  MAKE SIGN READABLE                         00968
         UNPK  FILEDONE+21(7),DWORD+4(4)  UNPACK BLOCK COUNT             00969
         MVC   BLKCNTSV,BLKCNTSV-1        INITIALIZE TO ZEROS            00970
         MVC   BLKCNTSV(7),FILEDONE+21    COPY TO SAVE AREA   SBG 09/00  00971
**** ---- BYTE COUNTS --------------------------- BELOW ---- ****
         TM    PARMFLG3,X'04'     COUNTING BYTES?
         BZ    MARKNCNT           NO-SKIP ROUTINE
         MVC   FILEBYTE,BYTESPAT  MOVE IN EDIT PATTERN
         MVC   FILECONT,=C'CONTAINING'
         L     R4,DBINH           LOAD REG WITH HI ORDER
         CVD   R4,DWORD           CONVERT HI ORDER TO PACKED
         ZAP   QWORD,DWORD        PUT IT INTO PACKED HOLD AREA
         MP    QWORD,TWO31        MULT BY 2 TO THE 31ST
         L     R4,DBINL           LOAD REG WITH LOW ORDER
         CVD   R4,DWORD           CONVERT LOW ORDER TO PACKED
         AP    QWORD,DWORD        AND ADD IT IN
         ED    FILEBYTE,QWORD+6   DISPLAY COUNT IN LINE
         B     MARKNCNE           AVOID BLANKING OUT LINE
MARKNCNT DS    0H
         MVC   FILEPBYT(44),LINE44   BLANK OUT THIS PART OF MESSAGE
MARKNCNE DS    0H
**** ---- BYTE COUNTS --------------------------- ABOVE ---- ****
         PUT   SYSPRINT,FILEDONE  WRITE IT                               00972
**** ---- BYTE COUNTS --------------------------- BELOW ---- ****
         TM    PARMFLG3,X'04'     COUNTING BYTES?
         BZ    MARKNTOT           NO-SKIP ROUTINE
         MVC   FILECONT,=C'          '
         LM    R4,R5,TOTBYTES
         A     R5,DBINL            LOW ORDER COUNT
         BNO   MARKNOVR            B IF NO OVERFLOW
         N     R5,=X'7FFFFFFF'     GET RID OF SIGN BYTE
         LA    R4,1(R4)            ADD 1 TO HIGH ORDER
MARKNOVR DS    0H
         A     R4,DBINH            HIGH ORDER
         STM   R4,R5,TOTBYTES      AND STORE THE NEW TOTAL
         SR    R4,R4          ZERO BLOCK COUNT FOR NEW FILE
         ST    R4,DBINH            ZERO BYTE COUNT
         ST    R4,DBINL            ZERO BYTE COUNT
MARKNTOT DS    0H
**** ---- BYTE COUNTS --------------------------- ABOVE ---- ****
MARKFILE DS    0H                                                        00973
         SR    R7,R7          ZERO BLOCK COUNT FOR NEW FILE              00974
         ST    R7,BLOKCNT                                                00975
         L     R7,FILECNT                                                00976
         LA    R7,1(,R7)      ADD 1 TO FILE NUMBER                       00977
         ST    R7,FILECNT                                                00978
         L     R7,STOR7REG                                               00979
         TM    DATFLAG,X'10'  STILL NO REAL DATA READ?        SBG 03/00  00980
         BO    NOLBL          YES, DON'T TEST FOR 2ND TMK     SBG 03/00  00981
*** ---  FILE LIMITING CODE ---  BELOW ---- ***
         TM    PARMFLG3,X'02'    ARE WE LIMITING INPUT FILES
         BZ    MARKFILA          NO - SKIP THIS CODE
         CLC   LTGFILE,FILECNT   IS FILECOUNT + 1 BIGGER THAN LIMIT?
         BNL   MARKFILA          NO - NO RESTRICTIONS
         OI    EOFINFLG,X'01'    YES - CONSIDER AS END OF INPUT DATA
MARKFILA DS    0H
*** ---  FILE LIMITING CODE ---  ABOVE ---- ***
*  BREAK IN HERE TO DETECT EOV AND STOP AFTER 1 TAPEMARK      SBG 04/00  00982
         TM    LBLFLAG,X'C0'  DID WE SEE AN EOV1 OR EOV2?     SBG 04/00  00983
         BZ    MARKGO         NO. TEST FOR 2ND TM             SBG 04/00  00984
         B     READIN2        YES. WRITE TO OUTPUTS & END     SBG 04/00  00985
MARKGO   CLI   OUTCCW,X'1F'   2ND TM IN A ROW?                           00997
         BE    TESTEND        YES. TEST IF RIGHT AFTER LABELS SBG 03/00  00998
NOLBL    MVI   OUTCCW,X'1F'   SET OUTPUT CCW TO WRITE TM      SBG 03/00  00999
         B     WRITE1         GO WRITE TM TO OUTPUTS                     01000
*  --- BELOW ---  CODE TO GO ON IF LABEL BEFORE 2 TAPE MARKS. SBG 03/00  01001
TESTEND  TM    LBLFLAG,X'03'  TEST FOR PREV HDR1 OR HDR2      SBG 03/00  01002
         BZ    INEODATA       NOT EITHER. END AS USUAL.       SBG 03/00  01003
TESTGOON MVI   LBLFLAG,X'00'  CLEAR LABEL FLAGS FOR NEXT READ SBG 03/00  01008
         B     NOLBL          GO ON WITHOUT SETTING EOV FLAG  SBG 03/00  01009
*  --- ABOVE ---  CODE TO GO ON IF LABEL BEFORE 2 TAPE MARKS. SBG 03/00  01013
*                                                             SBG 04/00  01014
*  --- ABOVE ---  PROCESSING WHEN TAPE MARK WAS ENCOUNTERED   SBG 04/00  01015
INEODATA DS    0H                                                        01016
         OI    INEODFLG,X'03'   INDICATE END OF DATA ON INPUT TAPE       01017
*
READIN2  DS    0H                                                        01018
*  --- BELOW ---  ARE WE WRITING EXTERNAL LABELS AND EOF ON INPUT?       01019
         TM    PARMFLG2,X'80'    WRITING NEW LABELS ON OUTPUT TAPE?      01020
         BZ    READ2GO           NO. BYPASS THIS CODE.                   01021
         TM    PARMFLG3,X'40'    NO EXTRA LABELS AFTER END OF TAPE DATA
         BO    READ2STP          YES, CUT OFF EXTRA STD LABELS
         TM    WRLBLFLG,X'04'    COMING HERE FROM ENDHEADR?
         BZ    NOEXTMK           NO
         B     WRTTAPMK
NOEXTMK  TM    INEODFLG,X'01'    DID WE GET HERE FROM 2 TMKS ?           01022
         BZ    READ2GO           NO. BYPASS REST OF CODE.                01023
         OI    WRLBLFLG,X'01'    NEXT READ WILL BE FROM LABELS.          01024
         NI    INEODFLG,FF-X'01'  ONLY COME HERE ONCE                    01025
         MVI   LBLFLAG,X'00'     DON'T CONTROL WITH INPUT TAPE LABELS
         B     READIN            DON'T WRITE FINAL TAPE MARK YET         01026
READ2STP DS    0H                                                        01027
         BAL   R7,BACKEXTH       BACKSPACE OVER EXTRA HEADERS
READ2GO  DS    0H                                                        01027
*  --- ABOVE ---  ARE WE WRITING EXTERNAL LABELS AND EOF ON INPUT?       01028
         OI    FLAG2A,EOV     INDICATE EOV ON INPUT                      01029
         B     WRITE1
         SPACE 3                                                         01030
TLITWRIT DS    0H
         TM    PARMFLG3,X'01'
         BZ    TLITWRIE
         MVC   OUTCCW+1(3),=AL3(EXTLBLIN)  SET UP LABEL WRITE            00905
         OI    WRLBLFLG,X'01'
TLITSKP1 DS    0H
         TM    INIT1FLG,X'01'          NOT FIRST PASS THRU?
         BO    TLITSKP2                GO TO SECOND PASS FOR HDR1
         OI    LBLFLAG,X'04'           SIMULATE VOL1 FROM TAPE INPUT
         NI    LBLFLAG,FF-X'03'        SIMULATE NO HDR1 OR HDR2
         OI    LBLLFLAG,X'04'          SIMULATE VOL1 FROM EXT LABELS
         NI    LBLLFLAG,FF-X'03'       SIMULATE NO HDR1 OR HDR2
         MVC   EXTLBLIN(80),VOL1LABL   STUFF THE INPUT AREA WITH VOL1
         MVC   OUTCCW+6(2),=H'80'      SET OUTPUT SIZE TO 80 BYTES
         OI    INIT1FLG,X'01'          DON'T PASS THRU HERE AGAIN
         B     WRITE1                  WRITE THIS VOL1 TO OUTPUTS
TLITSKP2 DS    0H
         OI    LBLFLAG,X'09'           SIMULATE HDR1 AND INITTED HDR1
         OI    LBLLFLAG,X'01'          SIMULATE HDR1 FROM EXT LABELS
         MVC   EXTLBLIN(80),HDR1INIT   STUFF THE INPUT AREA WITH HDR1
         MVC   OUTCCW+6(2),=H'80'      SET OUTPUT SIZE TO 80 BYTES
         OI    FLAG2A,EOV              INDICATE EOV ON INPUT             01029
         OI    INIT1FLG,X'02'          SHOW WRITE THAT I'VE BEEN HERE
         B     WRITE1                  WRITE INITTED HDR1 TO OUTPUTS
TLITWRIE DS    0H
*                                                                        01031
*  WRITE TO OUTPUT TAPES                                                 01032
*                                                                        01033
WRITE1   DS    0H                                             SBG 06/00  01034
* --- READ ONLY CODE ------------------------------- BELOW -- SBG 06/00  01035
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  01036
         BO    WRITE17    YES--NO WRITES - ONLY READS         SBG 06/00  01037
* --- READ ONLY CODE ------------------------------- ABOVE -- SBG 06/00  01038
         TM    FLAG1,OP1      IS THIS OUTPUT PRESENT?                    01039
         BZ    WRITE2         NO                                         01040
         MVC   VOLCHG(6),VOLUME1     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT1      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT1        R2=ADDRESS OF CURRENT DCB                  01058
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01059
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01060
         EXCP  OUTIOB         WRITE IT                                   01061
         WAIT  ECB=OUTECB     WAIT FOR IT                                01062
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01063
         BNE   OUTERR         NO - ERROR                                 01064
WRITE2   TM    FLAG1,OP2      IS THIS OUTPUT PRESENT?                    01065
         BZ    WRITE3         NO                                         01066
         MVC   VOLCHG(6),VOLUME2     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT2      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT2        R2=ADDRESS OF CURRENT DCB                  01084
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01085
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01086
         EXCP  OUTIOB         WRITE IT                                   01087
         WAIT  ECB=OUTECB     WAIT FOR IT                                01088
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01089
         BNE   OUTERR         NO - ERROR                                 01090
WRITE3   TM    FLAG1,OP3      IS THIS OUTPUT PRESENT?                    01091
         BZ    WRITE4         NO                                         01092
         MVC   VOLCHG(6),VOLUME3     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT3      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT3        R2=ADDRESS OF CURRENT DCB                  01110
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01111
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01112
         EXCP  OUTIOB         WRITE IT                                   01113
         WAIT  ECB=OUTECB     WAIT FOR IT                                01114
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01115
         BNE   OUTERR         NO - ERROR                                 01116
WRITE4   TM    FLAG1,OP4      IS THIS OUTPUT PRESENT?                    01117
         BZ    WRITE5         NO                                         01118
         MVC   VOLCHG(6),VOLUME4     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT4      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT4        R2=ADDRESS OF CURRENT DCB                  01136
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01137
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01138
         EXCP  OUTIOB         WRITE IT                                   01139
         WAIT  ECB=OUTECB     WAIT FOR IT                                01140
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01141
         BNE   OUTERR         NO - ERROR                                 01142
WRITE5   TM    FLAG1,OP5      IS THIS OUTPUT PRESENT?                    01143
         BZ    WRITE6         NO                                         01144
         MVC   VOLCHG(6),VOLUME5     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT5      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT5        R2=ADDRESS OF CURRENT DCB                  01162
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01163
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01164
         EXCP  OUTIOB         WRITE IT                                   01165
         WAIT  ECB=OUTECB     WAIT FOR IT                                01166
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01167
         BNE   OUTERR         NO - ERROR                                 01168
WRITE6   TM    FLAG1,OP6      IS THIS OUTPUT PRESENT?                    01169
         BZ    WRITE7         NO                                         01170
         MVC   VOLCHG(6),VOLUME6     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT6      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT6        R2=ADDRESS OF CURRENT DCB                  01188
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01189
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01190
         EXCP  OUTIOB         WRITE IT                                   01191
         WAIT  ECB=OUTECB     WAIT FOR IT                                01192
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01193
         BNE   OUTERR         NO - ERROR                                 01194
WRITE7   TM    FLAG1,OP7      IS THIS OUTPUT PRESENT?                    01195
         BZ    WRITE8         NO                                         01196
         MVC   VOLCHG(6),VOLUME7     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT7      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT7        R2=ADDRESS OF CURRENT DCB                  01214
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01215
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01216
         EXCP  OUTIOB         WRITE IT                                   01217
         WAIT  ECB=OUTECB     WAIT FOR IT                                01218
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01219
         BNE   OUTERR         NO - ERROR                                 01220
WRITE8   TM    FLAG1,OP8      IS THIS OUTPUT PRESENT?                    01221
         BZ    WRITE9         NO                                         01222
         MVC   VOLCHG(6),VOLUME8     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT8      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT8        R2=ADDRESS OF CURRENT DCB                  01240
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01241
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01242
         EXCP  OUTIOB         WRITE IT                                   01243
         WAIT  ECB=OUTECB     WAIT FOR IT                                01244
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01245
         BNE   OUTERR         NO - ERROR                                 01246
WRITE9   TM    FLAG2,OP9      IS THIS OUTPUT PRESENT?                    01247
         BZ    WRITE10        NO                                         01248
         MVC   VOLCHG(6),VOLUME9     MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT9      MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT9        R2=ADDRESS OF CURRENT DCB                  01266
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01267
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01268
         EXCP  OUTIOB         WRITE IT                                   01269
         WAIT  ECB=OUTECB     WAIT FOR IT                                01270
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01271
         BNE   OUTERR         NO - ERROR                                 01272
WRITE10  TM    FLAG2,OP10     IS THIS OUTPUT PRESENT?                    01273
         BZ    WRITE11        NO                                         01274
         MVC   VOLCHG(6),VOLUME10    MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT10     MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT10       R2=ADDRESS OF CURRENT DCB                  01292
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01293
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01294
         EXCP  OUTIOB         WRITE IT                                   01295
         WAIT  ECB=OUTECB     WAIT FOR IT                                01296
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01297
         BNE   OUTERR         NO - ERROR                                 01298
WRITE11  TM    FLAG2,OP11     IS THIS OUTPUT PRESENT?                    01299
         BZ    WRITE12        NO                                         01300
         MVC   VOLCHG(6),VOLUME11    MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT11     MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT11       R2=ADDRESS OF CURRENT DCB                  01318
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01319
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01320
         EXCP  OUTIOB         WRITE IT                                   01321
         WAIT  ECB=OUTECB     WAIT FOR IT                                01322
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01323
         BNE   OUTERR         NO - ERROR                                 01324
WRITE12  TM    FLAG2,OP12     IS THIS OUTPUT PRESENT?                    01325
         BZ    WRITE13        NO                                         01326
         MVC   VOLCHG(6),VOLUME12    MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT12     MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT12       R2=ADDRESS OF CURRENT DCB                  01344
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01345
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01346
         EXCP  OUTIOB         WRITE IT                                   01347
         WAIT  ECB=OUTECB     WAIT FOR IT                                01348
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01349
         BNE   OUTERR         NO - ERROR                                 01350
WRITE13  TM    FLAG2,OP13     IS THIS OUTPUT PRESENT?                    01351
         BZ    WRITE14        NO                                         01352
         MVC   VOLCHG(6),VOLUME13    MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT13     MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT13       R2=ADDRESS OF CURRENT DCB                  01370
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01371
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01372
         EXCP  OUTIOB         WRITE IT                                   01373
         WAIT  ECB=OUTECB     WAIT FOR IT                                01374
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01375
         BNE   OUTERR         NO - ERROR                                 01376
WRITE14  TM    FLAG2,OP14     IS THIS OUTPUT PRESENT?                    01377
         BZ    WRITE15        NO                                         01378
         MVC   VOLCHG(6),VOLUME14    MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT14     MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT14       R2=ADDRESS OF CURRENT DCB                  01396
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01397
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01398
         EXCP  OUTIOB         WRITE IT                                   01399
         WAIT  ECB=OUTECB     WAIT FOR IT                                01400
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01401
         BNE   OUTERR         NO - ERROR                                 01402
WRITE15  TM    FLAG2,OP15     IS THIS OUTPUT PRESENT?                    01403
         BZ    WRITE16        NO                                         01404
         MVC   VOLCHG(6),VOLUME15    MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT15     MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT15       R2=ADDRESS OF CURRENT DCB                  01422
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01423
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01424
         EXCP  OUTIOB         WRITE IT                                   01425
         WAIT  ECB=OUTECB     WAIT FOR IT                                01426
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01427
         BNE   OUTERR         NO - ERROR                                 01428
WRITE16  TM    FLAG2,OP16     IS THIS OUTPUT PRESENT?                    01429
         BZ    WRITE17        NO                                         01430
         MVC   VOLCHG(6),VOLUME16    MOVE IN JCL OR OUTVOLALL VOLSER
         MVC   DDOCHG(5),DDOUT16     MOVE IN OUTPUT DD NAME FOR MESSAGE
         BAL   R7,CHANGVOL           PROCESS CHANGE OF VOL1 IF ANY
         BAL   R7,CLEARIOB    CLEAR SECTIONS OF IOB BEFORE REUSE
         LA    R2,OUT16       R2=ADDRESS OF CURRENT DCB                  01448
         ST    R2,OUTDCBPT    PUT IT IN IOB                              01449
         MVI   OUTECB,X'00'   INITIALIZE ECB                             01450
         EXCP  OUTIOB         WRITE IT                                   01451
         WAIT  ECB=OUTECB     WAIT FOR IT                                01452
         CLI   OUTECB,X'7F'   WRITE COMPLETE NORMALLY?                   01453
         BNE   OUTERR         NO - ERROR                                 01454
WRITE17  DS    0H                                                        01455
         TM    LBLFLAG,X'08'  INITTED HDR1 SEEN?
         BO    ENDINPUT       YES. CLOSE.
*        TM    LBLFLAG,X'80'  EOV2 SEEN?
*        BO    ENDINPUT       YES. CLOSE.
         TM    FLAG2A,EOV     END OF INPUT?                              01455
         BO    ENDINPUT       YES - QUIT                                 01456
         B     READIN         NO - LOOP                                  01457
         SPACE 3                                                         01458
*                                                                        01459
*  ERROR ON INPUT -- TELL OPERATOR AND ABEND                             01460
*                                                                        01461
INERR    TM    INCSW+4,X'02'  UNIT CHECK?                                01462
         BZ    INERR1         NO - ASSUME DATA CHECK                     01463
         MVC   LINE(133),INEQC  SET ERROR MESSAGE                        01464
         MVC   INERR3+16(25),INEQC+12  MOVE ERROR MESSAGE TO WTOR        01465
         B     INERR2         CONTINUE                                   01466
INERR1   MVC   LINE(133),INDCK  SET ERROR MESSAGE                        01467
         MVC   INERR3+16(20),INDCK+12  MOVE ERROR MESSAGE TO WTOR        01468
INERR2   PUT   SYSPRINT,LINE  WRITE ERROR MESSAGE                        01469
         MVI   INECB,X'00'    RESET ECB                                  01470
INERR3   WTOR  '                          -- ACKNOWLEDGE',REPLY,       X 01471
               6,INECB,ROUTCDE=(3)                                       01472
         WAIT  ECB=INECB      WAIT FOR OPERATOR TO SEE THE MESSAGE       01473
*                             WHO CARES WHAT THE REPLY IS                01474
         ABEND 69             QUIT                                       01475
         SPACE 3                                                         01476
*                                                                        01477
*  ERROR ON OUTPUT -- TELL OPERATOR THEN TERMINATE THIS OUTPUT ONLY      01478
*                                                                        01479
OUTERR   NI    UNEXFLAG,FF-X'01'  CLEAR BIT ON UNIT EXCEPTION FLAG       01480
         TM    OUTCSW+4,X'02' UNIT CHECK?                                01480
         BO    OUTERUC        YES. HANDLE IT.                            01481
         TM    OUTCSW+4,X'01' UNIT EXCEPTION ON WRITE?                   01480
         BZ    OUTERR1        NO. ASSUME DATA CHECK.
         OI    UNEXFLAG,X'01'     FLAG THAT WE HAVE UNIT EXCEPTION
         MVC   LINE(133),OUTUNEX  SET UNIT EXCEPTION ERROR MESSAGE
         B     OUTERR2            GO FILL IN REST OF THE INFO
OUTERUC  MVC   LINE(133),OUTEQC  SET ERROR MESSAGE                       01482
         B     OUTERR2        CONTINUE                                   01483
OUTERR1  MVC   LINE(133),OUTDCK  SET ERROR MESSAGE                       01484
OUTERR2  LH    R4,40(,R2)     R4=TIOT OFFSET                             01485
         L     R5,16          R5=CVT                                     01486
         L     R5,0(,R5)      R5=TCB WORDS                               01487
         L     R5,4(,R5)      R5=MY TCB                                  01488
         L     R5,12(,R5)     R5=TIOT                                    01489
         AR    R4,R5          R4=TIOT ENTRY FOR THIS OUTPUT              01490
         MVC   LINE+35(5),4(R4)  MOVE DDNAME TO MESSAGE                  01491
         L     R4,16(,R4)     R4=UCB FOR THIS OUTPUT                     01492
         MVC   LINE+47(3),13(R4)  MOVE UNIT ADDRESS TO MESSAGE           01493
         MVC   LINE+59(6),36(R4)  MOVE VOLSER TO MESSAGE                 01494
         PUT   SYSPRINT,LINE  WRITE MESSAGE                              01495
         TM    UNEXFLAG,X'01'   WAS THIS A UNIT EXCEPTION ONLY
         BO    OUTERR4A         IF SO, SKIP THE WTOR BECAUSE
*                               THIS IS A SEMI-NORMAL CONDITION
*                               AND WHY INVOLVE THE OPERATOR?
         MVC   OUTERR4+16(53),LINE+12  MOVE ERROR MESSAGE TO WTOR        01496
OUTERR3  MVI   OUTECB,X'00'   RESET ECB                                  01497
OUTERR4  WTOR  '                                                       X 01498
               -- REPLY GO TO CONTINUE',REPLY,2,OUTECB,ROUTCDE=(3)       01499
         WAIT  ECB=OUTECB     WAIT FOR OPERATOR TO REPLY                 01500
         CLC   REPLY(2),=C'GO'  CORRECT REPLY?                           01501
         BNE   OUTERR3        NO - TRY AGAIN                             01502
* ------------------------------------------------------------------- *
*        REWIND BEFORE CLOSE RUINS WHATEVER OUTPUT HAS BEEN WRITTEN   *
*        ALREADY.  DON'T DO IT ON END-OF-TAPE CONDITIONS.             *
* ------------------------------------------------------------------- *
*        ST    R2,REWDCBPT    PUT DCB ADDRESS IN REWIND IOB              01503
*        EXCP  REWIOB         REWIND TAPE WITH THE ERROR                 01504
*                             DON'T BOTHER WAITING FOR REWIND            01505
* ------------------------------------------------------------------- *
OUTERR4A OI    FLAG2A,ERR     INDICATE THAT THERE WAS AN ERROR           01506
         LA    R3,OUT1        R3=DCB FOR OUTPUT 1                        01507
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01508
         BNE   OUTERR5        NO                                         01509
         NI    FLAG1,FF-OP1   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01510
         B     WRITE2         CONTINUE WITH OTHER OUTPUT                 01511
OUTERR5  LA    R3,OUT2        R3=DCB FOR OUTPUT 2                        01512
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01513
         BNE   OUTERR6        NO                                         01514
         NI    FLAG1,FF-OP2   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01515
         B     WRITE3         CONTINUE WITH OTHER OUTPUT                 01516
OUTERR6  LA    R3,OUT3        R3=DCB FOR OUTPUT 3                        01517
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01518
         BNE   OUTERR7        NO                                         01519
         NI    FLAG1,FF-OP3   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01520
         B     WRITE4         CONTINUE WITH OTHER OUTPUT                 01521
OUTERR7  LA    R3,OUT4        R3=DCB FOR OUTPUT 4                        01522
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01523
         BNE   OUTERR8        NO                                         01524
         NI    FLAG1,FF-OP4   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01525
         B     WRITE5         CONTINUE WITH OTHER OUTPUT                 01526
OUTERR8  LA    R3,OUT5        R3=DCB FOR OUTPUT 5                        01527
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01528
         BNE   OUTERR9        NO                                         01529
         NI    FLAG1,FF-OP5   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01530
         B     WRITE6         CONTINUE WITH OTHER OUTPUT                 01531
OUTERR9  LA    R3,OUT6        R3=DCB FOR OUTPUT 6                        01532
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01533
         BNE   OUTERR10       NO                                         01534
         NI    FLAG1,FF-OP6   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01535
         B     WRITE7         CONTINUE WITH OTHER OUTPUT                 01536
OUTERR10 LA    R3,OUT7        R3=DCB FOR OUTPUT 7                        01537
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01538
         BNE   OUTERR11       NO                                         01539
         NI    FLAG1,FF-OP7   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01540
         B     WRITE8         CONTINUE WITH OTHER OUTPUT                 01541
OUTERR11 LA    R3,OUT8        R3=DCB FOR OUTPUT 8                        01542
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01543
         BNE   OUTERR12       NO                                         01544
         NI    FLAG1,FF-OP8   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01545
         B     WRITE9         CONTINUE WITH OTHER OUTPUT                 01546
OUTERR12 LA    R3,OUT9        R3=DCB FOR OUTPUT 9                        01547
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01548
         BNE   OUTERR13       NO                                         01549
         NI    FLAG2,FF-OP9   SHOW THIS OUTPUT NOT PRESENT ANY MORE      01550
         B     WRITE10        CONTINUE WITH OTHER OUTPUT                 01551
OUTERR13 LA    R3,OUT10       R3=DCB FOR OUTPUT 10                       01552
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01553
         BNE   OUTERR14       NO                                         01554
         NI    FLAG2,FF-OP10  SHOW THIS OUTPUT NOT PRESENT ANY MORE      01555
         B     WRITE11        CONTINUE WITH OTHER OUTPUT                 01556
OUTERR14 LA    R3,OUT11       R3=DCB FOR OUTPUT 11                       01557
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01558
         BNE   OUTERR15       NO                                         01559
         NI    FLAG2,FF-OP11  SHOW THIS OUTPUT NOT PRESENT ANY MORE      01560
         B     WRITE12        CONTINUE WITH OTHER OUTPUT                 01561
OUTERR15 LA    R3,OUT12       R3=DCB FOR OUTPUT 12                       01562
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01563
         BNE   OUTERR16       NO                                         01564
         NI    FLAG2,FF-OP12  SHOW THIS OUTPUT NOT PRESENT ANY MORE      01565
         B     WRITE13        CONTINUE WITH OTHER OUTPUT                 01566
OUTERR16 LA    R3,OUT13       R3=DCB FOR OUTPUT 13                       01567
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01568
         BNE   OUTERR17       NO                                         01569
         NI    FLAG2,FF-OP13  SHOW THIS OUTPUT NOT PRESENT ANY MORE      01570
         B     WRITE14        CONTINUE WITH OTHER OUTPUT                 01571
OUTERR17 LA    R3,OUT14       R3=DCB FOR OUTPUT 14                       01572
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01573
         BNE   OUTERR18       NO                                         01574
         NI    FLAG2,FF-OP14  SHOW THIS OUTPUT NOT PRESENT ANY MORE      01575
         B     WRITE15        CONTINUE WITH OTHER OUTPUT                 01576
OUTERR18 LA    R3,OUT15       R3=DCB FOR OUTPUT 15                       01577
         CR    R2,R3          WAS THIS THE DCB WITH THE ERROR?           01578
         BNE   OUTERR19       NO                                         01579
         NI    FLAG2,FF-OP15  SHOW THIS OUTPUT NOT PRESENT ANY MORE      01580
         B     WRITE16        CONTINUE WITH OTHER OUTPUT                 01581
*                             THEN IT MUST BE OUTPUT 16                  01582
OUTERR19 NI    FLAG2,FF-OP16  SHOW THIS OUTPUT NOT PRESENT ANY MORE      01583
         B     WRITE17        CONTINUE WITH OTHER OUTPUT                 01584
         SPACE 3                                                         01585
*                                                                        01586
*  END OF INPUT -- FINISH UP                                             01587
*                                                                        01588
ENDINPUT DS    0H                                                        01589
         SPACE 3
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  01590
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  01591
         BZ    ENDIN0     NO. USE WRITE SUCCESS MESSAGE       SBG 06/00  01592
         MVC   LINE(133),SUCCESSR    MOVE READ-ONLY MESSAGE   SBG 06/00  01593
         B     ENDIN16          WRITE OUT MESSAGE             SBG 06/00  01594
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  01595
ENDIN0   MVC   LINE(133),SUCCESS  MOVE MESSAGE TO LINE                   01596
         TM    FLAG2,OP16     OUTPUT 16 COMPLETED?                       01597
         BO    ENDIN1         YES - CONTINUE                             01598
         MVC   LINE+126(5),LINE+131 NO - DON'T SHOW IT                   01599
ENDIN1   TM    FLAG2,OP15     OUTPUT 15 COMPLETED?                       01600
         BO    ENDIN2         YES - CONTINUE                             01601
         MVC   LINE+119(12),LINE+126  NO - DON'T SHOW IT                 01602
ENDIN2   TM    FLAG2,OP14     OUTPUT 14 COMPLETED?                       01603
         BO    ENDIN3         YES - CONTINUE                             01604
         MVC   LINE+112(19),LINE+119  NO - DON'T SHOW IT                 01605
ENDIN3   TM    FLAG2,OP13     OUTPUT 13 COMPLETED?                       01606
         BO    ENDIN4         YES - CONTINUE                             01607
         MVC   LINE+105(26),LINE+112  NO - DON'T SHOW IT                 01608
ENDIN4   TM    FLAG2,OP12     OUTPUT 12 COMPLETED?                       01609
         BO    ENDIN5         YES - CONTINUE                             01610
         MVC   LINE+98(33),LINE+105  NO - DON'T SHOW IT                  01611
ENDIN5   TM    FLAG2,OP11     OUTPUT 11 COMPLETED?                       01612
         BO    ENDIN6         YES - CONTINUE                             01613
         MVC   LINE+91(40),LINE+98  NO - DON'T SHOW IT                   01614
ENDIN6   TM    FLAG2,OP10     OUTPUT 10 COMPLETED?                       01615
         BO    ENDIN7         YES - CONTINUE                             01616
         MVC   LINE+84(47),LINE+91  NO - DON'T SHOW IT                   01617
ENDIN7   TM    FLAG2,OP9      OUTPUT 9 COMPLETED?                        01618
         BO    ENDIN8         YES - CONTINUE                             01619
         MVC   LINE+78(53),LINE+84  NO - DON'T SHOW IT                   01620
ENDIN8   TM    FLAG1,OP8      OUTPUT 8 COMPLETED?                        01621
         BO    ENDIN9         YES - CONTINUE                             01622
         MVC   LINE+72(59),LINE+78  NO - DON'T SHOW IT                   01623
ENDIN9   TM    FLAG1,OP7      OUTPUT 7 COMPLETED?                        01624
         BO    ENDIN10        YES - CONTINUE                             01625
         MVC   LINE+66(65),LINE+72  NO - DON'T SHOW IT                   01626
ENDIN10  TM    FLAG1,OP6      OUTPUT 6 COMPLETED?                        01627
         BO    ENDIN11        YES - CONTINUE                             01628
         MVC   LINE+60(71),LINE+66  NO - DON'T SHOW IT                   01629
ENDIN11  TM    FLAG1,OP5      OUTPUT 5 COMPLETED?                        01630
         BO    ENDIN12        YES - CONTINUE                             01631
         MVC   LINE+54(77),LINE+60  NO - DON'T SHOW IT                   01632
ENDIN12  TM    FLAG1,OP4      OUTPUT 4 COMPLETED?                        01633
         BO    ENDIN13        YES - CONTINUE                             01634
         MVC   LINE+48(83),LINE+54  NO - DON'T SHOW IT                   01635
ENDIN13  TM    FLAG1,OP3      OUTPUT 3 COMPLETED?                        01636
         BO    ENDIN14        YES - CONTINUE                             01637
         MVC   LINE+42(89),LINE+48  NO - DON'T SHOW IT                   01638
ENDIN14  TM    FLAG1,OP2      OUTPUT 2 COMPLETED?                        01639
         BO    ENDIN15        YES - CONTINUE                             01640
         MVC   LINE+36(95),LINE+42  NO - DON'T SHOW IT                   01641
ENDIN15  TM    FLAG1,OP1      OUTPUT 1 COMPLETED?                        01642
         BO    ENDIN16        YES - CONTINUE                             01643
         MVC   LINE+30(101),LINE+36  NO - DON'T SHOW IT                  01644
ENDIN16  PUT   SYSPRINT,LINE  WRITE IT                                   01645
         SPACE 3                                                         01646
*                                                                        01647
*  CLOSE ALL FILES                                                       01648
*                                                                        01649
CLOSMALL DS    0H
**** ---- BYTE COUNT CODE ---------------- BELOW -------- *
         TM    PARMFLG3,X'04'    COUNTING BYTES?
         BZ    ENDINTOT          NO - SKIP ROUTINE
         LM    R4,R5,TOTBYTES    GET TOTAL NUMBER OF BYTES
         CVD   R4,DWORD          HIGH ORDER WORD OF BYTE COUNT
         ZAP   QWORD,DWORD       DUMP INTO TARGET
         MP    QWORD,TWO31       MULT BY 2 TO THE 31ST
         CVD   R5,DWORD          LOW ORDER WORD
         AP    QWORD,DWORD       AND ADD IT IN
         ED    TOTBPATT,QWORD+6     MAKE NUMBER DISPLAYABLE
         PUT   SYSPRINT,TOTBLINE
         MVI   LINE,C' '
         MVC   LINE+1(L'LINE-1),LINE CLEAR LINE
ENDINTOT DS    0H                                                        01589
**** ---- BYTE COUNT CODE ---------------- ABOVE -------- *
* --------------------  REPORT THAT WE COPIED INITTED TAPES - BELOW - *
         TM    LBLFLAG,X'08'  HAVE WE COPIED AN INITTED TAPE?
         BZ    NOINITT3       NOPE. DON'T REPORT IT EITHER.
         MVI   LINE-1,C' '                                               00989
         MVC   LINE,LINE-1    CLEAR PRINT LINE                           00990
         MVC   INITSER(6),INVOLUME  MOVE IN VOLSER FROM VOL1             00991
         MVC   LINE(133),INITMSG MSG-WE'RE DOING INITTED TAPE            00992
         PUT   SYSPRINT,LINE  WRITE MESSAGE                              00993
NOINITT3 DS    0H
* --------------------  REPORT THAT WE COPIED INITTED TAPES - ABOVE - *
         TM    PARMFLG3,X'01'   INIT ONLY?
         BO    NOCLOSIN
         CLOSE (IN)                                                      01650
NOCLOSIN DS    0H
         CLOSE (SYSPRINT)                                                01650
         TM    PARMFLG2,X'10'   DO WE DUMP LABELS?            SBG 09/00  01651
         BZ    NOLBLCLS         NO. NO FILE TO CLOSE          SBG 09/00  01652
         NI    OPENDFLG,FF-X'01'  MARK FILE AS CLOSED
         CLOSE (LABLDUMP)                                                01653
NOLBLCLS DS    0H               SKIP CLOSE OF LABEL DUMP FILE            01654
         TM    PARMFLG2,X'80'   DO WE ADD LABELS?                        01651
         BZ    NOLABACL         NO. NO FILE TO CLOSE                     01652
         TM    OPENDFLG,X'04'   IS THE FILE OPEN?
         BZ    NOLABACL         NO. CANNOT CLOSE IT.
         NI    OPENDFLG,FF-X'04'  MARK FILE AS CLOSED
         CLOSE (LABADDIN)                                                01653
NOLABACL DS    0H               SKIP CLOSE OF EXTERNAL LABEL FILE        01654
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  01655
         TM    PARMFLG2,X'08'   IS THIS RUN READ-ONLY?        SBG 06/00  01656
         BO    THEEND     YES. ONLY CLOSE INPUT AND SYSPRINT. SBG 06/00  01657
* --- READ ONLY CODE ---------------------------------------- SBG 06/00  01658
         TM    FLAG3,OP1      OUTPUT 1 OPEN?                             01659
         BZ    CLOSE1         NO                                         01660
         CLOSE (OUT1)         CLOSE OUTPUT 1                             01661
CLOSE1   TM    FLAG3,OP2      OUTPUT 2 OPEN?                             01662
         BZ    CLOSE2         NO                                         01663
         CLOSE (OUT2)         CLOSE OUTPUT 2                             01664
CLOSE2   TM    FLAG3,OP3      OUTPUT 3 OPEN?                             01665
         BZ    CLOSE3         NO                                         01666
         CLOSE (OUT3)         CLOSE OUTPUT 3                             01667
CLOSE3   TM    FLAG3,OP4      OUTPUT 4 OPEN?                             01668
         BZ    CLOSE4         NO                                         01669
         CLOSE (OUT4)         CLOSE OUTPUT 4                             01670
CLOSE4   TM    FLAG3,OP5      OUTPUT 5 OPEN?                             01671
         BZ    CLOSE5         NO                                         01672
         CLOSE (OUT5)         CLOSE OUTPUT 5                             01673
CLOSE5   TM    FLAG3,OP6      OUTPUT 6 OPEN?                             01674
         BZ    CLOSE6         NO                                         01675
         CLOSE (OUT6)         CLOSE OUTPUT 6                             01676
CLOSE6   TM    FLAG3,OP7      OUTPUT 7 OPEN?                             01677
         BZ    CLOSE7         NO                                         01678
         CLOSE (OUT7)         CLOSE OUTPUT 7                             01679
CLOSE7   TM    FLAG3,OP8      OUTPUT 8 OPEN?                             01680
         BZ    CLOSE8         NO                                         01681
         CLOSE (OUT8)         CLOSE OUTPUT 8                             01682
CLOSE8   TM    FLAG4,OP9      OUTPUT 9 OPEN?                             01683
         BZ    CLOSE9         NO                                         01684
         CLOSE (OUT9)         CLOSE OUTPUT 9                             01685
CLOSE9   TM    FLAG4,OP10     OUTPUT 10 OPEN?                            01686
         BZ    CLOSE10        NO                                         01687
         CLOSE (OUT10)        CLOSE OUTPUT 10                            01688
CLOSE10  TM    FLAG4,OP11     OUTPUT 11 OPEN?                            01689
         BZ    CLOSE11        NO                                         01690
         CLOSE (OUT11)        CLOSE OUTPUT 11                            01691
CLOSE11  TM    FLAG4,OP12     OUTPUT 12 OPEN?                            01692
         BZ    CLOSE12        NO                                         01693
         CLOSE (OUT12)        CLOSE OUTPUT 12                            01694
CLOSE12  TM    FLAG4,OP13     OUTPUT 13 OPEN?                            01695
         BZ    CLOSE13        NO                                         01696
         CLOSE (OUT13)        CLOSE OUTPUT 13                            01697
CLOSE13  TM    FLAG4,OP14     OUTPUT 14 OPEN?                            01698
         BZ    CLOSE14        NO                                         01699
         CLOSE (OUT14)        CLOSE OUTPUT 14                            01700
CLOSE14  TM    FLAG4,OP15     OUTPUT 15 OPEN?                            01701
         BZ    CLOSE15        NO                                         01702
         CLOSE (OUT15)        CLOSE OUTPUT 15                            01703
CLOSE15  TM    FLAG4,OP16     OUTPUT 16 OPEN?                            01704
         BZ    THEEND         NO                                         01705
         CLOSE (OUT16)        CLOSE OUTPUT 16                            01706
         SPACE 3                                                         01707
*                                                                        01708
*  THE END                                                               01709
*                                                                        01710
THEEND   EQU   *                                                         01711
         MVC   WTOCBT+16(41),FILEDONE                                    01712
WTOCBT   WTO   'CBT990                                              '    01713
         SR    R15,R15        ZERO RETURN CODE                           01714
         TM    FLAG2A,ERR     WAS THERE AN ERROR?                        01715
         BZ    THEEND1        NO                                         01716
         LA    R15,16         SET RETURN CODE                            01717
*        TERME RMK=NO                                                    01718
THEEND1  DS    0H                                                        01719
         L     R13,4(,R13)                                               01720
         RETURN (14,12),RC=0                                             01721
         EJECT                                                           01722
* - - - - - - - -   SUBROUTINES   - - - - - - - - - - - - - - SBG 04/00  01723
*    BAL REGISTER IS R6.                                      SBG 04/00  01724
* --------------------------------------------------------- * SBG 04/00  01725
LABELCHK DS    0H         CHECK FOR PRESENCE OF TAPE LABELS   SBG 04/00  01726
*                         AND SET LABEL FLAGS, ACCORDINGLY,   SBG 04/00  01727
*                         IN THE LBLFLAG BYTE.                SBG 04/00  01728
*              X'01'    HDR1 HAS BEEN SEEN                    SBG 03/00  01729
*              X'02'    HDR2 HAS BEEN SEEN                    SBG 03/00  01730
*              X'04'    VOL1 HAS BEEN SEEN                    SBG 03/00  01731
*              X'08'    HDR1 IS FROM AN INITTED TAPE          SBG 03/00  01732
*              X'10'    EOF1 HAS BEEN SEEN                    SBG 04/00  01733
*              X'20'    EOF2 HAS BEEN SEEN                    SBG 04/00  01734
*              X'40'    EOV1 HAS BEEN SEEN                    SBG 04/00  01735
*              X'80'    EOV2 HAS BEEN SEEN                    SBG 04/00  01736
* --------------------------------------------------------- * SBG 04/00  01725
* -  CHANGED LOGIC OF LABEL DUMPING CODE FOR UHL AND UTL. - *            01725
* -                                                       - *            01725
* -   NOW:  IF YOU SEE A HDR2, FLAG IT, BUT ONLY WRITE    - *            01725
* -         THE CONTROL CARD WHEN YOU ENCOUNTER THE TAPE  - *            01725
* -         MARK THAT FOLLOWS IT.  THIS LEAVES ROOM FOR   - *            01725
* -         THE USER HEADER LABELS.  SIMILAR LOGIC WITH   - *            01725
* -         EOF2 AND EOV2.  DON'T WRITE THE CONTROL CARDS - *            01725
* -         IMMEDIATELY, BUT WAIT UNTIL THE NEXT TAPEMARK.- *            01725
* --------------------------------------------------------- *            01725
         CLC   INAREA(4),=C'VOL1'   IS THIS A VOL1 ?          SBG 04/00  01737
         BE    CVOL1                PROCESS THE VOL1          SBG 04/00  01738
         CLC   INAREA(4),=C'HDR1'   IS THIS A HDR1 ?          SBG 04/00  01739
         BE    CHDR1                PROCESS HDR1              SBG 04/00  01740
         CLC   INAREA(4),=C'HDR2'   THIS A HDR2 ?             SBG 04/00  01741
         BE    CHDR2                PROCESS HDR2              SBG 04/00  01742
         CLC   INAREA(4),=C'EOF1'   THIS AN EOF1 ?            SBG 04/00  01743
         BE    CEOF1                PROCESS EOF1              SBG 04/00  01744
         CLC   INAREA(4),=C'EOF2'   THIS AN EOF2 ?            SBG 04/00  01745
         BE    CEOF2                PROCESS EOF2              SBG 04/00  01746
         CLC   INAREA(4),=C'EOV1'   THIS AN EOV1 ?            SBG 04/00  01747
         BE    CEOV1                PROCESS EOV1              SBG 04/00  01748
         CLC   INAREA(4),=C'EOV2'   THIS AN EOV2 ?            SBG 04/00  01749
         BE    CEOV2                PROCESS EOV2              SBG 04/00  01750
         CLC   INAREA(3),=C'UHL'    THIS A USER HEADER LABEL? SBG 04/00  01749
         BE    CUHL                 PROCESS UHL               SBG 04/00  01750
         CLC   INAREA(3),=C'UTL'    THIS A USER TRAILER LABEL?    04/00  01749
         BE    CUTL                 PROCESS UTL               SBG 04/00  01750
         B     NOTLABEL       80 BYTE RECORD IS NOT IBM SL    SBG 04/00  01751
CVOL1    DS    0H    -------- PROCESS VOL1 LABEL -----------  SBG 05/00  01752
         MVC   INVOLUME(6),INAREA+4   SAVE SL VOLSER IF THERE SBG 03/00  01753
         MVC   VOLORIG(6),INAREA+4   SAVE SL VOLSER IF THERE  SBG 03/00  01754
* ---------------- LABEL ADDING CODE ---------------------- * SBG 09/00  01755
         TM    PARMFLG2,X'80'       ARE WE ADDING LABELS?                01756
         BZ    CVOLNPRB             NO. WE CAN GO ON.                    01757
         MVC   LINE(133),LINE-1   CLEAR MESSAGE LINE                     01758
         MVC   LINE(133),NOLABSL   DISPLAY NO SL ON SL MSG               01759
         PUT   SYSPRINT,LINE        WRITE MSG                            01760
         NI    OPENDFLG,FF-X'04'    MARK FILE AS CLOSED
         CLOSE (LABADDIN)                                                01761
         TM    OPENDFLG,X'02'       IS SYSIN OPEN?                       01762
         BZ    CVOL1OUT           NO. DON'T HAVE TO CLOSE IT             01763
         NI    OPENDFLG,FF-X'02'    MARK FILE AS CLOSED
         CLOSE (SYSIN)                                                   01764
CVOL1OUT B     CLOSMALL           CLOSE OTHER FILES AND SCRAM            01765
CVOLNPRB DS    0H                   NOT ADDING SL ONTO SL TAPE.          01766
* ---------------- LABEL ADDING CODE ---------------------- * SBG 09/00  01767
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01768
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  01769
         BZ    CVOL1ND              NO. SKIP PUTTING OUT      SBG 09/00  01770
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01771
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  01772
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01773
CVOL1ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  01774
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01775
         OI    LBLFLAG,X'04'  YES. FLAG VOL1 SEEN.            SBG 03/00  01776
         TM    PARMFLG2,X'02'  VOL1-FOUND OPTION OFF?         SBG 05/00  01777
         BZ    CVOL1NPR        YES.  DON'T REPORT VOL1 FOUND  SBG 05/00  01778
         MVI   LINE-1,C' '                                    SBG 03/00  01779
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 03/00  01780
         MVC   VOL1SER(6),LINE       CLEAR FIELD TO BLANKS    SBG 04/00  01781
         MVC   VOL1SER(6),INVOLUME   REPORT VOLUME SERIAL     SBG 03/00  01782
         MVC   VOL1OWNR(10),LINE     CLEAR FIELD TO BLANKS    SBG 04/00  01783
         MVC   VOL1OWNR(10),INAREA+41   OWNER INFORMATION     SBG 04/00  01784
         MVC   LINE(133),VOL1LBL  INDICATE THAT VOL1 FOUND    SBG 04/00  01785
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER       SBG 03/00  01786
CVOL1NPR OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  01787
         B     LABCHEND                                       SBG 04/00  01788
CHDR1    DS    0H                                             SBG 04/00  01789
         NI    LBLFLAG,X'0F'  TURN OFF EOV, EOF FLAGS         SBG 07/00  01790
         OI    LBLFLAG,X'01'  YES. FLAG HDR1 SEEN.            SBG 03/00  01791
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01792
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  01793
         BZ    CHDR1ND              NO. SKIP PUTTING OUT      SBG 09/00  01794
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01795
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  01796
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01797
CHDR1ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  01798
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01799
         CLC   INAREA+4(23),ZERO23   WAS TAPE JUST INITTED?   SBG 03/00  01800
         BNE   CHDR1A         NO. THIS IS A HDR1 FOR DATASET  SBG 03/00  01801
* ---------------- LABEL DUMPING CODE --------------------- *
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?
         BZ    CHDR1NDM             NO. DON'T PUT ENDOFHDR FOR INIT
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA
         MVC   LLINE(80),LABELITI   MOVE IN ENDOFHDRINIT
         PUT   LABLDUMP,LLINE       WRITE OUT ENDOFLABELHEADERINIT
CHDR1NDM DS    0H
* ---------------- LABEL DUMPING CODE --------------------- *
         OI    LBLFLAG,X'08'  YES. ZERO DSN AND VOLSER HERE   SBG 03/00  01802
         NOP   CHDR1Z         DON'T PRINT LABEL INFO          SBG 05/00  01803
CHDR1A   TM    PARMFLG1,X'02' DO WE PRINT LABELS?             SBG 05/00  01804
         BZ    CHDR1Z         NO. DON'T PRINT.                SBG 05/00  01805
         ST    R3,SAVE3REG                                               01806
         LA    R3,INAREA                                                 01807
         BAL   R7,PRTXXX1     PRINT LABEL INFO                SBG 05/00  01808
         L     R3,SAVE3REG                                               01809
CHDR1Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  01810
         B     LABCHEND                                       SBG 04/00  01811
CHDR2    DS    0H                                             SBG 04/00  01812
         NI    LBLFLAG,X'0F'  TURN OFF EOV, EOF FLAGS IF HDR2 SBG 07/00  01813
         OI    LBLFLAG,X'02'  YES. FLAG HDR2 SEEN.            SBG 03/00  01814
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01815
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  01816
         BZ    CHDR2ND              NO. SKIP PUTTING OUT      SBG 09/00  01817
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01818
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  01819
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01820
         OI    EOLGFLAG,X'01'       INDICATE HDR2 SEEN ON TAPE
CHDR2ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  01824
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01825
         TM    PARMFLG1,X'04'   DO WE PRINT LABELS?           SBG 05/00  01826
         BZ    CHDR2Z           NO.                           SBG 05/00  01827
         ST    R3,SAVE3REG                                               01828
         LA    R3,INAREA                                                 01829
         BAL   R7,PRTXXX2     PRINT LABEL INFO                           01830
         L     R3,SAVE3REG                                               01831
CHDR2Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  01832
         B     LABCHEND                                       SBG 04/00  01833
CEOF1    DS    0H                                             SBG 04/00  01834
         NI    LBLFLAG,X'F8'  TURN OFF HDR FLAGS IF EOF1      SBG 04/00  01835
         OI    LBLFLAG,X'10'  YES. FLAG EOF1 SEEN.            SBG 03/00  01836
* ------- OUTPUT TAPE BLOCK COUNT CORRECTION -------------- *            01895
BCTCEOF1 DS    0H
         TM    PARMFLG3,X'20'       IS BLK COUNT CORRECTION ON?
         BZ    BCTCEOFX             NO. BYPASS ROUTINE.
         MVC   INAREA+54(6),BLKCNTSV+1   MOVE IN CORRECTED COUNT
BCTCEOFX DS    0H
* ------- OUTPUT TAPE BLOCK COUNT CORRECTION -------------- *            01895
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01837
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  01838
         BZ    CEOF1ND              NO. SKIP PUTTING OUT      SBG 09/00  01839
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01840
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  01841
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01842
CEOF1ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  01843
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01844
         TM    PARMFLG1,X'08'   DO WE PRINT LABELS?           SBG 05/00  01845
         BZ    CEOF1Z           NO.                           SBG 05/00  01846
         ST    R3,SAVE3REG                                               01847
         LA    R3,INAREA                                                 01848
         BAL   R7,PRTXXX1     PRINT LABEL INFO                           01849
         L     R3,SAVE3REG                                               01850
CEOF1Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  01851
         B     LABCHEND                                       SBG 04/00  01852
CEOF2    DS    0H                                             SBG 04/00  01853
         NI    LBLFLAG,X'F8'  TURN OFF HDR FLAGS IF EOF2      SBG 04/00  01854
         OI    LBLFLAG,X'20'  YES. FLAG EOF2 SEEN.            SBG 03/00  01855
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01856
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  01857
         BZ    CEOF2ND              NO. SKIP PUTTING OUT      SBG 09/00  01858
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01859
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  01860
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01861
         OI    EOLGFLAG,X'02'       INDICATE EOF2 SEEN ON TAPE
CEOF2ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  01865
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01866
         TM    PARMFLG1,X'10'   DO WE PRINT LABELS?           SBG 05/00  01867
         BZ    CEOF2Z           NO.                           SBG 05/00  01868
         ST    R3,SAVE3REG                                               01869
         LA    R3,INAREA                                                 01870
         BAL   R7,PRTXXX2     PRINT LABEL INFO                           01871
         L     R3,SAVE3REG                                               01872
CEOF2Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  01873
         B     LABCHEND                                       SBG 04/00  01874
CEOV1    DS    0H                                             SBG 04/00  01875
         NI    LBLFLAG,X'F8'  TURN OFF HDR FLAGS IF EOV1      SBG 04/00  01876
         TM    PARMFLG2,X'04' CHANGE EOV TO EOF?              SBG 06/00  01877
         BZ    CEOVN1         NO, PROCESS ORDINARILY          SBG 06/00  01878
         OI    LBLFLAG,X'10'  INSTEAD, FLAG EOF1 SEEN         SBG 03/00  01879
         MVC   INAREA(3),=C'EOF'  PLUG IN FOR LABEL COPY      SBG 06/00  01880
         MVI   LINE-1,C' '                                    SBG 03/00  01881
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 03/00  01882
         MVC   LINE(133),EOVCHG   MOVE IN MESSAGE             SBG 06/00  01883
         PUT   SYSPRINT,LINE  MESSAGE THAT WE ALTERED EOV.    SBG 06/00  01884
         B     CEOVY1                                         SBG 06/00  01885
CEOVN1   OI    LBLFLAG,X'40'  YES. FLAG EOV1 SEEN.            SBG 03/00  01886
CEOVY1   DS    0H                                             SBG 09/00  01887
* ------- OUTPUT TAPE BLOCK COUNT CORRECTION -------------- *            01895
BCTCEOV1 DS    0H
         TM    PARMFLG3,X'20'       IS BLK COUNT CORRECTION ON?
         BZ    BCTCEOVX             NO. BYPASS ROUTINE.
         MVC   INAREA+54(6),BLKCNTSV+1   MOVE IN CORRECTED COUNT
BCTCEOVX DS    0H
* ------- OUTPUT TAPE BLOCK COUNT CORRECTION -------------- *            01895
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01888
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  01889
         BZ    CEOV1ND              NO. SKIP PUTTING OUT      SBG 09/00  01890
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01891
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  01892
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01893
CEOV1ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  01894
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01895
         TM    PARMFLG1,X'40'   DO WE PRINT LABELS?           SBG 05/00  01896
         BZ    CEOV1Z           NO.                           SBG 05/00  01897
         ST    R3,SAVE3REG                                               01898
         LA    R3,INAREA                                                 01899
         BAL   R7,PRTXXX1     PRINT LABEL INFO                           01900
         L     R3,SAVE3REG                                               01901
CEOV1Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  01902
         B     LABCHEND                                       SBG 04/00  01903
CEOV2    DS    0H                                             SBG 04/00  01904
         NI    LBLFLAG,X'F8'  TURN OFF HDR FLAGS IF EOV2      SBG 04/00  01905
         TM    PARMFLG2,X'04' CHANGE EOV TO EOF?              SBG 06/00  01906
         BZ    CEOVN2         NO, PROCESS ORDINARILY          SBG 06/00  01907
         OI    LBLFLAG,X'20'  INSTEAD, FLAG EOF2 SEEN         SBG 03/00  01908
         MVC   INAREA(3),=C'EOF'  PLUG IN FOR LABEL COPY      SBG 06/00  01909
         B     CEOVY2                                         SBG 06/00  01910
CEOVN2   OI    LBLFLAG,X'80'  YES. FLAG EOV2 SEEN.            SBG 03/00  01911
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01912
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?    SBG 09/00  01913
         BZ    CEOV2ND              NO. SKIP PUTTING OUT      SBG 09/00  01914
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA         SBG 09/00  01915
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO        SBG 09/00  01916
         PUT   LABLDUMP,LLINE       WRITE OUT INFO            SBG 09/00  01917
         OI    EOLGFLAG,X'04'       INDICATE EOV2 SEEN ON TAPE
CEOV2ND  DS    0H                   END OF LABEL DUMPING CODE SBG 09/00  01921
* ---------------- LABEL DUMPING CODE --------------------- * SBG 09/00  01922
CEOVY2   DS    0H                                             SBG 09/00  01923
         TM    PARMFLG1,X'80'   DO WE PRINT LABELS?           SBG 05/00  01924
         BZ    CEOV2Z           NO.                           SBG 05/00  01925
         ST    R3,SAVE3REG                                               01926
         LA    R3,INAREA                                                 01927
         BAL   R7,PRTXXX2     PRINT LABEL INFO                           01928
         L     R3,SAVE3REG                                               01929
CEOV2Z   OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL   SBG 04/00  01930
         B     LABCHEND                                       SBG 04/00  01931
*- USER LABEL HANDLING CODE  ------  BELOW  --------------- *
CUHL     DS    0H             HANDLE USER HEADER LABELS
         ST    R3,SAVE3REG
         LA    R3,INAREA
         BAL   R7,PRTUSER     PRINT LABEL INFO
         L     R3,SAVE3REG
* ---------------- LABEL DUMPING CODE --------------------- *            01912
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?               01913
         BZ    CUHLEN               NO. SKIP PUTTING OUT                 01914
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA                    01915
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO                   01916
         PUT   LABLDUMP,LLINE       WRITE OUT INFO                       01917
CUHLEN   DS    0H                   END OF LABEL DUMPING CODE            01921
* ---------------- LABEL DUMPING CODE --------------------- *            01912
         OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL
         B     LABCHEND                                                  01931
CUTL     DS    0H             HANDLE USER TRAILER LABELS
         ST    R3,SAVE3REG
         LA    R3,INAREA
         BAL   R7,PRTUSER     PRINT LABEL INFO
         L     R3,SAVE3REG
* ---------------- LABEL DUMPING CODE --------------------- *            01912
         TM    PARMFLG2,X'10'       ARE WE DUMPING LABELS?               01913
         BZ    CUTLEN               NO. SKIP PUTTING OUT                 01914
         MVC   LLINE,LLINE-1        CLEAR OUTPUT AREA                    01915
         MVC   LLINE(80),INAREA     MOVE IN LABEL INFO                   01916
         PUT   LABLDUMP,LLINE       WRITE OUT INFO                       01917
CUTLEN   DS    0H                   END OF LABEL DUMPING CODE            01921
* ---------------- LABEL DUMPING CODE --------------------- *            01912
         OI    ISLBLFLG,X'01' INDICATE WE JUST READ A LABEL
         B     LABCHEND                                                  01931
*- USER LABEL HANDLING CODE  ------  ABOVE  --------------- *
NOTLABEL NI    ISLBLFLG,FF-X'01'  TURN OFF "IS LABEL" FLAG    SBG 04/00  01932
LABCHEND BR    R6                                             SBG 04/00  01933
* --------------------------------------------------------- * SBG 04/00  01934
*    BAL REGISTER IS R6.                                      SBG 04/00  01935
* --------------------------------------------------------- * SBG 04/00  01936
PARMCHK  DS    0H         CHECK PARMS AND FLAG THEIR          SBG 04/00  01937
*                         PRESENCE OR ABSENCE.                SBG 04/00  01938
*            (PERMISSIBLE PARMS ARE CODED IN PARMTABL.)       SBG 04/00  01939
PARMINIT L     R1,0(,R1)      GET PARM FROM JCL               SBG 03/00  01940
         LH    R5,0(,R1)      SAVE PARM LENGTH                SBG 04/00  01941
         ST    R5,PARMSLEN    STORE FULLWORD VALUE            SBG 04/00  01942
         LA    R7,PARMTABL    LOAD START OF PARM TABLE        SBG 04/00  01943
         LA    R4,2(,R1)      POINT TO START OF JCL PARMS     SBG 04/00  01944
         ST    R4,PARMSTRT    PUT ADDRESS INTO PGM STORAGE    SBG 05/00  01945
         LA    R1,0           USE R1 TO MEASURE LENGTH READ   SBG 04/00  01946
* ----------------------------------------------------------- SBG 05/00  01947
*   ONE PASS THRU PARM TABLE TO SET DEFAULT ENTRIES BEFORE    SBG 05/00  01948
*   LOOKING AT JCL OVERRIDES TO THE PARMS.                    SBG 05/00  01949
* ----------------------------------------------------------- SBG 05/00  01950
PARMDFLT DS    0H             SET DEFAULTS FROM PARM TABLE    SBG 05/00  01951
         CLI   0(R7),X'FF'    END OF PARM TABLE?              SBG 04/00  01952
         BE    PARMDEND       YES. DEFAULTS SET. CHECK PARMS. SBG 04/00  01953
         TM    1(R7),X'10'    IS THIS ENTRY A DEFAULT?        SBG 05/00  01954
         BO    PARMDSET       YES, GO SET IT.                 SBG 05/00  01955
         LA    R7,PTELEN(,R7)  NO. BOP TO TEST NEXT ENTRY,    SBG 04/00  01956
         B     PARMDFLT       AND LOOP UNTIL TABLE ENDS.      SBG 05/00  01957
PARMDSET TM    1(R7),X'01'    DO WE TURN THIS FLAG OFF?       SBG 05/00  01958
         BO    PARMDOFF       YES. FLAGS ARE TURNED OFF..     SBG 05/00  01959
         OC    PARMFLGS(3),PTEFLG(R7)  NO. FLAG IS TURNED ON. SBG 05/00  01960
         LA    R7,PTELEN(,R7)  NO. BOP TO TEST NEXT ENTRY,    SBG 04/00  01961
         B     PARMDFLT       CHECK MORE TABLE ENTRIES.       SBG 05/00  01962
PARMDOFF MVC   PARMFWRK(3),PTEFLG(R7)    PARM BYTES TO WRK    SBG 05/00  01963
         XC    PARMFWRK(3),EFFS      FLIP PARM BYTES          SBG 05/00  01964
         NC    PARMFLGS(3),PARMFWRK    TURN PARM BYTE(S) OFF  SBG 05/00  01965
         LA    R7,PTELEN(,R7)  NO. BOP TO TEST NEXT ENTRY,    SBG 04/00  01966
         B     PARMDFLT   LOOP BACK TILL ONE PASS THRU TABLE  SBG 05/00  01967
PARMDEND LA    R1,0           INITIALIZE COUNTING REGISTER    SBG 05/00  01968
         LA    R7,PARMTABL    LOAD START OF PARM TABLE        SBG 04/00  01969
         L     R4,PARMSTRT    GET ADDRESS FROM PGM STORAGE    SBG 05/00  01970
* ----------------------------------------------------------- SBG 05/00  01971
*   NOW CHECK EACH CHARACTER IN JCL, TO SEE IF IT'S A PARM.   SBG 05/00  01972
* ----------------------------------------------------------- SBG 05/00  01973
PARMLOOP C     R1,PARMSLEN    PAST THE END OF PARMS?          SBG 04/00  01974
         BNL   PARMFIN        YES - GET OUT                   SBG 04/00  01975
         LA    R7,PARMTABL   POINT BACK TO BEGINNING OF TABLE SBG 05/00  01976
         AP    PARMLCNT,=P'1'  COUNT PARM LOOPS FOR DEBUGGING SBG 05/00  01977
BOPPTBL  CLI   0(R7),X'FF'    END OF PARM TABLE?              SBG 04/00  01978
         BE    PRMNFND        YES. BUMP AND TRY AGAIN.        SBG 04/00  01979
         SR    R5,R5          CLEAR WORK REGISTER FOR REUSE   SBG 05/00  01980
         IC    R5,0(,R7)      LOAD LENGTH TO BE COMPARED      SBG 04/00  01981
         BCTR  R5,0           ONE LESS FOR EXECUTE            SBG 04/00  01982
         EX    R5,CMPPARM     COMPARE TABLE ENTRY TO PARM LOC SBG 04/00  01983
         BE    PRMFOUND       PARM FOUND AT THIS LOCATION     SBG 04/00  01984
         LA    R7,PTELEN(,R7)  NEXT TABLE ENTRY               SBG 04/00  01985
         B     BOPPTBL        INNER LOOP                      SBG 04/00  01986
PRMNFND  LA    R4,1(,R4)      FORWARD IN JCL PARMS            SBG 04/00  01987
         LA    R1,1(,R1)      MEASURE DISTANCE TRAVELED       SBG 04/00  01988
         B     PARMLOOP       TRY AGAIN                       SBG 04/00  01989
PRMFOUND MVC   PARMTENT(PTELEN),0(R7)  DUMP TABLE ENTRY FOUND SBG 05/00  01990
         TM    1(R7),X'01'         PARM ON OR OFF?            SBG 05/00  01991
         BO    PARMOFF             OFF                        SBG 05/00  01992
         OC    PARMFLGS(3),PTEFLG(R7)  ON.FLAG THE PARM FOUND SBG 05/00  01993
         B     PARMGO              AND GO ON                  SBG 05/00  01994
PARMOFF  MVC   PARMFWRK(3),PTEFLG(R7)    PARM BYTES TO WRK    SBG 05/00  01995
         XC    PARMFWRK(3),EFFS      FLIP PARM BITS           SBG 05/00  01996
         NC    PARMFLGS(3),PARMFWRK    TURN PARM BIT(S) OFF   SBG 05/00  01997
PARMGO   AP    PARMHITS,=P'1'    COUNT PARM HITS              SBG 05/00  01998
         IC    R5,0(,R7)      LENGTH OF PARM, FROM THE TABLE  SBG 04/00  01999
         LA    R1,0(R5,R1)    INCREMENT COUNT BY LENGTH       SBG 04/00  02000
         LA    R4,0(R5,R4)    SAME FOR SEARCH POSITION        SBG 04/00  02001
         B     PARMLOOP       LOOK FOR MORE PARMS             SBG 04/00  02002
PARMFIN  ST    R1,PRMCHRCT    HOW MANY CHARS WE SEARCHED --   SBG 04/00  02003
*                             COUNT FOR DEBUGGING             SBG 05/00  02004
PRMCHEND BR    R6                                             SBG 04/00  02005
CMPPARM  CLC   0(0,R4),2(R7)    ** EXECUTED **                SBG 04/00  02006
* --------------------------------------------------------- * SBG 05/00  02007
*    BAL REGISTER IS R6.                                      SBG 05/00  02008
* --------------------------------------------------------- * SBG 05/00  02009
CARDREAD DS    0H              CHECK SYSIN FOR KEYWORDS AND PARMS        02010
         GET   SYSIN,CARDIN                                              02011
         CLC   =C'OUTVOLALL=',CARDIN    KEYWORD PRESENT IN THIS CARD?    02012
         BE    CDOVOLAL          PROCESS THIS CARD FOR KEYWORD           02013
         CLC   =C'TAPEOWNER=',CARDIN    KEYWORD PRESENT IN THIS CARD?    02012
         BE    TPOWNRAL          PROCESS THIS CARD FOR KEYWORD           02013
         CLC   =C'FILELIMIT=',CARDIN    KEYWORD PRESENT IN THIS CARD?    02012
         BE    FILELGET          PROCESS THIS CARD FOR KEYWORD           02013
* ----                                                                   02014
CHKPARMS DS    0H                CHECK THIS CARD AGAINST PARMTABL        02015
         ST    R6,SAVE6REG     SAVE BAL REGISTER                         02016
         LA    R4,CARDIN       POINT PARM SEARCH TO BEGINNING OF CARD    02017
         LA    R5,72           LOAD COLUMN LENGTH FOR SEARCH             02018
         ST    R5,PARMSLEN     LOAD LENGTH INTO FIELD FOR ROUTINE        02019
         LA    R7,PARMTABL     POINT R7 TO PARM TABLE                    02020
         L     R1,TOTCHRCT                                               02021
         A     R1,PRMCHRCT                                               02022
         ST    R1,TOTCHRCT                                               02023
         LA    R1,0            START SEARCH COUNT AT ZERO AGAIN          02024
         AP    TOTMHITS,PARMHITS                                         02025
         ZAP   PARMHITS,=P'0'                                            02026
         AP    TOTMLCNT,PARMLCNT                                         02027
         ZAP   PARMLCNT,=P'0'                                            02028
         BAL   R6,PARMLOOP     CHECK THIS CARD FOR PARMS                 02029
         L     R6,SAVE6REG     RESTORE BAL REGISTER                      02030
         B     CARDREAD        GET ANOTHER CARD                          02031
* ----                                                                   02032
CDOVOLAL CLI   CARDIN+10,C' '    IS FIRST VOLSER CHARACTER BLANK?        02033
         BE    CARDREAD                 YES. IGNORE CARD                 02034
         MVC   VOLSTG(6),CARDIN+10                                       02035
         OI    PARMFLG2,X'40'    SET OUTVOL FLAG ON
         OI    OVERFLAG,X'01'    HOLD ORDER TO PROPAGATE OUTPUT VOLSER   02036
         B     CARDREAD          GET ANOTHER CARD                        02037
TPOWNRAL CLI   CARDIN+10,C' '    IS FIRST OWNER  CHARACTER BLANK?        02033
         BE    CARDREAD                 YES. IGNORE CARD                 02034
         MVC   TAPEOWNR(10),CARDIN+10
         OI    PARMFLG2,X'40'    SET OUTVOL FLAG ON
         B     CARDREAD
FILELGET DS    0H
         CLI   CARDIN+10,C' '    IS FIRST NUMBER VALUE BLANK?
         BE    CARDREAD          YES. IGNORE ENTIRE CARD
         CLI   CARDIN+10,X'F0'   SMALLER THAN ZERO?
         BL    CARDREAD          YES. IGNORE.
         CLI   CARDIN+10,X'F9'   BIGGER THAN 9?
         BH    CARDREAD          YES. IGNORE.
         OI    PARMFLG3,X'02'    SET FILE LIMIT OPTION ON
         LA    R15,CARDIN+10     STARTING ADDRESS
         LR    R1,R15            LOAD R1 WITH THIS ADDRESS
FILELNUM DS    0H
         LA    R15,1(,R15)       BUMP TO NEXT CHARACTER
         C     R15,=A(CARDIN+71) END OF CARD?
         BH    FILELGNM          YES, GET NUMBER
         CLI   0(R15),C' '       BLANK HERE?
         BE    FILELGNM          YES, GET NUMBER
         B     FILELNUM          NO. STEP UP ONE PLACE
FILELGNM DS    0H
         SR    R15,R1            HOW BIG IS THE NUMBER
         BCTR  R15,0             LOWER IT FOR EXECUTE
         EX    R15,PACK          COPY THE NUMBER TO WORK AREA
         EX    R15,MVLIMNUM      COPY THE NUMBER TO MESSAGE AREA
         CVB   R0,WORKA          CONVERT IT TO BINARY
         ST    R0,LINFILE        STORE THE VALUE FOR LATER USE
         MP    WORKA,PL4NO3      MULTIPLY BY 3 IF SL FILES
         CVB   R0,WORKA          CONVERT IT TO BINARY
         ST    R0,LSLFILE        STORE THE VALUE FOR LATER USE
         MVC   LTGFILE(4),LINFILE   STUFF NL VALUE IN FOR STARTERS
FILELCLG DS    0H
         B     CARDREAD
SYSINEND DS    0H                                                        02038
         TM    OPENDFLG,X'02'   IS SYSIN    DD OPEN?                     02039
         BZ    CARDREND         NO.  GET OUT.                            02040
         NI    OPENDFLG,FF-X'02'   MARK SYSIN FILE AS CLOSED
         CLOSE (SYSIN)                                                   02041
CARDREND BR    R6                                                        02042
PACK     PACK  WORKA,0(0,1)          <<< EXECUTED >>>
MVLIMNUM MVC   LIMFMSG+11(0),0(R1)   <<< EXECUTED >>>
* --------------------------------------------------------- * SBG 05/00  02043
*    BAL REGISTER IS R7.                                      SBG 05/00  02044
* --------------------------------------------------------- * SBG 05/00  02045
VOL1PRT  DS    0H         PRINT MESSAGE THAT VOL1 LABEL WAS   SBG 04/00  02046
*                         ALTERED.                                       02047
         MVI   LINE-1,C' '                                               02048
         MVC   LINE,LINE-1           CLEAR OUTPUT LINE                   02049
         MVC   VOLALT+13(6),LINE     CLEAR OLDVOL FIELD IN MSG           02050
         MVC   VOLALT+35(6),LINE     CLEAR NEWVOL FIELD IN MSG           02051
         MVC   VOLALT+13(6),VOLORIG  MOVE OLD VOL TO MSG                 02052
         MVC   VOLALT+35(6),VOLNEW   MOVE NEW VOL TO MSG                 02053
* ----                                                                   02054
         TM    OVERFLAG,X'01'     ARE WE OVERLAYING ALL OUTPUT VOLSERS?  02055
         BZ    INDVVOLS           NO. REPORT INDIVIDUAL VOLS             02056
         MVC   VOLALT+35(6),VOLSTG   MOVE NEW VOLSER VALUE TO MSG        02057
INDVVOLS DS    0H                                                        02058
* ----                                                                   02059
         MVC   VOLDDN(5),LINE        CLEAR FIELD                         02060
         MVC   VOLDDN(5),VOLDD       MOVE DD NAME IN                     02061
         MVC   LINE(133),VOLALT      MOVE MESSAGE TO PRT                 02062
         PUT   SYSPRINT,LINE         WRITE MESSAGE                       02063
         BR    R7                    RETURN TO CALLER                    02064
* --------------------------------------------------------- * SBG 04/00  02065
*    BAL REGISTER IS R7.                                      SBG 04/00  02066
* --------------------------------------------------------- * SBG 04/00  02067
PRTXXX1  DS    0H                                             SBG 05/00  02068
*   R3 POINTS TO THE LABEL IMAGE TO BE PRINTED.                          02069
         MVI   LINE-1,C' '                                    SBG 05/00  02070
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 05/00  02071
         MVC   XXX1LBL+1(4),0(R3)   MOVE LABEL TYPE TO MESSAG SBG 05/00  02072
         MVC   XXX1VOL(6),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02073
         MVC   XXX1VOL(6),21(R3)     REPORT VOLUME SERIAL     SBG 05/00  02074
         MVC   XXX1DSN(17),LINE      CLEAR FIELD TO BLANKS    SBG 05/00  02075
         MVC   XXX1DSN(17),4(R3)     DATASET NAME             SBG 05/00  02076
         MVC   XXX1DSQ(4),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02077
         MVC   XXX1DSQ(4),31(R3)     DATASET SEQUENCE NUMBER  SBG 05/00  02078
         MVC   XXX1VSQ(4),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02079
         MVC   XXX1VSQ(4),27(R3)     VOLUME SEQUENCE NUMBER   SBG 05/00  02080
         MVC   XXX1BLC(6),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02081
         MVC   XXX1BLC(6),54(R3)     BLOCK COUNT - 6 DIGITS   SBG 05/00  02082
         MVC   XXX1CRD(6),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02083
         MVC   XXX1CRD(6),41(R3)     CREATE DATE - 6 DIGITS   SBG 05/00  02084
         MVC   XXX1EXD(6),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02085
         MVC   XXX1EXD(6),47(R3)     EXPIRE DATE - 6 DIGITS   SBG 05/00  02086
         MVC   LINE(133),XXX1LBL  MOVE INFO TO PRINT LINE     SBG 05/00  02087
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER       SBG 05/00  02088
PRTXXX1R BR    R7                                             SBG 05/00  02089
* --------------------------------------------------------- * SBG 04/00  02090
*    BAL REGISTER IS R7.                                      SBG 04/00  02091
* --------------------------------------------------------- * SBG 04/00  02092
PRTXXX2  DS    0H                                             SBG 05/00  02093
*   R3 POINTS TO THE LABEL IMAGE TO BE PRINTED.                          02094
         MVI   LINE-1,C' '                                    SBG 05/00  02095
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 05/00  02096
         MVC   XXX2LBL+1(4),0(R3)   MOVE LABEL TYPE TO MESSAG SBG 05/00  02097
         MVC   XXX2RFM(1),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02098
         MVC   XXX2RFM(1),4(R3)      RECFM                    SBG 05/00  02099
         MVC   XXX2BKL(5),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02100
         MVC   XXX2BKL(5),5(R3)      BLOCK LENGTH             SBG 05/00  02101
         MVC   XXX2RCL(5),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02102
         MVC   XXX2RCL(5),10(R3)     RECORD LENGTH            SBG 05/00  02103
         MVC   XXX2TDN(1),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02104
         MVC   XXX2TDN(1),15(R3)     TAPE DENSITY             SBG 05/00  02105
         MVC   XXX2JST(17),LINE      CLEAR FIELD TO BLANKS    SBG 05/00  02106
         MVC   XXX2JST(17),17(R3)     JOB/STEP NAME           SBG 05/00  02107
         MVC   XXX2IDR(3),LINE       CLEAR FIELD TO BLANKS    SBG 05/00  02108
         CLI   34(R3),C'P'           INDICATE IDRC?           SBG 05/00  02109
         BNE   PRX2NOI               NO. SAY NO               SBG 05/00  02110
         MVC   XXX2IDR(3),=C'YES'     IDRC COMPRESSION        SBG 05/00  02111
         B     PRX2MOV                                        SBG 04/00  02112
PRX2NOI  MVC   XXX2IDR(3),=C'NO '                             SBG 04/00  02113
PRX2MOV  MVC   LINE(133),XXX2LBL  MOVE INFO TO PRINT LINE     SBG 05/00  02114
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER       SBG 05/00  02115
PRTXXX2R BR    R7                                             SBG 05/00  02116
* --------------------------------------------------------- * SBG 04/00  02090
*    BAL REGISTER IS R7.                                      SBG 04/00  02091
* --------------------------------------------------------- * SBG 04/00  02092
PRTUSER  DS    0H                                             SBG 05/00  02093
*   R3 POINTS TO THE LABEL IMAGE TO BE PRINTED.                          02069
         MVI   LINE-1,C' '                                    SBG 05/00  02070
         MVC   LINE,LINE-1    CLEAR PRINT LINE                SBG 05/00  02071
         MVI   USERLBL-1,C' '
         MVC   USERLBL(133),USERLBL-1
         MVC   USERLBL+1(80),0(R3)  MOVE LABEL IMAGE TO MESSAGE          02097
         MVC   LINE(133),USERLBL  MOVE INFO TO PRINT LINE
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER
PRTUSERR BR    R7                                                        02116
* --------------------------------------------------------- *            02090
*    BAL REGISTER IS R7.                                                 02091
* --------------------------------------------------------- *            02092
PRTBLCNT DS    0H                                                        02093
         MVI   LINE-1,C' '                                               02070
         MVC   LINE,LINE-1    CLEAR PRINT LINE                           02071
         MVC   LINE(133),BLKCNTMS    MESSAGE TO PRINT LINE
         PUT   SYSPRINT,LINE  WRITE MESSAGE WITH VOLSER
PRTBLCNE BR    R7                                                        02116
* --------------------------------------------------------- *            02090
*    BAL REGISTER IS R7.                                                 02091
* --------------------------------------------------------- *            02092
BACKEXTH DS    0H             BACKSPACE OVER EXTRA HEADER LABELS         02093
         ST    R7,SAVE7REG                                               02070
         TM    WRLBLFLG,X'08'     EOF ON LABADDIN FILE?
         BO    BACKEXT1           DON'T BACKSPACE OVER LAST LABEL SET
         MVC   OUTCCWPT(4),=A(BACKCCW)
BACKEXT1 L     R7,SAVE7REG                                               02070
BACKEXTE BR    R7                                                        02116
* --------------------------------------------------------- *            02090
*    BAL REGISTER IS R7.                                                 02091
* --------------------------------------------------------- *            02092
CLEARSAV DS    0H             CLEAR HDR1, HDR2, AND UHL SAVE AREAS       02093
         ST    R7,SAVE7REG                                               02070
         TM    PARMFLG3,X'80'           IS LBLFIX OPTION ACTIVE?
         BZ    CLEARSV1                 NO. BYPASS CLEAR
         MVI   HDR1SAV-1,C' '           PRIME WITH BLANK
         MVC   HDR1SAV(240),HDR1SAV-1     CLEAR
         MVC   UHL2SAV(240),UHL2SAV-1       HEADER
         MVC   UHL5SAV(240),UHL5SAV-1         SAVE
         MVC   UHL8SAV(80),UHL8SAV-1            AREAS
CLEARSV1 L     R7,SAVE7REG                                               02070
CLEARSVE BR    R7                                                        02116
* --------------------------------------------------------- *            02090
*    BAL REGISTER IS R7.                                                 02091
* --------------------------------------------------------- *            02092
FIXEXTLB DS    0H             FIX AFTER BROKEN EXTERNAL LABEL FILE       02093
         ST    R7,SAVE7REG                                               02070
         TM    PARMFLG3,X'80'           IS LBLFIX OPTION ACTIVE?
         BZ    FIXEXTL1         NO. BYPASS LABEL FIX OPERATION
* ------   DETERMINE HOW BROKEN THE LABEL FILE IS   ------ BELOW --- *
         TM    LBLLFLAG,X'03'   DO WE HAVE AT LEAST HDR1 & HDR2
         BNO   FIXEXTL1         NOT THAT MUCH. DON'T ATTEMPT TO FIX
         TM    LBLLFLAG,X'70'   MISSING EOLHDR, EOF1 AND EOF2?
         BZ    FIXALL3
         TM    LBLLFLAG,X'30'   MISSING EOF1 AND EOF2 ONLY?
         BZ    FIXLAST2
         TM    LBLLFLAG,X'20'   MISSING ONLY EOF2?
         BZ    FIXLAST1
         B     FIXEXTL1         MISSING EOLTRLR DOESN'T GIVE ERROR
* ------   DETERMINE HOW BROKEN THE LABEL FILE IS   ------ ABOVE --- *
FIXALL3  DS    0H            REPLACE EOLHDR, EOF1, AND EOF2
         L     R7,SAVE7REG
         B     ENDHEADR      GO TO ENDHEADR PROCESSING AND THROW FLAG
FIXLAST2 DS    0H               REPLACE EOF1 AND EOF2
         OI    LBLLFLAG,X'10'   MARK EOF1 SEEN
         L     R7,SAVE7REG
         B     CORFEOF1         CREATE EOF1,FIX BLOCK COUNTS,AND WRITE
FIXLAST1 DS    0H               REPLACE EOF2
         OI    LBLLFLAG,X'20'   MARK EOF2 SEEN
         L     R7,SAVE7REG
         B     ADDEOF2          CREATE THE EOF2
FIXEXTL1 DS    0H                                                        02070
         OI    WRLBLFLG,X'10'   STOP WRITING LABELS
         L     R7,SAVE7REG                                               02070
FIXEXTLE BR    R7                                                        02116
* --------------------------------------------------------- *            02090
*    BAL REGISTER IS R7.                                                 02091
* --------------------------------------------------------- *            02092
CLEARIOB DS    0H             CLEAR THE PORTIONS OF THE OUTIOB THAT      02093
*                             IOS USES DURING EXCP PROCESSING.
*                        WE DO NOT WANT TO BLINDLY REUSE THESE IOB'S.
* ------------------------------------------------------------------- *
         MVC   OUTIOB(4),IOB01
         MVC   OUTCSW(8),FUL2ZERO
         MVC   OUTDCBPT(4),FUL2ZERO
         MVC   OUTDCBPT+4(4),FUL2ZERO
         MVC   OUTDCBPT+8(4),IOB02
CLEARIOE BR    R7
* --------------------------------------------------------- *
*    BAL REGISTER IS R7.
* --------------------------------------------------------- *
CHANGVOL DS    0H             PROCESS CHANGE VOLUME INFO FOR VOL1 LABEL
* ----------------------------------  PROCESS CHGVOL KEYWORD  SBG 05/00  01041
         TM    WRLBLFLG,X'01'  ARE WE PROCESSING EXTERNAL LABELS NOW?
         BO    CHEXTLAB        YES. JUST DO THAT STUFF.
         TM    LBLFLAG,X'04'  ARE WE WRITING A VOL1 LABEL?    SBG 05/00  01042
         BZ    CHANGVOE       NO, GET OUT OF THIS ROUTINE                01043
         TM    LBLFLAG,X'03'  IS THIS A HDR1 OR A HDR2?
         BNZ   CHANGVOE       NO. DON'T ATTEMPT TO CHANGE THIS.
         TM    PARMFLG2,X'41' ARE WE CHANGING OUTPUT VOLSERS? SBG 05/00  01044
         BZ    CHANGVOE       NO, GET OUT OF THIS ROUTINE                01045
         MVC   INAREA+4(6),VOLCHG   PUT JCL VOLSER                       01046
         TM    PARMFLG2,X'40'  IS OUTVOL PARM IN EFFECT
         BZ    CHNOTOWN        NO. DON'T CHANGE OWNER INFORMATION
         CLI   TAPEOWNR,C' '  IS THERE A TAPEOWNER VALUE
         BE    CHNOTOWN       NO--DON'T CHANGE OWNER INFORMATION THERE
         MVC   INAREA+41(10),TAPEOWNR    MOVE TAPE OWNER INFO IF ANY
         MVC   LINE(133),LINE-1
         MVC   OWNRTID(10),LINE          CLEAR FIELD
         MVC   OWNRTID(10),TAPEOWNR      MOVE OWNER INFO INTO MSG
         MVC   OWNRDDO(5),LINE           CLEAR FIELD
         MVC   OWNRDDO(5),DDOCHG         MOVE OUTPUT DDNAME INTO MSG
         MVC   LINE(133),OWNRMSG
         PUT   SYSPRINT,LINE
CHNOTOWN DS    0H
         B     CHNOZAPV       TAPE INPUT - DON'T DO EXTERNAL LABELS
*** ---  BELOW  --------  CHANGING VOLSER IN EXTERNAL LABELS             01047
CHEXTLAB DS    0H
         TM    WRLBLFLG,X'01'      IS INPUT FROM EXTERNAL LABELS?        01048
         BZ    CHNOZAPV            NO. DON'T AFFECT EXTLBLIN             01049
         TM    INIT1FLG,X'02'      SECOND PASS THRU TAPE INIT?
         BO    CHNOZAPV            YES, SKIP SECOND WRITE
         TM    LBLLFLAG,X'04'      VOL1 SEEN RECENTLY?
         BZ    CHNOZAPV            NO. DON'T CHANGE CARD                 01049
         TM    LBLLFLAG,X'03'      IS THIS A HDR1 OR HDR2?
         BNZ   CHNOZAPV            YES. ONLY CHANGE VOL1 CARD.           01049
         TM    PARMFLG2,X'41'      ARE WE CHANGING OUTPUT VOLSERS?
         BZ    CHNOZAPV            NO. BYPASS.
         MVC   EXTLBLIN+4(6),VOLCHG       VOL1 IS FROM EXTERNAL LABEL    01050
         TM    PARMFLG2,X'40'  IS OUTVOL PARM IN EFFECT
         BZ    CHNOZAPV        NO. DON'T CHANGE OWNER INFORMATION
         CLI   TAPEOWNR,C' '       IS THERE ANY CHANGE IN TAPEOWNR?
         BE    CHNOZAPV            NO INFO-THEREFORE NO CHANGE
         MVC   EXTLBLIN+41(10),TAPEOWNR   CHANGE TAPE OWNER TOO          01050
         MVC   LINE(133),LINE-1
         MVC   OWNRTID(10),LINE          CLEAR FIELD
         MVC   OWNRTID(10),TAPEOWNR      MOVE OWNER INFO INTO MSG
         MVC   OWNRDDO(5),LINE           CLEAR FIELD
         MVC   OWNRDDO(5),DDOCHG         MOVE OUTPUT DDNAME INTO MSG
         MVC   LINE(133),OWNRMSG
         PUT   SYSPRINT,LINE                                             01051
CHNOZAPV DS    0H
*** ---  ABOVE  --------  CHANGING VOLSER IN EXTERNAL LABELS             01052
         TM    INIT1FLG,X'02'      SECOND PASS THRU TAPE INIT?
         BO    CHGWRIT             YES, SKIP SECOND WRITE
         TM    LBLFLAG,X'04'       VOL1 FROM TAPE COPY HERE?
         BO    CHGPRINT            YES, PRINT.
         TM    LBLLFLAG,X'04'      VOL1 FROM EXTERNAL LABELS HERE?
         BO    CHGPRINT            YES, PRINT
         B     CHGWRIT
CHGPRINT DS    0H
         TM    LBLFLAG,X'33'       HEADERS OR TRAILERS?
         BNZ   CHGWRIT             ANY OF ABOVE - DON'T PRINT MSG
         TM    LBLLFLAG,X'33'      HEADERS OR TRAILERS IN EXTERNAL LBL
         BNZ   CHGWRIT             ANY OF ABOVE - DON'T PRINT MSG
         MVC   VOLNEW(6),VOLCHG    MOVE VOLUME NAME IN                   01053
         MVC   VOLDD(5),DDOCHG     MOVE THIS OUTPUT DDNAME IN            01054
         ST    R7,SAVE7RG1
         BAL   R7,VOL1PRT   PRINT MESSAGE THAT VOLSER CHANGED SBG 05/00  01055
         L     R7,SAVE7RG1
CHGWRIT  DS    0H                                             SBG 05/00  01056
* ----------------------------------  PROCESS CHGVOL KEYWORD  SBG 05/00  01057
CHANGVOE BR    R7                  END OF ROUTINE - RETURN
         SPACE 3
* --------------------------------------------------------- *
*    BAL REGISTER IS R7.
* --------------------------------------------------------- *
*   R2 HAS TO POINT TO THE BYTE COUNT FOR THE LAST READ
*   R3 HAS TO POINT TO THE DOUBLEWORD COUNTER TO BE INCREMENTED
ADDCOUNT DS    0H                  ADD BYTE COUNT SUBROUTINE
         L     R4,0(,R3)           LOAD HIGH ORDER COUNTER
         L     R5,4(,R3)           LOAD LOW  ORDER COUNTER
         AR    R5,R2               ADD TO BYTE COUNT
         BNO   ADDCNOOV            NO OVERFLOW, THEN BRANCH
         LA    R4,1(,R4)           ELSE, OVERFLOW TO HIGH WORD
         X     R5,=X'7FFFFFFF'     GET RID OF SIGN BIT
ADDCNOOV DS    0H
         ST    R4,0(,R3)           PUT UPDATED COUNTER IN STORAGE
         ST    R5,4(,R3)           PUT UPDATED COUNTER IN STORAGE
ADDCOUNE BR    R7                  END OF ROUTINE - RETURN
         SPACE 3
* - - - - - - END - SUBROUTINES   - - - - - - - - - - - - - - SBG 04/00  02117
         EJECT
* - - - - - - C O N S T A N T S   - - - - - - - - - - - - - - - - - - *
FUL2ZERO DC    2F'0'
IOB01    DC    X'02000000'
IOB02    DC    X'00010000'
PL4NO3   DC    PL4'3'
DBINF    DS    0D             BYTE COUNT SAVE AREA FOR INPUT FILE
DBINFH   DC    F'0'
DBINFL   DC    F'0'
DBIN     DS    0D             BYTE COUNT SAVE AREA FOR INPUT TOTAL
DBINH    DC    F'0'
DBINL    DC    F'0'
DBOUT1   DS    0D             BYTE COUNT SAVE AREA FOR OUT1
DBOUT1H  DC    F'0'
DBOUT1L  DC    F'0'
DBOUT2   DS    0D             BYTE COUNT SAVE AREA FOR OUT2
DBOUT2H  DC    F'0'
DBOUT2L  DC    F'0'
DBOUT3   DS    0D             BYTE COUNT SAVE AREA FOR OUT3
DBOUT3H  DC    F'0'
DBOUT3L  DC    F'0'
DBOUT4   DS    0D             BYTE COUNT SAVE AREA FOR OUT4
DBOUT4H  DC    F'0'
DBOUT4L  DC    F'0'
DBOUT5   DS    0D             BYTE COUNT SAVE AREA FOR OUT5
DBOUT5H  DC    F'0'
DBOUT5L  DC    F'0'
DBOUT6   DS    0D             BYTE COUNT SAVE AREA FOR OUT6
DBOUT6H  DC    F'0'
DBOUT6L  DC    F'0'
DBOUT7   DS    0D             BYTE COUNT SAVE AREA FOR OUT7
DBOUT7H  DC    F'0'
DBOUT7L  DC    F'0'
DBOUT8   DS    0D             BYTE COUNT SAVE AREA FOR OUT8
DBOUT8H  DC    F'0'
DBOUT8L  DC    F'0'
DBOUT9   DS    0D             BYTE COUNT SAVE AREA FOR OUT9
DBOUT9H  DC    F'0'
DBOUT9L  DC    F'0'
DBOUT10  DS    0D             BYTE COUNT SAVE AREA FOR OUT10
DBOUT10H DC    F'0'
DBOUT10L DC    F'0'
DBOUT11  DS    0D             BYTE COUNT SAVE AREA FOR OUT11
DBOUT11H DC    F'0'
DBOUT11L DC    F'0'
DBOUT12  DS    0D             BYTE COUNT SAVE AREA FOR OUT12
DBOUT12H DC    F'0'
DBOUT12L DC    F'0'
DBOUT13  DS    0D             BYTE COUNT SAVE AREA FOR OUT13
DBOUT13H DC    F'0'
DBOUT13L DC    F'0'
DBOUT14  DS    0D             BYTE COUNT SAVE AREA FOR OUT14
DBOUT14H DC    F'0'
DBOUT14L DC    F'0'
DBOUT15  DS    0D             BYTE COUNT SAVE AREA FOR OUT15
DBOUT15H DC    F'0'
DBOUT15L DC    F'0'
DBOUT16  DS    0D             BYTE COUNT SAVE AREA FOR OUT16
DBOUT16H DC    F'0'
DBOUT16L DC    F'0'
WORKA    DC    D'0'
SAV01MLT DC    D'0'
LINFILE  DC    F'0'           RAW FILE LIMIT VALUE - SAME FOR NL
LSLFILE  DC    F'0'           SL  FILE LIMIT VALUE - 3X NL VALUE
LTGFILE  DC    F'0'           TARGET NUMBER FOR FILE LIMIT VALUE
BLOKCNT  DC    F'0'                                                      02118
FILECNT  DC    F'1'                                                      02119
EOFINFLG DC    X'00'          END OF INPUT TAPE FILES WITH LIMFILE
EXEOFLAG DC    X'00'          EXTRA EOFS WITH LABADDIN AND FILELIMIT
UNEXFLAG DC    X'00'          UNIT EXCEPTION FLAG
*              X'01'          A UNIT EXCEPTION HAS OCCURRE ON AN OUTPUT
INIT1FLG DC    X'00'          FLAG WRITING THE SECOND INIT LABEL         02120
SLFLAG   DC    X'00'          IF DID INITIAL READ, MARK IF SL TAPE       02120
*              X'01'          TAPE IS SL
WRLBLFLG DC    X'00'          FLAG TELLING IF WE ARE WRITING LABELS      02120
*              X'00'          WE ARE NOW WRITING DATA FROM THE           02121
*                             INPUT TAPE. X'01' IS OFF.                  02122
*              X'01'          WE ARE NOW WRITING LABELS FROM THE         02123
*                             EXTERNAL FILE                              02124
*              X'02'          WE ARE WRITING AN EXTRA TAPE MARK          02123
*              X'04'          WE CAME FROM THE ENDHEADR LABEL            02123
*              X'08'          WE CAME FROM THE LBLINEND LABEL            02123
*                             THIS MEANS EOF OF THE LABADDIN FILE
*              X'10'          FINISHED FIXING LABELS                     02123
ISLBLFLG DC    X'00'          FLAG INDICATING WE JUST READ A LABEL       02125
*              X'00'          DATA IS NOT A LABEL                        02126
*              X'01'          DATA IS A LABEL                            02127
ENDITFLG DC    X'00'          FLAG INDICATING GET OUT FAST               02128
*              X'01'          BECAUSE OF LABLDUMP DD MISSING             02129
*              X'02'          BECAUSE OF SYSIN    DD MISSING             02130
*              X'04'          BECAUSE OF LABADDIN DD MISSING             02131
OPENDFLG DC    X'00'          FLAG INDICATING DCB IS OPEN                02132
*              X'01'          LABLDUMP DD IS OPEN                        02133
*              X'02'          SYSIN    DD IS OPEN                        02134
*              X'04'          LABADDIN DD IS OPEN                        02135
OUTBYT   DS    0F
OUTBYTH  DC    X'0000'        HI ORDER SO YOU USE A FULL REGISTER
OUTBYTL  DC    X'0000'        OUTPUT BYTE COUNT BEFORE WRITE
TOTBYTES DC    D'0'                COUNT OF TOTAL BYTES COPIED (BINARY)
TWO31    DC    P'2147483648'       2 TO THE 31ST
TAPEOWNR DC    CL10' '
INVOLUME DC    CL6'      '                                    SBG 03/00  02136
         DC    C'      '                                                 02137
         DC    C'0'                                                      02138
BLKCNTSV DC    C'0000000'     SAVE BLOCK COUNT FOR DATA FILES SBG 09/00  02139
         DC    C'      '                                                 02140
DWORD    DC    D'0'                                                      02141
QWORD    DS    PL16
ZERO23   DC    23C'0'         TEST FOR IEHINITTED HDR1        SBG 03/00  02142
         CNOP  0,8                                                       02143
INCCW    DC    X'02',AL3(INAREA),X'2000',X'FFFF'              SBG 03/00  02144
OUTCCW   DC    X'01',AL3(INAREA),X'2000',X'FFFF'              SBG 03/00  02145
REWCCW   DC    X'07',AL3(INAREA),X'6000',X'FFFF'              SBG 03/00  02146
         DC    X'03',AL3(INAREA),X'2000',X'FFFF'                         02146
BACKCCW  DC    X'2F',AL3(INAREA),X'6000',X'FFFF'                         02145
         DC    X'2F',AL3(INAREA),X'6000',X'FFFF'                         02145
         DC    X'03',AL3(INAREA),X'2000',X'FFFF'                         02146
INECB    DC    F'0'                                                      02147
INIOB    DC    X'02000000'                                               02148
         DC    A(INECB)                                                  02149
INCSW    DC    2F'0'                                                     02150
         DC    A(INCCW)                                                  02151
         DC    A(IN)                                                     02152
         DC    F'0'                                                      02153
         DC    X'00010000'                                               02154
OUTECB   DC    F'0'                                                      02155
OUTIOB   DC    X'02000000'                                               02156
         DC    A(OUTECB)                                                 02157
OUTCSW   DC    2F'0'                                                     02158
OUTCCWPT DC    A(OUTCCW)                                                 02159
OUTDCBPT DC    A(OUT1)                                                   02160
         DC    F'0'                                                      02161
         DC    X'00010000'                                               02162
REWECB   DC    F'0'                                                      02163
REWIOB   DC    X'02000000'                                               02164
         DC    A(REWECB)                                                 02165
REWCSW   DC    2F'0'                                                     02166
         DC    A(REWCCW)                                                 02167
REWDCBPT DC    A(OUT1)                                                   02168
         DC    F'0'                                                      02169
         DC    X'00010000'                                               02170
         SPACE 3                                                         02171
DDOCHG   DC    C'     '                                                  02172
DDOUT1   DC    C'OUT1 '                                                  02172
DDOUT2   DC    C'OUT2 '                                                  02173
DDOUT3   DC    C'OUT3 '                                                  02174
DDOUT4   DC    C'OUT4 '                                                  02175
DDOUT5   DC    C'OUT5 '                                                  02176
DDOUT6   DC    C'OUT6 '                                                  02177
DDOUT7   DC    C'OUT7 '                                                  02178
DDOUT8   DC    C'OUT8 '                                                  02179
DDOUT9   DC    C'OUT9 '                                                  02180
DDOUT10  DC    C'OUT10'                                                  02181
DDOUT11  DC    C'OUT11'                                                  02182
DDOUT12  DC    C'OUT12'                                                  02183
DDOUT13  DC    C'OUT13'                                                  02184
DDOUT14  DC    C'OUT14'                                                  02185
DDOUT15  DC    C'OUT15'                                                  02186
DDOUT16  DC    C'OUT16'                                                  02187
FLAGLIT  DC    C' - FLAGS - '                                            02188
* --------------------------
EOLGFLAG DC    X'00'          END OF LABEL GROUP FLAG - FOR LABLDUMP
*              X'01'          WE ARE IN A HDR GROUP
*              X'02'          WE ARE IN A EOF GROUP
*              X'04'          WE ARE IN A EOV GROUP
* --------------------------
INEODFLG DC    X'00'             X'02' IF END OF DATA ON INPUT TAPE      02189
FLAG1    DC    X'00'                                                     02190
OP1      EQU   X'80'                                                     02191
OP2      EQU   X'40'                                                     02192
OP3      EQU   X'20'                                                     02193
OP4      EQU   X'10'                                                     02194
OP5      EQU   X'08'                                                     02195
OP6      EQU   X'04'                                                     02196
OP7      EQU   X'02'                                                     02197
OP8      EQU   X'01'                                                     02198
FLAG2    DC    X'00'                                                     02199
OP9      EQU   X'80'                                                     02200
OP10     EQU   X'40'                                                     02201
OP11     EQU   X'20'                                                     02202
OP12     EQU   X'10'                                                     02203
OP13     EQU   X'08'                                                     02204
OP14     EQU   X'04'                                                     02205
OP15     EQU   X'02'                                                     02206
OP16     EQU   X'01'                                                     02207
FLAG2A   DC    X'00'                                          SBG 03/00  02208
ERR      EQU   X'02'                                                     02209
EOV      EQU   X'01'                                                     02210
FF       EQU   X'FF'                                                     02211
FLAG3    DC    X'00'                                                     02212
FLAG4    DC    X'00'                                                     02213
FLAG4A   DC    X'00'         COPY IMAGE FOR SAFETY'S SAKE     SBG 03/00  02214
L80FLAG  DC    X'00'                                          SBG 03/00  02215
*              X'01'    LAST DATA WAS 80 BYTE RECORD          SBG 03/00  02216
* ---------- *
LBLFLAG  DC    X'00'    FLAG WHEN TAPE LABELS ARE BEING READ IN          02217
*              X'01'    HDR1 HAS BEEN SEEN                    SBG 03/00  02218
*              X'02'    HDR2 HAS BEEN SEEN                    SBG 03/00  02219
*              X'04'    VOL1 HAS BEEN SEEN                    SBG 03/00  02220
*              X'08'    HDR1 IS FROM AN INITTED TAPE          SBG 03/00  02221
*              X'10'    EOF1 HAS BEEN SEEN                    SBG 04/00  02222
*              X'20'    EOF2 HAS BEEN SEEN                    SBG 04/00  02223
*              X'40'    EOV1 HAS BEEN SEEN                    SBG 04/00  02224
*              X'80'    EOV2 HAS BEEN SEEN                    SBG 04/00  02225
* ---------- *
LBLLFLAG DC    X'00'    FLAG TO IDENTIFY EXTERNAL LABELS BEING READ IN   02217
*              X'01'    HDR1 HAS BEEN READ IN                            02218
*              X'02'    HDR2 HAS BEEN READ IN                            02219
*              X'04'    VOL1 HAS BEEN READ IN                            02220
*              X'08'    UHL  HAS BEEN READ IN                            02220
*              X'10'    EOF1 HAS BEEN READ IN                            02222
*              X'20'    EOF2 HAS BEEN READ IN                            02223
*              X'40'    ----ENDOFLABELHEADER  HAS BEEN READ IN           02224
*              X'80'    ----ENTOFLABELTRAILER HAS BEEN READ IN           02225
* ---------- *
DATFLAG  DC    X'00'                                          SBG 03/00  02226
*              X'10'    NO REAL DATA HAS BEEN READ YET        SBG 03/00  02227
OVERFLAG DC    X'00'                                                     02228
*              X'01'    OUTVOLALL OVERRIDE OF CHGVOL                     02229
* --------------------------------------------------------- * SBG 04/00  02230
VOLDD    DC    C'     '                                                  02231
STOR7REG DS    F                                                         02232
SAV14T03 DC    6F'0'    SAVE REGS 14 THRU 03                  TEST       02233
BYTESPAT DC    X'40206B2020206B2020206B2020206B2020206B2020206B202120'
         DC    C' BYTES COPIED SUCCESSFULLY FOR:'
         SPACE 3                                                         02234
LABELITH DC    CL80'----ENDOFLABELHEADER '                               02235
LABELITI DC    CL80'----ENDOFLABELHEADERINIT'                            02235
LABELITR DC    CL80'----ENDOFLABELTRAILER'                               02236
LABELITV DC    CL80'----ENDOFLABELTRAILEREOV'                            02237
* ------------------------ INITIALIZATION OF VOLUMES ---- BELOW ---- *
VOL1LABL DS    0CL80
VOL1LIT  DC    CL4'VOL1'
VOL1SERL DC    CL6' '
VOL1FIL1 DC    CL31' '
VOL1ONER DC    CL10' '
VOL1FIL2 DC    CL29' '
* ------------------------ INITIALIZATION OF VOLUMES --------------- *
HDR1INIT DS    0CL80
HDR1ILIT DC    CL4'HDR1'
HDR1IFIL DC    76C'0'
* ------------------------ INITIALIZATION OF VOLUMES ---- ABOVE ---- *
TOTBLINE DC    C' TOTAL BYTES READ ON INPUT: '
TOTBPATT DC    X'40206B2020206B2020206B2020206B2020206B2020206B202120'
         DC    CL79' '
BLKCNTMS DC    C' BLOCK COUNTS IN EOF1 AND EOV1 ARE BEING CORRECTED FO'
         DC    C'R TAPE COPY OPERATION '
         DC    CL58' '
LDMPOUTM DC    C' LABELS ARE BEING DUMPED.  OUTPUT DSN=               '  02238
         DC    C'                             MEMBER=         VOLUME= '  02239
         DC    C'                          '                             02240
LDMPINMS DC    C' LABELS ARE BEING CREATED.  INPUT DSN=               '  02241
         DC    C'                             MEMBER=         VOLUME= '  02242
         DC    C'                          '                             02243
LDMPMSG  DC    C' WITH THE LABLDUMP PARM CODED, YOU HAVE TO CODE A //L'  02244
         DC    C'ABLDUMP DD CARD WITH LRECL=80,RECFM=FB. ANY BLKSIZE A'  02245
         DC    C' MULTIPLE OF 80           '                             02246
LIMFMSG  DC    C' FILELIMIT=           HAS BEEN CODED IN SYSIN. NUMBER'  02244
         DC    C' IS TREATED AS NL.                                   '  02244
         DC    CL27' '
NSYSMSG  DC    C' WITH THE SYSIN    PARM CODED, YOU HAVE TO CODE A //S'  02247
         DC    C'YSIN    DD CARD WITH LRECL=80,RECFM=FB. ANY BLKSIZE A'  02248
         DC    C' MULTIPLE OF 80           '                             02249
NLABMSG  DC    C' WITH THE LABADDIN PARM CODED, CODE A //LABADDIN DD C'  02250
         DC    C'ARD POINTING TO A DATASET OR MEMBER CONTAINING LABEL '  02251
         DC    C'IMAGES.                   '                             02252
NOLABSL  DC    C' WITH THE LABADDIN PARM CODED, YOU CAN''T ADD LABELS '  02253
         DC    C'TO A TAPE THAT IS ALREADY STANDARD LABELED.          '  02254
         DC    C'                           '                            02255
INEQC    DC    C' *********** EQUIPMENT CHECK ON INPUT -- COPY '         02256
         DC    C'TERMINATED '                                            02257
         DC    76C'*'                                                    02258
INDCK    DC    C' ********** DATA CHECK ON INPUT -- COPY TERMINATED '    02259
         DC    82C'*'                                                    02260
VOLALT   DC    C' VOL1 VOLSER XXXXXX WAS ALTERED TO XXXXXX'   SBG 03/00  02261
         DC    C' FOR DDNAME '                                           02262
VOLDDN   DC    C'     '                                                  02263
VOLFILL  DC    75C' '                    VOL1 CHANGE MESSAGE  SBG 03/00  02264
OWNRMSG  DC    C' VOL1 TAPE OWNER FIELD WAS CHANGED TO '
OWNRTID  DC    C'          '
OWNRLIT1 DC    C' FOR DDNAME '
OWNRDDO  DC    C'     '
OWNRFIL2 DC    68C' '
LTMRPT   DC    C' LEADING TAPE MARK WAS '                     SBG 03/00  02265
LTMRPTI  DC    C'       '                  COPIED OR SKIPPED  SBG 03/00  02266
         DC    103C' '                                        SBG 03/00  02267
EOVCHG   DC    C' EOV LABELS FOUND - CHANGED TO EOF AS PER '  SBG 06/00  02268
         DC    C'EOV2EOF PARM OR OPTION'                      SBG 06/00  02269
         DC    69C' '                                         SBG 06/00  02270
INITCREA DC    C'CREATED WITHOUT INPUT TAPE  '                           02271
INITMSG  DC    C' INITTED TAPE HAS BEEN '                                02271
INITCOPD DC    C'COPIED  - ORIGINAL VOLSER = '                           02271
INITSER  DC    C'      '                                      SBG 03/00  02272
INITBLNK DC    76C' '                                         SBG 03/00  02273
VOL1LBL  DC    C' VOL1 LABEL HAS BEEN DETECTED - VOLSER = '   SBG 03/00  02274
VOL1SER  DC    C'      '                                      SBG 03/00  02275
VOL1OWNT DC    C'     OWNER = '                               SBG 04/00  02276
VOL1OWNR DC    C'          '                                  SBG 04/00  02277
VOL1BLNK DC    63C' '                                         SBG 03/00  02278
         DC    C' '
USERLBL  DC    81C' '                                         SBG 03/00  02278
         DC    52C' '
XXX1LBL  DC    C' XXX1 LABEL: 1STVOL= '                       SBG 05/00  02279
XXX1VOL  DC    C'      '                                      SBG 05/00  02280
XXX1DSNL DC    C' DSN='                                       SBG 05/00  02281
XXX1DSN  DC    C'                 '                           SBG 05/00  02282
XXX1DSQL DC    C' DS SEQ #: '                                 SBG 05/00  02283
XXX1DSQ  DC    C'    '                                        SBG 05/00  02284
XXX1VSQL DC    C' VOL SEQ #: '                                SBG 05/00  02285
XXX1VSQ  DC    C'    '                                        SBG 05/00  02286
XXX1BLCL DC    C' BLOCK COUNT: '                              SBG 05/00  02287
XXX1BLC  DC    C'      '                                      SBG 05/00  02288
XXX1CRDL DC    C' CRDATE: '                                   SBG 05/00  02289
XXX1CRD  DC    C'      '                                      SBG 05/00  02290
XXX1EXDL DC    C' EXDATE: '                                   SBG 05/00  02291
XXX1EXD  DC    C'      '                                      SBG 05/00  02292
XXX1BLNK DC    30C' '                                         SBG 03/00  02293
XXX2LBL  DC    C' XXX2 LABEL: RECFM= '                        SBG 05/00  02294
XXX2RFM  DC    C' '                                           SBG 05/00  02295
XXX2BKLL DC    C'   BLOCK LENGTH: '                           SBG 05/00  02296
XXX2BKL  DC    C'     '                                       SBG 05/00  02297
XXX2RCLL DC    C'   RECORD LENGTH: '                          SBG 05/00  02298
XXX2RCL  DC    C'     '                                       SBG 05/00  02299
XXX2TDNL DC    C'  TAPE DEN: '                                SBG 05/00  02300
XXX2TDN  DC    C' '                                           SBG 05/00  02301
XXX2JSTL DC    C'   JOB/JOB STEP: '                           SBG 05/00  02302
XXX2JST  DC    C'                 '                           SBG 05/00  02303
XXX2IDRL DC    C'   IDRC? '                                   SBG 05/00  02304
XXX2IDR  DC    C'   '                                         SBG 05/00  02305
XXX2BLNK DC    8C' '                                          SBG 03/00  02306
OUTEQC   DC    C' *********** EQUIPMENT CHECK ON DD XXXXX, UNIT '        02307
         DC    C'XXX, VOLUME XXXXXX -- THIS OUTPUT TERMINATED '          02308
         DC    41C'*'                                                    02309
OUTUNEX  DC    C' *********** TAPE HAS ENDED  ON DD XXXXX, UNIT '        02307
         DC    C'XXX, VOLUME XXXXXX -- THIS OUTPUT TERMINATED '          02308
         DC    41C'*'                                                    02309
OUTDCK   DC    C' **********       DATA CHECK ON DD XXXXX, UNIT '        02310
         DC    C'XXX, VOLUME XXXXXX -- THIS OUTPUT TERMINATED '          02311
         DC    41C'*'                                                    02312
FILEDONE DC    C' FILE 00000 CONTAINS 0000000 DATA BLOCKS'               02313
FILEPBYT DS    0CL44
FILEDFL1 DC    C' '                                                      02314
FILECONT DC    C'          '                                             02314
FILEDFL2 DC    C' '                                                      02314
FILEBYTE DC    C' 9,999,999,999,999,999,999'
         DC    C' BYTES'
         DC    49C' '                                                    02314
SUCCESS  DC    C'0COPY CORRECTLY COMPLETED FOR OUT1, OUT2, OUT3, OU'     02315
         DC    C'T4, OUT5, OUT6, OUT7, OUT8, OUT9, OUT10, OUT11, OU'     02316
         DC    C'T12, OUT13, OUT14, OUT15, OUT16  '                      02317
         DC    C'       '          BLANKS FOR COVERING UP     SBG 03/00  02318
READOMSG DC    C'0THIS RUN OF THE COPYMODS PROGRAM IS READ-ONLY. JCL VOX 02319
               LSER: XXXXXX '                                 SBG 06/00  02320
         DC    66C' '                                         SBG 06/00  02321
SUCCESSR DC    C'0TAPE READ CORRECTLY COMPLETED FOR DDNAME IN, VOLUME SX 02322
               ERIAL XXXXXX '                                 SBG 06/00  02323
         DC    66C' '                                         SBG 06/00  02324
         DC    C' '                                                      02325
LINE     DC    133C' '                                                   02326
LINE44   DC    CL44' '
REPLY    DC    C'      '                                                 02328
COPIED   DC    C'COPIED '                                     SBG 03/00  02329
SKIPPED  DC    C'SKIPPED'                                     SBG 03/00  02330
FULLWORK DS    0F                                             SBG 03/00  02331
         DC    H'0'                                           SBG 03/00  02332
HALFWORK DC    H'0'                HALFWORD WORK AREA         SBG 03/00  02333
         DC    2F'0'               FILLER                     SBG 05/00  02334
* --------------------------------------------------------- * SBG 05/00  02335
PARMFLGS DS    0CL3     3 CONTIGUOUS BYTES OF PARM FLAGS      SBG 04/00  02336
PARMFLG1 DC    X'00'                                          SBG 03/00  02337
*              X'DE'    LABEL INFORMATION WILL BE PRINTED     SBG 03/00  02338
*              X'20'    LEADING TAPE MARKS WILL BE SKIPPED    SBG 03/00  02339
PARMFLG2 DC    X'00'                                          SBG 03/00  02340
PARMFLG3 DC    X'00'                                          SBG 03/00  02341
* --------------------------------------------------------- * SBG 05/00  02342
PARMSLEN DC    F'0'                LENGTH OF PARMS            SBG 04/00  02343
PARMSTRT DC    F'0'                START ADDR OF JCL PARMS    SBG 05/00  02344
PRMCHRCT DC    F'0'                CHAR COUNT FOR PRM SEARCH  SBG 05/00  02345
TOTCHRCT DC    F'0'                CHAR COUNT FOR PRM SEARCH  SBG 05/00  02346
PARMHITS DC    PL4'0'              NUMBER OF PARM HITS        SBG 05/00  02347
TOTMHITS DC    PL4'0'              NUMBER OF PARM HITS        SBG 05/00  02348
PARMLCNT DC    PL4'0'              NUMBER OF PARM LOOPS       SBG 05/00  02349
TOTMLCNT DC    PL4'0'              NUMBER OF PARM LOOPS       SBG 05/00  02350
PARMTENT DC    CL13' '             PARM TABLE ENTRY DUMP      SBG 05/00  02351
         DC    CL7' '              FILLER                     SBG 03/00  02352
PARMFWRK DC    XL3'00'             FOR TURNING OFF PARM BYTES SBG 03/00  02353
* --------------------------------------------------------- * SBG 05/00  02354
*              FORMAT OF PARM TABLE                           SBG 04/00  02355
*              ONE ENTRY IS 13 BYTES                          SBG 04/00  02356
*                1ST BYTE:      LENGTH OF THIS PARM IN HEX    SBG 04/00  02357
*                2ND BYTE:      X'01' SAYS TURN FLAG OFF      SBG 04/00  02358
*                               X'00' SAYS TURN FLAG ON       SBG 04/00  02359
*                               X'10' SET ENTRY AS A DEFAULT  SBG 04/00  02360
*                NEXT 8 BYTES:  PARM NAME - LEFT JUSTIFIED    SBG 04/00  02361
*                NEXT 3 BYTES:  FLAG SETTINGS - 3 FLAGS,      SBG 04/00  02362
*                                WHICH ALLOWS FOR 24 PARMS    SBG 04/00  02363
*                                THAT DON'T HAVE TO BE        SBG 04/00  02364
*                                SEPARATED BY A COMMA.        SBG 04/00  02365
PBYTES   EQU   3                NUMBER OF PARM SWITCH BYTES   SBG 05/00  02366
* --------------------------------------------------------- * SBG 05/00  02367
PARMTABL DC    X'07',X'00',C'LTMSKIP ',X'200000'  FIRST ENTRY SBG 05/00  02368
PTELEN   EQU   *-PARMTABL                                     SBG 05/00  02369
PTEFLG   EQU   PTELEN-PBYTES                                  SBG 05/00  02370
         DC    X'07',X'00',C'SKIPLTM ',X'200000'              SBG 05/00  02371
         DC    X'07',X'11',C'COPYLTM ',X'200000'  DEFAULT     SBG 05/00  02372
         DC    X'07',X'01',C'LTMCOPY ',X'200000'              SBG 05/00  02373
         DC    X'07',X'00',C'LBLINFO ',X'DE0000'              SBG 05/00  02374
         DC    X'06',X'00',C'PRINTL  ',X'DE0000'              SBG 05/00  02375
         DC    X'06',X'00',C'LABELS  ',X'DE0000'              SBG 05/00  02376
         DC    X'06',X'01',C'NOLABL  ',X'DE0000'              SBG 05/00  02377
         DC    X'07',X'11',C'NOLABEL ',X'DE0000'  DEFAULT     SBG 05/00  02378
         DC    X'04',X'00',C'HDR1    ',X'020000'              SBG 05/00  02379
         DC    X'06',X'01',C'NOHDR1  ',X'020000'              SBG 05/00  02380
         DC    X'04',X'00',C'HDR2    ',X'040000'              SBG 05/00  02381
         DC    X'06',X'01',C'NOHDR2  ',X'040000'              SBG 05/00  02382
         DC    X'04',X'00',C'EOF1    ',X'080000'              SBG 05/00  02383
         DC    X'06',X'01',C'NOEOF1  ',X'080000'              SBG 05/00  02384
         DC    X'04',X'00',C'EOF2    ',X'100000'              SBG 05/00  02385
         DC    X'06',X'01',C'NOEOF2  ',X'100000'              SBG 05/00  02386
         DC    X'04',X'00',C'EOV1    ',X'400000'              SBG 05/00  02387
         DC    X'06',X'01',C'NOEOV1  ',X'400000'              SBG 05/00  02388
         DC    X'04',X'00',C'EOV2    ',X'800000'              SBG 05/00  02389
         DC    X'06',X'01',C'NOEOV2  ',X'800000'              SBG 05/00  02390
         DC    X'04',X'00',C'HDRS    ',X'060000'              SBG 05/00  02391
         DC    X'06',X'01',C'NOHDRS  ',X'060000'              SBG 05/00  02392
         DC    X'04',X'00',C'EOFS    ',X'180000'              SBG 05/00  02393
         DC    X'06',X'01',C'NOEOFS  ',X'180000'              SBG 05/00  02394
         DC    X'04',X'00',C'EOVS    ',X'C00000'              SBG 05/00  02395
         DC    X'06',X'01',C'NOEOVS  ',X'C00000'              SBG 05/00  02396
         DC    X'06',X'00',C'CHGVOL  ',X'000100'              SBG 05/00  02397
         DC    X'08',X'11',C'NOCHGVOL',X'000100'  DEFAULT     SBG 05/00  02398
         DC    X'06',X'00',C'JCLVOL  ',X'000100'              SBG 05/00  02399
         DC    X'08',X'01',C'NOJCLVOL',X'000100'              SBG 05/00  02400
         DC    X'06',X'00',C'NEWVOL  ',X'000100'              SBG 05/00  02401
         DC    X'08',X'01',C'NONEWVOL',X'000100'              SBG 05/00  02402
         DC    X'06',X'10',C'VOLLBL  ',X'000200'  DEFAULT     SBG 05/00  02403
         DC    X'08',X'01',C'NOVOLLBL',X'000200'              SBG 05/00  02404
         DC    X'07',X'00',C'EOV2EOF ',X'000400'              SBG 05/00  02405
         DC    X'08',X'00',C'EOVTOEOF',X'000400'              SBG 05/00  02406
         DC    X'06',X'00',C'EOVCHG  ',X'000400'              SBG 05/00  02407
         DC    X'08',X'11',C'NOEOVCHG',X'000400'  DEFAULT     SBG 05/00  02408
         DC    X'04',X'00',C'READ    ',X'000800'              SBG 05/00  02409
         DC    X'08',X'00',C'READONLY',X'000800'              SBG 05/00  02410
         DC    X'07',X'00',C'NOWRITE ',X'000800'              SBG 05/00  02411
         DC    X'07',X'11',C'WRITE   ',X'000800'  DEFAULT     SBG 05/00  02412
         DC    X'08',X'00',C'LABLDUMP',X'001000'              SBG 05/00  02413
         DC    X'08',X'11',C'NOLABELD',X'001000'  DEFAULT     SBG 05/00  02414
         DC    X'05',X'00',C'SYSIN   ',X'002000'              SBG 05/00  02415
         DC    X'07',X'11',C'NOSYSIN ',X'002000'  DEFAULT     SBG 05/00  02416
         DC    X'06',X'00',C'OUTVOL  ',X'004000'                         02417
         DC    X'08',X'00',C'LABADDIN',X'008080'  INCLUDE LBLFIX  05/00  02418
         DC    X'06',X'10',C'BLKCNT  ',X'010000'  DEFAULT         05/00  02419
         DC    X'08',X'01',C'NOBLKCNT',X'010000'                  05/00  02420
         DC    X'08',X'00',C'PRADDLBL',X'000010'                  05/00  02421
         DC    X'08',X'01',C'NOPRADDL',X'000010'                  05/00  02422
         DC    X'08',X'00',C'CORRBLKS',X'000020'                  05/00  02422
         DC    X'08',X'00',C'NOEXNULL',X'000040'                  05/00  02422
         DC    X'08',X'00',C'NOSLNULL',X'000040'                  05/00  02422
         DC    X'06',X'11',C'EXNULL  ',X'000040'                  05/00  02422
         DC    X'06',X'01',C'SLNULL  ',X'000040'                  05/00  02422
         DC    X'06',X'00',C'LBLFIX  ',X'000080'                  05/00  02422
         DC    X'08',X'01',C'NOLBLFIX',X'000080'                  05/00  02422
         DC    X'08',X'00',C'INITVOLS',X'000101'                  05/00  02422
         DC    X'07',X'00',C'LIMFILE ',X'000002'                  05/00  02422
         DC    X'07',X'00',C'FILELIM ',X'000002'                  05/00  02422
         DC    X'05',X'00',C'BYTES   ',X'000004'                  05/00  02422
         DC    X'07',X'01',C'NOBYTES ',X'000004'                  05/00  02422
EFFS     DC    X'FFFFFFFFFFFFFFFF'                            SBG 05/00  02423
* --------------------------------------------------------- * SBG 04/00  02424
         SPACE 3                                                         02425
         LTORG                                                           02426
         SPACE 3                                                         02427
         DS    0D                                             SBG 09/00  02428
LBNEXLST DC    X'87',AL3(LBNJFCB)                                        02429
LBNJFCB  DC    44F'0'                                                    02430
         DS    0D                                             SBG 09/00  02431
LBLEXLST DC    X'87',AL3(LBLJFCB)                                        02432
LBLJFCB  DC    44F'0'                                                    02433
         DS    0D                                             SBG 05/00  02434
OUTEXLST DC    X'87',AL3(OUTJFCB)                                        02435
OUTJFCB  DC    44F'0'                                                    02436
         DS    0D                                             SBG 06/00  02437
INEXLST  DC    X'87',AL3(INJFCB)                              SBG 06/00  02438
INJFCB   DC    44F'0'                                         SBG 06/00  02439
         SPACE 3                                                         02440
INVOL    DC    C'      '     INPUT VOLUME NAME FROM VOL1 LABEL           02441
INVOLJ   DC    C'      '     INPUT VOLUME NAME FROM JCL VOLUME           02442
VOLORIG  DC    C'      '     JCL VOLUME NAME - FROM VOL1 LABEL           02443
VOLNEW   DC    C'      '     JCL VOLUME NAME - TO SUBSTITUTE             02444
VOLCHG   DC    C'      '
VOLSTG   DC    C'      '    CARD VOLUME NAME - TO OVERLAY OTHERS         02445
VOLALL   DS    0CL96         16 X 6                                      02446
VOLUME1  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02447
VOLUME2  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02448
VOLUME3  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02449
VOLUME4  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02450
VOLUME5  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02451
VOLUME6  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02452
VOLUME7  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02453
VOLUME8  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02454
VOLUME9  DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02455
VOLUME10 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02456
VOLUME11 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02457
VOLUME12 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02458
VOLUME13 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02459
VOLUME14 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02460
VOLUME15 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02461
VOLUME16 DC    C'      '     JCL VOLUME NAME - FROM RDJFCB               02462
* --------------------------------------------------------- * SBG 05/00  02463
         SPACE 3                                                         02464
IN       DCB   MACRF=(E),DDNAME=IN,DEVD=TA,DSORG=PS,RECFM=U,           X 02465
               EXLST=INEXLST                                             02466
OUT1     DCB   MACRF=(E),DDNAME=OUT1,DEVD=TA,DSORG=PS,RECFM=U,         X 02467
               EXLST=OUTEXLST                                            02468
OUT2     DCB   MACRF=(E),DDNAME=OUT2,DEVD=TA,DSORG=PS,RECFM=U,         X 02469
               EXLST=OUTEXLST                                            02470
OUT3     DCB   MACRF=(E),DDNAME=OUT3,DEVD=TA,DSORG=PS,RECFM=U,         X 02471
               EXLST=OUTEXLST                                            02472
OUT4     DCB   MACRF=(E),DDNAME=OUT4,DEVD=TA,DSORG=PS,RECFM=U,         X 02473
               EXLST=OUTEXLST                                            02474
OUT5     DCB   MACRF=(E),DDNAME=OUT5,DEVD=TA,DSORG=PS,RECFM=U,         X 02475
               EXLST=OUTEXLST                                            02476
OUT6     DCB   MACRF=(E),DDNAME=OUT6,DEVD=TA,DSORG=PS,RECFM=U,         X 02477
               EXLST=OUTEXLST                                            02478
OUT7     DCB   MACRF=(E),DDNAME=OUT7,DEVD=TA,DSORG=PS,RECFM=U,         X 02479
               EXLST=OUTEXLST                                            02480
OUT8     DCB   MACRF=(E),DDNAME=OUT8,DEVD=TA,DSORG=PS,RECFM=U,         X 02481
               EXLST=OUTEXLST                                            02482
OUT9     DCB   MACRF=(E),DDNAME=OUT9,DEVD=TA,DSORG=PS,RECFM=U,         X 02483
               EXLST=OUTEXLST                                            02484
OUT10    DCB   MACRF=(E),DDNAME=OUT10,DEVD=TA,DSORG=PS,RECFM=U,        X 02485
               EXLST=OUTEXLST                                            02486
OUT11    DCB   MACRF=(E),DDNAME=OUT11,DEVD=TA,DSORG=PS,RECFM=U,        X 02487
               EXLST=OUTEXLST                                            02488
OUT12    DCB   MACRF=(E),DDNAME=OUT12,DEVD=TA,DSORG=PS,RECFM=U,        X 02489
               EXLST=OUTEXLST                                            02490
OUT13    DCB   MACRF=(E),DDNAME=OUT13,DEVD=TA,DSORG=PS,RECFM=U,        X 02491
               EXLST=OUTEXLST                                            02492
OUT14    DCB   MACRF=(E),DDNAME=OUT14,DEVD=TA,DSORG=PS,RECFM=U,        X 02493
               EXLST=OUTEXLST                                            02494
OUT15    DCB   MACRF=(E),DDNAME=OUT15,DEVD=TA,DSORG=PS,RECFM=U,        X 02495
               EXLST=OUTEXLST                                            02496
OUT16    DCB   MACRF=(E),DDNAME=OUT16,DEVD=TA,DSORG=PS,RECFM=U,        X 02497
               EXLST=OUTEXLST                                            02498
SYSPRINT DCB   MACRF=PM,DDNAME=SYSPRINT,DSORG=PS,RECFM=FA,LRECL=133,   X 02499
               BLKSIZE=133                                               02500
LABLDUMP DCB   MACRF=PM,DDNAME=LABLDUMP,DSORG=PS,RECFM=FB,LRECL=80,    X 02501
               EXLST=LBLEXLST                                            02502
LABADDIN DCB   MACRF=GM,DDNAME=LABADDIN,DSORG=PS,RECFM=FB,LRECL=80,    X 02503
               EXLST=LBNEXLST,EODAD=LBLINEND                             02504
SYSIN    DCB   MACRF=GM,DDNAME=SYSIN,DSORG=PS,RECFM=FB,LRECL=80,       X 02505
               EODAD=SYSINEND                                            02506
         DC    C' '              BLANK FOR CLEARING AREA      SBG 09/00  02507
LLINE    DC    CL80' '           OUTPUT AREA FOR LABEL DUMP   SBG 09/00  02508
SAVE3REG DC    F'0'                                                      02509
SAVE6REG DC    F'0'                                                      02510
SAVE7REG DC    F'0'                                                      02511
SAVE7RG1 DC    F'0'                                                      02511
SAVE7RG2 DC    F'0'                                                      02511
         DC    CL4' '
HDR1SAV  DC    CL80' '
HDR2SAV  DC    CL80' '
UHL1SAV  DC    CL80' '
UHL2SAV  DC    CL80' '
UHL3SAV  DC    CL80' '
UHL4SAV  DC    CL80' '
UHL5SAV  DC    CL80' '
UHL6SAV  DC    CL80' '
UHL7SAV  DC    CL80' '
UHL8SAV  DC    CL80' '
CARDIN   DC    CL80' '    SYSIN CARD INPUT AREA                          02512
EXTLBLIN DC    CL80' '    INPUT AREA FOR EXTERNAL LABELS                 02513
         DC    CL80' '    PADDING TO SEPARATE FROM INAREA     SBG 09/00  02514
JFCBLK   DSECT                                                           02515
         IEFJFCBN LIST=YES                                               02516
COPYMODS CSECT                                                           02517
INAREA   DS    CL65535                                        SBG 03/00  02518
#PAN$AUD CSECT                                                           02519
$PAN#AUD DC    CL30'LEVEL 037 COPYMODS  10/31/00 '                       02520
         END                                                             02521
