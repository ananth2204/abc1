       IDENTIFICATION DIVISION.
       PROGRAM-ID. P2PBTBL.
      *DATE-WRITTEN.  06/07/99.
       DATE-COMPILED.
       ENVIRONMENT DIVISION.
       CONFIGURATION SECTION.
       SOURCE-COMPUTER.
           IBM-370.
       OBJECT-COMPUTER.
           IBM-370.
       INPUT-OUTPUT SECTION.
       FILE-CONTROL.
           SELECT MEMBER-LIST-LEFT
               ASSIGN TO MBRLISTL.
           SELECT MEMBER-LIST-RIGHT
               ASSIGN TO MBRLISTR.
       DATA DIVISION.
       FILE SECTION.
       FD  MEMBER-LIST-LEFT
           RECORDING MODE IS F
           DATA RECORD IS LEFT-MEMBER-REC.
       01  LEFT-MEMBER-REC             PIC X(80).
       FD  MEMBER-LIST-RIGHT
           RECORDING MODE IS F
           BLOCK CONTAINS 0 RECORDS
           DATA RECORD IS RIGHT-MEMBER-REC.
       01  RIGHT-MEMBER-REC            PIC X(80).
       WORKING-STORAGE SECTION.

      ******************************************************************
      *                                                                *
      *                        PROGRAM CONSTANTS                       *
      *                                                                *
      ******************************************************************

       01  WS-HEADER                   PIC X(35)           VALUE
           'P2PBTBL WORKING-STORAGE BEGINS HERE'.

      *                                                                *
      *              CONSTANT VALUES FOR ISPLINK PARAMETERS            *
      *                                                                *

       01  WS-CONTROL                  PIC X(08)           VALUE
           'CONTROL '.
       01  WS-ERRORS                   PIC X(08)           VALUE
           'ERRORS  '.
       01  WS-RETURN                   PIC X(08)           VALUE
           'RETURN  '.
       01  WS-SETMSG                   PIC X(08)           VALUE
           'SETMSG  '.
       01  WS-ISRZ002                  PIC X(08)           VALUE
           'ISRZ002 '.
       01  WS-TBL-LIMIT-MSG            PIC X(08)           VALUE
           'PTPM001B'.
       01  WS-VDEFINE                  PIC X(08)           VALUE
           'VDEFINE '.
       01  WS-VRESET                   PIC X(08)           VALUE
           'VRESET  '.
       01  WS-TBCREATE                 PIC X(08)           VALUE
           'TBCREATE'.
       01  WS-NOWRITE                  PIC X(08)           VALUE
           'NOWRITE '.
       01  WS-TBADD                    PIC X(08)           VALUE
           'TBADD   '.
       01  WS-TBTOP                    PIC X(08)           VALUE
           'TBTOP   '.
       01  WS-CHAR                     PIC X(08)           VALUE
           'CHAR    '.

      *                                                                *
      *  ISPF MEMBER LIST TABLE FIELD NAMES FOR 'TBCREATE' COMMAND     *
      *                                                                *

       01  WS-TBCREATE-KEYNAME-LIST    PIC X(01)           VALUE
           ' '.
       01  WS-TBCREATE-NAMELIST.
           05 FILLER                   PIC X(06)           VALUE
              '(RESL '.
           05 FILLER                   PIC X(05)           VALUE
              'MBRL '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT1L '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT2L '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT3L '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT4L '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT5L '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT6L '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT7L '.
           05 FILLER                   PIC X(05)           VALUE
              'RESR '.
           05 FILLER                   PIC X(05)           VALUE
              'MBRR '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT1R '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT2R '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT3R '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT4R '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT5R '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT6R '.
           05 FILLER                   PIC X(07)           VALUE
              'STAT7R)'.

      *                                                                *
      *       NUMBER OF PDS2PDS TABLES THAT MAY BE ACTIVE AT ONCE      *
      *                                                                *

       01  WS-TABLE-LIMIT              PIC 9(03)           VALUE 99.

      ******************************************************************
      *                                                                *
      *                    VDEFINE PARAMETER VALUES                    *
      *                                                                *
      ******************************************************************

      *                                                                *
      *                  MEMBER LIST TABLE FIELD NAMES                 *
      *                                                                *

       01  WS-RESL-NAME                PIC X(06)           VALUE
           '(RESL)'.
       01  WS-MBRL-NAME                PIC X(06)           VALUE
           '(MBRL)'.
       01  WS-STAT1L-NAME              PIC X(08)           VALUE
           '(STAT1L)'.
       01  WS-STAT2L-NAME              PIC X(08)           VALUE
           '(STAT2L)'.
       01  WS-STAT3L-NAME              PIC X(08)           VALUE
           '(STAT3L)'.
       01  WS-STAT4L-NAME              PIC X(08)           VALUE
           '(STAT4L)'.
       01  WS-STAT5L-NAME              PIC X(08)           VALUE
           '(STAT5L)'.
       01  WS-STAT6L-NAME              PIC X(08)           VALUE
           '(STAT6L)'.
       01  WS-STAT7L-NAME              PIC X(08)           VALUE
           '(STAT7L)'.
       01  WS-RESR-NAME                PIC X(06)           VALUE
           '(RESR)'.
       01  WS-MBRR-NAME                PIC X(06)           VALUE
           '(MBRR)'.
       01  WS-STAT1R-NAME              PIC X(08)           VALUE
           '(STAT1R)'.
       01  WS-STAT2R-NAME              PIC X(08)           VALUE
           '(STAT2R)'.
       01  WS-STAT3R-NAME              PIC X(08)           VALUE
           '(STAT3R)'.
       01  WS-STAT4R-NAME              PIC X(08)           VALUE
           '(STAT4R)'.
       01  WS-STAT5R-NAME              PIC X(08)           VALUE
           '(STAT5R)'.
       01  WS-STAT6R-NAME              PIC X(08)           VALUE
           '(STAT6R)'.
       01  WS-STAT7R-NAME              PIC X(08)           VALUE
           '(STAT7R)'.

      *                                                                *
      *                    TERMINAL ALARM FIELD NAME                   *
      *                                                                *

       01  WS-ZERRALRM-NAME            PIC X(10)           VALUE
           '(ZERRALRM)'.

      *                                                                *
      *                 MEMBER LIST TABLE FIELD LENGTHS                *
      *                                                                *

       01  WS-RESL-LENGTH              PIC 9(06)      COMP VALUE 1.
       01  WS-MBRL-LENGTH              PIC 9(06)      COMP VALUE 8.
       01  WS-STAT1L-LENGTH            PIC 9(06)      COMP VALUE 23.
       01  WS-STAT2L-LENGTH            PIC 9(06)      COMP VALUE 25.
       01  WS-STAT3L-LENGTH            PIC 9(06)      COMP VALUE 22.
       01  WS-STAT4L-LENGTH            PIC 9(06)      COMP VALUE 19.
       01  WS-STAT5L-LENGTH            PIC 9(06)      COMP VALUE 17.
       01  WS-STAT6L-LENGTH            PIC 9(06)      COMP VALUE 20.
       01  WS-STAT7L-LENGTH            PIC 9(06)      COMP VALUE 18.
       01  WS-RESR-LENGTH              PIC 9(06)      COMP VALUE 1.
       01  WS-MBRR-LENGTH              PIC 9(06)      COMP VALUE 8.
       01  WS-STAT1R-LENGTH            PIC 9(06)      COMP VALUE 23.
       01  WS-STAT2R-LENGTH            PIC 9(06)      COMP VALUE 25.
       01  WS-STAT3R-LENGTH            PIC 9(06)      COMP VALUE 22.
       01  WS-STAT4R-LENGTH            PIC 9(06)      COMP VALUE 19.
       01  WS-STAT5R-LENGTH            PIC 9(06)      COMP VALUE 17.
       01  WS-STAT6R-LENGTH            PIC 9(06)      COMP VALUE 20.
       01  WS-STAT7R-LENGTH            PIC 9(06)      COMP VALUE 18.

      *                                                                *
      *                   TERMINAL ALARM FIELD LENGTH                  *
      *                                                                *

       01  WS-ZERRALRM-LENGTH          PIC 9(06)      COMP VALUE 03.

      *                                                                *
      *                  MEMBER LIST TABLE FIELD DATA                  *
      *                                                                *

       01  WS-RESL                     PIC X(01)           VALUE SPACE.
       01  WS-MBRL                     PIC X(08)           VALUE SPACES.
       01  WS-STAT1L                   PIC X(23)           VALUE SPACES.
       01  WS-STAT2L                   PIC X(25)           VALUE SPACES.
       01  WS-STAT3L                   PIC X(22)           VALUE SPACES.
       01  WS-STAT4L                   PIC X(19)           VALUE SPACES.
       01  WS-STAT5L                   PIC X(17)           VALUE SPACES.
       01  WS-STAT6L                   PIC X(20)           VALUE SPACES.
       01  WS-STAT7L                   PIC X(18)           VALUE SPACES.
       01  WS-RESR                     PIC X(01)           VALUE SPACE.
       01  WS-MBRR                     PIC X(08)           VALUE SPACES.
       01  WS-STAT1R                   PIC X(23)           VALUE SPACES.
       01  WS-STAT2R                   PIC X(25)           VALUE SPACES.
       01  WS-STAT3R                   PIC X(22)           VALUE SPACES.
       01  WS-STAT4R                   PIC X(19)           VALUE SPACES.
       01  WS-STAT5R                   PIC X(17)           VALUE SPACES.
       01  WS-STAT6R                   PIC X(20)           VALUE SPACES.
       01  WS-STAT7R                   PIC X(18)           VALUE SPACES.

      *                                                                *
      *                    TERMINAL ALARM FIELD DATA                   *
      *                                                                *

       01  WS-ZERRALRM                 PIC X(03)           VALUE 'YES'.

      *                                                                *
      *  CREATE TABLE FIELD DATA HERE THEN MOVE IT TO THE TABLE FIELDS *
      *                                                                *

       01  WS-S1L.
           05  WS-S1L-VVMM             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S1L-CREATED          PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S1L-CHANGED          PIC X(08)           VALUE SPACES.
       01  WS-S2L.
           05  WS-S2L-CREATED          PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S2L-CHANGED          PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S2L-TIME             PIC X(07)           VALUE SPACES.
       01  WS-S3L.
           05  WS-S3L-CHANGED          PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S3L-TIME             PIC X(07)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S3L-SIZE             PIC X(05)           VALUE SPACES.
       01  WS-S4L.
           05  WS-S4L-TIME             PIC X(07)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S4L-SIZE             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S4L-INIT             PIC X(05)           VALUE SPACES.
       01  WS-S5L.
           05  WS-S5L-SIZE             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S5L-INIT             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S5L-MOD              PIC X(05)           VALUE SPACES.
       01  WS-S6L.
           05  WS-S6L-INIT             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S6L-MOD              PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S6L-USER             PIC X(08)           VALUE SPACES.
       01  WS-S7L.
           05  WS-S7L-MOD              PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S7L-USER             PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S7L-ALIAS            PIC X(03)           VALUE SPACES.
       01  WS-S1R.
           05  WS-S1R-VVMM             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S1R-CREATED          PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S1R-CHANGED          PIC X(08)           VALUE SPACES.
       01  WS-S2R.
           05  WS-S2R-CREATED          PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S2R-CHANGED          PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S2R-TIME             PIC X(07)           VALUE SPACES.
       01  WS-S3R.
           05  WS-S3R-CHANGED          PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S3R-TIME             PIC X(07)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S3R-SIZE             PIC X(05)           VALUE SPACES.
       01  WS-S4R.
           05  WS-S4R-TIME             PIC X(07)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S4R-SIZE             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S4R-INIT             PIC X(05)           VALUE SPACES.
       01  WS-S5R.
           05  WS-S5R-SIZE             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S5R-INIT             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S5R-MOD              PIC X(05)           VALUE SPACES.
       01  WS-S6R.
           05  WS-S6R-INIT             PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S6R-MOD              PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S6R-USER             PIC X(08)           VALUE SPACES.
       01  WS-S7R.
           05  WS-S7R-MOD              PIC X(05)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S7R-USER             PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-S7R-ALIAS            PIC X(03)           VALUE SPACES.

      ******************************************************************
      *                                                                *
      *            REXX/COBOL SHARED VARIABLE PARMS AND DATA           *
      *                                                                *
      ******************************************************************

      *                                                                *
      *            REXX PROGRAM SHARED VARIABLE LINKAGE                *
      *                                                                *

       01  DUMMY-PARM                  PIC X(04)           VALUE SPACE.
       01  SHVBLOCK.
           05  SHVNEXT                 PIC S9(09)     COMP VALUE ZERO.
           05  SHVUSER                 PIC S9(09)     COMP VALUE ZERO.
           05  SHVCODE                 PIC X(01)           VALUE SPACE.
           05  SHVRET                  PIC X(01)           VALUE SPACE.
           05  FILLER                  PIC X(02)           VALUE SPACE.
           05  SHVBUFL                 PIC S9(09)     COMP VALUE ZERO.
           05  SHVNAMA                 POINTER.
           05  SHVNAML                 PIC S9(09)     COMP VALUE ZERO.
           05  SHVVALA                 POINTER.
           05  SHVVALL                 PIC S9(09)     COMP VALUE ZERO.

      *                                                                *
      *                  REXX PROGRAM VARIABLE NAMES                   *
      *                                                                *

       01  WS-VARNAME-RTNNAME          PIC X(10)           VALUE
           'RTN_TBLNAM'.
       01  WS-RTNNAME-LENGTH           PIC S9(09)     COMP VALUE +10.
       01  WS-VARNAME-DISPLOPT         PIC X(08)           VALUE
           'DISPLOPT'.

      *                                                                *
      *                  NAME OF ISPF TABLE TO BUILD                   *
      *                                                                *

       01  WS-TBLNAME.
           05  FILLER                  PIC X(05)           VALUE
               'P2PTB'.
           05  WS-TBLNBR               PIC 9(03)           VALUE 001.

      *                                                                *
      *   MEMBER DISPLAY OPTION SELECTED BY USER ON DATASET NAME PANEL *
      *                                                                *
      *     THE MEMBER DISPLAY OPTION IS PASSED TO THIS PROGRAM AS A   *
      *     NUMBER THAT CORRESPONDS TO THE OPTION CHOSEN. VALID NUMBERS*
      *     ARE:                                                       *
      *                                                                *
      *     1 = NAMESAME     5 = UNIQLEFT                              *
      *     2 = STATSAME     6 = UNIQRITE                              *
      *     3 = STATDIFF     7 = OLDRLEFT                              *
      *     4 = NAMEDIFF     8 = OLDRRITE                              *
      *                                                                *

       01  WS-DISPLOPT                 PIC 9(01)           VALUE ZERO.
           88 WS-NAMESAME                                  VALUE 1.
           88 WS-STATSAME                                  VALUE 2.
           88 WS-STATDIFF                                  VALUE 3.
           88 WS-NAMEDIFF                                  VALUE 4.
           88 WS-UNIQLEFT                                  VALUE 5.
           88 WS-UNIQRITE                                  VALUE 6.
           88 WS-OLDRLEFT                                  VALUE 7.
           88 WS-OLDRRITE                                  VALUE 8.
           88 WS-DONT-PROCESS-LEFT                         VALUES ARE
                                                           1 2 3 6 7 8.
           88 WS-DONT-PROCESS-RIGHT                        VALUES ARE
                                                           1 2 3 5 7 8.
           88 WS-DONT-PROCESS-EITHER                       VALUES ARE
                                                           4 5 6.

      *                                                                *
      *                  DATA RETURNED TO REXX PROGRAM                 *
      *                                                                *

       01  WS-RETURN-TEXT.
           05  WS-RETURN-MSGTYPE       PIC X(01)           VALUE '1'.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-TBLNAME-RETURN       PIC X(08)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-NBR-MBRS-LEFT-Z      PIC ZZZZ9           VALUE ZERO.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-NBR-MBRS-RIGHT-Z     PIC ZZZZ9           VALUE ZERO.
           05  FILLER                  PIC X(01)           VALUE SPACE.
           05  WS-NBR-OF-MBRS-Z        PIC ZZZZ9           VALUE ZERO.

      ******************************************************************
      *                                                                *
      *             RIGHT- AND LEFT-SIDE PDS MEMBER RECORDS            *
      *                                                                *
      ******************************************************************

      *                                                                *
      *LEFT-SIDE MEMBER RECORD                                         *
      *                                                                *

       01  WS-MBR-REC-LEFT.
           05  WS-MBR-NAME-LEFT        PIC X(08)           VALUE SPACES.
           05  WS-STATS-FLDS-LEFT.
               10  WS-VVMM-LEFT        PIC X(05)           VALUE SPACES.
               10  WS-CREATED-LEFT     PIC X(10)           VALUE SPACES.
               10  WS-CHANGED-LEFT     PIC X(10)           VALUE SPACES.
               10  WS-TIME-LEFT        PIC X(08)           VALUE SPACES.
               10  WS-SIZE-LEFT        PIC X(05)           VALUE SPACES.
               10  WS-INIT-LEFT        PIC X(05)           VALUE SPACES.
               10  WS-MOD-LEFT         PIC X(05)           VALUE SPACES.
               10  WS-USER-LEFT        PIC X(08)           VALUE SPACES.
               10  WS-ALIAS-LEFT       PIC X(03)           VALUE SPACES.
           05  FILLER                  PIC X(13)           VALUE SPACES.

      *                                                                *
      *RIGHT-SIDE MEMBER RECORD                                        *
      *                                                                *

       01  WS-MBR-REC-RIGHT.
           05  WS-MBR-NAME-RIGHT       PIC X(08)           VALUE SPACES.
           05  WS-STATS-FLDS-RIGHT.
               10  WS-VVMM-RIGHT       PIC X(05)           VALUE SPACES.
               10  WS-CREATED-RIGHT    PIC X(10)           VALUE SPACES.
               10  WS-CHANGED-RIGHT    PIC X(10)           VALUE SPACES.
               10  WS-TIME-RIGHT       PIC X(08)           VALUE SPACES.
               10  WS-SIZE-RIGHT       PIC X(05)           VALUE SPACES.
               10  WS-INIT-RIGHT       PIC X(05)           VALUE SPACES.
               10  WS-MOD-RIGHT        PIC X(05)           VALUE SPACES.
               10  WS-USER-RIGHT       PIC X(08)           VALUE SPACES.
               10  WS-ALIAS-RIGHT      PIC X(03)           VALUE SPACES.
           05  FILLER                  PIC X(13)           VALUE SPACES.

      ******************************************************************
      *                                                                *
      *                    MEMBER COUNT WORK FIELDS                    *
      *                                                                *
      ******************************************************************

       01  WS-NBR-MBRS-LEFT            PIC 9(05)           VALUE ZERO.
       01  WS-NBR-MBRS-RIGHT           PIC 9(05)           VALUE ZERO.
       01  WS-NBR-OF-MBRS              PIC 9(05)           VALUE ZERO.

      ******************************************************************
      *                                                                *
      *                    DATE AND TIME WORK FIELDS                   *
      *                                                                *
      ******************************************************************

       01  WS-DATE-WORK.
           05  FILLER                  PIC X(02)           VALUE SPACES.
           05  WS-DW-YMD               PIC X(08)           VALUE SPACES.

       01  WS-TIME-WORK.
           05  WS-TW-HH                PIC X(02)           VALUE SPACES.
           05  FILLER                  PIC X(01)           VALUE SPACES.
           05  WS-TW-MMSS              PIC X(05)           VALUE SPACES.

       01  WS-TIME-WORK-2.
           05  WS-TW2-HH               PIC X(02)           VALUE SPACES.
           05  WS-TW2-MMSS             PIC X(05)           VALUE SPACES.

      ******************************************************************
      *                                                                *
      *                  PROGRAM PROCESSING SWITCHES                   *
      *                                                                *
      ******************************************************************

       01  WS-EOF-LEFT-LIST-SW         PIC 9(01)           VALUE ZERO.
           88  WS-EOF-LEFT-LIST                            VALUE 1.
       01  WS-EOF-RIGHT-LIST-SW        PIC 9(01)           VALUE ZERO.
           88  WS-EOF-RIGHT-LIST                           VALUE 1.
       01  WS-EOF-BOTH-LISTS-SW        PIC 9(01)           VALUE ZERO.
           88  WS-EOF-BOTH-LISTS                           VALUE 1.
       01  WS-SYSTEM-MSG-SW            PIC 9(01)           VALUE ZERO.
           88  WS-SYSTEM-MSG                               VALUE 1.
       01  WS-PGM-MSG-SW               PIC 9(01)           VALUE ZERO.
           88  WS-PGM-MSG                                  VALUE 1.
       01  WS-TABLE-CREATED-SW         PIC 9(01)           VALUE ZERO.
           88  WS-TABLE-CREATED                            VALUE 1.
       01  WS-MATCHING-STATS-SW        PIC 9(01)           VALUE ZERO.
           88  WS-NO-MATCHING-STATS                        VALUE 0.
           88  WS-MATCHING-STATS                           VALUE 1.
       01  WS-OLDER-FLAG               PIC X(01)           VALUE SPACE.
           88  WS-LEFT-OLDER                               VALUE 'L'.
           88  WS-RIGHT-OLDER                              VALUE 'R'.

        LINKAGE SECTION.

      ******************************************************************
      *                                                                *
      *               REXX EXTERNAL FUNCTION CALL LINKAGE              *
      *                                                                *
      ******************************************************************

        01  EFPLCOM                    PIC X(04).
        01  EFPLBARG                   PIC X(04).
        01  EFPLEARG                   PIC X(04).
        01  EFPLFB                     PIC X(04).
        01  EFPLARG.
            05  ARG-TBL-ENT            OCCURS 5 TIMES.
                10  ARG-ADDR           POINTER.
                10  ARG-LEN            PIC S9(09)     COMP.
        01  EFPLEVAL                   POINTER.
        01  ARG-STRING                 PIC X(250).
        01  EVALBLOCK.
            05  EVALBLOCK-EVPAD1       PIC X(04).
            05  EVALBLOCK-EVSIZE       PIC S9(09)     COMP.
            05  EVALBLOCK-EVLEN        PIC S9(09)     COMP.
            05  EVALBLOCK-EVPAD2       PIC X(04).
            05  EVALBLOCK-EVDATA.
                10  EVALBLOCK-RETTYPE  PIC X(01).
                10  FILLER             PIC X(01).
                10  EVALBLOCK-RETCODE  PIC 9(02).
                10  FILLER             PIC X(246).
      *
       PROCEDURE DIVISION USING EFPLCOM
                                EFPLBARG
                                EFPLEARG
                                EFPLFB
                                EFPLARG
                                EFPLEVAL.
       0100-MAIN.

      ******************************************************************
      *                                                                *
      *    GET CONTENTS OF VARIABLE 'DISPLOPT' FROM THE REXX PROGRAM   *
      *                                                                *
      ******************************************************************

           MOVE 'F' TO SHVCODE.
           MOVE 8 TO SHVNAML.
           SET SHVVALA TO ADDRESS OF EVALBLOCK-EVDATA.
           CALL 'SETPTR' USING WS-VARNAME-DISPLOPT
                               SHVNAMA.
           MOVE 1 TO SHVBUFL.
           CALL 'SETPTR' USING WS-DISPLOPT
                               SHVVALA.
           CALL 'IRXEXCOM' USING BY CONTENT   'IRXEXCOM'
                                 BY REFERENCE DUMMY-PARM
                                              DUMMY-PARM
                                              SHVBLOCK.

      ******************************************************************
      *                                                                *
      *            RETURN TO DIALOG MANAGER AFTER ANY ERRORS           *
      *                                                                *
      ******************************************************************

           CALL 'ISPLINK' USING WS-CONTROL WS-ERRORS WS-RETURN.

      ******************************************************************
      *                                                                *
      *           OPEN HAILING FREQUENCIES TO REXX VARIABLES           *
      *                                                                *
      ******************************************************************

           CALL 'ISPLINK' USING WS-VDEFINE WS-RESL-NAME WS-RESL
                                WS-CHAR WS-RESL-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-MBRL-NAME WS-MBRL
                                WS-CHAR WS-MBRL-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT1L-NAME WS-STAT1L
                                WS-CHAR WS-STAT1L-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT2L-NAME WS-STAT2L
                                WS-CHAR WS-STAT2L-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT3L-NAME WS-STAT3L
                                WS-CHAR WS-STAT3L-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT4L-NAME WS-STAT4L
                                WS-CHAR WS-STAT4L-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT5L-NAME WS-STAT5L
                                WS-CHAR WS-STAT5L-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT6L-NAME WS-STAT6L
                                WS-CHAR WS-STAT6L-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT7L-NAME WS-STAT7L
                                WS-CHAR WS-STAT7L-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-RESR-NAME WS-RESR
                                WS-CHAR WS-RESR-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-MBRR-NAME WS-MBRR
                                WS-CHAR WS-MBRR-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT1R-NAME WS-STAT1R
                                WS-CHAR WS-STAT1R-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT2R-NAME WS-STAT2R
                                WS-CHAR WS-STAT2R-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT3R-NAME WS-STAT3R
                                WS-CHAR WS-STAT3R-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT4R-NAME WS-STAT4R
                                WS-CHAR WS-STAT4R-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT5R-NAME WS-STAT5R
                                WS-CHAR WS-STAT5R-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT6R-NAME WS-STAT6R
                                WS-CHAR WS-STAT6R-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-STAT7R-NAME WS-STAT7R
                                WS-CHAR WS-STAT7R-LENGTH.
           CALL 'ISPLINK' USING WS-VDEFINE WS-ZERRALRM-NAME WS-ZERRALRM
                                WS-CHAR WS-ZERRALRM-LENGTH.

      ******************************************************************
      *                                                                *
      *                 OPEN THE TWO MEMBER LIST FILES                 *
      *                                                                *
      ******************************************************************

           OPEN INPUT MEMBER-LIST-LEFT
                      MEMBER-LIST-RIGHT.

      ******************************************************************
      *                                                                *
      *                  CREATE THE MEMBER LIST TABLE                  *
      *                                                                *
      ******************************************************************

           PERFORM UNTIL WS-TABLE-CREATED
              CALL 'ISPLINK' USING WS-TBCREATE
                                   WS-TBLNAME
                                   WS-TBCREATE-KEYNAME-LIST
                                   WS-TBCREATE-NAMELIST
                                   WS-NOWRITE
              IF RETURN-CODE = 8
                 ADD 1 TO WS-TBLNBR
                 IF WS-TBLNBR GREATER THAN WS-TABLE-LIMIT
                    MOVE 12 TO RETURN-CODE
                    CALL 'ISPLINK' USING WS-SETMSG WS-TBL-LIMIT-MSG
                    MOVE 1 TO WS-PGM-MSG-SW
                    GO TO 0190-MAIN
                 END-IF
              END-IF
              IF RETURN-CODE GREATER THAN 4 AND
                 RETURN-CODE NOT EQUAL 8
                 MOVE 1 TO WS-SYSTEM-MSG-SW
                 GO TO 0190-MAIN
              END-IF
              IF RETURN-CODE EQUAL ZERO
                 MOVE 1 TO WS-TABLE-CREATED-SW
              END-IF
           END-PERFORM.

      ******************************************************************
      *                                                                *
      *       MATCH THE LEFT AND RIGHT MEMBER LISTS TO EACH OTHER      *
      *                                                                *
      ******************************************************************

           PERFORM 0800-READ-LEFT-MEMBER THRU
                   0899-READ-LEFT-MEMBER-EXIT.
           PERFORM 0900-READ-RIGHT-MEMBER THRU
                   0999-READ-RIGHT-MEMBER-EXIT.
           IF WS-EOF-LEFT-LIST AND
              WS-EOF-RIGHT-LIST
              MOVE 1 TO WS-EOF-BOTH-LISTS-SW.
           PERFORM UNTIL WS-EOF-BOTH-LISTS
              PERFORM 1000-BLANK-LEFT-STATS THRU
                      1099-BLANK-LEFT-STATS-EXIT
              PERFORM 1100-BLANK-RIGHT-STATS THRU
                      1199-BLANK-RIGHT-STATS-EXIT
              EVALUATE TRUE
                WHEN WS-EOF-LEFT-LIST AND
                     WS-EOF-RIGHT-LIST
                     MOVE 1 TO WS-EOF-BOTH-LISTS-SW
                WHEN NOT WS-EOF-LEFT-LIST AND
                     NOT WS-EOF-RIGHT-LIST
                     PERFORM 0200-PROCESS-BOTH-MEMBERS THRU
                             0299-PROCESS-BOTH-MEMBERS-EXIT
                WHEN WS-EOF-LEFT-LIST AND NOT
                     WS-EOF-RIGHT-LIST
                     PERFORM 0300-PROCESS-RIGHT-MEMBER THRU
                             0399-PROCESS-RIGHT-MEMBER-EXIT
                WHEN NOT WS-EOF-LEFT-LIST AND
                         WS-EOF-RIGHT-LIST
                     PERFORM 0400-PROCESS-LEFT-MEMBER THRU
                             0499-PROCESS-LEFT-MEMBER-EXIT
              END-EVALUATE
              IF WS-SYSTEM-MSG
                 GO TO 0190-MAIN
              END-IF
           END-PERFORM.

      ******************************************************************
      *                                                                *
      *          POSITION TO THE TOP OF THE MEMBER LIST TABLE          *
      *                                                                *
      ******************************************************************

           CALL 'ISPLINK' USING WS-TBTOP WS-TBLNAME.

      ******************************************************************
      *                                                                *
      *         SET UP THE RETURN TO THE REXX CALLING PROGRAM          *
      *                                                                *
      ******************************************************************

       0190-MAIN.
           CLOSE MEMBER-LIST-LEFT
                 MEMBER-LIST-RIGHT.
           CALL 'ISPLINK' USING WS-VRESET.
           SET ADDRESS OF EVALBLOCK TO EFPLEVAL.
           EVALUATE TRUE
             WHEN WS-SYSTEM-MSG
               MOVE 'E' TO EVALBLOCK-RETTYPE
               MOVE 12 TO EVALBLOCK-RETCODE
               MOVE +4 TO EVALBLOCK-EVLEN
               CALL 'ISPLINK' USING WS-SETMSG WS-ISRZ002
             WHEN WS-PGM-MSG
               MOVE 'E' TO EVALBLOCK-RETTYPE
               MOVE 12 TO EVALBLOCK-RETCODE
               MOVE +4 TO EVALBLOCK-EVLEN
             WHEN OTHER
                MOVE WS-NBR-MBRS-LEFT TO WS-NBR-MBRS-LEFT-Z
                MOVE WS-NBR-MBRS-RIGHT TO WS-NBR-MBRS-RIGHT-Z
                MOVE WS-NBR-OF-MBRS TO WS-NBR-OF-MBRS-Z
                MOVE WS-TBLNAME TO WS-TBLNAME-RETURN
                MOVE WS-RETURN-TEXT TO EVALBLOCK-EVDATA
                MOVE +28 TO EVALBLOCK-EVLEN
           END-EVALUATE.
           MOVE 'S' TO SHVCODE.
           CALL 'SETPTR' USING WS-VARNAME-RTNNAME
                               SHVNAMA.
           MOVE WS-RTNNAME-LENGTH TO SHVNAML.
           SET SHVVALA TO ADDRESS OF EVALBLOCK-EVDATA.
           MOVE EVALBLOCK-EVLEN TO SHVVALL.
           CALL 'IRXEXCOM' USING BY CONTENT   'IRXEXCOM'
                                 BY REFERENCE DUMMY-PARM
                                              DUMMY-PARM
                                              SHVBLOCK.
       0199-MAIN.
           GOBACK.

      ******************************************************************
      *                                                                *
      *               PROCESS MEMBERS FROM BOTH DATASETS               *
      *                                                                *
      ******************************************************************

       0200-PROCESS-BOTH-MEMBERS.
           EVALUATE TRUE
             WHEN WS-MBR-NAME-LEFT LESS THAN
                  WS-MBR-NAME-RIGHT
                  PERFORM 0400-PROCESS-LEFT-MEMBER THRU
                          0499-PROCESS-LEFT-MEMBER-EXIT
             WHEN WS-MBR-NAME-RIGHT LESS THAN
                  WS-MBR-NAME-LEFT
                  PERFORM 0300-PROCESS-RIGHT-MEMBER THRU
                          0399-PROCESS-RIGHT-MEMBER-EXIT
             WHEN WS-MBR-NAME-LEFT EQUAL
                  WS-MBR-NAME-RIGHT
                  PERFORM 0500-ADD-BOTH-MEMBERS THRU
                          0599-ADD-BOTH-MEMBERS-EXIT
           END-EVALUATE.
       0299-PROCESS-BOTH-MEMBERS-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *               PROCESS RIGHT-SIDE DATASET MEMBER                *
      *                                                                *
      ******************************************************************

       0300-PROCESS-RIGHT-MEMBER.
           IF WS-DONT-PROCESS-RIGHT
              GO TO 0390-PROCESS-RIGHT-MEMBER.
           PERFORM 1300-FILL-RIGHT-STATS THRU
                   1399-FILL-RIGHT-STATS-EXIT.
           PERFORM 0700-ADD-TO-TABLE THRU
                   0799-ADD-TO-TABLE-EXIT.
       0390-PROCESS-RIGHT-MEMBER.
           PERFORM 0900-READ-RIGHT-MEMBER THRU
                   0999-READ-RIGHT-MEMBER-EXIT.
       0399-PROCESS-RIGHT-MEMBER-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *                PROCESS LEFT-SIDE DATASET MEMBER                *
      *                                                                *
      ******************************************************************

       0400-PROCESS-LEFT-MEMBER.
           IF WS-DONT-PROCESS-LEFT
              GO TO 0490-PROCESS-LEFT-MEMBER.
           PERFORM 1200-FILL-LEFT-STATS THRU
                   1299-FILL-LEFT-STATS-EXIT.
           PERFORM 0700-ADD-TO-TABLE THRU
                   0799-ADD-TO-TABLE-EXIT.
       0490-PROCESS-LEFT-MEMBER.
           PERFORM 0800-READ-LEFT-MEMBER THRU
                   0899-READ-LEFT-MEMBER-EXIT.
       0499-PROCESS-LEFT-MEMBER-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *               ADD BOTH MEMBERS TO THE ISPF TABLE               *
      *                                                                *
      ******************************************************************

       0500-ADD-BOTH-MEMBERS.
           PERFORM 0600-MATCH-STATS THRU
                   0699-MATCH-STATS-EXIT.
           IF WS-DONT-PROCESS-EITHER
              GO TO 0590-ADD-BOTH-MEMBERS.
           IF WS-STATSAME AND WS-NO-MATCHING-STATS
              GO TO 0590-ADD-BOTH-MEMBERS.
           IF WS-STATDIFF AND WS-MATCHING-STATS
              GO TO 0590-ADD-BOTH-MEMBERS.
           IF WS-OLDRLEFT AND NOT WS-LEFT-OLDER
              GO TO 0590-ADD-BOTH-MEMBERS.
           IF WS-OLDRRITE AND NOT WS-RIGHT-OLDER
              GO TO 0590-ADD-BOTH-MEMBERS.
           PERFORM 1200-FILL-LEFT-STATS THRU
                   1299-FILL-LEFT-STATS-EXIT.
           PERFORM 1300-FILL-RIGHT-STATS THRU
                   1399-FILL-RIGHT-STATS-EXIT.
           PERFORM 0700-ADD-TO-TABLE THRU
                   0799-ADD-TO-TABLE-EXIT.
       0590-ADD-BOTH-MEMBERS.
           PERFORM 0900-READ-RIGHT-MEMBER THRU
                   0999-READ-RIGHT-MEMBER-EXIT.
           PERFORM 0800-READ-LEFT-MEMBER THRU
                   0899-READ-LEFT-MEMBER-EXIT.
       0599-ADD-BOTH-MEMBERS-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *               MATCH RIGHT- AND LEFT-MEMBER STATS               *
      *                                                                *
      ******************************************************************

       0600-MATCH-STATS.
           MOVE ZERO  TO WS-MATCHING-STATS-SW.
           MOVE SPACE TO WS-OLDER-FLAG.
           IF WS-STATS-FLDS-LEFT  EQUAL SPACES  AND
              WS-STATS-FLDS-RIGHT EQUAL SPACES
              MOVE 1 TO WS-MATCHING-STATS-SW
              GO TO 0699-MATCH-STATS-EXIT.
           IF WS-OLDRLEFT
              IF WS-CHANGED-LEFT  EQUAL SPACES OR
                 WS-CHANGED-RIGHT EQUAL SPACES
                 GO TO 0699-MATCH-STATS-EXIT
              ELSE
                 IF WS-CHANGED-LEFT LESS THAN WS-CHANGED-RIGHT
                    MOVE 'L' TO WS-OLDER-FLAG
                    GO TO 0699-MATCH-STATS-EXIT.
           IF WS-OLDRLEFT
              IF WS-CHANGED-LEFT EQUAL WS-CHANGED-RIGHT
                 IF WS-TIME-LEFT LESS THAN WS-TIME-RIGHT
                    MOVE 'L' TO WS-OLDER-FLAG
                    GO TO 0699-MATCH-STATS-EXIT.
           IF WS-OLDRRITE
              IF WS-CHANGED-LEFT  EQUAL SPACES OR
                 WS-CHANGED-RIGHT EQUAL SPACES
                 GO TO 0699-MATCH-STATS-EXIT
              ELSE
                 IF WS-CHANGED-RIGHT LESS THAN WS-CHANGED-LEFT
                    MOVE 'R' TO WS-OLDER-FLAG
                    GO TO 0699-MATCH-STATS-EXIT.
           IF WS-OLDRRITE
              IF WS-CHANGED-RIGHT EQUAL WS-CHANGED-LEFT
                 IF WS-TIME-RIGHT LESS THAN WS-TIME-LEFT
                    MOVE 'R' TO WS-OLDER-FLAG
                    GO TO 0699-MATCH-STATS-EXIT.
           EVALUATE TRUE
             WHEN (WS-STATS-FLDS-LEFT = WS-STATS-FLDS-RIGHT) AND
                  (WS-STATS-FLDS-LEFT  NOT EQUAL SPACES      AND
                   WS-STATS-FLDS-RIGHT NOT EQUAL SPACES)
                  MOVE 1 TO WS-MATCHING-STATS-SW
             WHEN (WS-STATS-FLDS-LEFT NOT = WS-STATS-FLDS-RIGHT)
                  MOVE 0 TO WS-MATCHING-STATS-SW
           END-EVALUATE.
       0699-MATCH-STATS-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *                  ADD ROW TO MEMBER LIST TABLE                  *
      *                                                                *
      ******************************************************************

       0700-ADD-TO-TABLE.
           CALL 'ISPLINK' USING WS-TBADD WS-TBLNAME.
           IF RETURN-CODE GREATER THAN ZERO
              MOVE 1 TO WS-SYSTEM-MSG-SW.
           ADD 1 TO WS-NBR-OF-MBRS.
       0799-ADD-TO-TABLE-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *                  READ LEFT-SIDE MEMBER RECORD                  *
      *                                                                *
      ******************************************************************

       0800-READ-LEFT-MEMBER.
           READ MEMBER-LIST-LEFT INTO
                WS-MBR-REC-LEFT
                AT END
                   MOVE 1 TO WS-EOF-LEFT-LIST-SW.
       0899-READ-LEFT-MEMBER-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *                 READ RIGHT-SIDE MEMBER RECORD                  *
      *                                                                *
      ******************************************************************

       0900-READ-RIGHT-MEMBER.
           READ MEMBER-LIST-RIGHT INTO
                WS-MBR-REC-RIGHT
                AT END
                   MOVE 1 TO WS-EOF-RIGHT-LIST-SW.
       0999-READ-RIGHT-MEMBER-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *            BLANK THE LEFT-SIDE MEMBER STATS FIELDS             *
      *                                                                *
      ******************************************************************

       1000-BLANK-LEFT-STATS.
           MOVE SPACES TO WS-MBRL
                          WS-STAT1L
                          WS-STAT2L
                          WS-STAT3L
                          WS-STAT4L
                          WS-STAT5L
                          WS-STAT6L
                          WS-STAT7L.
       1099-BLANK-LEFT-STATS-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *            BLANK THE RIGHT-SIDE MEMBER STATS FIELDS            *
      *                                                                *
      ******************************************************************

       1100-BLANK-RIGHT-STATS.
           MOVE SPACES TO WS-MBRR
                          WS-STAT1R
                          WS-STAT2R
                          WS-STAT3R
                          WS-STAT4R
                          WS-STAT5R
                          WS-STAT6R
                          WS-STAT7R.
       1199-BLANK-RIGHT-STATS-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *            FILL THE RIGHT-SIDE MEMBER STATS FIELDS             *
      *                                                                *
      ******************************************************************

       1200-FILL-LEFT-STATS.
           MOVE WS-MBR-NAME-LEFT  TO WS-MBRL.
           MOVE WS-VVMM-LEFT      TO WS-S1L-VVMM.
           MOVE WS-CREATED-LEFT   TO WS-DATE-WORK.
           MOVE WS-DW-YMD         TO WS-S1L-CREATED
                                     WS-S2L-CREATED.
           MOVE WS-CHANGED-LEFT   TO WS-DATE-WORK.
           MOVE WS-DW-YMD         TO WS-S1L-CHANGED
                                     WS-S2L-CHANGED
                                     WS-S3L-CHANGED.
           MOVE WS-TIME-LEFT      TO WS-TIME-WORK.
           MOVE WS-TW-HH          TO WS-TW2-HH.
           MOVE WS-TW-MMSS        TO WS-TW2-MMSS
           MOVE WS-TIME-WORK-2    TO WS-S2L-TIME
                                     WS-S3L-TIME
                                     WS-S4L-TIME.
           MOVE WS-SIZE-LEFT      TO WS-S3L-SIZE
                                     WS-S4L-SIZE
                                     WS-S5L-SIZE.
           MOVE WS-INIT-LEFT      TO WS-S4L-INIT
                                     WS-S5L-INIT
                                     WS-S6L-INIT.
           MOVE WS-MOD-LEFT       TO WS-S5L-MOD
                                     WS-S6L-MOD
                                     WS-S7L-MOD.
           MOVE WS-USER-LEFT      TO WS-S6L-USER
                                     WS-S7L-USER.
           MOVE WS-ALIAS-LEFT     TO WS-S7L-ALIAS.
           MOVE WS-S1L TO WS-STAT1L.
           MOVE WS-S2L TO WS-STAT2L.
           MOVE WS-S3L TO WS-STAT3L.
           MOVE WS-S4L TO WS-STAT4L.
           MOVE WS-S5L TO WS-STAT5L.
           MOVE WS-S6L TO WS-STAT6L.
           MOVE WS-S7L TO WS-STAT7L.
           ADD 1 TO WS-NBR-MBRS-LEFT.
       1299-FILL-LEFT-STATS-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *             FILL THE LEFT-SIDE MEMBER STATS FIELDS             *
      *                                                                *
      ******************************************************************

       1300-FILL-RIGHT-STATS.
           MOVE WS-MBR-NAME-RIGHT  TO WS-MBRR.
           MOVE WS-VVMM-RIGHT      TO WS-S1R-VVMM.
           MOVE WS-CREATED-RIGHT   TO WS-DATE-WORK.
           MOVE WS-DW-YMD          TO WS-S1R-CREATED
                                      WS-S2R-CREATED.
           MOVE WS-CHANGED-RIGHT   TO WS-DATE-WORK.
           MOVE WS-DW-YMD          TO WS-S1R-CHANGED
                                      WS-S2R-CHANGED
                                      WS-S3R-CHANGED.
           MOVE WS-TIME-RIGHT      TO WS-TIME-WORK.
           MOVE WS-TW-HH           TO WS-TW2-HH.
           MOVE WS-TW-MMSS         TO WS-TW2-MMSS
           MOVE WS-TIME-WORK-2     TO WS-S2R-TIME
                                      WS-S3R-TIME
                                      WS-S4R-TIME.
           MOVE WS-SIZE-RIGHT      TO WS-S3R-SIZE
                                      WS-S4R-SIZE
                                      WS-S5R-SIZE.
           MOVE WS-INIT-RIGHT      TO WS-S4R-INIT
                                      WS-S5R-INIT
                                      WS-S6R-INIT.
           MOVE WS-MOD-RIGHT       TO WS-S5R-MOD
                                      WS-S6R-MOD
                                      WS-S7R-MOD.
           MOVE WS-USER-RIGHT      TO WS-S6R-USER
                                      WS-S7R-USER.
           MOVE WS-ALIAS-RIGHT     TO WS-S7R-ALIAS.
           MOVE WS-S1R TO WS-STAT1R.
           MOVE WS-S2R TO WS-STAT2R.
           MOVE WS-S3R TO WS-STAT3R.
           MOVE WS-S4R TO WS-STAT4R.
           MOVE WS-S5R TO WS-STAT5R.
           MOVE WS-S6R TO WS-STAT6R.
           MOVE WS-S7R TO WS-STAT7R.
           ADD 1 TO WS-NBR-MBRS-RIGHT.
       1399-FILL-RIGHT-STATS-EXIT.
           EXIT.

      ******************************************************************
      *                                                                *
      *                      NESTED PROGRAM SETPTR                     *
      *                                                                *
      ******************************************************************

       IDENTIFICATION DIVISION.
       PROGRAM-ID. SETPTR.
       DATA DIVISION.
       LINKAGE SECTION.
       01  VAR-DATA                      PIC X(250).
       01  VAR-PTR                       POINTER.
       PROCEDURE DIVISION
                 USING VAR-DATA
                       VAR-PTR.
           SET VAR-PTR TO ADDRESS OF VAR-DATA.
           GOBACK.
       END PROGRAM SETPTR.
       END PROGRAM P2PBTBL.
