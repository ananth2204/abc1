/*                                                                      rexx
  REXXGBLV IVP - test build 064
*/
trace off

 say 'RexxGblv version:' Rexxgblv('version')
 say ''

 say 'Test index'
 data.f='foxtrot'
 data.d='delta'
 data.x='xerox'
 data.k='kilo'
 data.e='echo'
 data.m='midway'
 Call RunPgm 'rlist var(data.)','data. before',0
 Call RunPgm 'rindex var(data.) stem(index.)','make index',0
 Call RunPgm 'rlist var(index.)'
 if index.0<>6 | index.6<>'DATA.F' then exit xmsg('Index not correct',8)
 drop data. index.

 say 'Test stemix'
 CAR.BMW   = 'german car make'
 CAR.FORD  = 'USA car make'
 CAR.MAZDA = 'japanese car make'
 CAR.PEUGEOT = 'french car make'
 Call RunPgm 'stemix stem(car.) ',0
 Call RunPgm 'rlist var(car.)'
 if car.0<>4               then exit xmsg('Stemix not correct',8)

 /* * for default pool */
 call Runpgm 'save var(car.) pool(*)'
 call Runpgm 'list           pool(*)'

 exit Xmsg('All ok...')

RunPgm:
 if arg(2)<>'' then say '->' space(arg(2) '-' arg(1))
 else               say '->' space(arg(1))
 cc=RexxGblv(arg(1))
 say 'rc='cc+0,
     'vsaven='REXXGBLV_VSAVEN+0,
     'vloadn='REXXGBLV_VLOADN+0,
     'vlistn='REXXGBLV_VLISTN+0,
     'vdeln='REXXGBLV_VdelN+0,
     'rlistn='REXXGBLV_RLISTN+0,
     'rloadn='REXXGBLV_RLOADN+0,
     'importn='REXXGBLV_importn+0,
     'exportn='REXXGBLV_exportn+0,
     'maxnl='REXXGBLV_MAXNL+0,
     'maxdl='REXXGBLV_MAXDL+0,
     'maxndl='REXXGBLV_MAXNDL+0,
     'text='space(REXXGBLV_msg)
 say ''
 if cc<=word(arg(3) 0,1) then return 0
 exit xmsg('**Error',8)
XMsg: if arg(1)<>'' then say arg(1);return word(arg(2) 0,1)
